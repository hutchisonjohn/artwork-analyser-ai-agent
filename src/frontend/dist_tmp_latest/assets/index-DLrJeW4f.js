var Mg=g=>{throw TypeError(g)};var Hu=(g,t,i)=>t.has(g)||Mg("Cannot "+i);var Jt=(g,t,i)=>(Hu(g,t,"read from private field"),i?i.call(g):t.get(g)),Fi=(g,t,i)=>t.has(g)?Mg("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(g):t.set(g,i),Ke=(g,t,i,s)=>(Hu(g,t,"write to private field"),s?s.call(g,i):t.set(g,i),i),Hi=(g,t,i)=>(Hu(g,t,"access private method"),i);var Dg=(g,t,i,s)=>({set _(r){Ke(g,t,r,i)},get _(){return Jt(g,t,s)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function i(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(r){if(r.ep)return;r.ep=!0;const l=i(r);fetch(r.href,l)}})();var Iu={exports:{}},fr={};var Rg;function y0(){if(Rg)return fr;Rg=1;var g=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function i(s,r,l){var c=null;if(l!==void 0&&(c=""+l),r.key!==void 0&&(c=""+r.key),"key"in r){l={};for(var u in r)u!=="key"&&(l[u]=r[u])}else l=r;return r=l.ref,{$$typeof:g,type:s,key:c,ref:r!==void 0?r:null,props:l}}return fr.Fragment=t,fr.jsx=i,fr.jsxs=i,fr}var Ng;function b0(){return Ng||(Ng=1,Iu.exports=y0()),Iu.exports}var C=b0(),Gu={exports:{}},gt={};var Og;function v0(){if(Og)return gt;Og=1;var g=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),b=Symbol.iterator;function A(R){return R===null||typeof R!="object"?null:(R=b&&R[b]||R["@@iterator"],typeof R=="function"?R:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,E={};function _(R,I,Q){this.props=R,this.context=I,this.refs=E,this.updater=Q||w}_.prototype.isReactComponent={},_.prototype.setState=function(R,I){if(typeof R!="object"&&typeof R!="function"&&R!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,R,I,"setState")},_.prototype.forceUpdate=function(R){this.updater.enqueueForceUpdate(this,R,"forceUpdate")};function D(){}D.prototype=_.prototype;function T(R,I,Q){this.props=R,this.context=I,this.refs=E,this.updater=Q||w}var B=T.prototype=new D;B.constructor=T,S(B,_.prototype),B.isPureReactComponent=!0;var O=Array.isArray;function L(){}var P={H:null,A:null,T:null,S:null},q=Object.prototype.hasOwnProperty;function K(R,I,Q){var et=Q.ref;return{$$typeof:g,type:R,key:I,ref:et!==void 0?et:null,props:Q}}function J(R,I){return K(R.type,I,R.props)}function W(R){return typeof R=="object"&&R!==null&&R.$$typeof===g}function ht(R){var I={"=":"=0",":":"=2"};return"$"+R.replace(/[=:]/g,function(Q){return I[Q]})}var yt=/\/+/g;function bt(R,I){return typeof R=="object"&&R!==null&&R.key!=null?ht(""+R.key):I.toString(36)}function vt(R){switch(R.status){case"fulfilled":return R.value;case"rejected":throw R.reason;default:switch(typeof R.status=="string"?R.then(L,L):(R.status="pending",R.then(function(I){R.status==="pending"&&(R.status="fulfilled",R.value=I)},function(I){R.status==="pending"&&(R.status="rejected",R.reason=I)})),R.status){case"fulfilled":return R.value;case"rejected":throw R.reason}}throw R}function k(R,I,Q,et,ct){var ft=typeof R;(ft==="undefined"||ft==="boolean")&&(R=null);var ut=!1;if(R===null)ut=!0;else switch(ft){case"bigint":case"string":case"number":ut=!0;break;case"object":switch(R.$$typeof){case g:case t:ut=!0;break;case m:return ut=R._init,k(ut(R._payload),I,Q,et,ct)}}if(ut)return ct=ct(R),ut=et===""?"."+bt(R,0):et,O(ct)?(Q="",ut!=null&&(Q=ut.replace(yt,"$&/")+"/"),k(ct,I,Q,"",function(Li){return Li})):ct!=null&&(W(ct)&&(ct=J(ct,Q+(ct.key==null||R&&R.key===ct.key?"":(""+ct.key).replace(yt,"$&/")+"/")+ut)),I.push(ct)),1;ut=0;var ee=et===""?".":et+":";if(O(R))for(var jt=0;jt<R.length;jt++)et=R[jt],ft=ee+bt(et,jt),ut+=k(et,I,Q,ft,ct);else if(jt=A(R),typeof jt=="function")for(R=jt.call(R),jt=0;!(et=R.next()).done;)et=et.value,ft=ee+bt(et,jt++),ut+=k(et,I,Q,ft,ct);else if(ft==="object"){if(typeof R.then=="function")return k(vt(R),I,Q,et,ct);throw I=String(R),Error("Objects are not valid as a React child (found: "+(I==="[object Object]"?"object with keys {"+Object.keys(R).join(", ")+"}":I)+"). If you meant to render a collection of children, use an array instead.")}return ut}function V(R,I,Q){if(R==null)return R;var et=[],ct=0;return k(R,et,"","",function(ft){return I.call(Q,ft,ct++)}),et}function tt(R){if(R._status===-1){var I=R._result;I=I(),I.then(function(Q){(R._status===0||R._status===-1)&&(R._status=1,R._result=Q)},function(Q){(R._status===0||R._status===-1)&&(R._status=2,R._result=Q)}),R._status===-1&&(R._status=0,R._result=I)}if(R._status===1)return R._result.default;throw R._result}var pt=typeof reportError=="function"?reportError:function(R){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var I=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof R=="object"&&R!==null&&typeof R.message=="string"?String(R.message):String(R),error:R});if(!window.dispatchEvent(I))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",R);return}console.error(R)},xt={map:V,forEach:function(R,I,Q){V(R,function(){I.apply(this,arguments)},Q)},count:function(R){var I=0;return V(R,function(){I++}),I},toArray:function(R){return V(R,function(I){return I})||[]},only:function(R){if(!W(R))throw Error("React.Children.only expected to receive a single React element child.");return R}};return gt.Activity=y,gt.Children=xt,gt.Component=_,gt.Fragment=i,gt.Profiler=r,gt.PureComponent=T,gt.StrictMode=s,gt.Suspense=h,gt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=P,gt.__COMPILER_RUNTIME={__proto__:null,c:function(R){return P.H.useMemoCache(R)}},gt.cache=function(R){return function(){return R.apply(null,arguments)}},gt.cacheSignal=function(){return null},gt.cloneElement=function(R,I,Q){if(R==null)throw Error("The argument must be a React element, but you passed "+R+".");var et=S({},R.props),ct=R.key;if(I!=null)for(ft in I.key!==void 0&&(ct=""+I.key),I)!q.call(I,ft)||ft==="key"||ft==="__self"||ft==="__source"||ft==="ref"&&I.ref===void 0||(et[ft]=I[ft]);var ft=arguments.length-2;if(ft===1)et.children=Q;else if(1<ft){for(var ut=Array(ft),ee=0;ee<ft;ee++)ut[ee]=arguments[ee+2];et.children=ut}return K(R.type,ct,et)},gt.createContext=function(R){return R={$$typeof:c,_currentValue:R,_currentValue2:R,_threadCount:0,Provider:null,Consumer:null},R.Provider=R,R.Consumer={$$typeof:l,_context:R},R},gt.createElement=function(R,I,Q){var et,ct={},ft=null;if(I!=null)for(et in I.key!==void 0&&(ft=""+I.key),I)q.call(I,et)&&et!=="key"&&et!=="__self"&&et!=="__source"&&(ct[et]=I[et]);var ut=arguments.length-2;if(ut===1)ct.children=Q;else if(1<ut){for(var ee=Array(ut),jt=0;jt<ut;jt++)ee[jt]=arguments[jt+2];ct.children=ee}if(R&&R.defaultProps)for(et in ut=R.defaultProps,ut)ct[et]===void 0&&(ct[et]=ut[et]);return K(R,ft,ct)},gt.createRef=function(){return{current:null}},gt.forwardRef=function(R){return{$$typeof:u,render:R}},gt.isValidElement=W,gt.lazy=function(R){return{$$typeof:m,_payload:{_status:-1,_result:R},_init:tt}},gt.memo=function(R,I){return{$$typeof:f,type:R,compare:I===void 0?null:I}},gt.startTransition=function(R){var I=P.T,Q={};P.T=Q;try{var et=R(),ct=P.S;ct!==null&&ct(Q,et),typeof et=="object"&&et!==null&&typeof et.then=="function"&&et.then(L,pt)}catch(ft){pt(ft)}finally{I!==null&&Q.types!==null&&(I.types=Q.types),P.T=I}},gt.unstable_useCacheRefresh=function(){return P.H.useCacheRefresh()},gt.use=function(R){return P.H.use(R)},gt.useActionState=function(R,I,Q){return P.H.useActionState(R,I,Q)},gt.useCallback=function(R,I){return P.H.useCallback(R,I)},gt.useContext=function(R){return P.H.useContext(R)},gt.useDebugValue=function(){},gt.useDeferredValue=function(R,I){return P.H.useDeferredValue(R,I)},gt.useEffect=function(R,I){return P.H.useEffect(R,I)},gt.useEffectEvent=function(R){return P.H.useEffectEvent(R)},gt.useId=function(){return P.H.useId()},gt.useImperativeHandle=function(R,I,Q){return P.H.useImperativeHandle(R,I,Q)},gt.useInsertionEffect=function(R,I){return P.H.useInsertionEffect(R,I)},gt.useLayoutEffect=function(R,I){return P.H.useLayoutEffect(R,I)},gt.useMemo=function(R,I){return P.H.useMemo(R,I)},gt.useOptimistic=function(R,I){return P.H.useOptimistic(R,I)},gt.useReducer=function(R,I,Q){return P.H.useReducer(R,I,Q)},gt.useRef=function(R){return P.H.useRef(R)},gt.useState=function(R){return P.H.useState(R)},gt.useSyncExternalStore=function(R,I,Q){return P.H.useSyncExternalStore(R,I,Q)},gt.useTransition=function(){return P.H.useTransition()},gt.version="19.2.0",gt}var Lg;function yh(){return Lg||(Lg=1,Gu.exports=v0()),Gu.exports}var at=yh(),qu={exports:{}},pr={},Vu={exports:{}},Xu={};var kg;function A0(){return kg||(kg=1,(function(g){function t(k,V){var tt=k.length;k.push(V);t:for(;0<tt;){var pt=tt-1>>>1,xt=k[pt];if(0<r(xt,V))k[pt]=V,k[tt]=xt,tt=pt;else break t}}function i(k){return k.length===0?null:k[0]}function s(k){if(k.length===0)return null;var V=k[0],tt=k.pop();if(tt!==V){k[0]=tt;t:for(var pt=0,xt=k.length,R=xt>>>1;pt<R;){var I=2*(pt+1)-1,Q=k[I],et=I+1,ct=k[et];if(0>r(Q,tt))et<xt&&0>r(ct,Q)?(k[pt]=ct,k[et]=tt,pt=et):(k[pt]=Q,k[I]=tt,pt=I);else if(et<xt&&0>r(ct,tt))k[pt]=ct,k[et]=tt,pt=et;else break t}}return V}function r(k,V){var tt=k.sortIndex-V.sortIndex;return tt!==0?tt:k.id-V.id}if(g.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;g.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();g.unstable_now=function(){return c.now()-u}}var h=[],f=[],m=1,y=null,b=3,A=!1,w=!1,S=!1,E=!1,_=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function B(k){for(var V=i(f);V!==null;){if(V.callback===null)s(f);else if(V.startTime<=k)s(f),V.sortIndex=V.expirationTime,t(h,V);else break;V=i(f)}}function O(k){if(S=!1,B(k),!w)if(i(h)!==null)w=!0,L||(L=!0,ht());else{var V=i(f);V!==null&&vt(O,V.startTime-k)}}var L=!1,P=-1,q=5,K=-1;function J(){return E?!0:!(g.unstable_now()-K<q)}function W(){if(E=!1,L){var k=g.unstable_now();K=k;var V=!0;try{t:{w=!1,S&&(S=!1,D(P),P=-1),A=!0;var tt=b;try{e:{for(B(k),y=i(h);y!==null&&!(y.expirationTime>k&&J());){var pt=y.callback;if(typeof pt=="function"){y.callback=null,b=y.priorityLevel;var xt=pt(y.expirationTime<=k);if(k=g.unstable_now(),typeof xt=="function"){y.callback=xt,B(k),V=!0;break e}y===i(h)&&s(h),B(k)}else s(h);y=i(h)}if(y!==null)V=!0;else{var R=i(f);R!==null&&vt(O,R.startTime-k),V=!1}}break t}finally{y=null,b=tt,A=!1}V=void 0}}finally{V?ht():L=!1}}}var ht;if(typeof T=="function")ht=function(){T(W)};else if(typeof MessageChannel<"u"){var yt=new MessageChannel,bt=yt.port2;yt.port1.onmessage=W,ht=function(){bt.postMessage(null)}}else ht=function(){_(W,0)};function vt(k,V){P=_(function(){k(g.unstable_now())},V)}g.unstable_IdlePriority=5,g.unstable_ImmediatePriority=1,g.unstable_LowPriority=4,g.unstable_NormalPriority=3,g.unstable_Profiling=null,g.unstable_UserBlockingPriority=2,g.unstable_cancelCallback=function(k){k.callback=null},g.unstable_forceFrameRate=function(k){0>k||125<k?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):q=0<k?Math.floor(1e3/k):5},g.unstable_getCurrentPriorityLevel=function(){return b},g.unstable_next=function(k){switch(b){case 1:case 2:case 3:var V=3;break;default:V=b}var tt=b;b=V;try{return k()}finally{b=tt}},g.unstable_requestPaint=function(){E=!0},g.unstable_runWithPriority=function(k,V){switch(k){case 1:case 2:case 3:case 4:case 5:break;default:k=3}var tt=b;b=k;try{return V()}finally{b=tt}},g.unstable_scheduleCallback=function(k,V,tt){var pt=g.unstable_now();switch(typeof tt=="object"&&tt!==null?(tt=tt.delay,tt=typeof tt=="number"&&0<tt?pt+tt:pt):tt=pt,k){case 1:var xt=-1;break;case 2:xt=250;break;case 5:xt=1073741823;break;case 4:xt=1e4;break;default:xt=5e3}return xt=tt+xt,k={id:m++,callback:V,priorityLevel:k,startTime:tt,expirationTime:xt,sortIndex:-1},tt>pt?(k.sortIndex=tt,t(f,k),i(h)===null&&k===i(f)&&(S?(D(P),P=-1):S=!0,vt(O,tt-pt))):(k.sortIndex=xt,t(h,k),w||A||(w=!0,L||(L=!0,ht()))),k},g.unstable_shouldYield=J,g.unstable_wrapCallback=function(k){var V=b;return function(){var tt=b;b=V;try{return k.apply(this,arguments)}finally{b=tt}}}})(Xu)),Xu}var Bg;function S0(){return Bg||(Bg=1,Vu.exports=A0()),Vu.exports}var Yu={exports:{}},Be={};var zg;function w0(){if(zg)return Be;zg=1;var g=yh();function t(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)f+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var s={d:{f:i,r:function(){throw Error(t(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},r=Symbol.for("react.portal");function l(h,f,m){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:y==null?null:""+y,children:h,containerInfo:f,implementation:m}}var c=g.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Be.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Be.createPortal=function(h,f){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return l(h,f,null,m)},Be.flushSync=function(h){var f=c.T,m=s.p;try{if(c.T=null,s.p=2,h)return h()}finally{c.T=f,s.p=m,s.d.f()}},Be.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,s.d.C(h,f))},Be.prefetchDNS=function(h){typeof h=="string"&&s.d.D(h)},Be.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var m=f.as,y=u(m,f.crossOrigin),b=typeof f.integrity=="string"?f.integrity:void 0,A=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;m==="style"?s.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:y,integrity:b,fetchPriority:A}):m==="script"&&s.d.X(h,{crossOrigin:y,integrity:b,fetchPriority:A,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Be.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var m=u(f.as,f.crossOrigin);s.d.M(h,{crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&s.d.M(h)},Be.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var m=f.as,y=u(m,f.crossOrigin);s.d.L(h,m,{crossOrigin:y,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Be.preloadModule=function(h,f){if(typeof h=="string")if(f){var m=u(f.as,f.crossOrigin);s.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else s.d.m(h)},Be.requestFormReset=function(h){s.d.r(h)},Be.unstable_batchedUpdates=function(h,f){return h(f)},Be.useFormState=function(h,f,m){return c.H.useFormState(h,f,m)},Be.useFormStatus=function(){return c.H.useHostTransitionStatus()},Be.version="19.2.0",Be}var Pg;function x0(){if(Pg)return Yu.exports;Pg=1;function g(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(g)}catch(t){console.error(t)}}return g(),Yu.exports=w0(),Yu.exports}var Ug;function _0(){if(Ug)return pr;Ug=1;var g=S0(),t=yh(),i=x0();function s(e){var n="https://react.dev/errors/"+e;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)n+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function l(e){var n=e,a=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(a=n.return),e=n.return;while(e)}return n.tag===3?a:null}function c(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function u(e){if(e.tag===31){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function h(e){if(l(e)!==e)throw Error(s(188))}function f(e){var n=e.alternate;if(!n){if(n=l(e),n===null)throw Error(s(188));return n!==e?null:e}for(var a=e,o=n;;){var d=a.return;if(d===null)break;var p=d.alternate;if(p===null){if(o=d.return,o!==null){a=o;continue}break}if(d.child===p.child){for(p=d.child;p;){if(p===a)return h(d),e;if(p===o)return h(d),n;p=p.sibling}throw Error(s(188))}if(a.return!==o.return)a=d,o=p;else{for(var v=!1,x=d.child;x;){if(x===a){v=!0,a=d,o=p;break}if(x===o){v=!0,o=d,a=p;break}x=x.sibling}if(!v){for(x=p.child;x;){if(x===a){v=!0,a=p,o=d;break}if(x===o){v=!0,o=p,a=d;break}x=x.sibling}if(!v)throw Error(s(189))}}if(a.alternate!==o)throw Error(s(190))}if(a.tag!==3)throw Error(s(188));return a.stateNode.current===a?e:n}function m(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e;for(e=e.child;e!==null;){if(n=m(e),n!==null)return n;e=e.sibling}return null}var y=Object.assign,b=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),D=Symbol.for("react.consumer"),T=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),K=Symbol.for("react.activity"),J=Symbol.for("react.memo_cache_sentinel"),W=Symbol.iterator;function ht(e){return e===null||typeof e!="object"?null:(e=W&&e[W]||e["@@iterator"],typeof e=="function"?e:null)}var yt=Symbol.for("react.client.reference");function bt(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===yt?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case S:return"Fragment";case _:return"Profiler";case E:return"StrictMode";case O:return"Suspense";case L:return"SuspenseList";case K:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case w:return"Portal";case T:return e.displayName||"Context";case D:return(e._context.displayName||"Context")+".Consumer";case B:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case P:return n=e.displayName||null,n!==null?n:bt(e.type)||"Memo";case q:n=e._payload,e=e._init;try{return bt(e(n))}catch{}}return null}var vt=Array.isArray,k=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,V=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,tt={pending:!1,data:null,method:null,action:null},pt=[],xt=-1;function R(e){return{current:e}}function I(e){0>xt||(e.current=pt[xt],pt[xt]=null,xt--)}function Q(e,n){xt++,pt[xt]=e.current,e.current=n}var et=R(null),ct=R(null),ft=R(null),ut=R(null);function ee(e,n){switch(Q(ft,n),Q(ct,e),Q(et,null),n.nodeType){case 9:case 11:e=(e=n.documentElement)&&(e=e.namespaceURI)?Zp(e):0;break;default:if(e=n.tagName,n=n.namespaceURI)n=Zp(n),e=Wp(n,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}I(et),Q(et,e)}function jt(){I(et),I(ct),I(ft)}function Li(e){e.memoizedState!==null&&Q(ut,e);var n=et.current,a=Wp(n,e.type);n!==a&&(Q(ct,e),Q(et,a))}function Ti(e){ct.current===e&&(I(et),I(ct)),ut.current===e&&(I(ut),cr._currentValue=tt)}var ui,Je;function hi(e){if(ui===void 0)try{throw Error()}catch(a){var n=a.stack.trim().match(/\n( *(at )?)/);ui=n&&n[1]||"",Je=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ui+e+Je}var Le=!1;function As(e,n){if(!e||Le)return"";Le=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var o={DetermineComponentFrameRoot:function(){try{if(n){var $=function(){throw Error()};if(Object.defineProperty($.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct($,[])}catch(G){var H=G}Reflect.construct(e,[],$)}else{try{$.call()}catch(G){H=G}e.call($.prototype)}}else{try{throw Error()}catch(G){H=G}($=e())&&typeof $.catch=="function"&&$.catch(function(){})}}catch(G){if(G&&H&&typeof G.stack=="string")return[G.stack,H.stack]}return[null,null]}};o.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var d=Object.getOwnPropertyDescriptor(o.DetermineComponentFrameRoot,"name");d&&d.configurable&&Object.defineProperty(o.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=o.DetermineComponentFrameRoot(),v=p[0],x=p[1];if(v&&x){var M=v.split(`
`),j=x.split(`
`);for(d=o=0;o<M.length&&!M[o].includes("DetermineComponentFrameRoot");)o++;for(;d<j.length&&!j[d].includes("DetermineComponentFrameRoot");)d++;if(o===M.length||d===j.length)for(o=M.length-1,d=j.length-1;1<=o&&0<=d&&M[o]!==j[d];)d--;for(;1<=o&&0<=d;o--,d--)if(M[o]!==j[d]){if(o!==1||d!==1)do if(o--,d--,0>d||M[o]!==j[d]){var X=`
`+M[o].replace(" at new "," at ");return e.displayName&&X.includes("<anonymous>")&&(X=X.replace("<anonymous>",e.displayName)),X}while(1<=o&&0<=d);break}}}finally{Le=!1,Error.prepareStackTrace=a}return(a=e?e.displayName||e.name:"")?hi(a):""}function ki(e,n){switch(e.tag){case 26:case 27:case 5:return hi(e.type);case 16:return hi("Lazy");case 13:return e.child!==n&&n!==null?hi("Suspense Fallback"):hi("Suspense");case 19:return hi("SuspenseList");case 0:case 15:return As(e.type,!1);case 11:return As(e.type.render,!1);case 1:return As(e.type,!0);case 31:return hi("Activity");default:return""}}function Xn(e){try{var n="",a=null;do n+=ki(e,a),a=e,e=e.return;while(e);return n}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}var Bi=Object.prototype.hasOwnProperty,Yi=g.unstable_scheduleCallback,$i=g.unstable_cancelCallback,yn=g.unstable_shouldYield,xl=g.unstable_requestPaint,ke=g.unstable_now,wa=g.unstable_getCurrentPriorityLevel,xa=g.unstable_ImmediatePriority,zr=g.unstable_UserBlockingPriority,Ss=g.unstable_NormalPriority,_l=g.unstable_LowPriority,Pr=g.unstable_IdlePriority,El=g.log,Tl=g.unstable_setDisableYieldValue,Yn=null,Zt=null;function Ci(e){if(typeof El=="function"&&Tl(e),Zt&&typeof Zt.setStrictMode=="function")try{Zt.setStrictMode(Yn,e)}catch{}}var ue=Math.clz32?Math.clz32:Dl,Cl=Math.log,Ml=Math.LN2;function Dl(e){return e>>>=0,e===0?32:31-(Cl(e)/Ml|0)|0}var ws=256,ze=262144,ye=4194304;function ti(e){var n=e&42;if(n!==0)return n;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function F(e,n,a){var o=e.pendingLanes;if(o===0)return 0;var d=0,p=e.suspendedLanes,v=e.pingedLanes;e=e.warmLanes;var x=o&134217727;return x!==0?(o=x&~p,o!==0?d=ti(o):(v&=x,v!==0?d=ti(v):a||(a=x&~e,a!==0&&(d=ti(a))))):(x=o&~p,x!==0?d=ti(x):v!==0?d=ti(v):a||(a=o&~e,a!==0&&(d=ti(a)))),d===0?0:n!==0&&n!==d&&(n&p)===0&&(p=d&-d,a=n&-n,p>=a||p===32&&(a&4194048)!==0)?n:d}function Z(e,n){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&n)===0}function Ot(e,n){switch(e){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Lt(){var e=ye;return ye<<=1,(ye&62914560)===0&&(ye=4194304),e}function It(e){for(var n=[],a=0;31>a;a++)n.push(e);return n}function xe(e,n){e.pendingLanes|=n,n!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Mi(e,n,a,o,d,p){var v=e.pendingLanes;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=a,e.entangledLanes&=a,e.errorRecoveryDisabledLanes&=a,e.shellSuspendCounter=0;var x=e.entanglements,M=e.expirationTimes,j=e.hiddenUpdates;for(a=v&~a;0<a;){var X=31-ue(a),$=1<<X;x[X]=0,M[X]=-1;var H=j[X];if(H!==null)for(j[X]=null,X=0;X<H.length;X++){var G=H[X];G!==null&&(G.lane&=-536870913)}a&=~$}o!==0&&xs(e,o,0),p!==0&&d===0&&e.tag!==0&&(e.suspendedLanes|=p&~(v&~n))}function xs(e,n,a){e.pendingLanes|=n,e.suspendedLanes&=~n;var o=31-ue(n);e.entangledLanes|=n,e.entanglements[o]=e.entanglements[o]|1073741824|a&261930}function Ur(e,n){var a=e.entangledLanes|=n;for(e=e.entanglements;a;){var o=31-ue(a),d=1<<o;d&n|e[o]&n&&(e[o]|=n),a&=~d}}function kh(e,n){var a=n&-n;return a=(a&42)!==0?1:Rl(a),(a&(e.suspendedLanes|n))!==0?0:a}function Rl(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Nl(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Bh(){var e=V.p;return e!==0?e:(e=window.event,e===void 0?32:Sg(e.type))}function zh(e,n){var a=V.p;try{return V.p=e,n()}finally{V.p=a}}var bn=Math.random().toString(36).slice(2),_e="__reactFiber$"+bn,Ie="__reactProps$"+bn,_s="__reactContainer$"+bn,Ol="__reactEvents$"+bn,ry="__reactListeners$"+bn,oy="__reactHandles$"+bn,Ph="__reactResources$"+bn,_a="__reactMarker$"+bn;function Ll(e){delete e[_e],delete e[Ie],delete e[Ol],delete e[ry],delete e[oy]}function Es(e){var n=e[_e];if(n)return n;for(var a=e.parentNode;a;){if(n=a[_s]||a[_e]){if(a=n.alternate,n.child!==null||a!==null&&a.child!==null)for(e=ag(e);e!==null;){if(a=e[_e])return a;e=ag(e)}return n}e=a,a=e.parentNode}return null}function Ts(e){if(e=e[_e]||e[_s]){var n=e.tag;if(n===5||n===6||n===13||n===31||n===26||n===27||n===3)return e}return null}function Ea(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e.stateNode;throw Error(s(33))}function Cs(e){var n=e[Ph];return n||(n=e[Ph]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function ve(e){e[_a]=!0}var Uh=new Set,jh={};function $n(e,n){Ms(e,n),Ms(e+"Capture",n)}function Ms(e,n){for(jh[e]=n,e=0;e<n.length;e++)Uh.add(n[e])}var ly=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Fh={},Hh={};function cy(e){return Bi.call(Hh,e)?!0:Bi.call(Fh,e)?!1:ly.test(e)?Hh[e]=!0:(Fh[e]=!0,!1)}function jr(e,n,a){if(cy(n))if(a===null)e.removeAttribute(n);else{switch(typeof a){case"undefined":case"function":case"symbol":e.removeAttribute(n);return;case"boolean":var o=n.toLowerCase().slice(0,5);if(o!=="data-"&&o!=="aria-"){e.removeAttribute(n);return}}e.setAttribute(n,""+a)}}function Fr(e,n,a){if(a===null)e.removeAttribute(n);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttribute(n,""+a)}}function Ki(e,n,a,o){if(o===null)e.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(a);return}e.setAttributeNS(n,a,""+o)}}function di(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ih(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function uy(e,n,a){var o=Object.getOwnPropertyDescriptor(e.constructor.prototype,n);if(!e.hasOwnProperty(n)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var d=o.get,p=o.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return d.call(this)},set:function(v){a=""+v,p.call(this,v)}}),Object.defineProperty(e,n,{enumerable:o.enumerable}),{getValue:function(){return a},setValue:function(v){a=""+v},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function kl(e){if(!e._valueTracker){var n=Ih(e)?"checked":"value";e._valueTracker=uy(e,n,""+e[n])}}function Gh(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var a=n.getValue(),o="";return e&&(o=Ih(e)?e.checked?"true":"false":e.value),e=o,e!==a?(n.setValue(e),!0):!1}function Hr(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var hy=/[\n"\\]/g;function fi(e){return e.replace(hy,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function Bl(e,n,a,o,d,p,v,x){e.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?e.type=v:e.removeAttribute("type"),n!=null?v==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+di(n)):e.value!==""+di(n)&&(e.value=""+di(n)):v!=="submit"&&v!=="reset"||e.removeAttribute("value"),n!=null?zl(e,v,di(n)):a!=null?zl(e,v,di(a)):o!=null&&e.removeAttribute("value"),d==null&&p!=null&&(e.defaultChecked=!!p),d!=null&&(e.checked=d&&typeof d!="function"&&typeof d!="symbol"),x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?e.name=""+di(x):e.removeAttribute("name")}function qh(e,n,a,o,d,p,v,x){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(e.type=p),n!=null||a!=null){if(!(p!=="submit"&&p!=="reset"||n!=null)){kl(e);return}a=a!=null?""+di(a):"",n=n!=null?""+di(n):a,x||n===e.value||(e.value=n),e.defaultValue=n}o=o??d,o=typeof o!="function"&&typeof o!="symbol"&&!!o,e.checked=x?e.checked:!!o,e.defaultChecked=!!o,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(e.name=v),kl(e)}function zl(e,n,a){n==="number"&&Hr(e.ownerDocument)===e||e.defaultValue===""+a||(e.defaultValue=""+a)}function Ds(e,n,a,o){if(e=e.options,n){n={};for(var d=0;d<a.length;d++)n["$"+a[d]]=!0;for(a=0;a<e.length;a++)d=n.hasOwnProperty("$"+e[a].value),e[a].selected!==d&&(e[a].selected=d),d&&o&&(e[a].defaultSelected=!0)}else{for(a=""+di(a),n=null,d=0;d<e.length;d++){if(e[d].value===a){e[d].selected=!0,o&&(e[d].defaultSelected=!0);return}n!==null||e[d].disabled||(n=e[d])}n!==null&&(n.selected=!0)}}function Vh(e,n,a){if(n!=null&&(n=""+di(n),n!==e.value&&(e.value=n),a==null)){e.defaultValue!==n&&(e.defaultValue=n);return}e.defaultValue=a!=null?""+di(a):""}function Xh(e,n,a,o){if(n==null){if(o!=null){if(a!=null)throw Error(s(92));if(vt(o)){if(1<o.length)throw Error(s(93));o=o[0]}a=o}a==null&&(a=""),n=a}a=di(n),e.defaultValue=a,o=e.textContent,o===a&&o!==""&&o!==null&&(e.value=o),kl(e)}function Rs(e,n){if(n){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=n;return}}e.textContent=n}var dy=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Yh(e,n,a){var o=n.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?o?e.setProperty(n,""):n==="float"?e.cssFloat="":e[n]="":o?e.setProperty(n,a):typeof a!="number"||a===0||dy.has(n)?n==="float"?e.cssFloat=a:e[n]=(""+a).trim():e[n]=a+"px"}function $h(e,n,a){if(n!=null&&typeof n!="object")throw Error(s(62));if(e=e.style,a!=null){for(var o in a)!a.hasOwnProperty(o)||n!=null&&n.hasOwnProperty(o)||(o.indexOf("--")===0?e.setProperty(o,""):o==="float"?e.cssFloat="":e[o]="");for(var d in n)o=n[d],n.hasOwnProperty(d)&&a[d]!==o&&Yh(e,d,o)}else for(var p in n)n.hasOwnProperty(p)&&Yh(e,p,n[p])}function Pl(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var fy=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),py=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ir(e){return py.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Qi(){}var Ul=null;function jl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ns=null,Os=null;function Kh(e){var n=Ts(e);if(n&&(e=n.stateNode)){var a=e[Ie]||null;t:switch(e=n.stateNode,n.type){case"input":if(Bl(e,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),n=a.name,a.type==="radio"&&n!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+fi(""+n)+'"][type="radio"]'),n=0;n<a.length;n++){var o=a[n];if(o!==e&&o.form===e.form){var d=o[Ie]||null;if(!d)throw Error(s(90));Bl(o,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name)}}for(n=0;n<a.length;n++)o=a[n],o.form===e.form&&Gh(o)}break t;case"textarea":Vh(e,a.value,a.defaultValue);break t;case"select":n=a.value,n!=null&&Ds(e,!!a.multiple,n,!1)}}}var Fl=!1;function Qh(e,n,a){if(Fl)return e(n,a);Fl=!0;try{var o=e(n);return o}finally{if(Fl=!1,(Ns!==null||Os!==null)&&(Ro(),Ns&&(n=Ns,e=Os,Os=Ns=null,Kh(n),e)))for(n=0;n<e.length;n++)Kh(e[n])}}function Ta(e,n){var a=e.stateNode;if(a===null)return null;var o=a[Ie]||null;if(o===null)return null;a=o[n];t:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break t;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(s(231,n,typeof a));return a}var Zi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Hl=!1;if(Zi)try{var Ca={};Object.defineProperty(Ca,"passive",{get:function(){Hl=!0}}),window.addEventListener("test",Ca,Ca),window.removeEventListener("test",Ca,Ca)}catch{Hl=!1}var vn=null,Il=null,Gr=null;function Zh(){if(Gr)return Gr;var e,n=Il,a=n.length,o,d="value"in vn?vn.value:vn.textContent,p=d.length;for(e=0;e<a&&n[e]===d[e];e++);var v=a-e;for(o=1;o<=v&&n[a-o]===d[p-o];o++);return Gr=d.slice(e,1<o?1-o:void 0)}function qr(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function Vr(){return!0}function Wh(){return!1}function Ge(e){function n(a,o,d,p,v){this._reactName=a,this._targetInst=d,this.type=o,this.nativeEvent=p,this.target=v,this.currentTarget=null;for(var x in e)e.hasOwnProperty(x)&&(a=e[x],this[x]=a?a(p):p[x]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?Vr:Wh,this.isPropagationStopped=Wh,this}return y(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=Vr)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=Vr)},persist:function(){},isPersistent:Vr}),n}var Kn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xr=Ge(Kn),Ma=y({},Kn,{view:0,detail:0}),gy=Ge(Ma),Gl,ql,Da,Yr=y({},Ma,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xl,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Da&&(Da&&e.type==="mousemove"?(Gl=e.screenX-Da.screenX,ql=e.screenY-Da.screenY):ql=Gl=0,Da=e),Gl)},movementY:function(e){return"movementY"in e?e.movementY:ql}}),Jh=Ge(Yr),my=y({},Yr,{dataTransfer:0}),yy=Ge(my),by=y({},Ma,{relatedTarget:0}),Vl=Ge(by),vy=y({},Kn,{animationName:0,elapsedTime:0,pseudoElement:0}),Ay=Ge(vy),Sy=y({},Kn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),wy=Ge(Sy),xy=y({},Kn,{data:0}),td=Ge(xy),_y={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ey={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ty={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cy(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=Ty[e])?!!n[e]:!1}function Xl(){return Cy}var My=y({},Ma,{key:function(e){if(e.key){var n=_y[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=qr(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Ey[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xl,charCode:function(e){return e.type==="keypress"?qr(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?qr(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Dy=Ge(My),Ry=y({},Yr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ed=Ge(Ry),Ny=y({},Ma,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xl}),Oy=Ge(Ny),Ly=y({},Kn,{propertyName:0,elapsedTime:0,pseudoElement:0}),ky=Ge(Ly),By=y({},Yr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),zy=Ge(By),Py=y({},Kn,{newState:0,oldState:0}),Uy=Ge(Py),jy=[9,13,27,32],Yl=Zi&&"CompositionEvent"in window,Ra=null;Zi&&"documentMode"in document&&(Ra=document.documentMode);var Fy=Zi&&"TextEvent"in window&&!Ra,id=Zi&&(!Yl||Ra&&8<Ra&&11>=Ra),nd=" ",sd=!1;function ad(e,n){switch(e){case"keyup":return jy.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ls=!1;function Hy(e,n){switch(e){case"compositionend":return rd(n);case"keypress":return n.which!==32?null:(sd=!0,nd);case"textInput":return e=n.data,e===nd&&sd?null:e;default:return null}}function Iy(e,n){if(Ls)return e==="compositionend"||!Yl&&ad(e,n)?(e=Zh(),Gr=Il=vn=null,Ls=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return id&&n.locale!=="ko"?null:n.data;default:return null}}var Gy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function od(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!Gy[e.type]:n==="textarea"}function ld(e,n,a,o){Ns?Os?Os.push(o):Os=[o]:Ns=o,n=Po(n,"onChange"),0<n.length&&(a=new Xr("onChange","change",null,a,o),e.push({event:a,listeners:n}))}var Na=null,Oa=null;function qy(e){Vp(e,0)}function $r(e){var n=Ea(e);if(Gh(n))return e}function cd(e,n){if(e==="change")return n}var ud=!1;if(Zi){var $l;if(Zi){var Kl="oninput"in document;if(!Kl){var hd=document.createElement("div");hd.setAttribute("oninput","return;"),Kl=typeof hd.oninput=="function"}$l=Kl}else $l=!1;ud=$l&&(!document.documentMode||9<document.documentMode)}function dd(){Na&&(Na.detachEvent("onpropertychange",fd),Oa=Na=null)}function fd(e){if(e.propertyName==="value"&&$r(Oa)){var n=[];ld(n,Oa,e,jl(e)),Qh(qy,n)}}function Vy(e,n,a){e==="focusin"?(dd(),Na=n,Oa=a,Na.attachEvent("onpropertychange",fd)):e==="focusout"&&dd()}function Xy(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return $r(Oa)}function Yy(e,n){if(e==="click")return $r(n)}function $y(e,n){if(e==="input"||e==="change")return $r(n)}function Ky(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var ei=typeof Object.is=="function"?Object.is:Ky;function La(e,n){if(ei(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var a=Object.keys(e),o=Object.keys(n);if(a.length!==o.length)return!1;for(o=0;o<a.length;o++){var d=a[o];if(!Bi.call(n,d)||!ei(e[d],n[d]))return!1}return!0}function pd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function gd(e,n){var a=pd(e);e=0;for(var o;a;){if(a.nodeType===3){if(o=e+a.textContent.length,e<=n&&o>=n)return{node:a,offset:n-e};e=o}t:{for(;a;){if(a.nextSibling){a=a.nextSibling;break t}a=a.parentNode}a=void 0}a=pd(a)}}function md(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?md(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function yd(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var n=Hr(e.document);n instanceof e.HTMLIFrameElement;){try{var a=typeof n.contentWindow.location.href=="string"}catch{a=!1}if(a)e=n.contentWindow;else break;n=Hr(e.document)}return n}function Ql(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}var Qy=Zi&&"documentMode"in document&&11>=document.documentMode,ks=null,Zl=null,ka=null,Wl=!1;function bd(e,n,a){var o=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Wl||ks==null||ks!==Hr(o)||(o=ks,"selectionStart"in o&&Ql(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),ka&&La(ka,o)||(ka=o,o=Po(Zl,"onSelect"),0<o.length&&(n=new Xr("onSelect","select",null,n,a),e.push({event:n,listeners:o}),n.target=ks)))}function Qn(e,n){var a={};return a[e.toLowerCase()]=n.toLowerCase(),a["Webkit"+e]="webkit"+n,a["Moz"+e]="moz"+n,a}var Bs={animationend:Qn("Animation","AnimationEnd"),animationiteration:Qn("Animation","AnimationIteration"),animationstart:Qn("Animation","AnimationStart"),transitionrun:Qn("Transition","TransitionRun"),transitionstart:Qn("Transition","TransitionStart"),transitioncancel:Qn("Transition","TransitionCancel"),transitionend:Qn("Transition","TransitionEnd")},Jl={},vd={};Zi&&(vd=document.createElement("div").style,"AnimationEvent"in window||(delete Bs.animationend.animation,delete Bs.animationiteration.animation,delete Bs.animationstart.animation),"TransitionEvent"in window||delete Bs.transitionend.transition);function Zn(e){if(Jl[e])return Jl[e];if(!Bs[e])return e;var n=Bs[e],a;for(a in n)if(n.hasOwnProperty(a)&&a in vd)return Jl[e]=n[a];return e}var Ad=Zn("animationend"),Sd=Zn("animationiteration"),wd=Zn("animationstart"),Zy=Zn("transitionrun"),Wy=Zn("transitionstart"),Jy=Zn("transitioncancel"),xd=Zn("transitionend"),_d=new Map,tc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");tc.push("scrollEnd");function Di(e,n){_d.set(e,n),$n(n,[e])}var Kr=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},pi=[],zs=0,ec=0;function Qr(){for(var e=zs,n=ec=zs=0;n<e;){var a=pi[n];pi[n++]=null;var o=pi[n];pi[n++]=null;var d=pi[n];pi[n++]=null;var p=pi[n];if(pi[n++]=null,o!==null&&d!==null){var v=o.pending;v===null?d.next=d:(d.next=v.next,v.next=d),o.pending=d}p!==0&&Ed(a,d,p)}}function Zr(e,n,a,o){pi[zs++]=e,pi[zs++]=n,pi[zs++]=a,pi[zs++]=o,ec|=o,e.lanes|=o,e=e.alternate,e!==null&&(e.lanes|=o)}function ic(e,n,a,o){return Zr(e,n,a,o),Wr(e)}function Wn(e,n){return Zr(e,null,null,n),Wr(e)}function Ed(e,n,a){e.lanes|=a;var o=e.alternate;o!==null&&(o.lanes|=a);for(var d=!1,p=e.return;p!==null;)p.childLanes|=a,o=p.alternate,o!==null&&(o.childLanes|=a),p.tag===22&&(e=p.stateNode,e===null||e._visibility&1||(d=!0)),e=p,p=p.return;return e.tag===3?(p=e.stateNode,d&&n!==null&&(d=31-ue(a),e=p.hiddenUpdates,o=e[d],o===null?e[d]=[n]:o.push(n),n.lane=a|536870912),p):null}function Wr(e){if(50<ir)throw ir=0,hu=null,Error(s(185));for(var n=e.return;n!==null;)e=n,n=e.return;return e.tag===3?e.stateNode:null}var Ps={};function tb(e,n,a,o){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ii(e,n,a,o){return new tb(e,n,a,o)}function nc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Wi(e,n){var a=e.alternate;return a===null?(a=ii(e.tag,n,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=n,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&65011712,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,n=e.dependencies,a.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a.refCleanup=e.refCleanup,a}function Td(e,n){e.flags&=65011714;var a=e.alternate;return a===null?(e.childLanes=0,e.lanes=n,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=a.childLanes,e.lanes=a.lanes,e.child=a.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,e.type=a.type,n=a.dependencies,e.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),e}function Jr(e,n,a,o,d,p){var v=0;if(o=e,typeof e=="function")nc(e)&&(v=1);else if(typeof e=="string")v=a0(e,a,et.current)?26:e==="html"||e==="head"||e==="body"?27:5;else t:switch(e){case K:return e=ii(31,a,n,d),e.elementType=K,e.lanes=p,e;case S:return Jn(a.children,d,p,n);case E:v=8,d|=24;break;case _:return e=ii(12,a,n,d|2),e.elementType=_,e.lanes=p,e;case O:return e=ii(13,a,n,d),e.elementType=O,e.lanes=p,e;case L:return e=ii(19,a,n,d),e.elementType=L,e.lanes=p,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case T:v=10;break t;case D:v=9;break t;case B:v=11;break t;case P:v=14;break t;case q:v=16,o=null;break t}v=29,a=Error(s(130,e===null?"null":typeof e,"")),o=null}return n=ii(v,a,n,d),n.elementType=e,n.type=o,n.lanes=p,n}function Jn(e,n,a,o){return e=ii(7,e,o,n),e.lanes=a,e}function sc(e,n,a){return e=ii(6,e,null,n),e.lanes=a,e}function Cd(e){var n=ii(18,null,null,0);return n.stateNode=e,n}function ac(e,n,a){return n=ii(4,e.children!==null?e.children:[],e.key,n),n.lanes=a,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}var Md=new WeakMap;function gi(e,n){if(typeof e=="object"&&e!==null){var a=Md.get(e);return a!==void 0?a:(n={value:e,source:n,stack:Xn(n)},Md.set(e,n),n)}return{value:e,source:n,stack:Xn(n)}}var Us=[],js=0,to=null,Ba=0,mi=[],yi=0,An=null,zi=1,Pi="";function Ji(e,n){Us[js++]=Ba,Us[js++]=to,to=e,Ba=n}function Dd(e,n,a){mi[yi++]=zi,mi[yi++]=Pi,mi[yi++]=An,An=e;var o=zi;e=Pi;var d=32-ue(o)-1;o&=~(1<<d),a+=1;var p=32-ue(n)+d;if(30<p){var v=d-d%5;p=(o&(1<<v)-1).toString(32),o>>=v,d-=v,zi=1<<32-ue(n)+d|a<<d|o,Pi=p+e}else zi=1<<p|a<<d|o,Pi=e}function rc(e){e.return!==null&&(Ji(e,1),Dd(e,1,0))}function oc(e){for(;e===to;)to=Us[--js],Us[js]=null,Ba=Us[--js],Us[js]=null;for(;e===An;)An=mi[--yi],mi[yi]=null,Pi=mi[--yi],mi[yi]=null,zi=mi[--yi],mi[yi]=null}function Rd(e,n){mi[yi++]=zi,mi[yi++]=Pi,mi[yi++]=An,zi=n.id,Pi=n.overflow,An=e}var Ee=null,Kt=null,Dt=!1,Sn=null,bi=!1,lc=Error(s(519));function wn(e){var n=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw za(gi(n,e)),lc}function Nd(e){var n=e.stateNode,a=e.type,o=e.memoizedProps;switch(n[_e]=e,n[Ie]=o,a){case"dialog":Tt("cancel",n),Tt("close",n);break;case"iframe":case"object":case"embed":Tt("load",n);break;case"video":case"audio":for(a=0;a<sr.length;a++)Tt(sr[a],n);break;case"source":Tt("error",n);break;case"img":case"image":case"link":Tt("error",n),Tt("load",n);break;case"details":Tt("toggle",n);break;case"input":Tt("invalid",n),qh(n,o.value,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name,!0);break;case"select":Tt("invalid",n);break;case"textarea":Tt("invalid",n),Xh(n,o.value,o.defaultValue,o.children)}a=o.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||n.textContent===""+a||o.suppressHydrationWarning===!0||Kp(n.textContent,a)?(o.popover!=null&&(Tt("beforetoggle",n),Tt("toggle",n)),o.onScroll!=null&&Tt("scroll",n),o.onScrollEnd!=null&&Tt("scrollend",n),o.onClick!=null&&(n.onclick=Qi),n=!0):n=!1,n||wn(e,!0)}function Od(e){for(Ee=e.return;Ee;)switch(Ee.tag){case 5:case 31:case 13:bi=!1;return;case 27:case 3:bi=!0;return;default:Ee=Ee.return}}function Fs(e){if(e!==Ee)return!1;if(!Dt)return Od(e),Dt=!0,!1;var n=e.tag,a;if((a=n!==3&&n!==27)&&((a=n===5)&&(a=e.type,a=!(a!=="form"&&a!=="button")||Tu(e.type,e.memoizedProps)),a=!a),a&&Kt&&wn(e),Od(e),n===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));Kt=sg(e)}else if(n===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));Kt=sg(e)}else n===27?(n=Kt,zn(e.type)?(e=Nu,Nu=null,Kt=e):Kt=n):Kt=Ee?Ai(e.stateNode.nextSibling):null;return!0}function ts(){Kt=Ee=null,Dt=!1}function cc(){var e=Sn;return e!==null&&(Ye===null?Ye=e:Ye.push.apply(Ye,e),Sn=null),e}function za(e){Sn===null?Sn=[e]:Sn.push(e)}var uc=R(null),es=null,tn=null;function xn(e,n,a){Q(uc,n._currentValue),n._currentValue=a}function en(e){e._currentValue=uc.current,I(uc)}function hc(e,n,a){for(;e!==null;){var o=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,o!==null&&(o.childLanes|=n)):o!==null&&(o.childLanes&n)!==n&&(o.childLanes|=n),e===a)break;e=e.return}}function dc(e,n,a,o){var d=e.child;for(d!==null&&(d.return=e);d!==null;){var p=d.dependencies;if(p!==null){var v=d.child;p=p.firstContext;t:for(;p!==null;){var x=p;p=d;for(var M=0;M<n.length;M++)if(x.context===n[M]){p.lanes|=a,x=p.alternate,x!==null&&(x.lanes|=a),hc(p.return,a,e),o||(v=null);break t}p=x.next}}else if(d.tag===18){if(v=d.return,v===null)throw Error(s(341));v.lanes|=a,p=v.alternate,p!==null&&(p.lanes|=a),hc(v,a,e),v=null}else v=d.child;if(v!==null)v.return=d;else for(v=d;v!==null;){if(v===e){v=null;break}if(d=v.sibling,d!==null){d.return=v.return,v=d;break}v=v.return}d=v}}function Hs(e,n,a,o){e=null;for(var d=n,p=!1;d!==null;){if(!p){if((d.flags&524288)!==0)p=!0;else if((d.flags&262144)!==0)break}if(d.tag===10){var v=d.alternate;if(v===null)throw Error(s(387));if(v=v.memoizedProps,v!==null){var x=d.type;ei(d.pendingProps.value,v.value)||(e!==null?e.push(x):e=[x])}}else if(d===ut.current){if(v=d.alternate,v===null)throw Error(s(387));v.memoizedState.memoizedState!==d.memoizedState.memoizedState&&(e!==null?e.push(cr):e=[cr])}d=d.return}e!==null&&dc(n,e,a,o),n.flags|=262144}function eo(e){for(e=e.firstContext;e!==null;){if(!ei(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function is(e){es=e,tn=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Te(e){return Ld(es,e)}function io(e,n){return es===null&&is(e),Ld(e,n)}function Ld(e,n){var a=n._currentValue;if(n={context:n,memoizedValue:a,next:null},tn===null){if(e===null)throw Error(s(308));tn=n,e.dependencies={lanes:0,firstContext:n},e.flags|=524288}else tn=tn.next=n;return a}var eb=typeof AbortController<"u"?AbortController:function(){var e=[],n=this.signal={aborted:!1,addEventListener:function(a,o){e.push(o)}};this.abort=function(){n.aborted=!0,e.forEach(function(a){return a()})}},ib=g.unstable_scheduleCallback,nb=g.unstable_NormalPriority,he={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function fc(){return{controller:new eb,data:new Map,refCount:0}}function Pa(e){e.refCount--,e.refCount===0&&ib(nb,function(){e.controller.abort()})}var Ua=null,pc=0,Is=0,Gs=null;function sb(e,n){if(Ua===null){var a=Ua=[];pc=0,Is=yu(),Gs={status:"pending",value:void 0,then:function(o){a.push(o)}}}return pc++,n.then(kd,kd),n}function kd(){if(--pc===0&&Ua!==null){Gs!==null&&(Gs.status="fulfilled");var e=Ua;Ua=null,Is=0,Gs=null;for(var n=0;n<e.length;n++)(0,e[n])()}}function ab(e,n){var a=[],o={status:"pending",value:null,reason:null,then:function(d){a.push(d)}};return e.then(function(){o.status="fulfilled",o.value=n;for(var d=0;d<a.length;d++)(0,a[d])(n)},function(d){for(o.status="rejected",o.reason=d,d=0;d<a.length;d++)(0,a[d])(void 0)}),o}var Bd=k.S;k.S=function(e,n){vp=ke(),typeof n=="object"&&n!==null&&typeof n.then=="function"&&sb(e,n),Bd!==null&&Bd(e,n)};var ns=R(null);function gc(){var e=ns.current;return e!==null?e:Yt.pooledCache}function no(e,n){n===null?Q(ns,ns.current):Q(ns,n.pool)}function zd(){var e=gc();return e===null?null:{parent:he._currentValue,pool:e}}var qs=Error(s(460)),mc=Error(s(474)),so=Error(s(542)),ao={then:function(){}};function Pd(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Ud(e,n,a){switch(a=e[a],a===void 0?e.push(n):a!==n&&(n.then(Qi,Qi),n=a),n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,Fd(e),e;default:if(typeof n.status=="string")n.then(Qi,Qi);else{if(e=Yt,e!==null&&100<e.shellSuspendCounter)throw Error(s(482));e=n,e.status="pending",e.then(function(o){if(n.status==="pending"){var d=n;d.status="fulfilled",d.value=o}},function(o){if(n.status==="pending"){var d=n;d.status="rejected",d.reason=o}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,Fd(e),e}throw as=n,qs}}function ss(e){try{var n=e._init;return n(e._payload)}catch(a){throw a!==null&&typeof a=="object"&&typeof a.then=="function"?(as=a,qs):a}}var as=null;function jd(){if(as===null)throw Error(s(459));var e=as;return as=null,e}function Fd(e){if(e===qs||e===so)throw Error(s(483))}var Vs=null,ja=0;function ro(e){var n=ja;return ja+=1,Vs===null&&(Vs=[]),Ud(Vs,e,n)}function Fa(e,n){n=n.props.ref,e.ref=n!==void 0?n:null}function oo(e,n){throw n.$$typeof===b?Error(s(525)):(e=Object.prototype.toString.call(n),Error(s(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)))}function Hd(e){function n(z,N){if(e){var U=z.deletions;U===null?(z.deletions=[N],z.flags|=16):U.push(N)}}function a(z,N){if(!e)return null;for(;N!==null;)n(z,N),N=N.sibling;return null}function o(z){for(var N=new Map;z!==null;)z.key!==null?N.set(z.key,z):N.set(z.index,z),z=z.sibling;return N}function d(z,N){return z=Wi(z,N),z.index=0,z.sibling=null,z}function p(z,N,U){return z.index=U,e?(U=z.alternate,U!==null?(U=U.index,U<N?(z.flags|=67108866,N):U):(z.flags|=67108866,N)):(z.flags|=1048576,N)}function v(z){return e&&z.alternate===null&&(z.flags|=67108866),z}function x(z,N,U,Y){return N===null||N.tag!==6?(N=sc(U,z.mode,Y),N.return=z,N):(N=d(N,U),N.return=z,N)}function M(z,N,U,Y){var ot=U.type;return ot===S?X(z,N,U.props.children,Y,U.key):N!==null&&(N.elementType===ot||typeof ot=="object"&&ot!==null&&ot.$$typeof===q&&ss(ot)===N.type)?(N=d(N,U.props),Fa(N,U),N.return=z,N):(N=Jr(U.type,U.key,U.props,null,z.mode,Y),Fa(N,U),N.return=z,N)}function j(z,N,U,Y){return N===null||N.tag!==4||N.stateNode.containerInfo!==U.containerInfo||N.stateNode.implementation!==U.implementation?(N=ac(U,z.mode,Y),N.return=z,N):(N=d(N,U.children||[]),N.return=z,N)}function X(z,N,U,Y,ot){return N===null||N.tag!==7?(N=Jn(U,z.mode,Y,ot),N.return=z,N):(N=d(N,U),N.return=z,N)}function $(z,N,U){if(typeof N=="string"&&N!==""||typeof N=="number"||typeof N=="bigint")return N=sc(""+N,z.mode,U),N.return=z,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case A:return U=Jr(N.type,N.key,N.props,null,z.mode,U),Fa(U,N),U.return=z,U;case w:return N=ac(N,z.mode,U),N.return=z,N;case q:return N=ss(N),$(z,N,U)}if(vt(N)||ht(N))return N=Jn(N,z.mode,U,null),N.return=z,N;if(typeof N.then=="function")return $(z,ro(N),U);if(N.$$typeof===T)return $(z,io(z,N),U);oo(z,N)}return null}function H(z,N,U,Y){var ot=N!==null?N.key:null;if(typeof U=="string"&&U!==""||typeof U=="number"||typeof U=="bigint")return ot!==null?null:x(z,N,""+U,Y);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case A:return U.key===ot?M(z,N,U,Y):null;case w:return U.key===ot?j(z,N,U,Y):null;case q:return U=ss(U),H(z,N,U,Y)}if(vt(U)||ht(U))return ot!==null?null:X(z,N,U,Y,null);if(typeof U.then=="function")return H(z,N,ro(U),Y);if(U.$$typeof===T)return H(z,N,io(z,U),Y);oo(z,U)}return null}function G(z,N,U,Y,ot){if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return z=z.get(U)||null,x(N,z,""+Y,ot);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case A:return z=z.get(Y.key===null?U:Y.key)||null,M(N,z,Y,ot);case w:return z=z.get(Y.key===null?U:Y.key)||null,j(N,z,Y,ot);case q:return Y=ss(Y),G(z,N,U,Y,ot)}if(vt(Y)||ht(Y))return z=z.get(U)||null,X(N,z,Y,ot,null);if(typeof Y.then=="function")return G(z,N,U,ro(Y),ot);if(Y.$$typeof===T)return G(z,N,U,io(N,Y),ot);oo(N,Y)}return null}function nt(z,N,U,Y){for(var ot=null,kt=null,rt=N,_t=N=0,Mt=null;rt!==null&&_t<U.length;_t++){rt.index>_t?(Mt=rt,rt=null):Mt=rt.sibling;var Bt=H(z,rt,U[_t],Y);if(Bt===null){rt===null&&(rt=Mt);break}e&&rt&&Bt.alternate===null&&n(z,rt),N=p(Bt,N,_t),kt===null?ot=Bt:kt.sibling=Bt,kt=Bt,rt=Mt}if(_t===U.length)return a(z,rt),Dt&&Ji(z,_t),ot;if(rt===null){for(;_t<U.length;_t++)rt=$(z,U[_t],Y),rt!==null&&(N=p(rt,N,_t),kt===null?ot=rt:kt.sibling=rt,kt=rt);return Dt&&Ji(z,_t),ot}for(rt=o(rt);_t<U.length;_t++)Mt=G(rt,z,_t,U[_t],Y),Mt!==null&&(e&&Mt.alternate!==null&&rt.delete(Mt.key===null?_t:Mt.key),N=p(Mt,N,_t),kt===null?ot=Mt:kt.sibling=Mt,kt=Mt);return e&&rt.forEach(function(Hn){return n(z,Hn)}),Dt&&Ji(z,_t),ot}function dt(z,N,U,Y){if(U==null)throw Error(s(151));for(var ot=null,kt=null,rt=N,_t=N=0,Mt=null,Bt=U.next();rt!==null&&!Bt.done;_t++,Bt=U.next()){rt.index>_t?(Mt=rt,rt=null):Mt=rt.sibling;var Hn=H(z,rt,Bt.value,Y);if(Hn===null){rt===null&&(rt=Mt);break}e&&rt&&Hn.alternate===null&&n(z,rt),N=p(Hn,N,_t),kt===null?ot=Hn:kt.sibling=Hn,kt=Hn,rt=Mt}if(Bt.done)return a(z,rt),Dt&&Ji(z,_t),ot;if(rt===null){for(;!Bt.done;_t++,Bt=U.next())Bt=$(z,Bt.value,Y),Bt!==null&&(N=p(Bt,N,_t),kt===null?ot=Bt:kt.sibling=Bt,kt=Bt);return Dt&&Ji(z,_t),ot}for(rt=o(rt);!Bt.done;_t++,Bt=U.next())Bt=G(rt,z,_t,Bt.value,Y),Bt!==null&&(e&&Bt.alternate!==null&&rt.delete(Bt.key===null?_t:Bt.key),N=p(Bt,N,_t),kt===null?ot=Bt:kt.sibling=Bt,kt=Bt);return e&&rt.forEach(function(m0){return n(z,m0)}),Dt&&Ji(z,_t),ot}function Vt(z,N,U,Y){if(typeof U=="object"&&U!==null&&U.type===S&&U.key===null&&(U=U.props.children),typeof U=="object"&&U!==null){switch(U.$$typeof){case A:t:{for(var ot=U.key;N!==null;){if(N.key===ot){if(ot=U.type,ot===S){if(N.tag===7){a(z,N.sibling),Y=d(N,U.props.children),Y.return=z,z=Y;break t}}else if(N.elementType===ot||typeof ot=="object"&&ot!==null&&ot.$$typeof===q&&ss(ot)===N.type){a(z,N.sibling),Y=d(N,U.props),Fa(Y,U),Y.return=z,z=Y;break t}a(z,N);break}else n(z,N);N=N.sibling}U.type===S?(Y=Jn(U.props.children,z.mode,Y,U.key),Y.return=z,z=Y):(Y=Jr(U.type,U.key,U.props,null,z.mode,Y),Fa(Y,U),Y.return=z,z=Y)}return v(z);case w:t:{for(ot=U.key;N!==null;){if(N.key===ot)if(N.tag===4&&N.stateNode.containerInfo===U.containerInfo&&N.stateNode.implementation===U.implementation){a(z,N.sibling),Y=d(N,U.children||[]),Y.return=z,z=Y;break t}else{a(z,N);break}else n(z,N);N=N.sibling}Y=ac(U,z.mode,Y),Y.return=z,z=Y}return v(z);case q:return U=ss(U),Vt(z,N,U,Y)}if(vt(U))return nt(z,N,U,Y);if(ht(U)){if(ot=ht(U),typeof ot!="function")throw Error(s(150));return U=ot.call(U),dt(z,N,U,Y)}if(typeof U.then=="function")return Vt(z,N,ro(U),Y);if(U.$$typeof===T)return Vt(z,N,io(z,U),Y);oo(z,U)}return typeof U=="string"&&U!==""||typeof U=="number"||typeof U=="bigint"?(U=""+U,N!==null&&N.tag===6?(a(z,N.sibling),Y=d(N,U),Y.return=z,z=Y):(a(z,N),Y=sc(U,z.mode,Y),Y.return=z,z=Y),v(z)):a(z,N)}return function(z,N,U,Y){try{ja=0;var ot=Vt(z,N,U,Y);return Vs=null,ot}catch(rt){if(rt===qs||rt===so)throw rt;var kt=ii(29,rt,null,z.mode);return kt.lanes=Y,kt.return=z,kt}finally{}}}var rs=Hd(!0),Id=Hd(!1),_n=!1;function yc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function bc(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function En(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Tn(e,n,a){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,(zt&2)!==0){var d=o.pending;return d===null?n.next=n:(n.next=d.next,d.next=n),o.pending=n,n=Wr(e),Ed(e,null,a),n}return Zr(e,o,n,a),Wr(e)}function Ha(e,n,a){if(n=n.updateQueue,n!==null&&(n=n.shared,(a&4194048)!==0)){var o=n.lanes;o&=e.pendingLanes,a|=o,n.lanes=a,Ur(e,a)}}function vc(e,n){var a=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,a===o)){var d=null,p=null;if(a=a.firstBaseUpdate,a!==null){do{var v={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};p===null?d=p=v:p=p.next=v,a=a.next}while(a!==null);p===null?d=p=n:p=p.next=n}else d=p=n;a={baseState:o.baseState,firstBaseUpdate:d,lastBaseUpdate:p,shared:o.shared,callbacks:o.callbacks},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=n:e.next=n,a.lastBaseUpdate=n}var Ac=!1;function Ia(){if(Ac){var e=Gs;if(e!==null)throw e}}function Ga(e,n,a,o){Ac=!1;var d=e.updateQueue;_n=!1;var p=d.firstBaseUpdate,v=d.lastBaseUpdate,x=d.shared.pending;if(x!==null){d.shared.pending=null;var M=x,j=M.next;M.next=null,v===null?p=j:v.next=j,v=M;var X=e.alternate;X!==null&&(X=X.updateQueue,x=X.lastBaseUpdate,x!==v&&(x===null?X.firstBaseUpdate=j:x.next=j,X.lastBaseUpdate=M))}if(p!==null){var $=d.baseState;v=0,X=j=M=null,x=p;do{var H=x.lane&-536870913,G=H!==x.lane;if(G?(Ct&H)===H:(o&H)===H){H!==0&&H===Is&&(Ac=!0),X!==null&&(X=X.next={lane:0,tag:x.tag,payload:x.payload,callback:null,next:null});t:{var nt=e,dt=x;H=n;var Vt=a;switch(dt.tag){case 1:if(nt=dt.payload,typeof nt=="function"){$=nt.call(Vt,$,H);break t}$=nt;break t;case 3:nt.flags=nt.flags&-65537|128;case 0:if(nt=dt.payload,H=typeof nt=="function"?nt.call(Vt,$,H):nt,H==null)break t;$=y({},$,H);break t;case 2:_n=!0}}H=x.callback,H!==null&&(e.flags|=64,G&&(e.flags|=8192),G=d.callbacks,G===null?d.callbacks=[H]:G.push(H))}else G={lane:H,tag:x.tag,payload:x.payload,callback:x.callback,next:null},X===null?(j=X=G,M=$):X=X.next=G,v|=H;if(x=x.next,x===null){if(x=d.shared.pending,x===null)break;G=x,x=G.next,G.next=null,d.lastBaseUpdate=G,d.shared.pending=null}}while(!0);X===null&&(M=$),d.baseState=M,d.firstBaseUpdate=j,d.lastBaseUpdate=X,p===null&&(d.shared.lanes=0),Nn|=v,e.lanes=v,e.memoizedState=$}}function Gd(e,n){if(typeof e!="function")throw Error(s(191,e));e.call(n)}function qd(e,n){var a=e.callbacks;if(a!==null)for(e.callbacks=null,e=0;e<a.length;e++)Gd(a[e],n)}var Xs=R(null),lo=R(0);function Vd(e,n){e=hn,Q(lo,e),Q(Xs,n),hn=e|n.baseLanes}function Sc(){Q(lo,hn),Q(Xs,Xs.current)}function wc(){hn=lo.current,I(Xs),I(lo)}var ni=R(null),vi=null;function Cn(e){var n=e.alternate;Q(oe,oe.current&1),Q(ni,e),vi===null&&(n===null||Xs.current!==null||n.memoizedState!==null)&&(vi=e)}function xc(e){Q(oe,oe.current),Q(ni,e),vi===null&&(vi=e)}function Xd(e){e.tag===22?(Q(oe,oe.current),Q(ni,e),vi===null&&(vi=e)):Mn()}function Mn(){Q(oe,oe.current),Q(ni,ni.current)}function si(e){I(ni),vi===e&&(vi=null),I(oe)}var oe=R(0);function co(e){for(var n=e;n!==null;){if(n.tag===13){var a=n.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||Du(a)||Ru(a)))return n}else if(n.tag===19&&(n.memoizedProps.revealOrder==="forwards"||n.memoizedProps.revealOrder==="backwards"||n.memoizedProps.revealOrder==="unstable_legacy-backwards"||n.memoizedProps.revealOrder==="together")){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var nn=0,St=null,Gt=null,de=null,uo=!1,Ys=!1,os=!1,ho=0,qa=0,$s=null,rb=0;function se(){throw Error(s(321))}function _c(e,n){if(n===null)return!1;for(var a=0;a<n.length&&a<e.length;a++)if(!ei(e[a],n[a]))return!1;return!0}function Ec(e,n,a,o,d,p){return nn=p,St=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,k.H=e===null||e.memoizedState===null?Rf:Fc,os=!1,p=a(o,d),os=!1,Ys&&(p=$d(n,a,o,d)),Yd(e),p}function Yd(e){k.H=Ya;var n=Gt!==null&&Gt.next!==null;if(nn=0,de=Gt=St=null,uo=!1,qa=0,$s=null,n)throw Error(s(300));e===null||fe||(e=e.dependencies,e!==null&&eo(e)&&(fe=!0))}function $d(e,n,a,o){St=e;var d=0;do{if(Ys&&($s=null),qa=0,Ys=!1,25<=d)throw Error(s(301));if(d+=1,de=Gt=null,e.updateQueue!=null){var p=e.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}k.H=Nf,p=n(a,o)}while(Ys);return p}function ob(){var e=k.H,n=e.useState()[0];return n=typeof n.then=="function"?Va(n):n,e=e.useState()[0],(Gt!==null?Gt.memoizedState:null)!==e&&(St.flags|=1024),n}function Tc(){var e=ho!==0;return ho=0,e}function Cc(e,n,a){n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~a}function Mc(e){if(uo){for(e=e.memoizedState;e!==null;){var n=e.queue;n!==null&&(n.pending=null),e=e.next}uo=!1}nn=0,de=Gt=St=null,Ys=!1,qa=ho=0,$s=null}function Pe(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return de===null?St.memoizedState=de=e:de=de.next=e,de}function le(){if(Gt===null){var e=St.alternate;e=e!==null?e.memoizedState:null}else e=Gt.next;var n=de===null?St.memoizedState:de.next;if(n!==null)de=n,Gt=e;else{if(e===null)throw St.alternate===null?Error(s(467)):Error(s(310));Gt=e,e={memoizedState:Gt.memoizedState,baseState:Gt.baseState,baseQueue:Gt.baseQueue,queue:Gt.queue,next:null},de===null?St.memoizedState=de=e:de=de.next=e}return de}function fo(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Va(e){var n=qa;return qa+=1,$s===null&&($s=[]),e=Ud($s,e,n),n=St,(de===null?n.memoizedState:de.next)===null&&(n=n.alternate,k.H=n===null||n.memoizedState===null?Rf:Fc),e}function po(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Va(e);if(e.$$typeof===T)return Te(e)}throw Error(s(438,String(e)))}function Dc(e){var n=null,a=St.updateQueue;if(a!==null&&(n=a.memoCache),n==null){var o=St.alternate;o!==null&&(o=o.updateQueue,o!==null&&(o=o.memoCache,o!=null&&(n={data:o.data.map(function(d){return d.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),a===null&&(a=fo(),St.updateQueue=a),a.memoCache=n,a=n.data[n.index],a===void 0)for(a=n.data[n.index]=Array(e),o=0;o<e;o++)a[o]=J;return n.index++,a}function sn(e,n){return typeof n=="function"?n(e):n}function go(e){var n=le();return Rc(n,Gt,e)}function Rc(e,n,a){var o=e.queue;if(o===null)throw Error(s(311));o.lastRenderedReducer=a;var d=e.baseQueue,p=o.pending;if(p!==null){if(d!==null){var v=d.next;d.next=p.next,p.next=v}n.baseQueue=d=p,o.pending=null}if(p=e.baseState,d===null)e.memoizedState=p;else{n=d.next;var x=v=null,M=null,j=n,X=!1;do{var $=j.lane&-536870913;if($!==j.lane?(Ct&$)===$:(nn&$)===$){var H=j.revertLane;if(H===0)M!==null&&(M=M.next={lane:0,revertLane:0,gesture:null,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null}),$===Is&&(X=!0);else if((nn&H)===H){j=j.next,H===Is&&(X=!0);continue}else $={lane:0,revertLane:j.revertLane,gesture:null,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null},M===null?(x=M=$,v=p):M=M.next=$,St.lanes|=H,Nn|=H;$=j.action,os&&a(p,$),p=j.hasEagerState?j.eagerState:a(p,$)}else H={lane:$,revertLane:j.revertLane,gesture:j.gesture,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null},M===null?(x=M=H,v=p):M=M.next=H,St.lanes|=$,Nn|=$;j=j.next}while(j!==null&&j!==n);if(M===null?v=p:M.next=x,!ei(p,e.memoizedState)&&(fe=!0,X&&(a=Gs,a!==null)))throw a;e.memoizedState=p,e.baseState=v,e.baseQueue=M,o.lastRenderedState=p}return d===null&&(o.lanes=0),[e.memoizedState,o.dispatch]}function Nc(e){var n=le(),a=n.queue;if(a===null)throw Error(s(311));a.lastRenderedReducer=e;var o=a.dispatch,d=a.pending,p=n.memoizedState;if(d!==null){a.pending=null;var v=d=d.next;do p=e(p,v.action),v=v.next;while(v!==d);ei(p,n.memoizedState)||(fe=!0),n.memoizedState=p,n.baseQueue===null&&(n.baseState=p),a.lastRenderedState=p}return[p,o]}function Kd(e,n,a){var o=St,d=le(),p=Dt;if(p){if(a===void 0)throw Error(s(407));a=a()}else a=n();var v=!ei((Gt||d).memoizedState,a);if(v&&(d.memoizedState=a,fe=!0),d=d.queue,kc(Wd.bind(null,o,d,e),[e]),d.getSnapshot!==n||v||de!==null&&de.memoizedState.tag&1){if(o.flags|=2048,Ks(9,{destroy:void 0},Zd.bind(null,o,d,a,n),null),Yt===null)throw Error(s(349));p||(nn&127)!==0||Qd(o,n,a)}return a}function Qd(e,n,a){e.flags|=16384,e={getSnapshot:n,value:a},n=St.updateQueue,n===null?(n=fo(),St.updateQueue=n,n.stores=[e]):(a=n.stores,a===null?n.stores=[e]:a.push(e))}function Zd(e,n,a,o){n.value=a,n.getSnapshot=o,Jd(n)&&tf(e)}function Wd(e,n,a){return a(function(){Jd(n)&&tf(e)})}function Jd(e){var n=e.getSnapshot;e=e.value;try{var a=n();return!ei(e,a)}catch{return!0}}function tf(e){var n=Wn(e,2);n!==null&&$e(n,e,2)}function Oc(e){var n=Pe();if(typeof e=="function"){var a=e;if(e=a(),os){Ci(!0);try{a()}finally{Ci(!1)}}}return n.memoizedState=n.baseState=e,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:sn,lastRenderedState:e},n}function ef(e,n,a,o){return e.baseState=a,Rc(e,Gt,typeof o=="function"?o:sn)}function lb(e,n,a,o,d){if(bo(e))throw Error(s(485));if(e=n.action,e!==null){var p={payload:d,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){p.listeners.push(v)}};k.T!==null?a(!0):p.isTransition=!1,o(p),a=n.pending,a===null?(p.next=n.pending=p,nf(n,p)):(p.next=a.next,n.pending=a.next=p)}}function nf(e,n){var a=n.action,o=n.payload,d=e.state;if(n.isTransition){var p=k.T,v={};k.T=v;try{var x=a(d,o),M=k.S;M!==null&&M(v,x),sf(e,n,x)}catch(j){Lc(e,n,j)}finally{p!==null&&v.types!==null&&(p.types=v.types),k.T=p}}else try{p=a(d,o),sf(e,n,p)}catch(j){Lc(e,n,j)}}function sf(e,n,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(o){af(e,n,o)},function(o){return Lc(e,n,o)}):af(e,n,a)}function af(e,n,a){n.status="fulfilled",n.value=a,rf(n),e.state=a,n=e.pending,n!==null&&(a=n.next,a===n?e.pending=null:(a=a.next,n.next=a,nf(e,a)))}function Lc(e,n,a){var o=e.pending;if(e.pending=null,o!==null){o=o.next;do n.status="rejected",n.reason=a,rf(n),n=n.next;while(n!==o)}e.action=null}function rf(e){e=e.listeners;for(var n=0;n<e.length;n++)(0,e[n])()}function of(e,n){return n}function lf(e,n){if(Dt){var a=Yt.formState;if(a!==null){t:{var o=St;if(Dt){if(Kt){e:{for(var d=Kt,p=bi;d.nodeType!==8;){if(!p){d=null;break e}if(d=Ai(d.nextSibling),d===null){d=null;break e}}p=d.data,d=p==="F!"||p==="F"?d:null}if(d){Kt=Ai(d.nextSibling),o=d.data==="F!";break t}}wn(o)}o=!1}o&&(n=a[0])}}return a=Pe(),a.memoizedState=a.baseState=n,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:of,lastRenderedState:n},a.queue=o,a=Cf.bind(null,St,o),o.dispatch=a,o=Oc(!1),p=jc.bind(null,St,!1,o.queue),o=Pe(),d={state:n,dispatch:null,action:e,pending:null},o.queue=d,a=lb.bind(null,St,d,p,a),d.dispatch=a,o.memoizedState=e,[n,a,!1]}function cf(e){var n=le();return uf(n,Gt,e)}function uf(e,n,a){if(n=Rc(e,n,of)[0],e=go(sn)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var o=Va(n)}catch(v){throw v===qs?so:v}else o=n;n=le();var d=n.queue,p=d.dispatch;return a!==n.memoizedState&&(St.flags|=2048,Ks(9,{destroy:void 0},cb.bind(null,d,a),null)),[o,p,e]}function cb(e,n){e.action=n}function hf(e){var n=le(),a=Gt;if(a!==null)return uf(n,a,e);le(),n=n.memoizedState,a=le();var o=a.queue.dispatch;return a.memoizedState=e,[n,o,!1]}function Ks(e,n,a,o){return e={tag:e,create:a,deps:o,inst:n,next:null},n=St.updateQueue,n===null&&(n=fo(),St.updateQueue=n),a=n.lastEffect,a===null?n.lastEffect=e.next=e:(o=a.next,a.next=e,e.next=o,n.lastEffect=e),e}function df(){return le().memoizedState}function mo(e,n,a,o){var d=Pe();St.flags|=e,d.memoizedState=Ks(1|n,{destroy:void 0},a,o===void 0?null:o)}function yo(e,n,a,o){var d=le();o=o===void 0?null:o;var p=d.memoizedState.inst;Gt!==null&&o!==null&&_c(o,Gt.memoizedState.deps)?d.memoizedState=Ks(n,p,a,o):(St.flags|=e,d.memoizedState=Ks(1|n,p,a,o))}function ff(e,n){mo(8390656,8,e,n)}function kc(e,n){yo(2048,8,e,n)}function ub(e){St.flags|=4;var n=St.updateQueue;if(n===null)n=fo(),St.updateQueue=n,n.events=[e];else{var a=n.events;a===null?n.events=[e]:a.push(e)}}function pf(e){var n=le().memoizedState;return ub({ref:n,nextImpl:e}),function(){if((zt&2)!==0)throw Error(s(440));return n.impl.apply(void 0,arguments)}}function gf(e,n){return yo(4,2,e,n)}function mf(e,n){return yo(4,4,e,n)}function yf(e,n){if(typeof n=="function"){e=e();var a=n(e);return function(){typeof a=="function"?a():n(null)}}if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function bf(e,n,a){a=a!=null?a.concat([e]):null,yo(4,4,yf.bind(null,n,e),a)}function Bc(){}function vf(e,n){var a=le();n=n===void 0?null:n;var o=a.memoizedState;return n!==null&&_c(n,o[1])?o[0]:(a.memoizedState=[e,n],e)}function Af(e,n){var a=le();n=n===void 0?null:n;var o=a.memoizedState;if(n!==null&&_c(n,o[1]))return o[0];if(o=e(),os){Ci(!0);try{e()}finally{Ci(!1)}}return a.memoizedState=[o,n],o}function zc(e,n,a){return a===void 0||(nn&1073741824)!==0&&(Ct&261930)===0?e.memoizedState=n:(e.memoizedState=a,e=Sp(),St.lanes|=e,Nn|=e,a)}function Sf(e,n,a,o){return ei(a,n)?a:Xs.current!==null?(e=zc(e,a,o),ei(e,n)||(fe=!0),e):(nn&42)===0||(nn&1073741824)!==0&&(Ct&261930)===0?(fe=!0,e.memoizedState=a):(e=Sp(),St.lanes|=e,Nn|=e,n)}function wf(e,n,a,o,d){var p=V.p;V.p=p!==0&&8>p?p:8;var v=k.T,x={};k.T=x,jc(e,!1,n,a);try{var M=d(),j=k.S;if(j!==null&&j(x,M),M!==null&&typeof M=="object"&&typeof M.then=="function"){var X=ab(M,o);Xa(e,n,X,oi(e))}else Xa(e,n,o,oi(e))}catch($){Xa(e,n,{then:function(){},status:"rejected",reason:$},oi())}finally{V.p=p,v!==null&&x.types!==null&&(v.types=x.types),k.T=v}}function hb(){}function Pc(e,n,a,o){if(e.tag!==5)throw Error(s(476));var d=xf(e).queue;wf(e,d,n,tt,a===null?hb:function(){return _f(e),a(o)})}function xf(e){var n=e.memoizedState;if(n!==null)return n;n={memoizedState:tt,baseState:tt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sn,lastRenderedState:tt},next:null};var a={};return n.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sn,lastRenderedState:a},next:null},e.memoizedState=n,e=e.alternate,e!==null&&(e.memoizedState=n),n}function _f(e){var n=xf(e);n.next===null&&(n=e.alternate.memoizedState),Xa(e,n.next.queue,{},oi())}function Uc(){return Te(cr)}function Ef(){return le().memoizedState}function Tf(){return le().memoizedState}function db(e){for(var n=e.return;n!==null;){switch(n.tag){case 24:case 3:var a=oi();e=En(a);var o=Tn(n,e,a);o!==null&&($e(o,n,a),Ha(o,n,a)),n={cache:fc()},e.payload=n;return}n=n.return}}function fb(e,n,a){var o=oi();a={lane:o,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},bo(e)?Mf(n,a):(a=ic(e,n,a,o),a!==null&&($e(a,e,o),Df(a,n,o)))}function Cf(e,n,a){var o=oi();Xa(e,n,a,o)}function Xa(e,n,a,o){var d={lane:o,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(bo(e))Mf(n,d);else{var p=e.alternate;if(e.lanes===0&&(p===null||p.lanes===0)&&(p=n.lastRenderedReducer,p!==null))try{var v=n.lastRenderedState,x=p(v,a);if(d.hasEagerState=!0,d.eagerState=x,ei(x,v))return Zr(e,n,d,0),Yt===null&&Qr(),!1}catch{}finally{}if(a=ic(e,n,d,o),a!==null)return $e(a,e,o),Df(a,n,o),!0}return!1}function jc(e,n,a,o){if(o={lane:2,revertLane:yu(),gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},bo(e)){if(n)throw Error(s(479))}else n=ic(e,a,o,2),n!==null&&$e(n,e,2)}function bo(e){var n=e.alternate;return e===St||n!==null&&n===St}function Mf(e,n){Ys=uo=!0;var a=e.pending;a===null?n.next=n:(n.next=a.next,a.next=n),e.pending=n}function Df(e,n,a){if((a&4194048)!==0){var o=n.lanes;o&=e.pendingLanes,a|=o,n.lanes=a,Ur(e,a)}}var Ya={readContext:Te,use:po,useCallback:se,useContext:se,useEffect:se,useImperativeHandle:se,useLayoutEffect:se,useInsertionEffect:se,useMemo:se,useReducer:se,useRef:se,useState:se,useDebugValue:se,useDeferredValue:se,useTransition:se,useSyncExternalStore:se,useId:se,useHostTransitionStatus:se,useFormState:se,useActionState:se,useOptimistic:se,useMemoCache:se,useCacheRefresh:se};Ya.useEffectEvent=se;var Rf={readContext:Te,use:po,useCallback:function(e,n){return Pe().memoizedState=[e,n===void 0?null:n],e},useContext:Te,useEffect:ff,useImperativeHandle:function(e,n,a){a=a!=null?a.concat([e]):null,mo(4194308,4,yf.bind(null,n,e),a)},useLayoutEffect:function(e,n){return mo(4194308,4,e,n)},useInsertionEffect:function(e,n){mo(4,2,e,n)},useMemo:function(e,n){var a=Pe();n=n===void 0?null:n;var o=e();if(os){Ci(!0);try{e()}finally{Ci(!1)}}return a.memoizedState=[o,n],o},useReducer:function(e,n,a){var o=Pe();if(a!==void 0){var d=a(n);if(os){Ci(!0);try{a(n)}finally{Ci(!1)}}}else d=n;return o.memoizedState=o.baseState=d,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:d},o.queue=e,e=e.dispatch=fb.bind(null,St,e),[o.memoizedState,e]},useRef:function(e){var n=Pe();return e={current:e},n.memoizedState=e},useState:function(e){e=Oc(e);var n=e.queue,a=Cf.bind(null,St,n);return n.dispatch=a,[e.memoizedState,a]},useDebugValue:Bc,useDeferredValue:function(e,n){var a=Pe();return zc(a,e,n)},useTransition:function(){var e=Oc(!1);return e=wf.bind(null,St,e.queue,!0,!1),Pe().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,n,a){var o=St,d=Pe();if(Dt){if(a===void 0)throw Error(s(407));a=a()}else{if(a=n(),Yt===null)throw Error(s(349));(Ct&127)!==0||Qd(o,n,a)}d.memoizedState=a;var p={value:a,getSnapshot:n};return d.queue=p,ff(Wd.bind(null,o,p,e),[e]),o.flags|=2048,Ks(9,{destroy:void 0},Zd.bind(null,o,p,a,n),null),a},useId:function(){var e=Pe(),n=Yt.identifierPrefix;if(Dt){var a=Pi,o=zi;a=(o&~(1<<32-ue(o)-1)).toString(32)+a,n="_"+n+"R_"+a,a=ho++,0<a&&(n+="H"+a.toString(32)),n+="_"}else a=rb++,n="_"+n+"r_"+a.toString(32)+"_";return e.memoizedState=n},useHostTransitionStatus:Uc,useFormState:lf,useActionState:lf,useOptimistic:function(e){var n=Pe();n.memoizedState=n.baseState=e;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=a,n=jc.bind(null,St,!0,a),a.dispatch=n,[e,n]},useMemoCache:Dc,useCacheRefresh:function(){return Pe().memoizedState=db.bind(null,St)},useEffectEvent:function(e){var n=Pe(),a={impl:e};return n.memoizedState=a,function(){if((zt&2)!==0)throw Error(s(440));return a.impl.apply(void 0,arguments)}}},Fc={readContext:Te,use:po,useCallback:vf,useContext:Te,useEffect:kc,useImperativeHandle:bf,useInsertionEffect:gf,useLayoutEffect:mf,useMemo:Af,useReducer:go,useRef:df,useState:function(){return go(sn)},useDebugValue:Bc,useDeferredValue:function(e,n){var a=le();return Sf(a,Gt.memoizedState,e,n)},useTransition:function(){var e=go(sn)[0],n=le().memoizedState;return[typeof e=="boolean"?e:Va(e),n]},useSyncExternalStore:Kd,useId:Ef,useHostTransitionStatus:Uc,useFormState:cf,useActionState:cf,useOptimistic:function(e,n){var a=le();return ef(a,Gt,e,n)},useMemoCache:Dc,useCacheRefresh:Tf};Fc.useEffectEvent=pf;var Nf={readContext:Te,use:po,useCallback:vf,useContext:Te,useEffect:kc,useImperativeHandle:bf,useInsertionEffect:gf,useLayoutEffect:mf,useMemo:Af,useReducer:Nc,useRef:df,useState:function(){return Nc(sn)},useDebugValue:Bc,useDeferredValue:function(e,n){var a=le();return Gt===null?zc(a,e,n):Sf(a,Gt.memoizedState,e,n)},useTransition:function(){var e=Nc(sn)[0],n=le().memoizedState;return[typeof e=="boolean"?e:Va(e),n]},useSyncExternalStore:Kd,useId:Ef,useHostTransitionStatus:Uc,useFormState:hf,useActionState:hf,useOptimistic:function(e,n){var a=le();return Gt!==null?ef(a,Gt,e,n):(a.baseState=e,[e,a.queue.dispatch])},useMemoCache:Dc,useCacheRefresh:Tf};Nf.useEffectEvent=pf;function Hc(e,n,a,o){n=e.memoizedState,a=a(o,n),a=a==null?n:y({},n,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var Ic={enqueueSetState:function(e,n,a){e=e._reactInternals;var o=oi(),d=En(o);d.payload=n,a!=null&&(d.callback=a),n=Tn(e,d,o),n!==null&&($e(n,e,o),Ha(n,e,o))},enqueueReplaceState:function(e,n,a){e=e._reactInternals;var o=oi(),d=En(o);d.tag=1,d.payload=n,a!=null&&(d.callback=a),n=Tn(e,d,o),n!==null&&($e(n,e,o),Ha(n,e,o))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var a=oi(),o=En(a);o.tag=2,n!=null&&(o.callback=n),n=Tn(e,o,a),n!==null&&($e(n,e,a),Ha(n,e,a))}};function Of(e,n,a,o,d,p,v){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,p,v):n.prototype&&n.prototype.isPureReactComponent?!La(a,o)||!La(d,p):!0}function Lf(e,n,a,o){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(a,o),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(a,o),n.state!==e&&Ic.enqueueReplaceState(n,n.state,null)}function ls(e,n){var a=n;if("ref"in n){a={};for(var o in n)o!=="ref"&&(a[o]=n[o])}if(e=e.defaultProps){a===n&&(a=y({},a));for(var d in e)a[d]===void 0&&(a[d]=e[d])}return a}function kf(e){Kr(e)}function Bf(e){console.error(e)}function zf(e){Kr(e)}function vo(e,n){try{var a=e.onUncaughtError;a(n.value,{componentStack:n.stack})}catch(o){setTimeout(function(){throw o})}}function Pf(e,n,a){try{var o=e.onCaughtError;o(a.value,{componentStack:a.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(d){setTimeout(function(){throw d})}}function Gc(e,n,a){return a=En(a),a.tag=3,a.payload={element:null},a.callback=function(){vo(e,n)},a}function Uf(e){return e=En(e),e.tag=3,e}function jf(e,n,a,o){var d=a.type.getDerivedStateFromError;if(typeof d=="function"){var p=o.value;e.payload=function(){return d(p)},e.callback=function(){Pf(n,a,o)}}var v=a.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(e.callback=function(){Pf(n,a,o),typeof d!="function"&&(On===null?On=new Set([this]):On.add(this));var x=o.stack;this.componentDidCatch(o.value,{componentStack:x!==null?x:""})})}function pb(e,n,a,o,d){if(a.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){if(n=a.alternate,n!==null&&Hs(n,a,d,!0),a=ni.current,a!==null){switch(a.tag){case 31:case 13:return vi===null?No():a.alternate===null&&ae===0&&(ae=3),a.flags&=-257,a.flags|=65536,a.lanes=d,o===ao?a.flags|=16384:(n=a.updateQueue,n===null?a.updateQueue=new Set([o]):n.add(o),pu(e,o,d)),!1;case 22:return a.flags|=65536,o===ao?a.flags|=16384:(n=a.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([o])},a.updateQueue=n):(a=n.retryQueue,a===null?n.retryQueue=new Set([o]):a.add(o)),pu(e,o,d)),!1}throw Error(s(435,a.tag))}return pu(e,o,d),No(),!1}if(Dt)return n=ni.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=d,o!==lc&&(e=Error(s(422),{cause:o}),za(gi(e,a)))):(o!==lc&&(n=Error(s(423),{cause:o}),za(gi(n,a))),e=e.current.alternate,e.flags|=65536,d&=-d,e.lanes|=d,o=gi(o,a),d=Gc(e.stateNode,o,d),vc(e,d),ae!==4&&(ae=2)),!1;var p=Error(s(520),{cause:o});if(p=gi(p,a),er===null?er=[p]:er.push(p),ae!==4&&(ae=2),n===null)return!0;o=gi(o,a),a=n;do{switch(a.tag){case 3:return a.flags|=65536,e=d&-d,a.lanes|=e,e=Gc(a.stateNode,o,e),vc(a,e),!1;case 1:if(n=a.type,p=a.stateNode,(a.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(On===null||!On.has(p))))return a.flags|=65536,d&=-d,a.lanes|=d,d=Uf(d),jf(d,e,a,o),vc(a,d),!1}a=a.return}while(a!==null);return!1}var qc=Error(s(461)),fe=!1;function Ce(e,n,a,o){n.child=e===null?Id(n,null,a,o):rs(n,e.child,a,o)}function Ff(e,n,a,o,d){a=a.render;var p=n.ref;if("ref"in o){var v={};for(var x in o)x!=="ref"&&(v[x]=o[x])}else v=o;return is(n),o=Ec(e,n,a,v,p,d),x=Tc(),e!==null&&!fe?(Cc(e,n,d),an(e,n,d)):(Dt&&x&&rc(n),n.flags|=1,Ce(e,n,o,d),n.child)}function Hf(e,n,a,o,d){if(e===null){var p=a.type;return typeof p=="function"&&!nc(p)&&p.defaultProps===void 0&&a.compare===null?(n.tag=15,n.type=p,If(e,n,p,o,d)):(e=Jr(a.type,null,o,n,n.mode,d),e.ref=n.ref,e.return=n,n.child=e)}if(p=e.child,!Wc(e,d)){var v=p.memoizedProps;if(a=a.compare,a=a!==null?a:La,a(v,o)&&e.ref===n.ref)return an(e,n,d)}return n.flags|=1,e=Wi(p,o),e.ref=n.ref,e.return=n,n.child=e}function If(e,n,a,o,d){if(e!==null){var p=e.memoizedProps;if(La(p,o)&&e.ref===n.ref)if(fe=!1,n.pendingProps=o=p,Wc(e,d))(e.flags&131072)!==0&&(fe=!0);else return n.lanes=e.lanes,an(e,n,d)}return Vc(e,n,a,o,d)}function Gf(e,n,a,o){var d=o.children,p=e!==null?e.memoizedState:null;if(e===null&&n.stateNode===null&&(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.mode==="hidden"){if((n.flags&128)!==0){if(p=p!==null?p.baseLanes|a:a,e!==null){for(o=n.child=e.child,d=0;o!==null;)d=d|o.lanes|o.childLanes,o=o.sibling;o=d&~p}else o=0,n.child=null;return qf(e,n,p,a,o)}if((a&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},e!==null&&no(n,p!==null?p.cachePool:null),p!==null?Vd(n,p):Sc(),Xd(n);else return o=n.lanes=536870912,qf(e,n,p!==null?p.baseLanes|a:a,a,o)}else p!==null?(no(n,p.cachePool),Vd(n,p),Mn(),n.memoizedState=null):(e!==null&&no(n,null),Sc(),Mn());return Ce(e,n,d,a),n.child}function $a(e,n){return e!==null&&e.tag===22||n.stateNode!==null||(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.sibling}function qf(e,n,a,o,d){var p=gc();return p=p===null?null:{parent:he._currentValue,pool:p},n.memoizedState={baseLanes:a,cachePool:p},e!==null&&no(n,null),Sc(),Xd(n),e!==null&&Hs(e,n,o,!0),n.childLanes=d,null}function Ao(e,n){return n=wo({mode:n.mode,children:n.children},e.mode),n.ref=e.ref,e.child=n,n.return=e,n}function Vf(e,n,a){return rs(n,e.child,null,a),e=Ao(n,n.pendingProps),e.flags|=2,si(n),n.memoizedState=null,e}function gb(e,n,a){var o=n.pendingProps,d=(n.flags&128)!==0;if(n.flags&=-129,e===null){if(Dt){if(o.mode==="hidden")return e=Ao(n,o),n.lanes=536870912,$a(null,e);if(xc(n),(e=Kt)?(e=ng(e,bi),e=e!==null&&e.data==="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:An!==null?{id:zi,overflow:Pi}:null,retryLane:536870912,hydrationErrors:null},a=Cd(e),a.return=n,n.child=a,Ee=n,Kt=null)):e=null,e===null)throw wn(n);return n.lanes=536870912,null}return Ao(n,o)}var p=e.memoizedState;if(p!==null){var v=p.dehydrated;if(xc(n),d)if(n.flags&256)n.flags&=-257,n=Vf(e,n,a);else if(n.memoizedState!==null)n.child=e.child,n.flags|=128,n=null;else throw Error(s(558));else if(fe||Hs(e,n,a,!1),d=(a&e.childLanes)!==0,fe||d){if(o=Yt,o!==null&&(v=kh(o,a),v!==0&&v!==p.retryLane))throw p.retryLane=v,Wn(e,v),$e(o,e,v),qc;No(),n=Vf(e,n,a)}else e=p.treeContext,Kt=Ai(v.nextSibling),Ee=n,Dt=!0,Sn=null,bi=!1,e!==null&&Rd(n,e),n=Ao(n,o),n.flags|=4096;return n}return e=Wi(e.child,{mode:o.mode,children:o.children}),e.ref=n.ref,n.child=e,e.return=n,e}function So(e,n){var a=n.ref;if(a===null)e!==null&&e.ref!==null&&(n.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(s(284));(e===null||e.ref!==a)&&(n.flags|=4194816)}}function Vc(e,n,a,o,d){return is(n),a=Ec(e,n,a,o,void 0,d),o=Tc(),e!==null&&!fe?(Cc(e,n,d),an(e,n,d)):(Dt&&o&&rc(n),n.flags|=1,Ce(e,n,a,d),n.child)}function Xf(e,n,a,o,d,p){return is(n),n.updateQueue=null,a=$d(n,o,a,d),Yd(e),o=Tc(),e!==null&&!fe?(Cc(e,n,p),an(e,n,p)):(Dt&&o&&rc(n),n.flags|=1,Ce(e,n,a,p),n.child)}function Yf(e,n,a,o,d){if(is(n),n.stateNode===null){var p=Ps,v=a.contextType;typeof v=="object"&&v!==null&&(p=Te(v)),p=new a(o,p),n.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=Ic,n.stateNode=p,p._reactInternals=n,p=n.stateNode,p.props=o,p.state=n.memoizedState,p.refs={},yc(n),v=a.contextType,p.context=typeof v=="object"&&v!==null?Te(v):Ps,p.state=n.memoizedState,v=a.getDerivedStateFromProps,typeof v=="function"&&(Hc(n,a,v,o),p.state=n.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(v=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),v!==p.state&&Ic.enqueueReplaceState(p,p.state,null),Ga(n,o,p,d),Ia(),p.state=n.memoizedState),typeof p.componentDidMount=="function"&&(n.flags|=4194308),o=!0}else if(e===null){p=n.stateNode;var x=n.memoizedProps,M=ls(a,x);p.props=M;var j=p.context,X=a.contextType;v=Ps,typeof X=="object"&&X!==null&&(v=Te(X));var $=a.getDerivedStateFromProps;X=typeof $=="function"||typeof p.getSnapshotBeforeUpdate=="function",x=n.pendingProps!==x,X||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(x||j!==v)&&Lf(n,p,o,v),_n=!1;var H=n.memoizedState;p.state=H,Ga(n,o,p,d),Ia(),j=n.memoizedState,x||H!==j||_n?(typeof $=="function"&&(Hc(n,a,$,o),j=n.memoizedState),(M=_n||Of(n,a,M,o,H,j,v))?(X||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(n.flags|=4194308)):(typeof p.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=o,n.memoizedState=j),p.props=o,p.state=j,p.context=v,o=M):(typeof p.componentDidMount=="function"&&(n.flags|=4194308),o=!1)}else{p=n.stateNode,bc(e,n),v=n.memoizedProps,X=ls(a,v),p.props=X,$=n.pendingProps,H=p.context,j=a.contextType,M=Ps,typeof j=="object"&&j!==null&&(M=Te(j)),x=a.getDerivedStateFromProps,(j=typeof x=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(v!==$||H!==M)&&Lf(n,p,o,M),_n=!1,H=n.memoizedState,p.state=H,Ga(n,o,p,d),Ia();var G=n.memoizedState;v!==$||H!==G||_n||e!==null&&e.dependencies!==null&&eo(e.dependencies)?(typeof x=="function"&&(Hc(n,a,x,o),G=n.memoizedState),(X=_n||Of(n,a,X,o,H,G,M)||e!==null&&e.dependencies!==null&&eo(e.dependencies))?(j||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(o,G,M),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(o,G,M)),typeof p.componentDidUpdate=="function"&&(n.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof p.componentDidUpdate!="function"||v===e.memoizedProps&&H===e.memoizedState||(n.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&H===e.memoizedState||(n.flags|=1024),n.memoizedProps=o,n.memoizedState=G),p.props=o,p.state=G,p.context=M,o=X):(typeof p.componentDidUpdate!="function"||v===e.memoizedProps&&H===e.memoizedState||(n.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&H===e.memoizedState||(n.flags|=1024),o=!1)}return p=o,So(e,n),o=(n.flags&128)!==0,p||o?(p=n.stateNode,a=o&&typeof a.getDerivedStateFromError!="function"?null:p.render(),n.flags|=1,e!==null&&o?(n.child=rs(n,e.child,null,d),n.child=rs(n,null,a,d)):Ce(e,n,a,d),n.memoizedState=p.state,e=n.child):e=an(e,n,d),e}function $f(e,n,a,o){return ts(),n.flags|=256,Ce(e,n,a,o),n.child}var Xc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Yc(e){return{baseLanes:e,cachePool:zd()}}function $c(e,n,a){return e=e!==null?e.childLanes&~a:0,n&&(e|=ri),e}function Kf(e,n,a){var o=n.pendingProps,d=!1,p=(n.flags&128)!==0,v;if((v=p)||(v=e!==null&&e.memoizedState===null?!1:(oe.current&2)!==0),v&&(d=!0,n.flags&=-129),v=(n.flags&32)!==0,n.flags&=-33,e===null){if(Dt){if(d?Cn(n):Mn(),(e=Kt)?(e=ng(e,bi),e=e!==null&&e.data!=="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:An!==null?{id:zi,overflow:Pi}:null,retryLane:536870912,hydrationErrors:null},a=Cd(e),a.return=n,n.child=a,Ee=n,Kt=null)):e=null,e===null)throw wn(n);return Ru(e)?n.lanes=32:n.lanes=536870912,null}var x=o.children;return o=o.fallback,d?(Mn(),d=n.mode,x=wo({mode:"hidden",children:x},d),o=Jn(o,d,a,null),x.return=n,o.return=n,x.sibling=o,n.child=x,o=n.child,o.memoizedState=Yc(a),o.childLanes=$c(e,v,a),n.memoizedState=Xc,$a(null,o)):(Cn(n),Kc(n,x))}var M=e.memoizedState;if(M!==null&&(x=M.dehydrated,x!==null)){if(p)n.flags&256?(Cn(n),n.flags&=-257,n=Qc(e,n,a)):n.memoizedState!==null?(Mn(),n.child=e.child,n.flags|=128,n=null):(Mn(),x=o.fallback,d=n.mode,o=wo({mode:"visible",children:o.children},d),x=Jn(x,d,a,null),x.flags|=2,o.return=n,x.return=n,o.sibling=x,n.child=o,rs(n,e.child,null,a),o=n.child,o.memoizedState=Yc(a),o.childLanes=$c(e,v,a),n.memoizedState=Xc,n=$a(null,o));else if(Cn(n),Ru(x)){if(v=x.nextSibling&&x.nextSibling.dataset,v)var j=v.dgst;v=j,o=Error(s(419)),o.stack="",o.digest=v,za({value:o,source:null,stack:null}),n=Qc(e,n,a)}else if(fe||Hs(e,n,a,!1),v=(a&e.childLanes)!==0,fe||v){if(v=Yt,v!==null&&(o=kh(v,a),o!==0&&o!==M.retryLane))throw M.retryLane=o,Wn(e,o),$e(v,e,o),qc;Du(x)||No(),n=Qc(e,n,a)}else Du(x)?(n.flags|=192,n.child=e.child,n=null):(e=M.treeContext,Kt=Ai(x.nextSibling),Ee=n,Dt=!0,Sn=null,bi=!1,e!==null&&Rd(n,e),n=Kc(n,o.children),n.flags|=4096);return n}return d?(Mn(),x=o.fallback,d=n.mode,M=e.child,j=M.sibling,o=Wi(M,{mode:"hidden",children:o.children}),o.subtreeFlags=M.subtreeFlags&65011712,j!==null?x=Wi(j,x):(x=Jn(x,d,a,null),x.flags|=2),x.return=n,o.return=n,o.sibling=x,n.child=o,$a(null,o),o=n.child,x=e.child.memoizedState,x===null?x=Yc(a):(d=x.cachePool,d!==null?(M=he._currentValue,d=d.parent!==M?{parent:M,pool:M}:d):d=zd(),x={baseLanes:x.baseLanes|a,cachePool:d}),o.memoizedState=x,o.childLanes=$c(e,v,a),n.memoizedState=Xc,$a(e.child,o)):(Cn(n),a=e.child,e=a.sibling,a=Wi(a,{mode:"visible",children:o.children}),a.return=n,a.sibling=null,e!==null&&(v=n.deletions,v===null?(n.deletions=[e],n.flags|=16):v.push(e)),n.child=a,n.memoizedState=null,a)}function Kc(e,n){return n=wo({mode:"visible",children:n},e.mode),n.return=e,e.child=n}function wo(e,n){return e=ii(22,e,null,n),e.lanes=0,e}function Qc(e,n,a){return rs(n,e.child,null,a),e=Kc(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function Qf(e,n,a){e.lanes|=n;var o=e.alternate;o!==null&&(o.lanes|=n),hc(e.return,n,a)}function Zc(e,n,a,o,d,p){var v=e.memoizedState;v===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:o,tail:a,tailMode:d,treeForkCount:p}:(v.isBackwards=n,v.rendering=null,v.renderingStartTime=0,v.last=o,v.tail=a,v.tailMode=d,v.treeForkCount=p)}function Zf(e,n,a){var o=n.pendingProps,d=o.revealOrder,p=o.tail;o=o.children;var v=oe.current,x=(v&2)!==0;if(x?(v=v&1|2,n.flags|=128):v&=1,Q(oe,v),Ce(e,n,o,a),o=Dt?Ba:0,!x&&e!==null&&(e.flags&128)!==0)t:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Qf(e,a,n);else if(e.tag===19)Qf(e,a,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break t;for(;e.sibling===null;){if(e.return===null||e.return===n)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(d){case"forwards":for(a=n.child,d=null;a!==null;)e=a.alternate,e!==null&&co(e)===null&&(d=a),a=a.sibling;a=d,a===null?(d=n.child,n.child=null):(d=a.sibling,a.sibling=null),Zc(n,!1,d,a,p,o);break;case"backwards":case"unstable_legacy-backwards":for(a=null,d=n.child,n.child=null;d!==null;){if(e=d.alternate,e!==null&&co(e)===null){n.child=d;break}e=d.sibling,d.sibling=a,a=d,d=e}Zc(n,!0,a,null,p,o);break;case"together":Zc(n,!1,null,null,void 0,o);break;default:n.memoizedState=null}return n.child}function an(e,n,a){if(e!==null&&(n.dependencies=e.dependencies),Nn|=n.lanes,(a&n.childLanes)===0)if(e!==null){if(Hs(e,n,a,!1),(a&n.childLanes)===0)return null}else return null;if(e!==null&&n.child!==e.child)throw Error(s(153));if(n.child!==null){for(e=n.child,a=Wi(e,e.pendingProps),n.child=a,a.return=n;e.sibling!==null;)e=e.sibling,a=a.sibling=Wi(e,e.pendingProps),a.return=n;a.sibling=null}return n.child}function Wc(e,n){return(e.lanes&n)!==0?!0:(e=e.dependencies,!!(e!==null&&eo(e)))}function mb(e,n,a){switch(n.tag){case 3:ee(n,n.stateNode.containerInfo),xn(n,he,e.memoizedState.cache),ts();break;case 27:case 5:Li(n);break;case 4:ee(n,n.stateNode.containerInfo);break;case 10:xn(n,n.type,n.memoizedProps.value);break;case 31:if(n.memoizedState!==null)return n.flags|=128,xc(n),null;break;case 13:var o=n.memoizedState;if(o!==null)return o.dehydrated!==null?(Cn(n),n.flags|=128,null):(a&n.child.childLanes)!==0?Kf(e,n,a):(Cn(n),e=an(e,n,a),e!==null?e.sibling:null);Cn(n);break;case 19:var d=(e.flags&128)!==0;if(o=(a&n.childLanes)!==0,o||(Hs(e,n,a,!1),o=(a&n.childLanes)!==0),d){if(o)return Zf(e,n,a);n.flags|=128}if(d=n.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),Q(oe,oe.current),o)break;return null;case 22:return n.lanes=0,Gf(e,n,a,n.pendingProps);case 24:xn(n,he,e.memoizedState.cache)}return an(e,n,a)}function Wf(e,n,a){if(e!==null)if(e.memoizedProps!==n.pendingProps)fe=!0;else{if(!Wc(e,a)&&(n.flags&128)===0)return fe=!1,mb(e,n,a);fe=(e.flags&131072)!==0}else fe=!1,Dt&&(n.flags&1048576)!==0&&Dd(n,Ba,n.index);switch(n.lanes=0,n.tag){case 16:t:{var o=n.pendingProps;if(e=ss(n.elementType),n.type=e,typeof e=="function")nc(e)?(o=ls(e,o),n.tag=1,n=Yf(null,n,e,o,a)):(n.tag=0,n=Vc(null,n,e,o,a));else{if(e!=null){var d=e.$$typeof;if(d===B){n.tag=11,n=Ff(null,n,e,o,a);break t}else if(d===P){n.tag=14,n=Hf(null,n,e,o,a);break t}}throw n=bt(e)||e,Error(s(306,n,""))}}return n;case 0:return Vc(e,n,n.type,n.pendingProps,a);case 1:return o=n.type,d=ls(o,n.pendingProps),Yf(e,n,o,d,a);case 3:t:{if(ee(n,n.stateNode.containerInfo),e===null)throw Error(s(387));o=n.pendingProps;var p=n.memoizedState;d=p.element,bc(e,n),Ga(n,o,null,a);var v=n.memoizedState;if(o=v.cache,xn(n,he,o),o!==p.cache&&dc(n,[he],a,!0),Ia(),o=v.element,p.isDehydrated)if(p={element:o,isDehydrated:!1,cache:v.cache},n.updateQueue.baseState=p,n.memoizedState=p,n.flags&256){n=$f(e,n,o,a);break t}else if(o!==d){d=gi(Error(s(424)),n),za(d),n=$f(e,n,o,a);break t}else{switch(e=n.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Kt=Ai(e.firstChild),Ee=n,Dt=!0,Sn=null,bi=!0,a=Id(n,null,o,a),n.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(ts(),o===d){n=an(e,n,a);break t}Ce(e,n,o,a)}n=n.child}return n;case 26:return So(e,n),e===null?(a=cg(n.type,null,n.pendingProps,null))?n.memoizedState=a:Dt||(a=n.type,e=n.pendingProps,o=Uo(ft.current).createElement(a),o[_e]=n,o[Ie]=e,Me(o,a,e),ve(o),n.stateNode=o):n.memoizedState=cg(n.type,e.memoizedProps,n.pendingProps,e.memoizedState),null;case 27:return Li(n),e===null&&Dt&&(o=n.stateNode=rg(n.type,n.pendingProps,ft.current),Ee=n,bi=!0,d=Kt,zn(n.type)?(Nu=d,Kt=Ai(o.firstChild)):Kt=d),Ce(e,n,n.pendingProps.children,a),So(e,n),e===null&&(n.flags|=4194304),n.child;case 5:return e===null&&Dt&&((d=o=Kt)&&(o=Xb(o,n.type,n.pendingProps,bi),o!==null?(n.stateNode=o,Ee=n,Kt=Ai(o.firstChild),bi=!1,d=!0):d=!1),d||wn(n)),Li(n),d=n.type,p=n.pendingProps,v=e!==null?e.memoizedProps:null,o=p.children,Tu(d,p)?o=null:v!==null&&Tu(d,v)&&(n.flags|=32),n.memoizedState!==null&&(d=Ec(e,n,ob,null,null,a),cr._currentValue=d),So(e,n),Ce(e,n,o,a),n.child;case 6:return e===null&&Dt&&((e=a=Kt)&&(a=Yb(a,n.pendingProps,bi),a!==null?(n.stateNode=a,Ee=n,Kt=null,e=!0):e=!1),e||wn(n)),null;case 13:return Kf(e,n,a);case 4:return ee(n,n.stateNode.containerInfo),o=n.pendingProps,e===null?n.child=rs(n,null,o,a):Ce(e,n,o,a),n.child;case 11:return Ff(e,n,n.type,n.pendingProps,a);case 7:return Ce(e,n,n.pendingProps,a),n.child;case 8:return Ce(e,n,n.pendingProps.children,a),n.child;case 12:return Ce(e,n,n.pendingProps.children,a),n.child;case 10:return o=n.pendingProps,xn(n,n.type,o.value),Ce(e,n,o.children,a),n.child;case 9:return d=n.type._context,o=n.pendingProps.children,is(n),d=Te(d),o=o(d),n.flags|=1,Ce(e,n,o,a),n.child;case 14:return Hf(e,n,n.type,n.pendingProps,a);case 15:return If(e,n,n.type,n.pendingProps,a);case 19:return Zf(e,n,a);case 31:return gb(e,n,a);case 22:return Gf(e,n,a,n.pendingProps);case 24:return is(n),o=Te(he),e===null?(d=gc(),d===null&&(d=Yt,p=fc(),d.pooledCache=p,p.refCount++,p!==null&&(d.pooledCacheLanes|=a),d=p),n.memoizedState={parent:o,cache:d},yc(n),xn(n,he,d)):((e.lanes&a)!==0&&(bc(e,n),Ga(n,null,null,a),Ia()),d=e.memoizedState,p=n.memoizedState,d.parent!==o?(d={parent:o,cache:o},n.memoizedState=d,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=d),xn(n,he,o)):(o=p.cache,xn(n,he,o),o!==d.cache&&dc(n,[he],a,!0))),Ce(e,n,n.pendingProps.children,a),n.child;case 29:throw n.pendingProps}throw Error(s(156,n.tag))}function rn(e){e.flags|=4}function Jc(e,n,a,o,d){if((n=(e.mode&32)!==0)&&(n=!1),n){if(e.flags|=16777216,(d&335544128)===d)if(e.stateNode.complete)e.flags|=8192;else if(Ep())e.flags|=8192;else throw as=ao,mc}else e.flags&=-16777217}function Jf(e,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!pg(n))if(Ep())e.flags|=8192;else throw as=ao,mc}function xo(e,n){n!==null&&(e.flags|=4),e.flags&16384&&(n=e.tag!==22?Lt():536870912,e.lanes|=n,Js|=n)}function Ka(e,n){if(!Dt)switch(e.tailMode){case"hidden":n=e.tail;for(var a=null;n!==null;)n.alternate!==null&&(a=n),n=n.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function Qt(e){var n=e.alternate!==null&&e.alternate.child===e.child,a=0,o=0;if(n)for(var d=e.child;d!==null;)a|=d.lanes|d.childLanes,o|=d.subtreeFlags&65011712,o|=d.flags&65011712,d.return=e,d=d.sibling;else for(d=e.child;d!==null;)a|=d.lanes|d.childLanes,o|=d.subtreeFlags,o|=d.flags,d.return=e,d=d.sibling;return e.subtreeFlags|=o,e.childLanes=a,n}function yb(e,n,a){var o=n.pendingProps;switch(oc(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(n),null;case 1:return Qt(n),null;case 3:return a=n.stateNode,o=null,e!==null&&(o=e.memoizedState.cache),n.memoizedState.cache!==o&&(n.flags|=2048),en(he),jt(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(Fs(n)?rn(n):e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,cc())),Qt(n),null;case 26:var d=n.type,p=n.memoizedState;return e===null?(rn(n),p!==null?(Qt(n),Jf(n,p)):(Qt(n),Jc(n,d,null,o,a))):p?p!==e.memoizedState?(rn(n),Qt(n),Jf(n,p)):(Qt(n),n.flags&=-16777217):(e=e.memoizedProps,e!==o&&rn(n),Qt(n),Jc(n,d,e,o,a)),null;case 27:if(Ti(n),a=ft.current,d=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==o&&rn(n);else{if(!o){if(n.stateNode===null)throw Error(s(166));return Qt(n),null}e=et.current,Fs(n)?Nd(n):(e=rg(d,o,a),n.stateNode=e,rn(n))}return Qt(n),null;case 5:if(Ti(n),d=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==o&&rn(n);else{if(!o){if(n.stateNode===null)throw Error(s(166));return Qt(n),null}if(p=et.current,Fs(n))Nd(n);else{var v=Uo(ft.current);switch(p){case 1:p=v.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:p=v.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":p=v.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":p=v.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":p=v.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof o.is=="string"?v.createElement("select",{is:o.is}):v.createElement("select"),o.multiple?p.multiple=!0:o.size&&(p.size=o.size);break;default:p=typeof o.is=="string"?v.createElement(d,{is:o.is}):v.createElement(d)}}p[_e]=n,p[Ie]=o;t:for(v=n.child;v!==null;){if(v.tag===5||v.tag===6)p.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===n)break t;for(;v.sibling===null;){if(v.return===null||v.return===n)break t;v=v.return}v.sibling.return=v.return,v=v.sibling}n.stateNode=p;t:switch(Me(p,d,o),d){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break t;case"img":o=!0;break t;default:o=!1}o&&rn(n)}}return Qt(n),Jc(n,n.type,e===null?null:e.memoizedProps,n.pendingProps,a),null;case 6:if(e&&n.stateNode!=null)e.memoizedProps!==o&&rn(n);else{if(typeof o!="string"&&n.stateNode===null)throw Error(s(166));if(e=ft.current,Fs(n)){if(e=n.stateNode,a=n.memoizedProps,o=null,d=Ee,d!==null)switch(d.tag){case 27:case 5:o=d.memoizedProps}e[_e]=n,e=!!(e.nodeValue===a||o!==null&&o.suppressHydrationWarning===!0||Kp(e.nodeValue,a)),e||wn(n,!0)}else e=Uo(e).createTextNode(o),e[_e]=n,n.stateNode=e}return Qt(n),null;case 31:if(a=n.memoizedState,e===null||e.memoizedState!==null){if(o=Fs(n),a!==null){if(e===null){if(!o)throw Error(s(318));if(e=n.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(557));e[_e]=n}else ts(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Qt(n),e=!1}else a=cc(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=a),e=!0;if(!e)return n.flags&256?(si(n),n):(si(n),null);if((n.flags&128)!==0)throw Error(s(558))}return Qt(n),null;case 13:if(o=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(d=Fs(n),o!==null&&o.dehydrated!==null){if(e===null){if(!d)throw Error(s(318));if(d=n.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(s(317));d[_e]=n}else ts(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Qt(n),d=!1}else d=cc(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=d),d=!0;if(!d)return n.flags&256?(si(n),n):(si(n),null)}return si(n),(n.flags&128)!==0?(n.lanes=a,n):(a=o!==null,e=e!==null&&e.memoizedState!==null,a&&(o=n.child,d=null,o.alternate!==null&&o.alternate.memoizedState!==null&&o.alternate.memoizedState.cachePool!==null&&(d=o.alternate.memoizedState.cachePool.pool),p=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),p!==d&&(o.flags|=2048)),a!==e&&a&&(n.child.flags|=8192),xo(n,n.updateQueue),Qt(n),null);case 4:return jt(),e===null&&Su(n.stateNode.containerInfo),Qt(n),null;case 10:return en(n.type),Qt(n),null;case 19:if(I(oe),o=n.memoizedState,o===null)return Qt(n),null;if(d=(n.flags&128)!==0,p=o.rendering,p===null)if(d)Ka(o,!1);else{if(ae!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(p=co(e),p!==null){for(n.flags|=128,Ka(o,!1),e=p.updateQueue,n.updateQueue=e,xo(n,e),n.subtreeFlags=0,e=a,a=n.child;a!==null;)Td(a,e),a=a.sibling;return Q(oe,oe.current&1|2),Dt&&Ji(n,o.treeForkCount),n.child}e=e.sibling}o.tail!==null&&ke()>Mo&&(n.flags|=128,d=!0,Ka(o,!1),n.lanes=4194304)}else{if(!d)if(e=co(p),e!==null){if(n.flags|=128,d=!0,e=e.updateQueue,n.updateQueue=e,xo(n,e),Ka(o,!0),o.tail===null&&o.tailMode==="hidden"&&!p.alternate&&!Dt)return Qt(n),null}else 2*ke()-o.renderingStartTime>Mo&&a!==536870912&&(n.flags|=128,d=!0,Ka(o,!1),n.lanes=4194304);o.isBackwards?(p.sibling=n.child,n.child=p):(e=o.last,e!==null?e.sibling=p:n.child=p,o.last=p)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=ke(),e.sibling=null,a=oe.current,Q(oe,d?a&1|2:a&1),Dt&&Ji(n,o.treeForkCount),e):(Qt(n),null);case 22:case 23:return si(n),wc(),o=n.memoizedState!==null,e!==null?e.memoizedState!==null!==o&&(n.flags|=8192):o&&(n.flags|=8192),o?(a&536870912)!==0&&(n.flags&128)===0&&(Qt(n),n.subtreeFlags&6&&(n.flags|=8192)):Qt(n),a=n.updateQueue,a!==null&&xo(n,a.retryQueue),a=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),o=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),o!==a&&(n.flags|=2048),e!==null&&I(ns),null;case 24:return a=null,e!==null&&(a=e.memoizedState.cache),n.memoizedState.cache!==a&&(n.flags|=2048),en(he),Qt(n),null;case 25:return null;case 30:return null}throw Error(s(156,n.tag))}function bb(e,n){switch(oc(n),n.tag){case 1:return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return en(he),jt(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 26:case 27:case 5:return Ti(n),null;case 31:if(n.memoizedState!==null){if(si(n),n.alternate===null)throw Error(s(340));ts()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 13:if(si(n),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(s(340));ts()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return I(oe),null;case 4:return jt(),null;case 10:return en(n.type),null;case 22:case 23:return si(n),wc(),e!==null&&I(ns),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 24:return en(he),null;case 25:return null;default:return null}}function tp(e,n){switch(oc(n),n.tag){case 3:en(he),jt();break;case 26:case 27:case 5:Ti(n);break;case 4:jt();break;case 31:n.memoizedState!==null&&si(n);break;case 13:si(n);break;case 19:I(oe);break;case 10:en(n.type);break;case 22:case 23:si(n),wc(),e!==null&&I(ns);break;case 24:en(he)}}function Qa(e,n){try{var a=n.updateQueue,o=a!==null?a.lastEffect:null;if(o!==null){var d=o.next;a=d;do{if((a.tag&e)===e){o=void 0;var p=a.create,v=a.inst;o=p(),v.destroy=o}a=a.next}while(a!==d)}}catch(x){Ht(n,n.return,x)}}function Dn(e,n,a){try{var o=n.updateQueue,d=o!==null?o.lastEffect:null;if(d!==null){var p=d.next;o=p;do{if((o.tag&e)===e){var v=o.inst,x=v.destroy;if(x!==void 0){v.destroy=void 0,d=n;var M=a,j=x;try{j()}catch(X){Ht(d,M,X)}}}o=o.next}while(o!==p)}}catch(X){Ht(n,n.return,X)}}function ep(e){var n=e.updateQueue;if(n!==null){var a=e.stateNode;try{qd(n,a)}catch(o){Ht(e,e.return,o)}}}function ip(e,n,a){a.props=ls(e.type,e.memoizedProps),a.state=e.memoizedState;try{a.componentWillUnmount()}catch(o){Ht(e,n,o)}}function Za(e,n){try{var a=e.ref;if(a!==null){switch(e.tag){case 26:case 27:case 5:var o=e.stateNode;break;case 30:o=e.stateNode;break;default:o=e.stateNode}typeof a=="function"?e.refCleanup=a(o):a.current=o}}catch(d){Ht(e,n,d)}}function Ui(e,n){var a=e.ref,o=e.refCleanup;if(a!==null)if(typeof o=="function")try{o()}catch(d){Ht(e,n,d)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(d){Ht(e,n,d)}else a.current=null}function np(e){var n=e.type,a=e.memoizedProps,o=e.stateNode;try{t:switch(n){case"button":case"input":case"select":case"textarea":a.autoFocus&&o.focus();break t;case"img":a.src?o.src=a.src:a.srcSet&&(o.srcset=a.srcSet)}}catch(d){Ht(e,e.return,d)}}function tu(e,n,a){try{var o=e.stateNode;Fb(o,e.type,a,n),o[Ie]=n}catch(d){Ht(e,e.return,d)}}function sp(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&zn(e.type)||e.tag===4}function eu(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||sp(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&zn(e.type)||e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function iu(e,n,a){var o=e.tag;if(o===5||o===6)e=e.stateNode,n?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(e,n):(n=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,n.appendChild(e),a=a._reactRootContainer,a!=null||n.onclick!==null||(n.onclick=Qi));else if(o!==4&&(o===27&&zn(e.type)&&(a=e.stateNode,n=null),e=e.child,e!==null))for(iu(e,n,a),e=e.sibling;e!==null;)iu(e,n,a),e=e.sibling}function _o(e,n,a){var o=e.tag;if(o===5||o===6)e=e.stateNode,n?a.insertBefore(e,n):a.appendChild(e);else if(o!==4&&(o===27&&zn(e.type)&&(a=e.stateNode),e=e.child,e!==null))for(_o(e,n,a),e=e.sibling;e!==null;)_o(e,n,a),e=e.sibling}function ap(e){var n=e.stateNode,a=e.memoizedProps;try{for(var o=e.type,d=n.attributes;d.length;)n.removeAttributeNode(d[0]);Me(n,o,a),n[_e]=e,n[Ie]=a}catch(p){Ht(e,e.return,p)}}var on=!1,pe=!1,nu=!1,rp=typeof WeakSet=="function"?WeakSet:Set,Ae=null;function vb(e,n){if(e=e.containerInfo,_u=Vo,e=yd(e),Ql(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else t:{a=(a=e.ownerDocument)&&a.defaultView||window;var o=a.getSelection&&a.getSelection();if(o&&o.rangeCount!==0){a=o.anchorNode;var d=o.anchorOffset,p=o.focusNode;o=o.focusOffset;try{a.nodeType,p.nodeType}catch{a=null;break t}var v=0,x=-1,M=-1,j=0,X=0,$=e,H=null;e:for(;;){for(var G;$!==a||d!==0&&$.nodeType!==3||(x=v+d),$!==p||o!==0&&$.nodeType!==3||(M=v+o),$.nodeType===3&&(v+=$.nodeValue.length),(G=$.firstChild)!==null;)H=$,$=G;for(;;){if($===e)break e;if(H===a&&++j===d&&(x=v),H===p&&++X===o&&(M=v),(G=$.nextSibling)!==null)break;$=H,H=$.parentNode}$=G}a=x===-1||M===-1?null:{start:x,end:M}}else a=null}a=a||{start:0,end:0}}else a=null;for(Eu={focusedElem:e,selectionRange:a},Vo=!1,Ae=n;Ae!==null;)if(n=Ae,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,Ae=e;else for(;Ae!==null;){switch(n=Ae,p=n.alternate,e=n.flags,n.tag){case 0:if((e&4)!==0&&(e=n.updateQueue,e=e!==null?e.events:null,e!==null))for(a=0;a<e.length;a++)d=e[a],d.ref.impl=d.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&p!==null){e=void 0,a=n,d=p.memoizedProps,p=p.memoizedState,o=a.stateNode;try{var nt=ls(a.type,d);e=o.getSnapshotBeforeUpdate(nt,p),o.__reactInternalSnapshotBeforeUpdate=e}catch(dt){Ht(a,a.return,dt)}}break;case 3:if((e&1024)!==0){if(e=n.stateNode.containerInfo,a=e.nodeType,a===9)Mu(e);else if(a===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Mu(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(s(163))}if(e=n.sibling,e!==null){e.return=n.return,Ae=e;break}Ae=n.return}}function op(e,n,a){var o=a.flags;switch(a.tag){case 0:case 11:case 15:cn(e,a),o&4&&Qa(5,a);break;case 1:if(cn(e,a),o&4)if(e=a.stateNode,n===null)try{e.componentDidMount()}catch(v){Ht(a,a.return,v)}else{var d=ls(a.type,n.memoizedProps);n=n.memoizedState;try{e.componentDidUpdate(d,n,e.__reactInternalSnapshotBeforeUpdate)}catch(v){Ht(a,a.return,v)}}o&64&&ep(a),o&512&&Za(a,a.return);break;case 3:if(cn(e,a),o&64&&(e=a.updateQueue,e!==null)){if(n=null,a.child!==null)switch(a.child.tag){case 27:case 5:n=a.child.stateNode;break;case 1:n=a.child.stateNode}try{qd(e,n)}catch(v){Ht(a,a.return,v)}}break;case 27:n===null&&o&4&&ap(a);case 26:case 5:cn(e,a),n===null&&o&4&&np(a),o&512&&Za(a,a.return);break;case 12:cn(e,a);break;case 31:cn(e,a),o&4&&up(e,a);break;case 13:cn(e,a),o&4&&hp(e,a),o&64&&(e=a.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(a=Mb.bind(null,a),$b(e,a))));break;case 22:if(o=a.memoizedState!==null||on,!o){n=n!==null&&n.memoizedState!==null||pe,d=on;var p=pe;on=o,(pe=n)&&!p?un(e,a,(a.subtreeFlags&8772)!==0):cn(e,a),on=d,pe=p}break;case 30:break;default:cn(e,a)}}function lp(e){var n=e.alternate;n!==null&&(e.alternate=null,lp(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&Ll(n)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Wt=null,qe=!1;function ln(e,n,a){for(a=a.child;a!==null;)cp(e,n,a),a=a.sibling}function cp(e,n,a){if(Zt&&typeof Zt.onCommitFiberUnmount=="function")try{Zt.onCommitFiberUnmount(Yn,a)}catch{}switch(a.tag){case 26:pe||Ui(a,n),ln(e,n,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:pe||Ui(a,n);var o=Wt,d=qe;zn(a.type)&&(Wt=a.stateNode,qe=!1),ln(e,n,a),rr(a.stateNode),Wt=o,qe=d;break;case 5:pe||Ui(a,n);case 6:if(o=Wt,d=qe,Wt=null,ln(e,n,a),Wt=o,qe=d,Wt!==null)if(qe)try{(Wt.nodeType===9?Wt.body:Wt.nodeName==="HTML"?Wt.ownerDocument.body:Wt).removeChild(a.stateNode)}catch(p){Ht(a,n,p)}else try{Wt.removeChild(a.stateNode)}catch(p){Ht(a,n,p)}break;case 18:Wt!==null&&(qe?(e=Wt,eg(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,a.stateNode),oa(e)):eg(Wt,a.stateNode));break;case 4:o=Wt,d=qe,Wt=a.stateNode.containerInfo,qe=!0,ln(e,n,a),Wt=o,qe=d;break;case 0:case 11:case 14:case 15:Dn(2,a,n),pe||Dn(4,a,n),ln(e,n,a);break;case 1:pe||(Ui(a,n),o=a.stateNode,typeof o.componentWillUnmount=="function"&&ip(a,n,o)),ln(e,n,a);break;case 21:ln(e,n,a);break;case 22:pe=(o=pe)||a.memoizedState!==null,ln(e,n,a),pe=o;break;default:ln(e,n,a)}}function up(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{oa(e)}catch(a){Ht(n,n.return,a)}}}function hp(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{oa(e)}catch(a){Ht(n,n.return,a)}}function Ab(e){switch(e.tag){case 31:case 13:case 19:var n=e.stateNode;return n===null&&(n=e.stateNode=new rp),n;case 22:return e=e.stateNode,n=e._retryCache,n===null&&(n=e._retryCache=new rp),n;default:throw Error(s(435,e.tag))}}function Eo(e,n){var a=Ab(e);n.forEach(function(o){if(!a.has(o)){a.add(o);var d=Db.bind(null,e,o);o.then(d,d)}})}function Ve(e,n){var a=n.deletions;if(a!==null)for(var o=0;o<a.length;o++){var d=a[o],p=e,v=n,x=v;t:for(;x!==null;){switch(x.tag){case 27:if(zn(x.type)){Wt=x.stateNode,qe=!1;break t}break;case 5:Wt=x.stateNode,qe=!1;break t;case 3:case 4:Wt=x.stateNode.containerInfo,qe=!0;break t}x=x.return}if(Wt===null)throw Error(s(160));cp(p,v,d),Wt=null,qe=!1,p=d.alternate,p!==null&&(p.return=null),d.return=null}if(n.subtreeFlags&13886)for(n=n.child;n!==null;)dp(n,e),n=n.sibling}var Ri=null;function dp(e,n){var a=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Ve(n,e),Xe(e),o&4&&(Dn(3,e,e.return),Qa(3,e),Dn(5,e,e.return));break;case 1:Ve(n,e),Xe(e),o&512&&(pe||a===null||Ui(a,a.return)),o&64&&on&&(e=e.updateQueue,e!==null&&(o=e.callbacks,o!==null&&(a=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=a===null?o:a.concat(o))));break;case 26:var d=Ri;if(Ve(n,e),Xe(e),o&512&&(pe||a===null||Ui(a,a.return)),o&4){var p=a!==null?a.memoizedState:null;if(o=e.memoizedState,a===null)if(o===null)if(e.stateNode===null){t:{o=e.type,a=e.memoizedProps,d=d.ownerDocument||d;e:switch(o){case"title":p=d.getElementsByTagName("title")[0],(!p||p[_a]||p[_e]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=d.createElement(o),d.head.insertBefore(p,d.querySelector("head > title"))),Me(p,o,a),p[_e]=e,ve(p),o=p;break t;case"link":var v=dg("link","href",d).get(o+(a.href||""));if(v){for(var x=0;x<v.length;x++)if(p=v[x],p.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&p.getAttribute("rel")===(a.rel==null?null:a.rel)&&p.getAttribute("title")===(a.title==null?null:a.title)&&p.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){v.splice(x,1);break e}}p=d.createElement(o),Me(p,o,a),d.head.appendChild(p);break;case"meta":if(v=dg("meta","content",d).get(o+(a.content||""))){for(x=0;x<v.length;x++)if(p=v[x],p.getAttribute("content")===(a.content==null?null:""+a.content)&&p.getAttribute("name")===(a.name==null?null:a.name)&&p.getAttribute("property")===(a.property==null?null:a.property)&&p.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&p.getAttribute("charset")===(a.charSet==null?null:a.charSet)){v.splice(x,1);break e}}p=d.createElement(o),Me(p,o,a),d.head.appendChild(p);break;default:throw Error(s(468,o))}p[_e]=e,ve(p),o=p}e.stateNode=o}else fg(d,e.type,e.stateNode);else e.stateNode=hg(d,o,e.memoizedProps);else p!==o?(p===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):p.count--,o===null?fg(d,e.type,e.stateNode):hg(d,o,e.memoizedProps)):o===null&&e.stateNode!==null&&tu(e,e.memoizedProps,a.memoizedProps)}break;case 27:Ve(n,e),Xe(e),o&512&&(pe||a===null||Ui(a,a.return)),a!==null&&o&4&&tu(e,e.memoizedProps,a.memoizedProps);break;case 5:if(Ve(n,e),Xe(e),o&512&&(pe||a===null||Ui(a,a.return)),e.flags&32){d=e.stateNode;try{Rs(d,"")}catch(nt){Ht(e,e.return,nt)}}o&4&&e.stateNode!=null&&(d=e.memoizedProps,tu(e,d,a!==null?a.memoizedProps:d)),o&1024&&(nu=!0);break;case 6:if(Ve(n,e),Xe(e),o&4){if(e.stateNode===null)throw Error(s(162));o=e.memoizedProps,a=e.stateNode;try{a.nodeValue=o}catch(nt){Ht(e,e.return,nt)}}break;case 3:if(Ho=null,d=Ri,Ri=jo(n.containerInfo),Ve(n,e),Ri=d,Xe(e),o&4&&a!==null&&a.memoizedState.isDehydrated)try{oa(n.containerInfo)}catch(nt){Ht(e,e.return,nt)}nu&&(nu=!1,fp(e));break;case 4:o=Ri,Ri=jo(e.stateNode.containerInfo),Ve(n,e),Xe(e),Ri=o;break;case 12:Ve(n,e),Xe(e);break;case 31:Ve(n,e),Xe(e),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,Eo(e,o)));break;case 13:Ve(n,e),Xe(e),e.child.flags&8192&&e.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(Co=ke()),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,Eo(e,o)));break;case 22:d=e.memoizedState!==null;var M=a!==null&&a.memoizedState!==null,j=on,X=pe;if(on=j||d,pe=X||M,Ve(n,e),pe=X,on=j,Xe(e),o&8192)t:for(n=e.stateNode,n._visibility=d?n._visibility&-2:n._visibility|1,d&&(a===null||M||on||pe||cs(e)),a=null,n=e;;){if(n.tag===5||n.tag===26){if(a===null){M=a=n;try{if(p=M.stateNode,d)v=p.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{x=M.stateNode;var $=M.memoizedProps.style,H=$!=null&&$.hasOwnProperty("display")?$.display:null;x.style.display=H==null||typeof H=="boolean"?"":(""+H).trim()}}catch(nt){Ht(M,M.return,nt)}}}else if(n.tag===6){if(a===null){M=n;try{M.stateNode.nodeValue=d?"":M.memoizedProps}catch(nt){Ht(M,M.return,nt)}}}else if(n.tag===18){if(a===null){M=n;try{var G=M.stateNode;d?ig(G,!0):ig(M.stateNode,!1)}catch(nt){Ht(M,M.return,nt)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===e)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break t;for(;n.sibling===null;){if(n.return===null||n.return===e)break t;a===n&&(a=null),n=n.return}a===n&&(a=null),n.sibling.return=n.return,n=n.sibling}o&4&&(o=e.updateQueue,o!==null&&(a=o.retryQueue,a!==null&&(o.retryQueue=null,Eo(e,a))));break;case 19:Ve(n,e),Xe(e),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,Eo(e,o)));break;case 30:break;case 21:break;default:Ve(n,e),Xe(e)}}function Xe(e){var n=e.flags;if(n&2){try{for(var a,o=e.return;o!==null;){if(sp(o)){a=o;break}o=o.return}if(a==null)throw Error(s(160));switch(a.tag){case 27:var d=a.stateNode,p=eu(e);_o(e,p,d);break;case 5:var v=a.stateNode;a.flags&32&&(Rs(v,""),a.flags&=-33);var x=eu(e);_o(e,x,v);break;case 3:case 4:var M=a.stateNode.containerInfo,j=eu(e);iu(e,j,M);break;default:throw Error(s(161))}}catch(X){Ht(e,e.return,X)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function fp(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var n=e;fp(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),e=e.sibling}}function cn(e,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)op(e,n.alternate,n),n=n.sibling}function cs(e){for(e=e.child;e!==null;){var n=e;switch(n.tag){case 0:case 11:case 14:case 15:Dn(4,n,n.return),cs(n);break;case 1:Ui(n,n.return);var a=n.stateNode;typeof a.componentWillUnmount=="function"&&ip(n,n.return,a),cs(n);break;case 27:rr(n.stateNode);case 26:case 5:Ui(n,n.return),cs(n);break;case 22:n.memoizedState===null&&cs(n);break;case 30:cs(n);break;default:cs(n)}e=e.sibling}}function un(e,n,a){for(a=a&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var o=n.alternate,d=e,p=n,v=p.flags;switch(p.tag){case 0:case 11:case 15:un(d,p,a),Qa(4,p);break;case 1:if(un(d,p,a),o=p,d=o.stateNode,typeof d.componentDidMount=="function")try{d.componentDidMount()}catch(j){Ht(o,o.return,j)}if(o=p,d=o.updateQueue,d!==null){var x=o.stateNode;try{var M=d.shared.hiddenCallbacks;if(M!==null)for(d.shared.hiddenCallbacks=null,d=0;d<M.length;d++)Gd(M[d],x)}catch(j){Ht(o,o.return,j)}}a&&v&64&&ep(p),Za(p,p.return);break;case 27:ap(p);case 26:case 5:un(d,p,a),a&&o===null&&v&4&&np(p),Za(p,p.return);break;case 12:un(d,p,a);break;case 31:un(d,p,a),a&&v&4&&up(d,p);break;case 13:un(d,p,a),a&&v&4&&hp(d,p);break;case 22:p.memoizedState===null&&un(d,p,a),Za(p,p.return);break;case 30:break;default:un(d,p,a)}n=n.sibling}}function su(e,n){var a=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),e=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(e=n.memoizedState.cachePool.pool),e!==a&&(e!=null&&e.refCount++,a!=null&&Pa(a))}function au(e,n){e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&Pa(e))}function Ni(e,n,a,o){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)pp(e,n,a,o),n=n.sibling}function pp(e,n,a,o){var d=n.flags;switch(n.tag){case 0:case 11:case 15:Ni(e,n,a,o),d&2048&&Qa(9,n);break;case 1:Ni(e,n,a,o);break;case 3:Ni(e,n,a,o),d&2048&&(e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&Pa(e)));break;case 12:if(d&2048){Ni(e,n,a,o),e=n.stateNode;try{var p=n.memoizedProps,v=p.id,x=p.onPostCommit;typeof x=="function"&&x(v,n.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(M){Ht(n,n.return,M)}}else Ni(e,n,a,o);break;case 31:Ni(e,n,a,o);break;case 13:Ni(e,n,a,o);break;case 23:break;case 22:p=n.stateNode,v=n.alternate,n.memoizedState!==null?p._visibility&2?Ni(e,n,a,o):Wa(e,n):p._visibility&2?Ni(e,n,a,o):(p._visibility|=2,Qs(e,n,a,o,(n.subtreeFlags&10256)!==0||!1)),d&2048&&su(v,n);break;case 24:Ni(e,n,a,o),d&2048&&au(n.alternate,n);break;default:Ni(e,n,a,o)}}function Qs(e,n,a,o,d){for(d=d&&((n.subtreeFlags&10256)!==0||!1),n=n.child;n!==null;){var p=e,v=n,x=a,M=o,j=v.flags;switch(v.tag){case 0:case 11:case 15:Qs(p,v,x,M,d),Qa(8,v);break;case 23:break;case 22:var X=v.stateNode;v.memoizedState!==null?X._visibility&2?Qs(p,v,x,M,d):Wa(p,v):(X._visibility|=2,Qs(p,v,x,M,d)),d&&j&2048&&su(v.alternate,v);break;case 24:Qs(p,v,x,M,d),d&&j&2048&&au(v.alternate,v);break;default:Qs(p,v,x,M,d)}n=n.sibling}}function Wa(e,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var a=e,o=n,d=o.flags;switch(o.tag){case 22:Wa(a,o),d&2048&&su(o.alternate,o);break;case 24:Wa(a,o),d&2048&&au(o.alternate,o);break;default:Wa(a,o)}n=n.sibling}}var Ja=8192;function Zs(e,n,a){if(e.subtreeFlags&Ja)for(e=e.child;e!==null;)gp(e,n,a),e=e.sibling}function gp(e,n,a){switch(e.tag){case 26:Zs(e,n,a),e.flags&Ja&&e.memoizedState!==null&&r0(a,Ri,e.memoizedState,e.memoizedProps);break;case 5:Zs(e,n,a);break;case 3:case 4:var o=Ri;Ri=jo(e.stateNode.containerInfo),Zs(e,n,a),Ri=o;break;case 22:e.memoizedState===null&&(o=e.alternate,o!==null&&o.memoizedState!==null?(o=Ja,Ja=16777216,Zs(e,n,a),Ja=o):Zs(e,n,a));break;default:Zs(e,n,a)}}function mp(e){var n=e.alternate;if(n!==null&&(e=n.child,e!==null)){n.child=null;do n=e.sibling,e.sibling=null,e=n;while(e!==null)}}function tr(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var a=0;a<n.length;a++){var o=n[a];Ae=o,bp(o,e)}mp(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)yp(e),e=e.sibling}function yp(e){switch(e.tag){case 0:case 11:case 15:tr(e),e.flags&2048&&Dn(9,e,e.return);break;case 3:tr(e);break;case 12:tr(e);break;case 22:var n=e.stateNode;e.memoizedState!==null&&n._visibility&2&&(e.return===null||e.return.tag!==13)?(n._visibility&=-3,To(e)):tr(e);break;default:tr(e)}}function To(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var a=0;a<n.length;a++){var o=n[a];Ae=o,bp(o,e)}mp(e)}for(e=e.child;e!==null;){switch(n=e,n.tag){case 0:case 11:case 15:Dn(8,n,n.return),To(n);break;case 22:a=n.stateNode,a._visibility&2&&(a._visibility&=-3,To(n));break;default:To(n)}e=e.sibling}}function bp(e,n){for(;Ae!==null;){var a=Ae;switch(a.tag){case 0:case 11:case 15:Dn(8,a,n);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var o=a.memoizedState.cachePool.pool;o!=null&&o.refCount++}break;case 24:Pa(a.memoizedState.cache)}if(o=a.child,o!==null)o.return=a,Ae=o;else t:for(a=e;Ae!==null;){o=Ae;var d=o.sibling,p=o.return;if(lp(o),o===a){Ae=null;break t}if(d!==null){d.return=p,Ae=d;break t}Ae=p}}}var Sb={getCacheForType:function(e){var n=Te(he),a=n.data.get(e);return a===void 0&&(a=e(),n.data.set(e,a)),a},cacheSignal:function(){return Te(he).controller.signal}},wb=typeof WeakMap=="function"?WeakMap:Map,zt=0,Yt=null,Et=null,Ct=0,Ft=0,ai=null,Rn=!1,Ws=!1,ru=!1,hn=0,ae=0,Nn=0,us=0,ou=0,ri=0,Js=0,er=null,Ye=null,lu=!1,Co=0,vp=0,Mo=1/0,Do=null,On=null,be=0,Ln=null,ta=null,dn=0,cu=0,uu=null,Ap=null,ir=0,hu=null;function oi(){return(zt&2)!==0&&Ct!==0?Ct&-Ct:k.T!==null?yu():Bh()}function Sp(){if(ri===0)if((Ct&536870912)===0||Dt){var e=ze;ze<<=1,(ze&3932160)===0&&(ze=262144),ri=e}else ri=536870912;return e=ni.current,e!==null&&(e.flags|=32),ri}function $e(e,n,a){(e===Yt&&(Ft===2||Ft===9)||e.cancelPendingCommit!==null)&&(ea(e,0),kn(e,Ct,ri,!1)),xe(e,a),((zt&2)===0||e!==Yt)&&(e===Yt&&((zt&2)===0&&(us|=a),ae===4&&kn(e,Ct,ri,!1)),ji(e))}function wp(e,n,a){if((zt&6)!==0)throw Error(s(327));var o=!a&&(n&127)===0&&(n&e.expiredLanes)===0||Z(e,n),d=o?Eb(e,n):fu(e,n,!0),p=o;do{if(d===0){Ws&&!o&&kn(e,n,0,!1);break}else{if(a=e.current.alternate,p&&!xb(a)){d=fu(e,n,!1),p=!1;continue}if(d===2){if(p=n,e.errorRecoveryDisabledLanes&p)var v=0;else v=e.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){n=v;t:{var x=e;d=er;var M=x.current.memoizedState.isDehydrated;if(M&&(ea(x,v).flags|=256),v=fu(x,v,!1),v!==2){if(ru&&!M){x.errorRecoveryDisabledLanes|=p,us|=p,d=4;break t}p=Ye,Ye=d,p!==null&&(Ye===null?Ye=p:Ye.push.apply(Ye,p))}d=v}if(p=!1,d!==2)continue}}if(d===1){ea(e,0),kn(e,n,0,!0);break}t:{switch(o=e,p=d,p){case 0:case 1:throw Error(s(345));case 4:if((n&4194048)!==n)break;case 6:kn(o,n,ri,!Rn);break t;case 2:Ye=null;break;case 3:case 5:break;default:throw Error(s(329))}if((n&62914560)===n&&(d=Co+300-ke(),10<d)){if(kn(o,n,ri,!Rn),F(o,0,!0)!==0)break t;dn=n,o.timeoutHandle=Jp(xp.bind(null,o,a,Ye,Do,lu,n,ri,us,Js,Rn,p,"Throttled",-0,0),d);break t}xp(o,a,Ye,Do,lu,n,ri,us,Js,Rn,p,null,-0,0)}}break}while(!0);ji(e)}function xp(e,n,a,o,d,p,v,x,M,j,X,$,H,G){if(e.timeoutHandle=-1,$=n.subtreeFlags,$&8192||($&16785408)===16785408){$={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Qi},gp(n,p,$);var nt=(p&62914560)===p?Co-ke():(p&4194048)===p?vp-ke():0;if(nt=o0($,nt),nt!==null){dn=p,e.cancelPendingCommit=nt(Np.bind(null,e,n,p,a,o,d,v,x,M,X,$,null,H,G)),kn(e,p,v,!j);return}}Np(e,n,p,a,o,d,v,x,M)}function xb(e){for(var n=e;;){var a=n.tag;if((a===0||a===11||a===15)&&n.flags&16384&&(a=n.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var o=0;o<a.length;o++){var d=a[o],p=d.getSnapshot;d=d.value;try{if(!ei(p(),d))return!1}catch{return!1}}if(a=n.child,n.subtreeFlags&16384&&a!==null)a.return=n,n=a;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function kn(e,n,a,o){n&=~ou,n&=~us,e.suspendedLanes|=n,e.pingedLanes&=~n,o&&(e.warmLanes|=n),o=e.expirationTimes;for(var d=n;0<d;){var p=31-ue(d),v=1<<p;o[p]=-1,d&=~v}a!==0&&xs(e,a,n)}function Ro(){return(zt&6)===0?(nr(0),!1):!0}function du(){if(Et!==null){if(Ft===0)var e=Et.return;else e=Et,tn=es=null,Mc(e),Vs=null,ja=0,e=Et;for(;e!==null;)tp(e.alternate,e),e=e.return;Et=null}}function ea(e,n){var a=e.timeoutHandle;a!==-1&&(e.timeoutHandle=-1,Gb(a)),a=e.cancelPendingCommit,a!==null&&(e.cancelPendingCommit=null,a()),dn=0,du(),Yt=e,Et=a=Wi(e.current,null),Ct=n,Ft=0,ai=null,Rn=!1,Ws=Z(e,n),ru=!1,Js=ri=ou=us=Nn=ae=0,Ye=er=null,lu=!1,(n&8)!==0&&(n|=n&32);var o=e.entangledLanes;if(o!==0)for(e=e.entanglements,o&=n;0<o;){var d=31-ue(o),p=1<<d;n|=e[d],o&=~p}return hn=n,Qr(),a}function _p(e,n){St=null,k.H=Ya,n===qs||n===so?(n=jd(),Ft=3):n===mc?(n=jd(),Ft=4):Ft=n===qc?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,ai=n,Et===null&&(ae=1,vo(e,gi(n,e.current)))}function Ep(){var e=ni.current;return e===null?!0:(Ct&4194048)===Ct?vi===null:(Ct&62914560)===Ct||(Ct&536870912)!==0?e===vi:!1}function Tp(){var e=k.H;return k.H=Ya,e===null?Ya:e}function Cp(){var e=k.A;return k.A=Sb,e}function No(){ae=4,Rn||(Ct&4194048)!==Ct&&ni.current!==null||(Ws=!0),(Nn&134217727)===0&&(us&134217727)===0||Yt===null||kn(Yt,Ct,ri,!1)}function fu(e,n,a){var o=zt;zt|=2;var d=Tp(),p=Cp();(Yt!==e||Ct!==n)&&(Do=null,ea(e,n)),n=!1;var v=ae;t:do try{if(Ft!==0&&Et!==null){var x=Et,M=ai;switch(Ft){case 8:du(),v=6;break t;case 3:case 2:case 9:case 6:ni.current===null&&(n=!0);var j=Ft;if(Ft=0,ai=null,ia(e,x,M,j),a&&Ws){v=0;break t}break;default:j=Ft,Ft=0,ai=null,ia(e,x,M,j)}}_b(),v=ae;break}catch(X){_p(e,X)}while(!0);return n&&e.shellSuspendCounter++,tn=es=null,zt=o,k.H=d,k.A=p,Et===null&&(Yt=null,Ct=0,Qr()),v}function _b(){for(;Et!==null;)Mp(Et)}function Eb(e,n){var a=zt;zt|=2;var o=Tp(),d=Cp();Yt!==e||Ct!==n?(Do=null,Mo=ke()+500,ea(e,n)):Ws=Z(e,n);t:do try{if(Ft!==0&&Et!==null){n=Et;var p=ai;e:switch(Ft){case 1:Ft=0,ai=null,ia(e,n,p,1);break;case 2:case 9:if(Pd(p)){Ft=0,ai=null,Dp(n);break}n=function(){Ft!==2&&Ft!==9||Yt!==e||(Ft=7),ji(e)},p.then(n,n);break t;case 3:Ft=7;break t;case 4:Ft=5;break t;case 7:Pd(p)?(Ft=0,ai=null,Dp(n)):(Ft=0,ai=null,ia(e,n,p,7));break;case 5:var v=null;switch(Et.tag){case 26:v=Et.memoizedState;case 5:case 27:var x=Et;if(v?pg(v):x.stateNode.complete){Ft=0,ai=null;var M=x.sibling;if(M!==null)Et=M;else{var j=x.return;j!==null?(Et=j,Oo(j)):Et=null}break e}}Ft=0,ai=null,ia(e,n,p,5);break;case 6:Ft=0,ai=null,ia(e,n,p,6);break;case 8:du(),ae=6;break t;default:throw Error(s(462))}}Tb();break}catch(X){_p(e,X)}while(!0);return tn=es=null,k.H=o,k.A=d,zt=a,Et!==null?0:(Yt=null,Ct=0,Qr(),ae)}function Tb(){for(;Et!==null&&!yn();)Mp(Et)}function Mp(e){var n=Wf(e.alternate,e,hn);e.memoizedProps=e.pendingProps,n===null?Oo(e):Et=n}function Dp(e){var n=e,a=n.alternate;switch(n.tag){case 15:case 0:n=Xf(a,n,n.pendingProps,n.type,void 0,Ct);break;case 11:n=Xf(a,n,n.pendingProps,n.type.render,n.ref,Ct);break;case 5:Mc(n);default:tp(a,n),n=Et=Td(n,hn),n=Wf(a,n,hn)}e.memoizedProps=e.pendingProps,n===null?Oo(e):Et=n}function ia(e,n,a,o){tn=es=null,Mc(n),Vs=null,ja=0;var d=n.return;try{if(pb(e,d,n,a,Ct)){ae=1,vo(e,gi(a,e.current)),Et=null;return}}catch(p){if(d!==null)throw Et=d,p;ae=1,vo(e,gi(a,e.current)),Et=null;return}n.flags&32768?(Dt||o===1?e=!0:Ws||(Ct&536870912)!==0?e=!1:(Rn=e=!0,(o===2||o===9||o===3||o===6)&&(o=ni.current,o!==null&&o.tag===13&&(o.flags|=16384))),Rp(n,e)):Oo(n)}function Oo(e){var n=e;do{if((n.flags&32768)!==0){Rp(n,Rn);return}e=n.return;var a=yb(n.alternate,n,hn);if(a!==null){Et=a;return}if(n=n.sibling,n!==null){Et=n;return}Et=n=e}while(n!==null);ae===0&&(ae=5)}function Rp(e,n){do{var a=bb(e.alternate,e);if(a!==null){a.flags&=32767,Et=a;return}if(a=e.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!n&&(e=e.sibling,e!==null)){Et=e;return}Et=e=a}while(e!==null);ae=6,Et=null}function Np(e,n,a,o,d,p,v,x,M){e.cancelPendingCommit=null;do Lo();while(be!==0);if((zt&6)!==0)throw Error(s(327));if(n!==null){if(n===e.current)throw Error(s(177));if(p=n.lanes|n.childLanes,p|=ec,Mi(e,a,p,v,x,M),e===Yt&&(Et=Yt=null,Ct=0),ta=n,Ln=e,dn=a,cu=p,uu=d,Ap=o,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Rb(Ss,function(){return zp(),null})):(e.callbackNode=null,e.callbackPriority=0),o=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||o){o=k.T,k.T=null,d=V.p,V.p=2,v=zt,zt|=4;try{vb(e,n,a)}finally{zt=v,V.p=d,k.T=o}}be=1,Op(),Lp(),kp()}}function Op(){if(be===1){be=0;var e=Ln,n=ta,a=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||a){a=k.T,k.T=null;var o=V.p;V.p=2;var d=zt;zt|=4;try{dp(n,e);var p=Eu,v=yd(e.containerInfo),x=p.focusedElem,M=p.selectionRange;if(v!==x&&x&&x.ownerDocument&&md(x.ownerDocument.documentElement,x)){if(M!==null&&Ql(x)){var j=M.start,X=M.end;if(X===void 0&&(X=j),"selectionStart"in x)x.selectionStart=j,x.selectionEnd=Math.min(X,x.value.length);else{var $=x.ownerDocument||document,H=$&&$.defaultView||window;if(H.getSelection){var G=H.getSelection(),nt=x.textContent.length,dt=Math.min(M.start,nt),Vt=M.end===void 0?dt:Math.min(M.end,nt);!G.extend&&dt>Vt&&(v=Vt,Vt=dt,dt=v);var z=gd(x,dt),N=gd(x,Vt);if(z&&N&&(G.rangeCount!==1||G.anchorNode!==z.node||G.anchorOffset!==z.offset||G.focusNode!==N.node||G.focusOffset!==N.offset)){var U=$.createRange();U.setStart(z.node,z.offset),G.removeAllRanges(),dt>Vt?(G.addRange(U),G.extend(N.node,N.offset)):(U.setEnd(N.node,N.offset),G.addRange(U))}}}}for($=[],G=x;G=G.parentNode;)G.nodeType===1&&$.push({element:G,left:G.scrollLeft,top:G.scrollTop});for(typeof x.focus=="function"&&x.focus(),x=0;x<$.length;x++){var Y=$[x];Y.element.scrollLeft=Y.left,Y.element.scrollTop=Y.top}}Vo=!!_u,Eu=_u=null}finally{zt=d,V.p=o,k.T=a}}e.current=n,be=2}}function Lp(){if(be===2){be=0;var e=Ln,n=ta,a=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||a){a=k.T,k.T=null;var o=V.p;V.p=2;var d=zt;zt|=4;try{op(e,n.alternate,n)}finally{zt=d,V.p=o,k.T=a}}be=3}}function kp(){if(be===4||be===3){be=0,xl();var e=Ln,n=ta,a=dn,o=Ap;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?be=5:(be=0,ta=Ln=null,Bp(e,e.pendingLanes));var d=e.pendingLanes;if(d===0&&(On=null),Nl(a),n=n.stateNode,Zt&&typeof Zt.onCommitFiberRoot=="function")try{Zt.onCommitFiberRoot(Yn,n,void 0,(n.current.flags&128)===128)}catch{}if(o!==null){n=k.T,d=V.p,V.p=2,k.T=null;try{for(var p=e.onRecoverableError,v=0;v<o.length;v++){var x=o[v];p(x.value,{componentStack:x.stack})}}finally{k.T=n,V.p=d}}(dn&3)!==0&&Lo(),ji(e),d=e.pendingLanes,(a&261930)!==0&&(d&42)!==0?e===hu?ir++:(ir=0,hu=e):ir=0,nr(0)}}function Bp(e,n){(e.pooledCacheLanes&=n)===0&&(n=e.pooledCache,n!=null&&(e.pooledCache=null,Pa(n)))}function Lo(){return Op(),Lp(),kp(),zp()}function zp(){if(be!==5)return!1;var e=Ln,n=cu;cu=0;var a=Nl(dn),o=k.T,d=V.p;try{V.p=32>a?32:a,k.T=null,a=uu,uu=null;var p=Ln,v=dn;if(be=0,ta=Ln=null,dn=0,(zt&6)!==0)throw Error(s(331));var x=zt;if(zt|=4,yp(p.current),pp(p,p.current,v,a),zt=x,nr(0,!1),Zt&&typeof Zt.onPostCommitFiberRoot=="function")try{Zt.onPostCommitFiberRoot(Yn,p)}catch{}return!0}finally{V.p=d,k.T=o,Bp(e,n)}}function Pp(e,n,a){n=gi(a,n),n=Gc(e.stateNode,n,2),e=Tn(e,n,2),e!==null&&(xe(e,2),ji(e))}function Ht(e,n,a){if(e.tag===3)Pp(e,e,a);else for(;n!==null;){if(n.tag===3){Pp(n,e,a);break}else if(n.tag===1){var o=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(On===null||!On.has(o))){e=gi(a,e),a=Uf(2),o=Tn(n,a,2),o!==null&&(jf(a,o,n,e),xe(o,2),ji(o));break}}n=n.return}}function pu(e,n,a){var o=e.pingCache;if(o===null){o=e.pingCache=new wb;var d=new Set;o.set(n,d)}else d=o.get(n),d===void 0&&(d=new Set,o.set(n,d));d.has(a)||(ru=!0,d.add(a),e=Cb.bind(null,e,n,a),n.then(e,e))}function Cb(e,n,a){var o=e.pingCache;o!==null&&o.delete(n),e.pingedLanes|=e.suspendedLanes&a,e.warmLanes&=~a,Yt===e&&(Ct&a)===a&&(ae===4||ae===3&&(Ct&62914560)===Ct&&300>ke()-Co?(zt&2)===0&&ea(e,0):ou|=a,Js===Ct&&(Js=0)),ji(e)}function Up(e,n){n===0&&(n=Lt()),e=Wn(e,n),e!==null&&(xe(e,n),ji(e))}function Mb(e){var n=e.memoizedState,a=0;n!==null&&(a=n.retryLane),Up(e,a)}function Db(e,n){var a=0;switch(e.tag){case 31:case 13:var o=e.stateNode,d=e.memoizedState;d!==null&&(a=d.retryLane);break;case 19:o=e.stateNode;break;case 22:o=e.stateNode._retryCache;break;default:throw Error(s(314))}o!==null&&o.delete(n),Up(e,a)}function Rb(e,n){return Yi(e,n)}var ko=null,na=null,gu=!1,Bo=!1,mu=!1,Bn=0;function ji(e){e!==na&&e.next===null&&(na===null?ko=na=e:na=na.next=e),Bo=!0,gu||(gu=!0,Ob())}function nr(e,n){if(!mu&&Bo){mu=!0;do for(var a=!1,o=ko;o!==null;){if(e!==0){var d=o.pendingLanes;if(d===0)var p=0;else{var v=o.suspendedLanes,x=o.pingedLanes;p=(1<<31-ue(42|e)+1)-1,p&=d&~(v&~x),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(a=!0,Ip(o,p))}else p=Ct,p=F(o,o===Yt?p:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),(p&3)===0||Z(o,p)||(a=!0,Ip(o,p));o=o.next}while(a);mu=!1}}function Nb(){jp()}function jp(){Bo=gu=!1;var e=0;Bn!==0&&Ib()&&(e=Bn);for(var n=ke(),a=null,o=ko;o!==null;){var d=o.next,p=Fp(o,n);p===0?(o.next=null,a===null?ko=d:a.next=d,d===null&&(na=a)):(a=o,(e!==0||(p&3)!==0)&&(Bo=!0)),o=d}be!==0&&be!==5||nr(e),Bn!==0&&(Bn=0)}function Fp(e,n){for(var a=e.suspendedLanes,o=e.pingedLanes,d=e.expirationTimes,p=e.pendingLanes&-62914561;0<p;){var v=31-ue(p),x=1<<v,M=d[v];M===-1?((x&a)===0||(x&o)!==0)&&(d[v]=Ot(x,n)):M<=n&&(e.expiredLanes|=x),p&=~x}if(n=Yt,a=Ct,a=F(e,e===n?a:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o=e.callbackNode,a===0||e===n&&(Ft===2||Ft===9)||e.cancelPendingCommit!==null)return o!==null&&o!==null&&$i(o),e.callbackNode=null,e.callbackPriority=0;if((a&3)===0||Z(e,a)){if(n=a&-a,n===e.callbackPriority)return n;switch(o!==null&&$i(o),Nl(a)){case 2:case 8:a=zr;break;case 32:a=Ss;break;case 268435456:a=Pr;break;default:a=Ss}return o=Hp.bind(null,e),a=Yi(a,o),e.callbackPriority=n,e.callbackNode=a,n}return o!==null&&o!==null&&$i(o),e.callbackPriority=2,e.callbackNode=null,2}function Hp(e,n){if(be!==0&&be!==5)return e.callbackNode=null,e.callbackPriority=0,null;var a=e.callbackNode;if(Lo()&&e.callbackNode!==a)return null;var o=Ct;return o=F(e,e===Yt?o:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o===0?null:(wp(e,o,n),Fp(e,ke()),e.callbackNode!=null&&e.callbackNode===a?Hp.bind(null,e):null)}function Ip(e,n){if(Lo())return null;wp(e,n,!0)}function Ob(){qb(function(){(zt&6)!==0?Yi(xa,Nb):jp()})}function yu(){if(Bn===0){var e=Is;e===0&&(e=ws,ws<<=1,(ws&261888)===0&&(ws=256)),Bn=e}return Bn}function Gp(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Ir(""+e)}function qp(e,n){var a=n.ownerDocument.createElement("input");return a.name=n.name,a.value=n.value,e.id&&a.setAttribute("form",e.id),n.parentNode.insertBefore(a,n),e=new FormData(e),a.parentNode.removeChild(a),e}function Lb(e,n,a,o,d){if(n==="submit"&&a&&a.stateNode===d){var p=Gp((d[Ie]||null).action),v=o.submitter;v&&(n=(n=v[Ie]||null)?Gp(n.formAction):v.getAttribute("formAction"),n!==null&&(p=n,v=null));var x=new Xr("action","action",null,o,d);e.push({event:x,listeners:[{instance:null,listener:function(){if(o.defaultPrevented){if(Bn!==0){var M=v?qp(d,v):new FormData(d);Pc(a,{pending:!0,data:M,method:d.method,action:p},null,M)}}else typeof p=="function"&&(x.preventDefault(),M=v?qp(d,v):new FormData(d),Pc(a,{pending:!0,data:M,method:d.method,action:p},p,M))},currentTarget:d}]})}}for(var bu=0;bu<tc.length;bu++){var vu=tc[bu],kb=vu.toLowerCase(),Bb=vu[0].toUpperCase()+vu.slice(1);Di(kb,"on"+Bb)}Di(Ad,"onAnimationEnd"),Di(Sd,"onAnimationIteration"),Di(wd,"onAnimationStart"),Di("dblclick","onDoubleClick"),Di("focusin","onFocus"),Di("focusout","onBlur"),Di(Zy,"onTransitionRun"),Di(Wy,"onTransitionStart"),Di(Jy,"onTransitionCancel"),Di(xd,"onTransitionEnd"),Ms("onMouseEnter",["mouseout","mouseover"]),Ms("onMouseLeave",["mouseout","mouseover"]),Ms("onPointerEnter",["pointerout","pointerover"]),Ms("onPointerLeave",["pointerout","pointerover"]),$n("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),$n("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),$n("onBeforeInput",["compositionend","keypress","textInput","paste"]),$n("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),$n("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),$n("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var sr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zb=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(sr));function Vp(e,n){n=(n&4)!==0;for(var a=0;a<e.length;a++){var o=e[a],d=o.event;o=o.listeners;t:{var p=void 0;if(n)for(var v=o.length-1;0<=v;v--){var x=o[v],M=x.instance,j=x.currentTarget;if(x=x.listener,M!==p&&d.isPropagationStopped())break t;p=x,d.currentTarget=j;try{p(d)}catch(X){Kr(X)}d.currentTarget=null,p=M}else for(v=0;v<o.length;v++){if(x=o[v],M=x.instance,j=x.currentTarget,x=x.listener,M!==p&&d.isPropagationStopped())break t;p=x,d.currentTarget=j;try{p(d)}catch(X){Kr(X)}d.currentTarget=null,p=M}}}}function Tt(e,n){var a=n[Ol];a===void 0&&(a=n[Ol]=new Set);var o=e+"__bubble";a.has(o)||(Xp(n,e,2,!1),a.add(o))}function Au(e,n,a){var o=0;n&&(o|=4),Xp(a,e,o,n)}var zo="_reactListening"+Math.random().toString(36).slice(2);function Su(e){if(!e[zo]){e[zo]=!0,Uh.forEach(function(a){a!=="selectionchange"&&(zb.has(a)||Au(a,!1,e),Au(a,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[zo]||(n[zo]=!0,Au("selectionchange",!1,n))}}function Xp(e,n,a,o){switch(Sg(n)){case 2:var d=u0;break;case 8:d=h0;break;default:d=zu}a=d.bind(null,n,a,e),d=void 0,!Hl||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(d=!0),o?d!==void 0?e.addEventListener(n,a,{capture:!0,passive:d}):e.addEventListener(n,a,!0):d!==void 0?e.addEventListener(n,a,{passive:d}):e.addEventListener(n,a,!1)}function wu(e,n,a,o,d){var p=o;if((n&1)===0&&(n&2)===0&&o!==null)t:for(;;){if(o===null)return;var v=o.tag;if(v===3||v===4){var x=o.stateNode.containerInfo;if(x===d)break;if(v===4)for(v=o.return;v!==null;){var M=v.tag;if((M===3||M===4)&&v.stateNode.containerInfo===d)return;v=v.return}for(;x!==null;){if(v=Es(x),v===null)return;if(M=v.tag,M===5||M===6||M===26||M===27){o=p=v;continue t}x=x.parentNode}}o=o.return}Qh(function(){var j=p,X=jl(a),$=[];t:{var H=_d.get(e);if(H!==void 0){var G=Xr,nt=e;switch(e){case"keypress":if(qr(a)===0)break t;case"keydown":case"keyup":G=Dy;break;case"focusin":nt="focus",G=Vl;break;case"focusout":nt="blur",G=Vl;break;case"beforeblur":case"afterblur":G=Vl;break;case"click":if(a.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":G=Jh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":G=yy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":G=Oy;break;case Ad:case Sd:case wd:G=Ay;break;case xd:G=ky;break;case"scroll":case"scrollend":G=gy;break;case"wheel":G=zy;break;case"copy":case"cut":case"paste":G=wy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":G=ed;break;case"toggle":case"beforetoggle":G=Uy}var dt=(n&4)!==0,Vt=!dt&&(e==="scroll"||e==="scrollend"),z=dt?H!==null?H+"Capture":null:H;dt=[];for(var N=j,U;N!==null;){var Y=N;if(U=Y.stateNode,Y=Y.tag,Y!==5&&Y!==26&&Y!==27||U===null||z===null||(Y=Ta(N,z),Y!=null&&dt.push(ar(N,Y,U))),Vt)break;N=N.return}0<dt.length&&(H=new G(H,nt,null,a,X),$.push({event:H,listeners:dt}))}}if((n&7)===0){t:{if(H=e==="mouseover"||e==="pointerover",G=e==="mouseout"||e==="pointerout",H&&a!==Ul&&(nt=a.relatedTarget||a.fromElement)&&(Es(nt)||nt[_s]))break t;if((G||H)&&(H=X.window===X?X:(H=X.ownerDocument)?H.defaultView||H.parentWindow:window,G?(nt=a.relatedTarget||a.toElement,G=j,nt=nt?Es(nt):null,nt!==null&&(Vt=l(nt),dt=nt.tag,nt!==Vt||dt!==5&&dt!==27&&dt!==6)&&(nt=null)):(G=null,nt=j),G!==nt)){if(dt=Jh,Y="onMouseLeave",z="onMouseEnter",N="mouse",(e==="pointerout"||e==="pointerover")&&(dt=ed,Y="onPointerLeave",z="onPointerEnter",N="pointer"),Vt=G==null?H:Ea(G),U=nt==null?H:Ea(nt),H=new dt(Y,N+"leave",G,a,X),H.target=Vt,H.relatedTarget=U,Y=null,Es(X)===j&&(dt=new dt(z,N+"enter",nt,a,X),dt.target=U,dt.relatedTarget=Vt,Y=dt),Vt=Y,G&&nt)e:{for(dt=Pb,z=G,N=nt,U=0,Y=z;Y;Y=dt(Y))U++;Y=0;for(var ot=N;ot;ot=dt(ot))Y++;for(;0<U-Y;)z=dt(z),U--;for(;0<Y-U;)N=dt(N),Y--;for(;U--;){if(z===N||N!==null&&z===N.alternate){dt=z;break e}z=dt(z),N=dt(N)}dt=null}else dt=null;G!==null&&Yp($,H,G,dt,!1),nt!==null&&Vt!==null&&Yp($,Vt,nt,dt,!0)}}t:{if(H=j?Ea(j):window,G=H.nodeName&&H.nodeName.toLowerCase(),G==="select"||G==="input"&&H.type==="file")var kt=cd;else if(od(H))if(ud)kt=$y;else{kt=Xy;var rt=Vy}else G=H.nodeName,!G||G.toLowerCase()!=="input"||H.type!=="checkbox"&&H.type!=="radio"?j&&Pl(j.elementType)&&(kt=cd):kt=Yy;if(kt&&(kt=kt(e,j))){ld($,kt,a,X);break t}rt&&rt(e,H,j),e==="focusout"&&j&&H.type==="number"&&j.memoizedProps.value!=null&&zl(H,"number",H.value)}switch(rt=j?Ea(j):window,e){case"focusin":(od(rt)||rt.contentEditable==="true")&&(ks=rt,Zl=j,ka=null);break;case"focusout":ka=Zl=ks=null;break;case"mousedown":Wl=!0;break;case"contextmenu":case"mouseup":case"dragend":Wl=!1,bd($,a,X);break;case"selectionchange":if(Qy)break;case"keydown":case"keyup":bd($,a,X)}var _t;if(Yl)t:{switch(e){case"compositionstart":var Mt="onCompositionStart";break t;case"compositionend":Mt="onCompositionEnd";break t;case"compositionupdate":Mt="onCompositionUpdate";break t}Mt=void 0}else Ls?ad(e,a)&&(Mt="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(Mt="onCompositionStart");Mt&&(id&&a.locale!=="ko"&&(Ls||Mt!=="onCompositionStart"?Mt==="onCompositionEnd"&&Ls&&(_t=Zh()):(vn=X,Il="value"in vn?vn.value:vn.textContent,Ls=!0)),rt=Po(j,Mt),0<rt.length&&(Mt=new td(Mt,e,null,a,X),$.push({event:Mt,listeners:rt}),_t?Mt.data=_t:(_t=rd(a),_t!==null&&(Mt.data=_t)))),(_t=Fy?Hy(e,a):Iy(e,a))&&(Mt=Po(j,"onBeforeInput"),0<Mt.length&&(rt=new td("onBeforeInput","beforeinput",null,a,X),$.push({event:rt,listeners:Mt}),rt.data=_t)),Lb($,e,j,a,X)}Vp($,n)})}function ar(e,n,a){return{instance:e,listener:n,currentTarget:a}}function Po(e,n){for(var a=n+"Capture",o=[];e!==null;){var d=e,p=d.stateNode;if(d=d.tag,d!==5&&d!==26&&d!==27||p===null||(d=Ta(e,a),d!=null&&o.unshift(ar(e,d,p)),d=Ta(e,n),d!=null&&o.push(ar(e,d,p))),e.tag===3)return o;e=e.return}return[]}function Pb(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Yp(e,n,a,o,d){for(var p=n._reactName,v=[];a!==null&&a!==o;){var x=a,M=x.alternate,j=x.stateNode;if(x=x.tag,M!==null&&M===o)break;x!==5&&x!==26&&x!==27||j===null||(M=j,d?(j=Ta(a,p),j!=null&&v.unshift(ar(a,j,M))):d||(j=Ta(a,p),j!=null&&v.push(ar(a,j,M)))),a=a.return}v.length!==0&&e.push({event:n,listeners:v})}var Ub=/\r\n?/g,jb=/\u0000|\uFFFD/g;function $p(e){return(typeof e=="string"?e:""+e).replace(Ub,`
`).replace(jb,"")}function Kp(e,n){return n=$p(n),$p(e)===n}function qt(e,n,a,o,d,p){switch(a){case"children":typeof o=="string"?n==="body"||n==="textarea"&&o===""||Rs(e,o):(typeof o=="number"||typeof o=="bigint")&&n!=="body"&&Rs(e,""+o);break;case"className":Fr(e,"class",o);break;case"tabIndex":Fr(e,"tabindex",o);break;case"dir":case"role":case"viewBox":case"width":case"height":Fr(e,a,o);break;case"style":$h(e,o,p);break;case"data":if(n!=="object"){Fr(e,"data",o);break}case"src":case"href":if(o===""&&(n!=="a"||a!=="href")){e.removeAttribute(a);break}if(o==null||typeof o=="function"||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(a);break}o=Ir(""+o),e.setAttribute(a,o);break;case"action":case"formAction":if(typeof o=="function"){e.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(a==="formAction"?(n!=="input"&&qt(e,n,"name",d.name,d,null),qt(e,n,"formEncType",d.formEncType,d,null),qt(e,n,"formMethod",d.formMethod,d,null),qt(e,n,"formTarget",d.formTarget,d,null)):(qt(e,n,"encType",d.encType,d,null),qt(e,n,"method",d.method,d,null),qt(e,n,"target",d.target,d,null)));if(o==null||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(a);break}o=Ir(""+o),e.setAttribute(a,o);break;case"onClick":o!=null&&(e.onclick=Qi);break;case"onScroll":o!=null&&Tt("scroll",e);break;case"onScrollEnd":o!=null&&Tt("scrollend",e);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(s(61));if(a=o.__html,a!=null){if(d.children!=null)throw Error(s(60));e.innerHTML=a}}break;case"multiple":e.multiple=o&&typeof o!="function"&&typeof o!="symbol";break;case"muted":e.muted=o&&typeof o!="function"&&typeof o!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(o==null||typeof o=="function"||typeof o=="boolean"||typeof o=="symbol"){e.removeAttribute("xlink:href");break}a=Ir(""+o),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(a,""+o):e.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":o&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(a,""):e.removeAttribute(a);break;case"capture":case"download":o===!0?e.setAttribute(a,""):o!==!1&&o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(a,o):e.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":o!=null&&typeof o!="function"&&typeof o!="symbol"&&!isNaN(o)&&1<=o?e.setAttribute(a,o):e.removeAttribute(a);break;case"rowSpan":case"start":o==null||typeof o=="function"||typeof o=="symbol"||isNaN(o)?e.removeAttribute(a):e.setAttribute(a,o);break;case"popover":Tt("beforetoggle",e),Tt("toggle",e),jr(e,"popover",o);break;case"xlinkActuate":Ki(e,"http://www.w3.org/1999/xlink","xlink:actuate",o);break;case"xlinkArcrole":Ki(e,"http://www.w3.org/1999/xlink","xlink:arcrole",o);break;case"xlinkRole":Ki(e,"http://www.w3.org/1999/xlink","xlink:role",o);break;case"xlinkShow":Ki(e,"http://www.w3.org/1999/xlink","xlink:show",o);break;case"xlinkTitle":Ki(e,"http://www.w3.org/1999/xlink","xlink:title",o);break;case"xlinkType":Ki(e,"http://www.w3.org/1999/xlink","xlink:type",o);break;case"xmlBase":Ki(e,"http://www.w3.org/XML/1998/namespace","xml:base",o);break;case"xmlLang":Ki(e,"http://www.w3.org/XML/1998/namespace","xml:lang",o);break;case"xmlSpace":Ki(e,"http://www.w3.org/XML/1998/namespace","xml:space",o);break;case"is":jr(e,"is",o);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=fy.get(a)||a,jr(e,a,o))}}function xu(e,n,a,o,d,p){switch(a){case"style":$h(e,o,p);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(s(61));if(a=o.__html,a!=null){if(d.children!=null)throw Error(s(60));e.innerHTML=a}}break;case"children":typeof o=="string"?Rs(e,o):(typeof o=="number"||typeof o=="bigint")&&Rs(e,""+o);break;case"onScroll":o!=null&&Tt("scroll",e);break;case"onScrollEnd":o!=null&&Tt("scrollend",e);break;case"onClick":o!=null&&(e.onclick=Qi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!jh.hasOwnProperty(a))t:{if(a[0]==="o"&&a[1]==="n"&&(d=a.endsWith("Capture"),n=a.slice(2,d?a.length-7:void 0),p=e[Ie]||null,p=p!=null?p[a]:null,typeof p=="function"&&e.removeEventListener(n,p,d),typeof o=="function")){typeof p!="function"&&p!==null&&(a in e?e[a]=null:e.hasAttribute(a)&&e.removeAttribute(a)),e.addEventListener(n,o,d);break t}a in e?e[a]=o:o===!0?e.setAttribute(a,""):jr(e,a,o)}}}function Me(e,n,a){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Tt("error",e),Tt("load",e);var o=!1,d=!1,p;for(p in a)if(a.hasOwnProperty(p)){var v=a[p];if(v!=null)switch(p){case"src":o=!0;break;case"srcSet":d=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:qt(e,n,p,v,a,null)}}d&&qt(e,n,"srcSet",a.srcSet,a,null),o&&qt(e,n,"src",a.src,a,null);return;case"input":Tt("invalid",e);var x=p=v=d=null,M=null,j=null;for(o in a)if(a.hasOwnProperty(o)){var X=a[o];if(X!=null)switch(o){case"name":d=X;break;case"type":v=X;break;case"checked":M=X;break;case"defaultChecked":j=X;break;case"value":p=X;break;case"defaultValue":x=X;break;case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(s(137,n));break;default:qt(e,n,o,X,a,null)}}qh(e,p,x,M,j,v,d,!1);return;case"select":Tt("invalid",e),o=v=p=null;for(d in a)if(a.hasOwnProperty(d)&&(x=a[d],x!=null))switch(d){case"value":p=x;break;case"defaultValue":v=x;break;case"multiple":o=x;default:qt(e,n,d,x,a,null)}n=p,a=v,e.multiple=!!o,n!=null?Ds(e,!!o,n,!1):a!=null&&Ds(e,!!o,a,!0);return;case"textarea":Tt("invalid",e),p=d=o=null;for(v in a)if(a.hasOwnProperty(v)&&(x=a[v],x!=null))switch(v){case"value":o=x;break;case"defaultValue":d=x;break;case"children":p=x;break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(s(91));break;default:qt(e,n,v,x,a,null)}Xh(e,o,d,p);return;case"option":for(M in a)if(a.hasOwnProperty(M)&&(o=a[M],o!=null))switch(M){case"selected":e.selected=o&&typeof o!="function"&&typeof o!="symbol";break;default:qt(e,n,M,o,a,null)}return;case"dialog":Tt("beforetoggle",e),Tt("toggle",e),Tt("cancel",e),Tt("close",e);break;case"iframe":case"object":Tt("load",e);break;case"video":case"audio":for(o=0;o<sr.length;o++)Tt(sr[o],e);break;case"image":Tt("error",e),Tt("load",e);break;case"details":Tt("toggle",e);break;case"embed":case"source":case"link":Tt("error",e),Tt("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(j in a)if(a.hasOwnProperty(j)&&(o=a[j],o!=null))switch(j){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:qt(e,n,j,o,a,null)}return;default:if(Pl(n)){for(X in a)a.hasOwnProperty(X)&&(o=a[X],o!==void 0&&xu(e,n,X,o,a,void 0));return}}for(x in a)a.hasOwnProperty(x)&&(o=a[x],o!=null&&qt(e,n,x,o,a,null))}function Fb(e,n,a,o){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var d=null,p=null,v=null,x=null,M=null,j=null,X=null;for(G in a){var $=a[G];if(a.hasOwnProperty(G)&&$!=null)switch(G){case"checked":break;case"value":break;case"defaultValue":M=$;default:o.hasOwnProperty(G)||qt(e,n,G,null,o,$)}}for(var H in o){var G=o[H];if($=a[H],o.hasOwnProperty(H)&&(G!=null||$!=null))switch(H){case"type":p=G;break;case"name":d=G;break;case"checked":j=G;break;case"defaultChecked":X=G;break;case"value":v=G;break;case"defaultValue":x=G;break;case"children":case"dangerouslySetInnerHTML":if(G!=null)throw Error(s(137,n));break;default:G!==$&&qt(e,n,H,G,o,$)}}Bl(e,v,x,M,j,X,p,d);return;case"select":G=v=x=H=null;for(p in a)if(M=a[p],a.hasOwnProperty(p)&&M!=null)switch(p){case"value":break;case"multiple":G=M;default:o.hasOwnProperty(p)||qt(e,n,p,null,o,M)}for(d in o)if(p=o[d],M=a[d],o.hasOwnProperty(d)&&(p!=null||M!=null))switch(d){case"value":H=p;break;case"defaultValue":x=p;break;case"multiple":v=p;default:p!==M&&qt(e,n,d,p,o,M)}n=x,a=v,o=G,H!=null?Ds(e,!!a,H,!1):!!o!=!!a&&(n!=null?Ds(e,!!a,n,!0):Ds(e,!!a,a?[]:"",!1));return;case"textarea":G=H=null;for(x in a)if(d=a[x],a.hasOwnProperty(x)&&d!=null&&!o.hasOwnProperty(x))switch(x){case"value":break;case"children":break;default:qt(e,n,x,null,o,d)}for(v in o)if(d=o[v],p=a[v],o.hasOwnProperty(v)&&(d!=null||p!=null))switch(v){case"value":H=d;break;case"defaultValue":G=d;break;case"children":break;case"dangerouslySetInnerHTML":if(d!=null)throw Error(s(91));break;default:d!==p&&qt(e,n,v,d,o,p)}Vh(e,H,G);return;case"option":for(var nt in a)if(H=a[nt],a.hasOwnProperty(nt)&&H!=null&&!o.hasOwnProperty(nt))switch(nt){case"selected":e.selected=!1;break;default:qt(e,n,nt,null,o,H)}for(M in o)if(H=o[M],G=a[M],o.hasOwnProperty(M)&&H!==G&&(H!=null||G!=null))switch(M){case"selected":e.selected=H&&typeof H!="function"&&typeof H!="symbol";break;default:qt(e,n,M,H,o,G)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var dt in a)H=a[dt],a.hasOwnProperty(dt)&&H!=null&&!o.hasOwnProperty(dt)&&qt(e,n,dt,null,o,H);for(j in o)if(H=o[j],G=a[j],o.hasOwnProperty(j)&&H!==G&&(H!=null||G!=null))switch(j){case"children":case"dangerouslySetInnerHTML":if(H!=null)throw Error(s(137,n));break;default:qt(e,n,j,H,o,G)}return;default:if(Pl(n)){for(var Vt in a)H=a[Vt],a.hasOwnProperty(Vt)&&H!==void 0&&!o.hasOwnProperty(Vt)&&xu(e,n,Vt,void 0,o,H);for(X in o)H=o[X],G=a[X],!o.hasOwnProperty(X)||H===G||H===void 0&&G===void 0||xu(e,n,X,H,o,G);return}}for(var z in a)H=a[z],a.hasOwnProperty(z)&&H!=null&&!o.hasOwnProperty(z)&&qt(e,n,z,null,o,H);for($ in o)H=o[$],G=a[$],!o.hasOwnProperty($)||H===G||H==null&&G==null||qt(e,n,$,H,o,G)}function Qp(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Hb(){if(typeof performance.getEntriesByType=="function"){for(var e=0,n=0,a=performance.getEntriesByType("resource"),o=0;o<a.length;o++){var d=a[o],p=d.transferSize,v=d.initiatorType,x=d.duration;if(p&&x&&Qp(v)){for(v=0,x=d.responseEnd,o+=1;o<a.length;o++){var M=a[o],j=M.startTime;if(j>x)break;var X=M.transferSize,$=M.initiatorType;X&&Qp($)&&(M=M.responseEnd,v+=X*(M<x?1:(x-j)/(M-j)))}if(--o,n+=8*(p+v)/(d.duration/1e3),e++,10<e)break}}if(0<e)return n/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var _u=null,Eu=null;function Uo(e){return e.nodeType===9?e:e.ownerDocument}function Zp(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Wp(e,n){if(e===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&n==="foreignObject"?0:e}function Tu(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Cu=null;function Ib(){var e=window.event;return e&&e.type==="popstate"?e===Cu?!1:(Cu=e,!0):(Cu=null,!1)}var Jp=typeof setTimeout=="function"?setTimeout:void 0,Gb=typeof clearTimeout=="function"?clearTimeout:void 0,tg=typeof Promise=="function"?Promise:void 0,qb=typeof queueMicrotask=="function"?queueMicrotask:typeof tg<"u"?function(e){return tg.resolve(null).then(e).catch(Vb)}:Jp;function Vb(e){setTimeout(function(){throw e})}function zn(e){return e==="head"}function eg(e,n){var a=n,o=0;do{var d=a.nextSibling;if(e.removeChild(a),d&&d.nodeType===8)if(a=d.data,a==="/$"||a==="/&"){if(o===0){e.removeChild(d),oa(n);return}o--}else if(a==="$"||a==="$?"||a==="$~"||a==="$!"||a==="&")o++;else if(a==="html")rr(e.ownerDocument.documentElement);else if(a==="head"){a=e.ownerDocument.head,rr(a);for(var p=a.firstChild;p;){var v=p.nextSibling,x=p.nodeName;p[_a]||x==="SCRIPT"||x==="STYLE"||x==="LINK"&&p.rel.toLowerCase()==="stylesheet"||a.removeChild(p),p=v}}else a==="body"&&rr(e.ownerDocument.body);a=d}while(a);oa(n)}function ig(e,n){var a=e;e=0;do{var o=a.nextSibling;if(a.nodeType===1?n?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",a.getAttribute("style")===""&&a.removeAttribute("style")):a.nodeType===3&&(n?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),o&&o.nodeType===8)if(a=o.data,a==="/$"){if(e===0)break;e--}else a!=="$"&&a!=="$?"&&a!=="$~"&&a!=="$!"||e++;a=o}while(a)}function Mu(e){var n=e.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var a=n;switch(n=n.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":Mu(a),Ll(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}e.removeChild(a)}}function Xb(e,n,a,o){for(;e.nodeType===1;){var d=a;if(e.nodeName.toLowerCase()!==n.toLowerCase()){if(!o&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(o){if(!e[_a])switch(n){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(p=e.getAttribute("rel"),p==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(p!==d.rel||e.getAttribute("href")!==(d.href==null||d.href===""?null:d.href)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin)||e.getAttribute("title")!==(d.title==null?null:d.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(p=e.getAttribute("src"),(p!==(d.src==null?null:d.src)||e.getAttribute("type")!==(d.type==null?null:d.type)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin))&&p&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(n==="input"&&e.type==="hidden"){var p=d.name==null?null:""+d.name;if(d.type==="hidden"&&e.getAttribute("name")===p)return e}else return e;if(e=Ai(e.nextSibling),e===null)break}return null}function Yb(e,n,a){if(n==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!a||(e=Ai(e.nextSibling),e===null))return null;return e}function ng(e,n){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=Ai(e.nextSibling),e===null))return null;return e}function Du(e){return e.data==="$?"||e.data==="$~"}function Ru(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function $b(e,n){var a=e.ownerDocument;if(e.data==="$~")e._reactRetry=n;else if(e.data!=="$?"||a.readyState!=="loading")n();else{var o=function(){n(),a.removeEventListener("DOMContentLoaded",o)};a.addEventListener("DOMContentLoaded",o),e._reactRetry=o}}function Ai(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"||n==="F!"||n==="F")break;if(n==="/$"||n==="/&")return null}}return e}var Nu=null;function sg(e){e=e.nextSibling;for(var n=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"||a==="/&"){if(n===0)return Ai(e.nextSibling);n--}else a!=="$"&&a!=="$!"&&a!=="$?"&&a!=="$~"&&a!=="&"||n++}e=e.nextSibling}return null}function ag(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"){if(n===0)return e;n--}else a!=="/$"&&a!=="/&"||n++}e=e.previousSibling}return null}function rg(e,n,a){switch(n=Uo(a),e){case"html":if(e=n.documentElement,!e)throw Error(s(452));return e;case"head":if(e=n.head,!e)throw Error(s(453));return e;case"body":if(e=n.body,!e)throw Error(s(454));return e;default:throw Error(s(451))}}function rr(e){for(var n=e.attributes;n.length;)e.removeAttributeNode(n[0]);Ll(e)}var Si=new Map,og=new Set;function jo(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var fn=V.d;V.d={f:Kb,r:Qb,D:Zb,C:Wb,L:Jb,m:t0,X:i0,S:e0,M:n0};function Kb(){var e=fn.f(),n=Ro();return e||n}function Qb(e){var n=Ts(e);n!==null&&n.tag===5&&n.type==="form"?_f(n):fn.r(e)}var sa=typeof document>"u"?null:document;function lg(e,n,a){var o=sa;if(o&&typeof n=="string"&&n){var d=fi(n);d='link[rel="'+e+'"][href="'+d+'"]',typeof a=="string"&&(d+='[crossorigin="'+a+'"]'),og.has(d)||(og.add(d),e={rel:e,crossOrigin:a,href:n},o.querySelector(d)===null&&(n=o.createElement("link"),Me(n,"link",e),ve(n),o.head.appendChild(n)))}}function Zb(e){fn.D(e),lg("dns-prefetch",e,null)}function Wb(e,n){fn.C(e,n),lg("preconnect",e,n)}function Jb(e,n,a){fn.L(e,n,a);var o=sa;if(o&&e&&n){var d='link[rel="preload"][as="'+fi(n)+'"]';n==="image"&&a&&a.imageSrcSet?(d+='[imagesrcset="'+fi(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(d+='[imagesizes="'+fi(a.imageSizes)+'"]')):d+='[href="'+fi(e)+'"]';var p=d;switch(n){case"style":p=aa(e);break;case"script":p=ra(e)}Si.has(p)||(e=y({rel:"preload",href:n==="image"&&a&&a.imageSrcSet?void 0:e,as:n},a),Si.set(p,e),o.querySelector(d)!==null||n==="style"&&o.querySelector(or(p))||n==="script"&&o.querySelector(lr(p))||(n=o.createElement("link"),Me(n,"link",e),ve(n),o.head.appendChild(n)))}}function t0(e,n){fn.m(e,n);var a=sa;if(a&&e){var o=n&&typeof n.as=="string"?n.as:"script",d='link[rel="modulepreload"][as="'+fi(o)+'"][href="'+fi(e)+'"]',p=d;switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=ra(e)}if(!Si.has(p)&&(e=y({rel:"modulepreload",href:e},n),Si.set(p,e),a.querySelector(d)===null)){switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(lr(p)))return}o=a.createElement("link"),Me(o,"link",e),ve(o),a.head.appendChild(o)}}}function e0(e,n,a){fn.S(e,n,a);var o=sa;if(o&&e){var d=Cs(o).hoistableStyles,p=aa(e);n=n||"default";var v=d.get(p);if(!v){var x={loading:0,preload:null};if(v=o.querySelector(or(p)))x.loading=5;else{e=y({rel:"stylesheet",href:e,"data-precedence":n},a),(a=Si.get(p))&&Ou(e,a);var M=v=o.createElement("link");ve(M),Me(M,"link",e),M._p=new Promise(function(j,X){M.onload=j,M.onerror=X}),M.addEventListener("load",function(){x.loading|=1}),M.addEventListener("error",function(){x.loading|=2}),x.loading|=4,Fo(v,n,o)}v={type:"stylesheet",instance:v,count:1,state:x},d.set(p,v)}}}function i0(e,n){fn.X(e,n);var a=sa;if(a&&e){var o=Cs(a).hoistableScripts,d=ra(e),p=o.get(d);p||(p=a.querySelector(lr(d)),p||(e=y({src:e,async:!0},n),(n=Si.get(d))&&Lu(e,n),p=a.createElement("script"),ve(p),Me(p,"link",e),a.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},o.set(d,p))}}function n0(e,n){fn.M(e,n);var a=sa;if(a&&e){var o=Cs(a).hoistableScripts,d=ra(e),p=o.get(d);p||(p=a.querySelector(lr(d)),p||(e=y({src:e,async:!0,type:"module"},n),(n=Si.get(d))&&Lu(e,n),p=a.createElement("script"),ve(p),Me(p,"link",e),a.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},o.set(d,p))}}function cg(e,n,a,o){var d=(d=ft.current)?jo(d):null;if(!d)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(n=aa(a.href),a=Cs(d).hoistableStyles,o=a.get(n),o||(o={type:"style",instance:null,count:0,state:null},a.set(n,o)),o):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){e=aa(a.href);var p=Cs(d).hoistableStyles,v=p.get(e);if(v||(d=d.ownerDocument||d,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(e,v),(p=d.querySelector(or(e)))&&!p._p&&(v.instance=p,v.state.loading=5),Si.has(e)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},Si.set(e,a),p||s0(d,e,a,v.state))),n&&o===null)throw Error(s(528,""));return v}if(n&&o!==null)throw Error(s(529,""));return null;case"script":return n=a.async,a=a.src,typeof a=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=ra(a),a=Cs(d).hoistableScripts,o=a.get(n),o||(o={type:"script",instance:null,count:0,state:null},a.set(n,o)),o):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function aa(e){return'href="'+fi(e)+'"'}function or(e){return'link[rel="stylesheet"]['+e+"]"}function ug(e){return y({},e,{"data-precedence":e.precedence,precedence:null})}function s0(e,n,a,o){e.querySelector('link[rel="preload"][as="style"]['+n+"]")?o.loading=1:(n=e.createElement("link"),o.preload=n,n.addEventListener("load",function(){return o.loading|=1}),n.addEventListener("error",function(){return o.loading|=2}),Me(n,"link",a),ve(n),e.head.appendChild(n))}function ra(e){return'[src="'+fi(e)+'"]'}function lr(e){return"script[async]"+e}function hg(e,n,a){if(n.count++,n.instance===null)switch(n.type){case"style":var o=e.querySelector('style[data-href~="'+fi(a.href)+'"]');if(o)return n.instance=o,ve(o),o;var d=y({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return o=(e.ownerDocument||e).createElement("style"),ve(o),Me(o,"style",d),Fo(o,a.precedence,e),n.instance=o;case"stylesheet":d=aa(a.href);var p=e.querySelector(or(d));if(p)return n.state.loading|=4,n.instance=p,ve(p),p;o=ug(a),(d=Si.get(d))&&Ou(o,d),p=(e.ownerDocument||e).createElement("link"),ve(p);var v=p;return v._p=new Promise(function(x,M){v.onload=x,v.onerror=M}),Me(p,"link",o),n.state.loading|=4,Fo(p,a.precedence,e),n.instance=p;case"script":return p=ra(a.src),(d=e.querySelector(lr(p)))?(n.instance=d,ve(d),d):(o=a,(d=Si.get(p))&&(o=y({},a),Lu(o,d)),e=e.ownerDocument||e,d=e.createElement("script"),ve(d),Me(d,"link",o),e.head.appendChild(d),n.instance=d);case"void":return null;default:throw Error(s(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(o=n.instance,n.state.loading|=4,Fo(o,a.precedence,e));return n.instance}function Fo(e,n,a){for(var o=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),d=o.length?o[o.length-1]:null,p=d,v=0;v<o.length;v++){var x=o[v];if(x.dataset.precedence===n)p=x;else if(p!==d)break}p?p.parentNode.insertBefore(e,p.nextSibling):(n=a.nodeType===9?a.head:a,n.insertBefore(e,n.firstChild))}function Ou(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.title==null&&(e.title=n.title)}function Lu(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.integrity==null&&(e.integrity=n.integrity)}var Ho=null;function dg(e,n,a){if(Ho===null){var o=new Map,d=Ho=new Map;d.set(a,o)}else d=Ho,o=d.get(a),o||(o=new Map,d.set(a,o));if(o.has(e))return o;for(o.set(e,null),a=a.getElementsByTagName(e),d=0;d<a.length;d++){var p=a[d];if(!(p[_a]||p[_e]||e==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var v=p.getAttribute(n)||"";v=e+v;var x=o.get(v);x?x.push(p):o.set(v,[p])}}return o}function fg(e,n,a){e=e.ownerDocument||e,e.head.insertBefore(a,n==="title"?e.querySelector("head > title"):null)}function a0(e,n,a){if(a===1||n.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;switch(n.rel){case"stylesheet":return e=n.disabled,typeof n.precedence=="string"&&e==null;default:return!0}case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function pg(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function r0(e,n,a,o){if(a.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var d=aa(o.href),p=n.querySelector(or(d));if(p){n=p._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(e.count++,e=Io.bind(e),n.then(e,e)),a.state.loading|=4,a.instance=p,ve(p);return}p=n.ownerDocument||n,o=ug(o),(d=Si.get(d))&&Ou(o,d),p=p.createElement("link"),ve(p);var v=p;v._p=new Promise(function(x,M){v.onload=x,v.onerror=M}),Me(p,"link",o),a.instance=p}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(a,n),(n=a.state.preload)&&(a.state.loading&3)===0&&(e.count++,a=Io.bind(e),n.addEventListener("load",a),n.addEventListener("error",a))}}var ku=0;function o0(e,n){return e.stylesheets&&e.count===0&&qo(e,e.stylesheets),0<e.count||0<e.imgCount?function(a){var o=setTimeout(function(){if(e.stylesheets&&qo(e,e.stylesheets),e.unsuspend){var p=e.unsuspend;e.unsuspend=null,p()}},6e4+n);0<e.imgBytes&&ku===0&&(ku=62500*Hb());var d=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&qo(e,e.stylesheets),e.unsuspend)){var p=e.unsuspend;e.unsuspend=null,p()}},(e.imgBytes>ku?50:800)+n);return e.unsuspend=a,function(){e.unsuspend=null,clearTimeout(o),clearTimeout(d)}}:null}function Io(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)qo(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Go=null;function qo(e,n){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Go=new Map,n.forEach(l0,e),Go=null,Io.call(e))}function l0(e,n){if(!(n.state.loading&4)){var a=Go.get(e);if(a)var o=a.get(null);else{a=new Map,Go.set(e,a);for(var d=e.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<d.length;p++){var v=d[p];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(a.set(v.dataset.precedence,v),o=v)}o&&a.set(null,o)}d=n.instance,v=d.getAttribute("data-precedence"),p=a.get(v)||o,p===o&&a.set(null,d),a.set(v,d),this.count++,o=Io.bind(this),d.addEventListener("load",o),d.addEventListener("error",o),p?p.parentNode.insertBefore(d,p.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(d,e.firstChild)),n.state.loading|=4}}var cr={$$typeof:T,Provider:null,Consumer:null,_currentValue:tt,_currentValue2:tt,_threadCount:0};function c0(e,n,a,o,d,p,v,x,M){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=It(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=It(0),this.hiddenUpdates=It(null),this.identifierPrefix=o,this.onUncaughtError=d,this.onCaughtError=p,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=M,this.incompleteTransitions=new Map}function gg(e,n,a,o,d,p,v,x,M,j,X,$){return e=new c0(e,n,a,v,M,j,X,$,x),n=1,p===!0&&(n|=24),p=ii(3,null,null,n),e.current=p,p.stateNode=e,n=fc(),n.refCount++,e.pooledCache=n,n.refCount++,p.memoizedState={element:o,isDehydrated:a,cache:n},yc(p),e}function mg(e){return e?(e=Ps,e):Ps}function yg(e,n,a,o,d,p){d=mg(d),o.context===null?o.context=d:o.pendingContext=d,o=En(n),o.payload={element:a},p=p===void 0?null:p,p!==null&&(o.callback=p),a=Tn(e,o,n),a!==null&&($e(a,e,n),Ha(a,e,n))}function bg(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<n?a:n}}function Bu(e,n){bg(e,n),(e=e.alternate)&&bg(e,n)}function vg(e){if(e.tag===13||e.tag===31){var n=Wn(e,67108864);n!==null&&$e(n,e,67108864),Bu(e,67108864)}}function Ag(e){if(e.tag===13||e.tag===31){var n=oi();n=Rl(n);var a=Wn(e,n);a!==null&&$e(a,e,n),Bu(e,n)}}var Vo=!0;function u0(e,n,a,o){var d=k.T;k.T=null;var p=V.p;try{V.p=2,zu(e,n,a,o)}finally{V.p=p,k.T=d}}function h0(e,n,a,o){var d=k.T;k.T=null;var p=V.p;try{V.p=8,zu(e,n,a,o)}finally{V.p=p,k.T=d}}function zu(e,n,a,o){if(Vo){var d=Pu(o);if(d===null)wu(e,n,o,Xo,a),wg(e,o);else if(f0(d,e,n,a,o))o.stopPropagation();else if(wg(e,o),n&4&&-1<d0.indexOf(e)){for(;d!==null;){var p=Ts(d);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var v=ti(p.pendingLanes);if(v!==0){var x=p;for(x.pendingLanes|=2,x.entangledLanes|=2;v;){var M=1<<31-ue(v);x.entanglements[1]|=M,v&=~M}ji(p),(zt&6)===0&&(Mo=ke()+500,nr(0))}}break;case 31:case 13:x=Wn(p,2),x!==null&&$e(x,p,2),Ro(),Bu(p,2)}if(p=Pu(o),p===null&&wu(e,n,o,Xo,a),p===d)break;d=p}d!==null&&o.stopPropagation()}else wu(e,n,o,null,a)}}function Pu(e){return e=jl(e),Uu(e)}var Xo=null;function Uu(e){if(Xo=null,e=Es(e),e!==null){var n=l(e);if(n===null)e=null;else{var a=n.tag;if(a===13){if(e=c(n),e!==null)return e;e=null}else if(a===31){if(e=u(n),e!==null)return e;e=null}else if(a===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null)}}return Xo=e,null}function Sg(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(wa()){case xa:return 2;case zr:return 8;case Ss:case _l:return 32;case Pr:return 268435456;default:return 32}default:return 32}}var ju=!1,Pn=null,Un=null,jn=null,ur=new Map,hr=new Map,Fn=[],d0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function wg(e,n){switch(e){case"focusin":case"focusout":Pn=null;break;case"dragenter":case"dragleave":Un=null;break;case"mouseover":case"mouseout":jn=null;break;case"pointerover":case"pointerout":ur.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":hr.delete(n.pointerId)}}function dr(e,n,a,o,d,p){return e===null||e.nativeEvent!==p?(e={blockedOn:n,domEventName:a,eventSystemFlags:o,nativeEvent:p,targetContainers:[d]},n!==null&&(n=Ts(n),n!==null&&vg(n)),e):(e.eventSystemFlags|=o,n=e.targetContainers,d!==null&&n.indexOf(d)===-1&&n.push(d),e)}function f0(e,n,a,o,d){switch(n){case"focusin":return Pn=dr(Pn,e,n,a,o,d),!0;case"dragenter":return Un=dr(Un,e,n,a,o,d),!0;case"mouseover":return jn=dr(jn,e,n,a,o,d),!0;case"pointerover":var p=d.pointerId;return ur.set(p,dr(ur.get(p)||null,e,n,a,o,d)),!0;case"gotpointercapture":return p=d.pointerId,hr.set(p,dr(hr.get(p)||null,e,n,a,o,d)),!0}return!1}function xg(e){var n=Es(e.target);if(n!==null){var a=l(n);if(a!==null){if(n=a.tag,n===13){if(n=c(a),n!==null){e.blockedOn=n,zh(e.priority,function(){Ag(a)});return}}else if(n===31){if(n=u(a),n!==null){e.blockedOn=n,zh(e.priority,function(){Ag(a)});return}}else if(n===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Yo(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var a=Pu(e.nativeEvent);if(a===null){a=e.nativeEvent;var o=new a.constructor(a.type,a);Ul=o,a.target.dispatchEvent(o),Ul=null}else return n=Ts(a),n!==null&&vg(n),e.blockedOn=a,!1;n.shift()}return!0}function _g(e,n,a){Yo(e)&&a.delete(n)}function p0(){ju=!1,Pn!==null&&Yo(Pn)&&(Pn=null),Un!==null&&Yo(Un)&&(Un=null),jn!==null&&Yo(jn)&&(jn=null),ur.forEach(_g),hr.forEach(_g)}function $o(e,n){e.blockedOn===n&&(e.blockedOn=null,ju||(ju=!0,g.unstable_scheduleCallback(g.unstable_NormalPriority,p0)))}var Ko=null;function Eg(e){Ko!==e&&(Ko=e,g.unstable_scheduleCallback(g.unstable_NormalPriority,function(){Ko===e&&(Ko=null);for(var n=0;n<e.length;n+=3){var a=e[n],o=e[n+1],d=e[n+2];if(typeof o!="function"){if(Uu(o||a)===null)continue;break}var p=Ts(a);p!==null&&(e.splice(n,3),n-=3,Pc(p,{pending:!0,data:d,method:a.method,action:o},o,d))}}))}function oa(e){function n(M){return $o(M,e)}Pn!==null&&$o(Pn,e),Un!==null&&$o(Un,e),jn!==null&&$o(jn,e),ur.forEach(n),hr.forEach(n);for(var a=0;a<Fn.length;a++){var o=Fn[a];o.blockedOn===e&&(o.blockedOn=null)}for(;0<Fn.length&&(a=Fn[0],a.blockedOn===null);)xg(a),a.blockedOn===null&&Fn.shift();if(a=(e.ownerDocument||e).$$reactFormReplay,a!=null)for(o=0;o<a.length;o+=3){var d=a[o],p=a[o+1],v=d[Ie]||null;if(typeof p=="function")v||Eg(a);else if(v){var x=null;if(p&&p.hasAttribute("formAction")){if(d=p,v=p[Ie]||null)x=v.formAction;else if(Uu(d)!==null)continue}else x=v.action;typeof x=="function"?a[o+1]=x:(a.splice(o,3),o-=3),Eg(a)}}}function Tg(){function e(p){p.canIntercept&&p.info==="react-transition"&&p.intercept({handler:function(){return new Promise(function(v){return d=v})},focusReset:"manual",scroll:"manual"})}function n(){d!==null&&(d(),d=null),o||setTimeout(a,20)}function a(){if(!o&&!navigation.transition){var p=navigation.currentEntry;p&&p.url!=null&&navigation.navigate(p.url,{state:p.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var o=!1,d=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",n),navigation.addEventListener("navigateerror",n),setTimeout(a,100),function(){o=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",n),navigation.removeEventListener("navigateerror",n),d!==null&&(d(),d=null)}}}function Fu(e){this._internalRoot=e}Qo.prototype.render=Fu.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(s(409));var a=n.current,o=oi();yg(a,o,e,n,null,null)},Qo.prototype.unmount=Fu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;yg(e.current,2,null,e,null,null),Ro(),n[_s]=null}};function Qo(e){this._internalRoot=e}Qo.prototype.unstable_scheduleHydration=function(e){if(e){var n=Bh();e={blockedOn:null,target:e,priority:n};for(var a=0;a<Fn.length&&n!==0&&n<Fn[a].priority;a++);Fn.splice(a,0,e),a===0&&xg(e)}};var Cg=t.version;if(Cg!=="19.2.0")throw Error(s(527,Cg,"19.2.0"));V.findDOMNode=function(e){var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(s(188)):(e=Object.keys(e).join(","),Error(s(268,e)));return e=f(n),e=e!==null?m(e):null,e=e===null?null:e.stateNode,e};var g0={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:k,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zo.isDisabled&&Zo.supportsFiber)try{Yn=Zo.inject(g0),Zt=Zo}catch{}}return pr.createRoot=function(e,n){if(!r(e))throw Error(s(299));var a=!1,o="",d=kf,p=Bf,v=zf;return n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onUncaughtError!==void 0&&(d=n.onUncaughtError),n.onCaughtError!==void 0&&(p=n.onCaughtError),n.onRecoverableError!==void 0&&(v=n.onRecoverableError)),n=gg(e,1,!1,null,null,a,o,null,d,p,v,Tg),e[_s]=n.current,Su(e),new Fu(n)},pr.hydrateRoot=function(e,n,a){if(!r(e))throw Error(s(299));var o=!1,d="",p=kf,v=Bf,x=zf,M=null;return a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(d=a.identifierPrefix),a.onUncaughtError!==void 0&&(p=a.onUncaughtError),a.onCaughtError!==void 0&&(v=a.onCaughtError),a.onRecoverableError!==void 0&&(x=a.onRecoverableError),a.formState!==void 0&&(M=a.formState)),n=gg(e,1,!0,n,a??null,o,d,M,p,v,x,Tg),n.context=mg(null),a=n.current,o=oi(),o=Rl(o),d=En(o),d.callback=null,Tn(a,d,o),a=o,n.current.lanes=a,xe(n,a),ji(n),e[_s]=n.current,Su(e),new Qo(n)},pr.version="19.2.0",pr}var jg;function E0(){if(jg)return qu.exports;jg=1;function g(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(g)}catch(t){console.error(t)}}return g(),qu.exports=_0(),qu.exports}var T0=E0();const C0=g=>g.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),M0=g=>g.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,i,s)=>s?s.toUpperCase():i.toLowerCase()),Fg=g=>{const t=M0(g);return t.charAt(0).toUpperCase()+t.slice(1)},wm=(...g)=>g.filter((t,i,s)=>!!t&&t.trim()!==""&&s.indexOf(t)===i).join(" ").trim(),D0=g=>{for(const t in g)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var R0={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const N0=at.forwardRef(({color:g="currentColor",size:t=24,strokeWidth:i=2,absoluteStrokeWidth:s,className:r="",children:l,iconNode:c,...u},h)=>at.createElement("svg",{ref:h,...R0,width:t,height:t,stroke:g,strokeWidth:s?Number(i)*24/Number(t):i,className:wm("lucide",r),...!l&&!D0(u)&&{"aria-hidden":"true"},...u},[...c.map(([f,m])=>at.createElement(f,m)),...Array.isArray(l)?l:[l]]));const Sa=(g,t)=>{const i=at.forwardRef(({className:s,...r},l)=>at.createElement(N0,{ref:l,iconNode:t,className:wm(`lucide-${C0(Fg(g))}`,`lucide-${g}`,s),...r}));return i.displayName=Fg(g),i};const O0=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],L0=Sa("cloud-upload",O0);const k0=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 18v-1",key:"zg0ygc"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"M16 18v-3",key:"j5jt4h"}]],B0=Sa("file-chart-column",k0);const z0=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],P0=Sa("file-text",z0);const U0=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],j0=Sa("loader-circle",U0);const F0=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],H0=Sa("settings-2",F0);const I0=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],G0=Sa("trash-2",I0),q0=["Keep text  2.5 mm x-height and hairlines  0.5 mm for DTF prints.","Avoid semi-transparent layers; use solid colors for best adhesion."];function We(g,t=2){const i=10**t;return Math.round(g*i)/i}function Hg(g,t){return g/t}function Ig(g,t,i){const s=Hg(g,i),r=Hg(t,i);return{w_in:We(s),h_in:We(r),w_cm:We(s*2.54),h_cm:We(r*2.54)}}function Gg(g,t){return{w_in:We(g),h_in:We(t),w_cm:We(g*2.54),h_cm:We(t*2.54)}}function V0(g,t){return{at300dpi:Ig(g,t,300),at150dpi:Ig(g,t,150)}}function X0(g,t){return{at300dpi:Gg(g,t),at150dpi:Gg(g,t)}}function Y0({dpi:g,width:t,height:i}){if(g!==null)return g>=300?"Optimal":g>=150?"Good":"Poor";const s=Math.min(t,i);return s>=4500?"Optimal":s>=2250?"Good":"Poor"}function xm(){return[...q0]}function _m(g,t){return t===0?g:_m(t,g%t)}function Em(g,t){if(!g||!t)return"N/A";const i=1e3,s=Math.round(g*i),r=Math.round(t*i),l=_m(s,r),c=Math.round(s/l),u=Math.round(r/l),h=We(g/t,2);return`${c}:${u} (${h}:1)`}const $0=new Uint8Array([137,80,78,71,13,10,26,10]),K0=new Set([4,6]);function Wo(g,t){return(g[t]<<24|g[t+1]<<16|g[t+2]<<8|g[t+3])>>>0}function qg(g,t,i){return new TextDecoder("ascii").decode(g.subarray(t,t+i))}function Q0(g){if(g.length<8||!$0.every((m,y)=>g[y]===m))throw new Error("Invalid PNG signature");let t=8,i=0,s=0,r=0,l=0,c=!1,u=!1,h=null,f;for(;t<g.length;){const m=Wo(g,t),y=qg(g,t+4,4),b=t+8,A=b+m;if(y==="IHDR")i=Wo(g,b),s=Wo(g,b+4),r=g[b+8],l=g[b+9],c=K0.has(l);else if(y==="pHYs"){const w=Wo(g,b);g[b+8]===1&&w>0&&(h=Math.round(w/1/39.37007874))}else if(y==="iCCP"){const w=g.indexOf(0,b);w>b&&(f=qg(g,b,w-b))}else y==="tRNS"&&(u=!0);if(t=A+4,y==="IEND")break}return{width:i,height:s,bitDepth:r,colorType:l,hasAlpha:c||u,hasTransparencyChunk:u,dpi:h,iccProfile:f}}async function Z0(g){const t=await g.arrayBuffer(),i=new Uint8Array(t),s=Q0(i);if(!s.width||!s.height)throw new Error("Unable to read PNG dimensions");const r=s.dpi??null,l=Y0({dpi:r,width:s.width,height:s.height}),c=xm();return r===null&&c.push("No embedded DPI value found (pHYs chunk missing)."),s.hasAlpha?c.push("Alpha channel detected in artwork."):c.push("No alpha channel detected."),s.iccProfile?c.push(`Embedded ICC profile: ${s.iccProfile}.`):c.push("No embedded ICC profile detected."),{fileType:"png",fileSizeMB:We(g.size/(1024*1024),2),pixels:{w:s.width,h:s.height},dpi:r,hasICC:!!s.iccProfile,iccProfile:s.iccProfile,bitDepth:s.bitDepth,hasAlpha:s.hasAlpha,alphaStats:void 0,imageCategory:"Raster",recommendedSizes:V0(s.width,s.height),aspectRatio:Em(s.width,s.height),rating:l,notes:c}}const je=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),nh=[.001,0,0,.001,0,0],$u=1.35,li={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},In={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},_r="pdfjs_internal_editor_",At={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Rt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},W0={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},sh={TRIANGLES:1,LATTICE:2},De={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},cl={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},me={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},ua={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},ml={ERRORS:0,WARNINGS:1,INFOS:5},Er={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},gr={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},J0={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let yl=ml.WARNINGS;function tv(g){Number.isInteger(g)&&(yl=g)}function ev(){return yl}function bl(g){yl>=ml.INFOS&&console.info(`Info: ${g}`)}function mt(g){yl>=ml.WARNINGS&&console.warn(`Warning: ${g}`)}function $t(g){throw new Error(g)}function Nt(g,t){g||$t(t)}function iv(g){switch(g?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Tm(g,t=null,i=null){if(!g)return null;if(i&&typeof g=="string"&&(i.addDefaultProtocol&&g.startsWith("www.")&&g.match(/\./g)?.length>=2&&(g=`http://${g}`),i.tryConvertEncoding))try{g=ov(g)}catch{}const s=t?URL.parse(g,t):URL.parse(g);return iv(s)?s:null}function Cm(g,t,i=!1){const s=URL.parse(g);return s?(s.hash=t,s.href):i&&Tm(g,"http://example.com")?g.split("#",1)[0]+`${t?`#${t}`:""}`:""}function wt(g,t,i,s=!1){return Object.defineProperty(g,t,{value:i,enumerable:!s,configurable:!0,writable:!1}),i}const bs=(function(){function t(i,s){this.message=i,this.name=s}return t.prototype=new Error,t.constructor=t,t})();class Vg extends bs{constructor(t,i){super(t,"PasswordException"),this.code=i}}class Ku extends bs{constructor(t,i){super(t,"UnknownErrorException"),this.details=i}}class ah extends bs{constructor(t){super(t,"InvalidPDFException")}}class dl extends bs{constructor(t,i,s){super(t,"ResponseException"),this.status=i,this.missing=s}}class nv extends bs{constructor(t){super(t,"FormatError")}}class qn extends bs{constructor(t){super(t,"AbortException")}}function Mm(g){(typeof g!="object"||g?.length===void 0)&&$t("Invalid argument for bytesToString");const t=g.length,i=8192;if(t<i)return String.fromCharCode.apply(null,g);const s=[];for(let r=0;r<t;r+=i){const l=Math.min(r+i,t),c=g.subarray(r,l);s.push(String.fromCharCode.apply(null,c))}return s.join("")}function Dr(g){typeof g!="string"&&$t("Invalid argument for stringToBytes");const t=g.length,i=new Uint8Array(t);for(let s=0;s<t;++s)i[s]=g.charCodeAt(s)&255;return i}function sv(g){return String.fromCharCode(g>>24&255,g>>16&255,g>>8&255,g&255)}function av(){const g=new Uint8Array(4);return g[0]=1,new Uint32Array(g.buffer,0,1)[0]===1}function rv(){try{return new Function(""),!0}catch{return!1}}class Oe{static get isLittleEndian(){return wt(this,"isLittleEndian",av())}static get isEvalSupported(){return wt(this,"isEvalSupported",rv())}static get isOffscreenCanvasSupported(){return wt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return wt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return wt(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return wt(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:t,userAgent:i}=navigator;return wt(this,"platform",{isAndroid:i.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:i.includes("Firefox")})}static get isCSSRoundSupported(){return wt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Qu=Array.from(Array(256).keys(),g=>g.toString(16).padStart(2,"0"));class st{static makeHexColor(t,i,s){return`#${Qu[t]}${Qu[i]}${Qu[s]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,i){let s;t[0]?(t[0]<0&&(s=i[0],i[0]=i[2],i[2]=s),i[0]*=t[0],i[2]*=t[0],t[3]<0&&(s=i[1],i[1]=i[3],i[3]=s),i[1]*=t[3],i[3]*=t[3]):(s=i[0],i[0]=i[1],i[1]=s,s=i[2],i[2]=i[3],i[3]=s,t[1]<0&&(s=i[1],i[1]=i[3],i[3]=s),i[1]*=t[1],i[3]*=t[1],t[2]<0&&(s=i[0],i[0]=i[2],i[2]=s),i[0]*=t[2],i[2]*=t[2]),i[0]+=t[4],i[1]+=t[5],i[2]+=t[4],i[3]+=t[5]}static transform(t,i){return[t[0]*i[0]+t[2]*i[1],t[1]*i[0]+t[3]*i[1],t[0]*i[2]+t[2]*i[3],t[1]*i[2]+t[3]*i[3],t[0]*i[4]+t[2]*i[5]+t[4],t[1]*i[4]+t[3]*i[5]+t[5]]}static multiplyByDOMMatrix(t,i){return[t[0]*i.a+t[2]*i.b,t[1]*i.a+t[3]*i.b,t[0]*i.c+t[2]*i.d,t[1]*i.c+t[3]*i.d,t[0]*i.e+t[2]*i.f+t[4],t[1]*i.e+t[3]*i.f+t[5]]}static applyTransform(t,i,s=0){const r=t[s],l=t[s+1];t[s]=r*i[0]+l*i[2]+i[4],t[s+1]=r*i[1]+l*i[3]+i[5]}static applyTransformToBezier(t,i,s=0){const r=i[0],l=i[1],c=i[2],u=i[3],h=i[4],f=i[5];for(let m=0;m<6;m+=2){const y=t[s+m],b=t[s+m+1];t[s+m]=y*r+b*c+h,t[s+m+1]=y*l+b*u+f}}static applyInverseTransform(t,i){const s=t[0],r=t[1],l=i[0]*i[3]-i[1]*i[2];t[0]=(s*i[3]-r*i[2]+i[2]*i[5]-i[4]*i[3])/l,t[1]=(-s*i[1]+r*i[0]+i[4]*i[1]-i[5]*i[0])/l}static axialAlignedBoundingBox(t,i,s){const r=i[0],l=i[1],c=i[2],u=i[3],h=i[4],f=i[5],m=t[0],y=t[1],b=t[2],A=t[3];let w=r*m+h,S=w,E=r*b+h,_=E,D=u*y+f,T=D,B=u*A+f,O=B;if(l!==0||c!==0){const L=l*m,P=l*b,q=c*y,K=c*A;w+=q,_+=q,E+=K,S+=K,D+=L,O+=L,B+=P,T+=P}s[0]=Math.min(s[0],w,E,S,_),s[1]=Math.min(s[1],D,B,T,O),s[2]=Math.max(s[2],w,E,S,_),s[3]=Math.max(s[3],D,B,T,O)}static inverseTransform(t){const i=t[0]*t[3]-t[1]*t[2];return[t[3]/i,-t[1]/i,-t[2]/i,t[0]/i,(t[2]*t[5]-t[4]*t[3])/i,(t[4]*t[1]-t[5]*t[0])/i]}static singularValueDecompose2dScale(t,i){const s=t[0],r=t[1],l=t[2],c=t[3],u=s**2+r**2,h=s*l+r*c,f=l**2+c**2,m=(u+f)/2,y=Math.sqrt(m**2-(u*f-h**2));i[0]=Math.sqrt(m+y||1),i[1]=Math.sqrt(m-y||1)}static normalizeRect(t){const i=t.slice(0);return t[0]>t[2]&&(i[0]=t[2],i[2]=t[0]),t[1]>t[3]&&(i[1]=t[3],i[3]=t[1]),i}static intersect(t,i){const s=Math.max(Math.min(t[0],t[2]),Math.min(i[0],i[2])),r=Math.min(Math.max(t[0],t[2]),Math.max(i[0],i[2]));if(s>r)return null;const l=Math.max(Math.min(t[1],t[3]),Math.min(i[1],i[3])),c=Math.min(Math.max(t[1],t[3]),Math.max(i[1],i[3]));return l>c?null:[s,l,r,c]}static pointBoundingBox(t,i,s){s[0]=Math.min(s[0],t),s[1]=Math.min(s[1],i),s[2]=Math.max(s[2],t),s[3]=Math.max(s[3],i)}static rectBoundingBox(t,i,s,r,l){l[0]=Math.min(l[0],t,s),l[1]=Math.min(l[1],i,r),l[2]=Math.max(l[2],t,s),l[3]=Math.max(l[3],i,r)}static#t(t,i,s,r,l,c,u,h,f,m){if(f<=0||f>=1)return;const y=1-f,b=f*f,A=b*f,w=y*(y*(y*t+3*f*i)+3*b*s)+A*r,S=y*(y*(y*l+3*f*c)+3*b*u)+A*h;m[0]=Math.min(m[0],w),m[1]=Math.min(m[1],S),m[2]=Math.max(m[2],w),m[3]=Math.max(m[3],S)}static#e(t,i,s,r,l,c,u,h,f,m,y,b){if(Math.abs(f)<1e-12){Math.abs(m)>=1e-12&&this.#t(t,i,s,r,l,c,u,h,-y/m,b);return}const A=m**2-4*y*f;if(A<0)return;const w=Math.sqrt(A),S=2*f;this.#t(t,i,s,r,l,c,u,h,(-m+w)/S,b),this.#t(t,i,s,r,l,c,u,h,(-m-w)/S,b)}static bezierBoundingBox(t,i,s,r,l,c,u,h,f){f[0]=Math.min(f[0],t,u),f[1]=Math.min(f[1],i,h),f[2]=Math.max(f[2],t,u),f[3]=Math.max(f[3],i,h),this.#e(t,s,l,u,i,r,c,h,3*(-t+3*(s-l)+u),6*(t-2*s+l),3*(s-t),f),this.#e(t,s,l,u,i,r,c,h,3*(-i+3*(r-c)+h),6*(i-2*r+c),3*(r-i),f)}}function ov(g){return decodeURIComponent(escape(g))}let Zu=null,Xg=null;function lv(g){return Zu||(Zu=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Xg=new Map([["","t"]])),g.replaceAll(Zu,(t,i,s)=>i?i.normalize("NFKC"):Xg.get(s))}function Dm(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const g=new Uint8Array(32);return crypto.getRandomValues(g),Mm(g)}const fa="pdfjs_internal_id_";function cv(g,t,i){if(!Array.isArray(i)||i.length<2)return!1;const[s,r,...l]=i;if(!g(s)&&!Number.isInteger(s)||!t(r))return!1;const c=l.length;let u=!0;switch(r.name){case"XYZ":if(c<2||c>3)return!1;break;case"Fit":case"FitB":return c===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(c>1)return!1;break;case"FitR":if(c!==4)return!1;u=!1;break;default:return!1}for(const h of l)if(!(typeof h=="number"||u&&h===null))return!1;return!0}function Fe(g,t,i){return Math.min(Math.max(g,t),i)}function Rm(g){return Uint8Array.prototype.toBase64?g.toBase64():btoa(Mm(g))}function uv(g){return Uint8Array.fromBase64?Uint8Array.fromBase64(g):Dr(atob(g))}typeof Promise.try!="function"&&(Promise.try=function(g,...t){return new Promise(i=>{i(g(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(g){return g.reduce((t,i)=>t+i,0)});class Tr{static textContent(t){const i=[],s={items:i,styles:Object.create(null)};function r(l){if(!l)return;let c=null;const u=l.name;if(u==="#text")c=l.value;else if(Tr.shouldBuildText(u))l?.attributes?.textContent?c=l.attributes.textContent:l.value&&(c=l.value);else return;if(c!==null&&i.push({str:c}),!!l.children)for(const h of l.children)r(h)}return r(t),s}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class Nm{static setupStorage(t,i,s,r,l){const c=r.getValue(i,{value:null});switch(s.name){case"textarea":if(c.value!==null&&(t.textContent=c.value),l==="print")break;t.addEventListener("input",u=>{r.setValue(i,{value:u.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(c.value===s.attributes.xfaOn?t.setAttribute("checked",!0):c.value===s.attributes.xfaOff&&t.removeAttribute("checked"),l==="print")break;t.addEventListener("change",u=>{r.setValue(i,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(c.value!==null&&t.setAttribute("value",c.value),l==="print")break;t.addEventListener("input",u=>{r.setValue(i,{value:u.target.value})})}break;case"select":if(c.value!==null){t.setAttribute("value",c.value);for(const u of s.children)u.attributes.value===c.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const h=u.target.options,f=h.selectedIndex===-1?"":h[h.selectedIndex].value;r.setValue(i,{value:f})});break}}static setAttributes({html:t,element:i,storage:s=null,intent:r,linkService:l}){const{attributes:c}=i,u=t instanceof HTMLAnchorElement;c.type==="radio"&&(c.name=`${c.name}-${r}`);for(const[h,f]of Object.entries(c))if(f!=null)switch(h){case"class":f.length&&t.setAttribute(h,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!u||h!=="href"&&h!=="newWindow")&&t.setAttribute(h,f)}u&&l.addLinkAttributes(t,c.href,c.newWindow),s&&c.dataId&&this.setupStorage(t,c.dataId,i,s)}static render(t){const i=t.annotationStorage,s=t.linkService,r=t.xfaHtml,l=t.intent||"display",c=document.createElement(r.name);r.attributes&&this.setAttributes({html:c,element:r,intent:l,linkService:s});const u=l!=="richText",h=t.div;if(h.append(c),t.viewport){const y=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=y}u&&h.setAttribute("class","xfaLayer xfaFont");const f=[];if(r.children.length===0){if(r.value){const y=document.createTextNode(r.value);c.append(y),u&&Tr.shouldBuildText(r.name)&&f.push(y)}return{textDivs:f}}const m=[[r,-1,c]];for(;m.length>0;){const[y,b,A]=m.at(-1);if(b+1===y.children.length){m.pop();continue}const w=y.children[++m.at(-1)[1]];if(w===null)continue;const{name:S}=w;if(S==="#text"){const _=document.createTextNode(w.value);f.push(_),A.append(_);continue}const E=w?.attributes?.xmlns?document.createElementNS(w.attributes.xmlns,S):document.createElement(S);if(A.append(E),w.attributes&&this.setAttributes({html:E,element:w,storage:i,intent:l,linkService:s}),w.children?.length>0)m.push([w,-1,E]);else if(w.value){const _=document.createTextNode(w.value);u&&Tr.shouldBuildText(S)&&f.push(_),E.append(_)}}for(const y of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))y.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const i=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=i,t.div.hidden=!1}}const pn="http://www.w3.org/2000/svg";class Aa{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Rr(g,t="text"){if(Ar(g,document.baseURI)){const i=await fetch(g);if(!i.ok)throw new Error(i.statusText);switch(t){case"arraybuffer":return i.arrayBuffer();case"blob":return i.blob();case"json":return i.json()}return i.text()}return new Promise((i,s)=>{const r=new XMLHttpRequest;r.open("GET",g,!0),r.responseType=t,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(t){case"arraybuffer":case"blob":case"json":i(r.response);return}i(r.responseText);return}s(new Error(r.statusText))}},r.send(null)})}class Nr{constructor({viewBox:t,userUnit:i,scale:s,rotation:r,offsetX:l=0,offsetY:c=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=i,this.scale=s,this.rotation=r,this.offsetX=l,this.offsetY=c,s*=i;const h=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let m,y,b,A;switch(r%=360,r<0&&(r+=360),r){case 180:m=-1,y=0,b=0,A=1;break;case 90:m=0,y=1,b=1,A=0;break;case 270:m=0,y=-1,b=-1,A=0;break;case 0:m=1,y=0,b=0,A=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(b=-b,A=-A);let w,S,E,_;m===0?(w=Math.abs(f-t[1])*s+l,S=Math.abs(h-t[0])*s+c,E=(t[3]-t[1])*s,_=(t[2]-t[0])*s):(w=Math.abs(h-t[0])*s+l,S=Math.abs(f-t[1])*s+c,E=(t[2]-t[0])*s,_=(t[3]-t[1])*s),this.transform=[m*s,y*s,b*s,A*s,w-m*s*h-b*s*f,S-y*s*h-A*s*f],this.width=E,this.height=_}get rawDims(){const t=this.viewBox;return wt(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:i=this.rotation,offsetX:s=this.offsetX,offsetY:r=this.offsetY,dontFlip:l=!1}={}){return new Nr({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:i,offsetX:s,offsetY:r,dontFlip:l})}convertToViewportPoint(t,i){const s=[t,i];return st.applyTransform(s,this.transform),s}convertToViewportRectangle(t){const i=[t[0],t[1]];st.applyTransform(i,this.transform);const s=[t[2],t[3]];return st.applyTransform(s,this.transform),[i[0],i[1],s[0],s[1]]}convertToPdfPoint(t,i){const s=[t,i];return st.applyInverseTransform(s,this.transform),s}}class bh extends bs{constructor(t,i=0){super(t,"RenderingCancelledException"),this.extraDelay=i}}function vl(g){const t=g.length;let i=0;for(;i<t&&g[i].trim()==="";)i++;return g.substring(i,i+5).toLowerCase()==="data:"}function vh(g){return typeof g=="string"&&/\.pdf$/i.test(g)}function hv(g){return[g]=g.split(/[#?]/,1),g.substring(g.lastIndexOf("/")+1)}function dv(g,t="document.pdf"){if(typeof g!="string")return t;if(vl(g))return mt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const s=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(g);if(!s)return t;const r=u=>{try{let h=decodeURIComponent(u);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:u):h}catch{return u}},l=/\.pdf$/i,c=s.pathname.split("/").at(-1);if(l.test(c))return r(c);if(s.searchParams.size>0){const u=Array.from(s.searchParams.values()).reverse();for(const f of u)if(l.test(f))return r(f);const h=Array.from(s.searchParams.keys()).reverse();for(const f of h)if(l.test(f))return r(f)}if(s.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(h)return r(h[0])}return t}class Yg{started=Object.create(null);times=[];time(t){t in this.started&&mt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||mt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let i=0;for(const{name:s}of this.times)i=Math.max(s.length,i);for(const{name:s,start:r,end:l}of this.times)t.push(`${s.padEnd(i)} ${l-r}ms
`);return t.join("")}}function Ar(g,t){const i=t?URL.parse(g,t):URL.parse(g);return i?.protocol==="http:"||i?.protocol==="https:"}function Ei(g){g.preventDefault()}function re(g){g.preventDefault(),g.stopPropagation()}function fv(g){console.log("Deprecated API usage: "+g)}class rh{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const i=this.#t.exec(t);if(!i)return null;const s=parseInt(i[1],10);let r=parseInt(i[2],10);r=r>=1&&r<=12?r-1:0;let l=parseInt(i[3],10);l=l>=1&&l<=31?l:1;let c=parseInt(i[4],10);c=c>=0&&c<=23?c:0;let u=parseInt(i[5],10);u=u>=0&&u<=59?u:0;let h=parseInt(i[6],10);h=h>=0&&h<=59?h:0;const f=i[7]||"Z";let m=parseInt(i[8],10);m=m>=0&&m<=23?m:0;let y=parseInt(i[9],10)||0;return y=y>=0&&y<=59?y:0,f==="-"?(c+=m,u+=y):f==="+"&&(c-=m,u-=y),new Date(Date.UTC(s,r,l,c,u,h))}}function pv(g,{scale:t=1,rotation:i=0}){const{width:s,height:r}=g.attributes.style,l=[0,0,parseInt(s),parseInt(r)];return new Nr({viewBox:l,userUnit:1,scale:t,rotation:i})}function Or(g){if(g.startsWith("#")){const t=parseInt(g.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return g.startsWith("rgb(")?g.slice(4,-1).split(",").map(t=>parseInt(t)):g.startsWith("rgba(")?g.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(mt(`Not a valid color format: "${g}"`),[0,0,0])}function gv(g){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const i of g.keys()){t.style.color=i;const s=window.getComputedStyle(t).color;g.set(i,Or(s))}t.remove()}function ie(g){const{a:t,b:i,c:s,d:r,e:l,f:c}=g.getTransform();return[t,i,s,r,l,c]}function Ii(g){const{a:t,b:i,c:s,d:r,e:l,f:c}=g.getTransform().invertSelf();return[t,i,s,r,l,c]}function ms(g,t,i=!1,s=!0){if(t instanceof Nr){const{pageWidth:r,pageHeight:l}=t.rawDims,{style:c}=g,u=Oe.isCSSRoundSupported,h=`var(--total-scale-factor) * ${r}px`,f=`var(--total-scale-factor) * ${l}px`,m=u?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,y=u?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!i||t.rotation%180===0?(c.width=m,c.height=y):(c.width=y,c.height=m)}s&&g.setAttribute("data-main-rotation",t.rotation)}class Xi{constructor(){const{pixelRatio:t}=Xi;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,i,s,r,l=-1){let c=1/0,u=1/0,h=1/0;s=Xi.capPixels(s,l),s>0&&(c=Math.sqrt(s/(t*i))),r!==-1&&(u=r/t,h=r/i);const f=Math.min(c,u,h);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,i){if(i>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+i/100));return t>0?Math.min(t,s):s}return t}}const oh=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class mv{static get isDarkMode(){return wt(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class yv{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:i}=t;i.width=i.height="0",i.display="none",i.color="var(--comment-fg-color)",document.body.append(t);const{color:s}=window.getComputedStyle(t);return t.remove(),wt(this,"commentForegroundColor",Or(s))}}function bv(g,t,i,s){s=Math.min(Math.max(s??1,0),1);const r=255*(1-s);return g=Math.round(g*s+r),t=Math.round(t*s+r),i=Math.round(i*s+r),[g,t,i]}function $g(g,t){const i=g[0]/255,s=g[1]/255,r=g[2]/255,l=Math.max(i,s,r),c=Math.min(i,s,r),u=(l+c)/2;if(l===c)t[0]=t[1]=0;else{const h=l-c;switch(t[1]=u<.5?h/(l+c):h/(2-l-c),l){case i:t[0]=((s-r)/h+(s<r?6:0))*60;break;case s:t[0]=((r-i)/h+2)*60;break;case r:t[0]=((i-s)/h+4)*60;break}}t[2]=u}function lh(g,t){const i=g[0],s=g[1],r=g[2],l=(1-Math.abs(2*r-1))*s,c=l*(1-Math.abs(i/60%2-1)),u=r-l/2;switch(Math.floor(i/60)){case 0:t[0]=l+u,t[1]=c+u,t[2]=u;break;case 1:t[0]=c+u,t[1]=l+u,t[2]=u;break;case 2:t[0]=u,t[1]=l+u,t[2]=c+u;break;case 3:t[0]=u,t[1]=c+u,t[2]=l+u;break;case 4:t[0]=c+u,t[1]=u,t[2]=l+u;break;case 5:case 6:t[0]=l+u,t[1]=u,t[2]=c+u;break}}function Kg(g){return g<=.03928?g/12.92:((g+.055)/1.055)**2.4}function Qg(g,t,i){lh(g,i),i.map(Kg);const s=.2126*i[0]+.7152*i[1]+.0722*i[2];lh(t,i),i.map(Kg);const r=.2126*i[0]+.7152*i[1]+.0722*i[2];return s>r?(s+.05)/(r+.05):(r+.05)/(s+.05)}const Zg=new Map;function vv(g,t){const i=g[0]+g[1]*256+g[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let s=Zg.get(i);if(s)return s;const r=new Float32Array(9),l=r.subarray(0,3),c=r.subarray(3,6);$g(g,c);const u=r.subarray(6,9);$g(t,u);const h=u[2]<.5,f=h?12:4.5;if(c[2]=h?Math.sqrt(c[2]):1-Math.sqrt(1-c[2]),Qg(c,u,l)<f){let m,y;h?(m=c[2],y=1):(m=0,y=c[2]);const b=.005;for(;y-m>b;){const A=c[2]=(m+y)/2;h===Qg(c,u,l)<f?m=A:y=A}c[2]=h?y:m}return lh(c,l),s=st.makeHexColor(Math.round(l[0]*255),Math.round(l[1]*255),Math.round(l[2]*255)),Zg.set(i,s),s}function Om({html:g,dir:t,className:i},s){const r=document.createDocumentFragment();if(typeof g=="string"){const l=document.createElement("p");l.dir=t||"auto";const c=g.split(/(?:\r\n?|\n)/);for(let u=0,h=c.length;u<h;++u){const f=c[u];l.append(document.createTextNode(f)),u<h-1&&l.append(document.createElement("br"))}r.append(l)}else Nm.render({xfaHtml:g,div:r,intent:"richText"});r.firstChild.classList.add("richText",i),s.append(r)}function Lm(g){const t=new Path2D;if(!g)return t;for(let i=0,s=g.length;i<s;)switch(g[i++]){case gr.moveTo:t.moveTo(g[i++],g[i++]);break;case gr.lineTo:t.lineTo(g[i++],g[i++]);break;case gr.curveTo:t.bezierCurveTo(g[i++],g[i++],g[i++],g[i++],g[i++],g[i++]);break;case gr.quadraticCurveTo:t.quadraticCurveTo(g[i++],g[i++],g[i++],g[i++]);break;case gr.closePath:t.closePath();break;default:mt(`Unrecognized drawing path operator: ${g[i-1]}`);break}return t}class xr{#t=null;#e=null;#n;#i=null;#r=null;#a=null;#s=null;#o=null;static#c=null;constructor(t){this.#n=t,xr.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const i=this.#n._uiManager._signal;i instanceof AbortSignal&&!i.aborted&&(t.addEventListener("contextmenu",Ei,{signal:i}),t.addEventListener("pointerdown",xr.#l,{signal:i}));const s=this.#i=document.createElement("div");s.className="buttons",t.append(s);const r=this.#n.toolbarPosition;if(r){const{style:l}=t,c=this.#n._uiManager.direction==="ltr"?1-r[0]:r[0];l.insetInlineEnd=`${100*c}%`,l.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#l(t){t.stopPropagation()}#d(t){this.#n._focusEventsAllowed=!1,re(t)}#h(t){this.#n._focusEventsAllowed=!0,re(t)}#f(t){const i=this.#n._uiManager._signal;return!(i instanceof AbortSignal)||i.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:i}),t.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:i}),t.addEventListener("contextmenu",Ei,{signal:i}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#r?.shown(),this.#a?.shown()}addDeleteButton(){const{editorType:t,_uiManager:i}=this.#n,s=document.createElement("button");s.classList.add("basic","deleteButton"),s.tabIndex=0,s.setAttribute("data-l10n-id",xr.#c[t]),this.#f(s)&&s.addEventListener("click",r=>{i.delete()},{signal:i._signal}),this.#i.append(s)}get#m(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const i=await t.render();this.#f(i),this.#i.append(i,this.#m),this.#r=t}addComment(t,i=null){if(this.#a)return;const s=t.renderForToolbar();if(!s)return;this.#f(s);const r=this.#s=this.#m;i?(this.#i.insertBefore(s,i),this.#i.insertBefore(r,i)):this.#i.append(s,r),this.#a=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const i=t.renderButton();this.#f(i),this.#i.append(i,this.#m)}async addEditSignatureButton(t){const i=this.#o=await t.renderEditButton(this.#n);this.#f(i),this.#i.append(i,this.#m)}removeButton(t){switch(t){case"comment":this.#a?.removeToolbarCommentButton(),this.#a=null,this.#s?.remove(),this.#s=null;break}}async addButton(t,i){switch(t){case"colorPicker":i&&this.addColorPicker(i);break;case"altText":i&&await this.addAltText(i);break;case"editSignature":i&&await this.addEditSignatureButton(i);break;case"delete":this.addDeleteButton();break;case"comment":i&&this.addComment(i);break}}async addButtonBefore(t,i,s){if(!i&&t==="comment")return;const r=this.#i.querySelector(s);r&&t==="comment"&&this.addComment(i,r)}updateEditSignatureButton(t){this.#o&&(this.#o.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class Av{#t=null;#e=null;#n;constructor(t){this.#n=t}#i(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const i=this.#n._signal;i instanceof AbortSignal&&!i.aborted&&t.addEventListener("contextmenu",Ei,{signal:i});const s=this.#t=document.createElement("div");return s.className="buttons",t.append(s),this.#n.hasCommentManager()&&this.#a("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#n.commentSelection("floating_button")}),this.#a("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#n.highlightSelection("floating_button")}),t}#r(t,i){let s=0,r=0;for(const l of t){const c=l.y+l.height;if(c<s)continue;const u=l.x+(i?l.width:0);if(c>s){r=u,s=c;continue}i?u>r&&(r=u):u<r&&(r=u)}return[i?1-r:r,s]}show(t,i,s){const[r,l]=this.#r(i,s),{style:c}=this.#e||=this.#i();t.append(this.#e),c.insetInlineEnd=`${100*r}%`,c.top=`calc(${100*l}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#a(t,i,s,r){const l=document.createElement("button");l.classList.add("basic",t),l.tabIndex=0,l.setAttribute("data-l10n-id",i);const c=document.createElement("span");l.append(c),c.className="visuallyHidden",c.setAttribute("data-l10n-id",s);const u=this.#n._signal;u instanceof AbortSignal&&!u.aborted&&(l.addEventListener("contextmenu",Ei,{signal:u}),l.addEventListener("click",r,{signal:u})),this.#t.append(l)}}function km(g,t,i){for(const s of i)t.addEventListener(s,g[s].bind(g))}class Ut{static#t=NaN;static#e=null;static#n=NaN;static#i=null;static initializeAndAddPointerId(t){(Ut.#e||=new Set).add(t)}static setPointer(t,i){Ut.#t||=i,Ut.#i??=t}static setTimeStamp(t){Ut.#n=t}static isSamePointerId(t){return Ut.#t===t}static isSamePointerIdOrRemove(t){return Ut.#t===t?!0:(Ut.#e?.delete(t),!1)}static isSamePointerType(t){return Ut.#i===t}static isInitializedAndDifferentPointerType(t){return Ut.#i!==null&&!Ut.isSamePointerType(t)}static isSameTimeStamp(t){return Ut.#n===t}static isUsingMultiplePointers(){return Ut.#e?.size>=1}static clearPointerType(){Ut.#i=null}static clearPointerIds(){Ut.#t=NaN,Ut.#e=null}static clearTimeStamp(){Ut.#n=NaN}}class Sv{#t=0;get id(){return`${_r}${this.#t++}`}}class Ah{#t=Dm();#e=0;#n=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=t;const l=r.decode().then(()=>(s.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return wt(this,"_isSVGFittingCanvas",l)}async#i(t,i){this.#n||=new Map;let s=this.#n.get(t);if(s===null)return null;if(s?.bitmap)return s.refCounter+=1,s;try{s||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let r;if(typeof i=="string"?(s.url=i,r=await Rr(i,"blob")):i instanceof File?r=s.file=i:i instanceof Blob&&(r=i),r.type==="image/svg+xml"){const l=Ah._isSVGFittingCanvas,c=new FileReader,u=new Image,h=new Promise((f,m)=>{u.onload=()=>{s.bitmap=u,s.isSvg=!0,f()},c.onload=async()=>{const y=s.svgUrl=c.result;u.src=await l?`${y}#svgView(preserveAspectRatio(none))`:y},u.onerror=c.onerror=m});c.readAsDataURL(r),await h}else s.bitmap=await createImageBitmap(r);s.refCounter=1}catch(r){mt(r),s=null}return this.#n.set(t,s),s&&this.#n.set(s.id,s),s}async getFromFile(t){const{lastModified:i,name:s,size:r,type:l}=t;return this.#i(`${i}_${s}_${r}_${l}`,t)}async getFromUrl(t){return this.#i(t,t)}async getFromBlob(t,i){const s=await i;return this.#i(t,s)}async getFromId(t){this.#n||=new Map;const i=this.#n.get(t);if(!i)return null;if(i.bitmap)return i.refCounter+=1,i;if(i.file)return this.getFromFile(i.file);if(i.blobPromise){const{blobPromise:s}=i;return delete i.blobPromise,this.getFromBlob(i.id,s)}return this.getFromUrl(i.url)}getFromCanvas(t,i){this.#n||=new Map;let s=this.#n.get(t);if(s?.bitmap)return s.refCounter+=1,s;const r=new OffscreenCanvas(i.width,i.height);return r.getContext("2d").drawImage(i,0,0),s={bitmap:r.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#n.set(t,s),this.#n.set(s.id,s),s}getSvgUrl(t){const i=this.#n.get(t);return i?.isSvg?i.svgUrl:null}deleteId(t){this.#n||=new Map;const i=this.#n.get(t);if(!i||(i.refCounter-=1,i.refCounter!==0))return;const{bitmap:s}=i;if(!i.url&&!i.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),i.blobPromise=r.convertToBlob()}s.close?.(),i.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class wv{#t=[];#e=!1;#n;#i=-1;constructor(t=128){this.#n=t}add({cmd:t,undo:i,post:s,mustExec:r,type:l=NaN,overwriteIfSameType:c=!1,keepUndo:u=!1}){if(r&&t(),this.#e)return;const h={cmd:t,undo:i,post:s,type:l};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(h);return}if(c&&this.#t[this.#i].type===l){u&&(h.undo=this.#t[this.#i].undo),this.#t[this.#i]=h;return}const f=this.#i+1;f===this.#n?this.#t.splice(0,1):(this.#i=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(h)}undo(){if(this.#i===-1)return;this.#e=!0;const{undo:t,post:i}=this.#t[this.#i];t(),i?.(),this.#e=!1,this.#i-=1}redo(){if(this.#i<this.#t.length-1){this.#i+=1,this.#e=!0;const{cmd:t,post:i}=this.#t[this.#i];t(),i?.(),this.#e=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}cleanType(t){if(this.#i!==-1){for(let i=this.#i;i>=0;i--)if(this.#t[i].type!==t){this.#t.splice(i+1,this.#i-i),this.#i=i;return}this.#t.length=0,this.#i=-1}}destroy(){this.#t=null}}class Lr{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:i}=Oe.platform;for(const[s,r,l={}]of t)for(const c of s){const u=c.startsWith("mac+");i&&u?(this.callbacks.set(c.slice(4),{callback:r,options:l}),this.allKeys.add(c.split("+").at(-1))):!i&&!u&&(this.callbacks.set(c,{callback:r,options:l}),this.allKeys.add(c.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const i=this.buffer.join("+");return this.buffer.length=0,i}exec(t,i){if(!this.allKeys.has(i.key))return;const s=this.callbacks.get(this.#t(i));if(!s)return;const{callback:r,options:{bubbles:l=!1,args:c=[],checker:u=null}}=s;u&&!u(t,i)||(r.bind(t,...c,i)(),l||re(i))}}class Sh{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return gv(t),wt(this,"_colors",t)}convert(t){const i=Or(t);if(!window.matchMedia("(forced-colors: active)").matches)return i;for(const[s,r]of this._colors)if(r.every((l,c)=>l===i[c]))return Sh._colorsMapping.get(s);return i}getHexCode(t){const i=this._colors.get(t);return i?st.makeHexColor(...i):t}}class Vn{#t=new AbortController;#e=null;#n=null;#i=new Map;#r=new Map;#a=null;#s=null;#o=null;#c=new wv;#l=null;#d=null;#h=null;#f=0;#m=new Set;#g=null;#u=null;#p=new Set;_editorUndoBar=null;#y=!1;#v=!1;#b=!1;#E=null;#x=null;#S=null;#C=null;#A=!1;#_=null;#R=new Sv;#M=!1;#D=!1;#P=!1;#O=null;#k=null;#U=null;#B=null;#q=null;#T=At.NONE;#w=new Set;#L=null;#j=null;#H=null;#Y=null;#X=null;#$={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#I=[0,0];#z=null;#V=null;#W=null;#J=null;#F=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=Vn.prototype,i=c=>c.#V.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&c.hasSomethingToControl(),s=(c,{target:u})=>{if(u instanceof HTMLInputElement){const{type:h}=u;return h!=="text"&&h!=="number"}return!0},r=this.TRANSLATE_SMALL,l=this.TRANSLATE_BIG;return wt(this,"_keyboardManager",new Lr([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],t.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:s}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#V.contains(u)&&!c.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#V.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-l,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[l,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-l],checker:i}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,l],checker:i}]]))}constructor(t,i,s,r,l,c,u,h,f,m,y,b,A,w,S,E){const _=this._signal=this.#t.signal;this.#V=t,this.#W=i,this.#J=s,this.#a=r,this.#l=l,this.#j=c,this.#X=h,this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:_}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:_}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:_}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:_}),u._on("setpreference",this.onSetPreference.bind(this),{signal:_}),u._on("switchannotationeditorparams",D=>this.updateParams(D.type,D.value),{signal:_}),window.addEventListener("pointerdown",()=>{this.#D=!0},{capture:!0,signal:_}),window.addEventListener("pointerup",()=>{this.#D=!1},{capture:!0,signal:_}),this.#rt(),this.#dt(),this.#et(),this.#s=h.annotationStorage,this.#E=h.filterFactory,this.#H=f,this.#C=m||null,this.#y=y,this.#v=b,this.#b=A,this.#q=w||null,this.viewParameters={realScale:Aa.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=S||null,this._supportsPinchToZoom=E!==!1,l?.setSidebarUiManager(this)}destroy(){this.#F?.resolve(),this.#F=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#r.values())t.destroy();this.#r.clear(),this.#i.clear(),this.#p.clear(),this.#B?.clear(),this.#e=null,this.#w.clear(),this.#c.destroy(),this.#a?.destroy(),this.#l?.destroy(),this.#j?.destroy(),this.#_?.hide(),this.#_=null,this.#U?.destroy(),this.#U=null,this.#n=null,this.#x&&(clearTimeout(this.#x),this.#x=null),this.#z&&(clearTimeout(this.#z),this.#z=null),this._editorUndoBar?.destroy(),this.#X=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#q}get useNewAltTextFlow(){return this.#v}get useNewAltTextWhenAddingImage(){return this.#b}get hcmFilter(){return wt(this,"hcmFilter",this.#H?this.#E.addHCMFilter(this.#H.foreground,this.#H.background):"none")}get direction(){return wt(this,"direction",getComputedStyle(this.#V).direction)}get _highlightColors(){return wt(this,"_highlightColors",this.#C?new Map(this.#C.split(",").map(t=>(t=t.split("=").map(i=>i.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return wt(this,"highlightColors",null);const i=new Map,s=!!this.#H;for(const[r,l]of t){const c=r.endsWith("_HCM");if(s&&c){i.set(r.replace("_HCM",""),l);continue}!s&&!c&&i.set(r,l)}return wt(this,"highlightColors",i)}get highlightColorNames(){return wt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const i=this.highlightColorNames.get(t);return this._highlightColors.get(i)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=t}setMainHighlightColorPicker(t){this.#U=t}editAltText(t,i=!1){this.#a?.editAltText(this,t,i)}hasCommentManager(){return!!this.#l}editComment(t,i,s,r){this.#l?.showDialog(this,t,i,s,r)}selectComment(t,i){this.#r.get(t)?.getEditorByUID(i)?.toggleComment(!0,!0)}updateComment(t){this.#l?.updateComment(t.getData())}updatePopupColor(t){this.#l?.updatePopupColor(t)}removeComment(t){this.#l?.removeComments([t.uid])}toggleComment(t,i,s=void 0){this.#l?.toggleCommentPopup(t,i,s)}makeCommentColor(t,i){return t&&this.#l?.makeCommentColor(t,i)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(t){if(this.#r.has(t-1))return;const{resolve:i,promise:s}=Promise.withResolvers(),r=l=>{l.pageNumber===t&&(this._eventBus._off("editorsrendered",r),i())};this._eventBus.on("editorsrendered",r),await s}getSignature(t){this.#j?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#j}switchToMode(t,i){this._eventBus.on("annotationeditormodechanged",i,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,i){this._eventBus.dispatch("setpreference",{source:this,name:t,value:i})}onSetPreference({name:t,value:i}){switch(t){case"enableNewAltTextWhenAddingImage":this.#b=i;break}}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#V.focus()}findParent(t,i){for(const s of this.#r.values()){const{x:r,y:l,width:c,height:u}=s.div.getBoundingClientRect();if(t>=r&&t<=r+c&&i>=l&&i<=l+u)return s}return null}disableUserSelect(t=!1){this.#W.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Aa.PDF_TO_CSS_UNITS;for(const i of this.#p)i.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#Z({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:i}=this;if(i.hasTextLayer(t))return i;for(const s of this.#r.values())if(s.hasTextLayer(t))return s;return null}highlightSelection(t="",i=!1){const s=document.getSelection();if(!s||s.isCollapsed)return;const{anchorNode:r,anchorOffset:l,focusNode:c,focusOffset:u}=s,h=s.toString(),m=this.#Z(s).closest(".textLayer"),y=this.getSelectionBoxes(m);if(!y)return;s.empty();const b=this.#tt(m),A=this.#T===At.NONE,w=()=>{const S=b?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:y,anchorNode:r,anchorOffset:l,focusNode:c,focusOffset:u,text:h});A&&this.showAllEditors("highlight",!0,!0),i&&S?.editComment()};if(A){this.switchToMode(At.HIGHLIGHT,w);return}w()}commentSelection(t=""){this.highlightSelection(t,!0)}#st(){const t=document.getSelection();if(!t||t.isCollapsed)return;const s=this.#Z(t).closest(".textLayer"),r=this.getSelectionBoxes(s);r&&(this.#_||=new Av(this),this.#_.show(s,r,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#s)return null;const i=`${_r}${t}`,s=this.#s.getRawValue(i);return s&&this.#s.remove(i),s}addToAnnotationStorage(t){!t.isEmpty()&&this.#s&&!this.#s.has(t.id)&&this.#s.setValue(t.id,t)}a11yAlert(t,i=null){const s=this.#J;s&&(s.setAttribute("data-l10n-id",t),i?s.setAttribute("data-l10n-args",JSON.stringify(i)):s.removeAttribute("data-l10n-args"))}#at(){const t=document.getSelection();if(!t||t.isCollapsed){this.#L&&(this.#_?.hide(),this.#L=null,this.#N({hasSelectedText:!1}));return}const{anchorNode:i}=t;if(i===this.#L)return;const r=this.#Z(t).closest(".textLayer");if(!r){this.#L&&(this.#_?.hide(),this.#L=null,this.#N({hasSelectedText:!1}));return}if(this.#_?.hide(),this.#L=i,this.#N({hasSelectedText:!0}),!(this.#T!==At.HIGHLIGHT&&this.#T!==At.NONE)&&(this.#T===At.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#A=this.isShiftKeyDown,!this.isShiftKeyDown)){const l=this.#T===At.HIGHLIGHT?this.#tt(r):null;if(l?.toggleDrawing(),this.#D){const c=new AbortController,u=this.combinedSignal(c),h=f=>{f.type==="pointerup"&&f.button!==0||(c.abort(),l?.toggleDrawing(!0),f.type==="pointerup"&&this.#K("main_toolbar"))};window.addEventListener("pointerup",h,{signal:u}),window.addEventListener("blur",h,{signal:u})}else l?.toggleDrawing(!0),this.#K("main_toolbar")}}#K(t=""){this.#T===At.HIGHLIGHT?this.highlightSelection(t):this.#y&&this.#st()}#rt(){document.addEventListener("selectionchange",this.#at.bind(this),{signal:this._signal})}#ot(){if(this.#S)return;this.#S=new AbortController;const t=this.combinedSignal(this.#S);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#lt(){this.#S?.abort(),this.#S=null}blur(){if(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#K("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const i of this.#w)if(i.div.contains(t)){this.#k=[i,t],i._focusEventsAllowed=!1;break}}focus(){if(!this.#k)return;const[t,i]=this.#k;this.#k=null,i.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),i.focus()}#et(){if(this.#O)return;this.#O=new AbortController;const t=this.combinedSignal(this.#O);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ct(){this.#O?.abort(),this.#O=null}#ut(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#ht(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.setEditingState(!0)}removeEditListeners(){this.#ct(),this.setEditingState(!1)}dragOver(t){for(const{type:i}of t.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(i)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const i of t.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(i.type)){s.paste(i,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const i=[];for(const s of this.#w){const r=s.serialize(!0);r&&i.push(r)}i.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(i))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:i}=t;for(const l of i.items)for(const c of this.#u)if(c.isHandlingMimeForPasting(l.type)){c.paste(l,this.currentLayer);return}let s=i.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(l){mt(`paste: "${l.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const r=this.currentLayer;try{const l=[];for(const h of s){const f=await r.deserialize(h);if(!f)return;l.push(f)}const c=()=>{for(const h of l)this.#it(h);this.#nt(l)},u=()=>{for(const h of l)h.remove()};this.addCommands({cmd:c,undo:u,mustExec:!0})}catch(l){mt(`paste: "${l.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#T!==At.NONE&&!this.isEditorHandlingKeyboard&&Vn._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#K("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#N(t){Object.entries(t).some(([s,r])=>this.#$[s]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#$,t)}),this.#T===At.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#G([[Rt.HIGHLIGHT_FREE,!0]]))}#G(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ot(),this.#ut(),this.#N({isEditing:this.#T!==At.NONE,isEmpty:this.#Q(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#lt(),this.#ht(),this.#N({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#u){this.#u=t;for(const i of this.#u)this.#G(i.defaultPropertiesToUpdate)}}getId(){return this.#R.id}get currentLayer(){return this.#r.get(this.#f)}getLayer(t){return this.#r.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#r.set(t.pageIndex,t),this.#M?t.enable():t.disable()}removeLayer(t){this.#r.delete(t.pageIndex)}async updateMode(t,i=null,s=!1,r=!1,l=!1){if(this.#T!==t&&!(this.#F&&(await this.#F.promise,!this.#F))){if(this.#F=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#T===At.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#T=t,t===At.NONE){this.setEditingState(!1),this.#pt();for(const c of this.#i.values())c.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#F.resolve();return}for(const c of this.#i.values())c.addStandaloneCommentButton();t===At.SIGNATURE&&await this.#j?.loadSignatures(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const c of this.#r.values())c.updateMode(t);if(t===At.POPUP){this.#n||=await this.#X.getAnnotationsByType(new Set(this.#u.map(h=>h._editorType)));const c=new Set,u=[];for(const h of this.#i.values()){const{annotationElementId:f,hasComment:m,deleted:y}=h;f&&c.add(f),m&&!y&&u.push(h.getData())}for(const h of this.#n){const{id:f,popupRef:m,contentsObj:y}=h;m&&y?.str&&!c.has(f)&&!this.#m.has(f)&&u.push(h)}this.#l?.showSidebar(u)}if(!i){s&&this.addNewEditorFromKeyboard(),this.#F.resolve();return}for(const c of this.#i.values())c.uid===i?(this.setSelected(c),l?c.editComment():r?c.enterInEditMode():c.focus()):c.unselect();this.#F.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#T&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,i){if(this.#u){switch(t){case Rt.CREATE:this.currentLayer.addNewEditor(i);return;case Rt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#Y||=new Map).set(t,i),this.showAllEditors("highlight",i);break}if(this.hasSelection)for(const s of this.#w)s.updateParams(t,i);else for(const s of this.#u)s.updateDefaultParams(t,i)}}showAllEditors(t,i,s=!1){for(const l of this.#i.values())l.editorType===t&&l.show(i);(this.#Y?.get(Rt.HIGHLIGHT_SHOW_ALL)??!0)!==i&&this.#G([[Rt.HIGHLIGHT_SHOW_ALL,i]])}enableWaiting(t=!1){if(this.#P!==t){this.#P=t;for(const i of this.#r.values())t?i.disableClick():i.enableClick(),i.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#M){this.#M=!0;const t=[];for(const i of this.#r.values())t.push(i.enable());await Promise.all(t);for(const i of this.#i.values())i.enable()}}#pt(){if(this.unselectAll(),this.#M){this.#M=!1;for(const t of this.#r.values())t.disable();for(const t of this.#i.values())t.disable()}}*getEditors(t){for(const i of this.#i.values())i.pageIndex===t&&(yield i)}getEditor(t){return this.#i.get(t)}addEditor(t){this.#i.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#x&&clearTimeout(this.#x),this.#x=setTimeout(()=>{this.focusMainContainer(),this.#x=null},0)),this.#i.delete(t.id),t.annotationElementId&&this.#B?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#m.has(t.annotationElementId))&&this.#s?.remove(t.id)}addDeletedAnnotationElement(t){this.#m.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#m.has(t)}removeDeletedAnnotationElement(t){this.#m.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#it(t){const i=this.#r.get(t.pageIndex);i?i.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#G(t.propertiesToUpdate))}get#gt(){let t=null;for(t of this.#w);return t}updateUI(t){this.#gt===t&&this.#G(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#G(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#w.has(t)){this.#w.delete(t),t.unselect(),this.#N({hasSelectedEditor:this.hasSelection});return}this.#w.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#N({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.uid}),this.#h?.commitOrRemove();for(const i of this.#w)i!==t&&i.unselect();this.#w.clear(),this.#w.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#N({hasSelectedEditor:!0})}isSelected(t){return this.#w.has(t)}get firstSelectedEditor(){return this.#w.values().next().value}unselect(t){t.unselect(),this.#w.delete(t),this.#N({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#w.size!==0}get isEnterHandled(){return this.#w.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#N({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#Q()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#N({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#Q()})}addCommands(t){this.#c.add(t),this.#N({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#Q()})}cleanUndoStack(t){this.#c.cleanType(t)}#Q(){if(this.#i.size===0)return!0;if(this.#i.size===1)for(const t of this.#i.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const i=t?[t]:[...this.#w],s=()=>{this._editorUndoBar?.show(r,i.length===1?i[0].editorType:i.length);for(const l of i)l.remove()},r=()=>{for(const l of i)this.#it(l)};this.addCommands({cmd:s,undo:r,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#nt(t){for(const i of this.#w)i.unselect();this.#w.clear();for(const i of t)i.isEmpty()||(this.#w.add(i),i.select());this.#N({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#w)t.commit();this.#nt(this.#i.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#T!==At.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const t of this.#w)t.unselect();this.#w.clear(),this.#N({hasSelectedEditor:!1})}}translateSelectedEditors(t,i,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;this.#I[0]+=t,this.#I[1]+=i;const[r,l]=this.#I,c=[...this.#w],u=1e3;this.#z&&clearTimeout(this.#z),this.#z=setTimeout(()=>{this.#z=null,this.#I[0]=this.#I[1]=0,this.addCommands({cmd:()=>{for(const h of c)this.#i.has(h.id)&&(h.translateInPage(r,l),h.translationDone())},undo:()=>{for(const h of c)this.#i.has(h.id)&&(h.translateInPage(-r,-l),h.translationDone())},mustExec:!1})},u);for(const h of c)h.translateInPage(t,i),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#g=new Map;for(const t of this.#w)this.#g.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#g)return!1;this.disableUserSelect(!1);const t=this.#g;this.#g=null;let i=!1;for(const[{x:r,y:l,pageIndex:c},u]of t)u.newX=r,u.newY=l,u.newPageIndex=c,i||=r!==u.savedX||l!==u.savedY||c!==u.savedPageIndex;if(!i)return!1;const s=(r,l,c,u)=>{if(this.#i.has(r.id)){const h=this.#r.get(u);h?r._setParentAndPosition(h,l,c):(r.pageIndex=u,r.x=l,r.y=c)}};return this.addCommands({cmd:()=>{for(const[r,{newX:l,newY:c,newPageIndex:u}]of t)s(r,l,c,u)},undo:()=>{for(const[r,{savedX:l,savedY:c,savedPageIndex:u}]of t)s(r,l,c,u)},mustExec:!0}),!0}dragSelectedEditors(t,i){if(this.#g)for(const s of this.#g.keys())s.drag(t,i)}rebuild(t){if(t.parent===null){const i=this.getLayer(t.pageIndex);i?(i.changeParent(t),i.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#w.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#T}isEditingMode(){return this.#T!==At.NONE}get imageManager(){return wt(this,"imageManager",new Ah)}getSelectionBoxes(t){if(!t)return null;const i=document.getSelection();for(let f=0,m=i.rangeCount;f<m;f++)if(!t.contains(i.getRangeAt(f).commonAncestorContainer))return null;const{x:s,y:r,width:l,height:c}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(f,m,y,b)=>({x:(m-r)/c,y:1-(f+y-s)/l,width:b/c,height:y/l});break;case"180":u=(f,m,y,b)=>({x:1-(f+y-s)/l,y:1-(m+b-r)/c,width:y/l,height:b/c});break;case"270":u=(f,m,y,b)=>({x:1-(m+b-r)/c,y:(f-s)/l,width:b/c,height:y/l});break;default:u=(f,m,y,b)=>({x:(f-s)/l,y:(m-r)/c,width:y/l,height:b/c});break}const h=[];for(let f=0,m=i.rangeCount;f<m;f++){const y=i.getRangeAt(f);if(!y.collapsed)for(const{x:b,y:A,width:w,height:S}of y.getClientRects())w===0||S===0||h.push(u(b,A,w,S))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:t,id:i}){(this.#o||=new Map).set(t,i)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const i=this.#o?.get(t.data.id);if(!i)return;const s=this.#s.getRawValue(i);s&&(this.#T===At.NONE&&!s.hasBeenModified||s.renderAnnotationElement(t))}setMissingCanvas(t,i,s){const r=this.#B?.get(t);r&&(r.setCanvas(i,s),this.#B.delete(t))}addMissingCanvas(t,i){(this.#B||=new Map).set(t,i)}}class Vi{#t=null;#e=!1;#n=null;#i=null;#r=null;#a=null;#s=!1;#o=null;#c=null;#l=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(t){this.#c=t,this.#h=t._uiManager.useNewAltTextFlow,Vi.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){Vi._l10n??=t}async render(){const t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";const i=this.#i=document.createElement("span");t.append(i),this.#h?(t.classList.add("new"),t.setAttribute("data-l10n-id",Vi.#f.missing),i.setAttribute("data-l10n-id",Vi.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=this.#c._uiManager._signal;t.addEventListener("contextmenu",Ei,{signal:s}),t.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:s});const r=l=>{l.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#m}})};return t.addEventListener("click",r,{capture:!0,signal:s}),t.addEventListener("keydown",l=>{l.target===t&&l.key==="Enter"&&(this.#s=!0,r(l))},{signal:s}),await this.#g(),t}get#m(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#s}),this.#s=!1)}isEmpty(){return this.#h?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#h?this.#t!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(t){this.#t===null&&(this.#l=t,this.#d=await Vi._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#g())}toggleAltTextBadge(t=!1){if(!this.#h||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const i=this.#o=document.createElement("div");i.className="noAltTextBadge",this.#c.div.append(i)}this.#o.classList.toggle("hidden",!t)}serialize(t){let i=this.#t;return!t&&this.#l===i&&(i=this.#d),{altText:i,decorative:this.#e,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:i,guessedText:s,textWithDisclaimer:r,cancel:l=!1}){s&&(this.#l=s,this.#d=r),!(this.#t===t&&this.#e===i)&&(l||(this.#t=t,this.#e=i),this.#g())}toggle(t=!1){this.#n&&(!t&&this.#a&&(clearTimeout(this.#a),this.#a=null),this.#n.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#m}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#r=null,this.#o?.remove(),this.#o=null}async#g(){const t=this.#n;if(!t)return;if(this.#h){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",Vi.#f[this.#m]),this.#i?.setAttribute("data-l10n-id",Vi.#f[`${this.#m}-label`]),!this.#t){this.#r?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#r?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let i=this.#r;if(!i){this.#r=i=document.createElement("span"),i.className="tooltip",i.setAttribute("role","tooltip"),i.id=`alt-text-tooltip-${this.#c.id}`;const r=100,l=this.#c._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(this.#a),this.#a=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#a=setTimeout(()=>{this.#a=null,this.#r.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},r)},{signal:l}),t.addEventListener("mouseleave",()=>{this.#a&&(clearTimeout(this.#a),this.#a=null),this.#r?.classList.remove("show")},{signal:l})}this.#e?i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(i.removeAttribute("data-l10n-id"),i.textContent=this.#t),i.parentNode||t.append(i),this.#c.getElementForAltText()?.setAttribute("aria-describedby",i.id)}}class Jo{#t=null;#e=null;#n=!1;#i=null;#r=null;#a=null;#s=null;#o=null;#c=!1;#l=null;constructor(t){this.#i=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const i=this.#i.commentButtonPosition;if(i){const{style:s}=t;s.insetInlineEnd=`calc(${100*(this.#i._uiManager.direction==="ltr"?1-i[0]:i[0])}% - var(--comment-button-dim))`,s.top=`calc(${100*i[1]}% - var(--comment-button-dim))`;const r=this.#i.commentButtonColor;r&&(s.backgroundColor=r)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#i.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#i._uiManager.updatePopupColor(this.#i)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#i.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#t)return null;const{x:t,y:i,height:s}=this.#t.getBoundingClientRect(),{x:r,y:l,width:c,height:u}=this.#i.parent.boundingClientRect;return[(t-r)/c,(i+s-l)/u]}set commentPopupPositionInLayer(t){this.#l=t}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:i}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=i)}#d(t,i){if(!this.#i._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",i?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#i._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const s=this.#i._uiManager._signal;if(!(s instanceof AbortSignal)||s.aborted)return t;t.addEventListener("contextmenu",Ei,{signal:s}),i&&(t.addEventListener("focusin",l=>{this.#i._focusEventsAllowed=!1,re(l)},{capture:!0,signal:s}),t.addEventListener("focusout",l=>{this.#i._focusEventsAllowed=!0,re(l)},{capture:!0,signal:s})),t.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:s});const r=l=>{l.preventDefault(),t===this.#e?this.edit():this.#i.toggleComment(!0)};return t.addEventListener("click",r,{capture:!0,signal:s}),t.addEventListener("keydown",l=>{l.target===t&&l.key==="Enter"&&(this.#n=!0,r(l))},{signal:s}),t.addEventListener("pointerenter",()=>{this.#i.toggleComment(!1,!0)},{signal:s}),t.addEventListener("pointerleave",()=>{this.#i.toggleComment(!1,!1)},{signal:s}),t}edit(t){const i=this.commentPopupPositionInLayer;let s,r;if(i)[s,r]=i;else{[s,r]=this.#i.commentButtonPosition;const{width:m,height:y,x:b,y:A}=this.#i;s=b+s*m,r=A+r*y}const l=this.#i.parent.boundingClientRect,{x:c,y:u,width:h,height:f}=l;this.#i._uiManager.editComment(this.#i,c+s*h,u+r*f,{...t,parentDimensions:l})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#n}),this.#n=!1)}isDeleted(){return this.#c||this.#s===""}isEmpty(){return this.#s===null}hasBeenEdited(){return this.isDeleted()||this.#s!==this.#r}serialize(){return this.data}get data(){return{text:this.#s,richText:this.#a,date:this.#o,deleted:this.isDeleted()}}set data(t){if(t!==this.#s&&(this.#a=null),t===null){this.#s="",this.#c=!0;return}this.#s=t,this.#o=new Date,this.#c=!1}setInitialText(t,i=null){this.#r=t,this.data=t,this.#o=null,this.#a=i}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#s="",this.#a=null,this.#o=null,this.#i=null,this.#n=!1,this.#c=!1}}class Al{#t;#e=!1;#n=null;#i;#r;#a;#s;#o=null;#c;#l=null;#d;#h=null;constructor({container:t,isPinchingDisabled:i=null,isPinchingStopped:s=null,onPinchStart:r=null,onPinching:l=null,onPinchEnd:c=null,signal:u}){this.#t=t,this.#n=s,this.#i=i,this.#r=r,this.#a=l,this.#s=c,this.#d=new AbortController,this.#c=AbortSignal.any([u,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Xi.pixelRatio}#f(t){if(this.#i?.())return;if(t.touches.length===1){if(this.#o)return;const r=this.#o=new AbortController,l=AbortSignal.any([this.#c,r.signal]),c=this.#t,u={capture:!0,signal:l,passive:!1},h=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};c.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(re(f),h(f))},u),c.addEventListener("pointerup",h,u),c.addEventListener("pointercancel",h,u);return}if(!this.#h){this.#h=new AbortController;const r=AbortSignal.any([this.#c,this.#h.signal]),l=this.#t,c={signal:r,capture:!1,passive:!1};l.addEventListener("touchmove",this.#m.bind(this),c);const u=this.#g.bind(this);l.addEventListener("touchend",u,c),l.addEventListener("touchcancel",u,c),c.capture=!0,l.addEventListener("pointerdown",re,c),l.addEventListener("pointermove",re,c),l.addEventListener("pointercancel",re,c),l.addEventListener("pointerup",re,c),this.#r?.()}if(re(t),t.touches.length!==2||this.#n?.()){this.#l=null;return}let[i,s]=t.touches;i.identifier>s.identifier&&([i,s]=[s,i]),this.#l={touch0X:i.screenX,touch0Y:i.screenY,touch1X:s.screenX,touch1Y:s.screenY}}#m(t){if(!this.#l||t.touches.length!==2)return;re(t);let[i,s]=t.touches;i.identifier>s.identifier&&([i,s]=[s,i]);const{screenX:r,screenY:l}=i,{screenX:c,screenY:u}=s,h=this.#l,{touch0X:f,touch0Y:m,touch1X:y,touch1Y:b}=h,A=y-f,w=b-m,S=c-r,E=u-l,_=Math.hypot(S,E)||1,D=Math.hypot(A,w)||1;if(!this.#e&&Math.abs(D-_)<=Al.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=r,h.touch0Y=l,h.touch1X=c,h.touch1Y=u,!this.#e){this.#e=!0;return}const T=[(r+c)/2,(l+u)/2];this.#a?.(T,D,_)}#g(t){t.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#s?.()),this.#l&&(re(t),this.#l=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class lt{#t=null;#e=null;#n=null;#i=null;#r=null;#a=!1;#s=null;#o="";#c=null;#l=null;#d=null;#h=null;#f=null;#m="";#g=!1;#u=null;#p=!1;#y=!1;#v=!1;#b=null;#E=0;#x=0;#S=null;#C=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#A=!1;#_=lt._zIndex++;static _borderLineWidth=-1;static _colorManager=new Sh;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=lt.prototype._resizeWithKeyboard,i=Vn.TRANSLATE_SMALL,s=Vn.TRANSLATE_BIG;return wt(this,"_resizerKeyboardManager",new Lr([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-i,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[i,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-i]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,i]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,s]}],[["Escape","mac+Escape"],lt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null,this.canAddComment=!0;const{rotation:i,rawDims:{pageWidth:s,pageHeight:r,pageX:l,pageY:c}}=this.parent.viewport;this.rotation=i,this.pageRotation=(360+i-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,r],this.pageTranslation=[l,c];const[u,h]=this.parentDimensions;this.x=t.x/u,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return wt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const i=new xv({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});i.annotationElementId=t.annotationElementId,i.deleted=!0,i._uiManager.addToAnnotationStorage(i)}static initialize(t,i){if(lt._l10n??=t,lt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),lt._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);lt._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,i){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,i){$t("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#A}set _isDraggable(t){this.#A=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,i]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*i/(t*2),this.y+=this.width*t/(i*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*i/(t*2),this.y-=this.width*t/(i*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#_}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#z(),this.#h?.remove(),this.#h=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#g?this.#g=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,i,s,r){const[l,c]=this.parentDimensions;[s,r]=this.screenToPageTranslation(s,r),this.x=(t+s)/l,this.y=(i+r)/c,this.fixAndSetPosition()}_moveAfterPaste(t,i){const[s,r]=this.parentDimensions;this.setAt(t*s,i*r,this.width*s,this.height*r),this._onTranslated()}#R([t,i],s,r){[s,r]=this.screenToPageTranslation(s,r),this.x+=s/t,this.y+=r/i,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,i){this.#R(this.parentDimensions,t,i)}translateInPage(t,i){this.#u||=[this.x,this.y,this.width,this.height],this.#R(this.pageDimensions,t,i),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,i){this.#u||=[this.x,this.y,this.width,this.height];const{div:s,parentDimensions:[r,l]}=this;if(this.x+=t/r,this.y+=i/l,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:y,y:b}=this.div.getBoundingClientRect();this.parent.findNewParent(this,y,b)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:c,y:u}=this;const[h,f]=this.getBaseTranslation();c+=h,u+=f;const{style:m}=s;m.left=`${(100*c).toFixed(2)}%`,m.top=`${(100*u).toFixed(2)}%`,this._onTranslating(c,u),s.scrollIntoView({block:"nearest"})}_onTranslating(t,i){}_onTranslated(t,i){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[t,i]=this.parentDimensions,{_borderLineWidth:s}=lt,r=s/t,l=s/i;switch(this.rotation){case 90:return[-r,l];case 180:return[r,l];case 270:return[r,-l];default:return[-r,-l]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:i},pageDimensions:[s,r]}=this;let{x:l,y:c,width:u,height:h}=this;if(u*=s,h*=r,l*=s,c*=r,this._mustFixPosition)switch(t){case 0:l=Fe(l,0,s-u),c=Fe(c,0,r-h);break;case 90:l=Fe(l,0,s-h),c=Fe(c,u,r);break;case 180:l=Fe(l,u,s),c=Fe(c,h,r);break;case 270:l=Fe(l,h,s),c=Fe(c,0,r-u);break}this.x=l/=s,this.y=c/=r;const[f,m]=this.getBaseTranslation();l+=f,c+=m,i.left=`${(100*l).toFixed(2)}%`,i.top=`${(100*c).toFixed(2)}%`,this.moveInDOM()}static#M(t,i,s){switch(s){case 90:return[i,-t];case 180:return[-t,-i];case 270:return[-i,t];default:return[t,i]}}screenToPageTranslation(t,i){return lt.#M(t,i,this.parentRotation)}pageTranslationToScreen(t,i){return lt.#M(t,i,360-this.parentRotation)}#D(t){switch(t){case 90:{const[i,s]=this.pageDimensions;return[0,-i/s,s/i,0]}case 180:return[-1,0,0,-1];case 270:{const[i,s]=this.pageDimensions;return[0,i/s,-s/i,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[i,s]}=this;return[i*t,s*t]}setDims(){const{div:{style:t},width:i,height:s}=this;t.width=`${(100*i).toFixed(2)}%`,t.height=`${(100*s).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#P(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],i=this._uiManager._signal;for(const s of t){const r=document.createElement("div");this.#c.append(r),r.classList.add("resizer",s),r.setAttribute("data-resizer-name",s),r.addEventListener("pointerdown",this.#O.bind(this,s),{signal:i}),r.addEventListener("contextmenu",Ei,{signal:i}),r.tabIndex=-1}this.div.prepend(this.#c)}#O(t,i){i.preventDefault();const{isMac:s}=Oe.platform;if(i.button!==0||i.ctrlKey&&s)return;this.#n?.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,this.#l=[i.screenX,i.screenY];const l=new AbortController,c=this._uiManager.combinedSignal(l);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#B.bind(this,t),{passive:!0,capture:!0,signal:c}),window.addEventListener("touchmove",re,{passive:!1,signal:c}),window.addEventListener("contextmenu",Ei,{signal:c}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(i.target).cursor;const f=()=>{l.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=u,this.div.style.cursor=h,this.#U()};window.addEventListener("pointerup",f,{signal:c}),window.addEventListener("blur",f,{signal:c})}#k(t,i,s,r){this.width=s,this.height=r,this.x=t,this.y=i,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#U(){if(!this.#d)return;const{savedX:t,savedY:i,savedWidth:s,savedHeight:r}=this.#d;this.#d=null;const l=this.x,c=this.y,u=this.width,h=this.height;l===t&&c===i&&u===s&&h===r||this.addCommands({cmd:this.#k.bind(this,l,c,u,h),undo:this.#k.bind(this,t,i,s,r),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#B(t,i){const[s,r]=this.parentDimensions,l=this.x,c=this.y,u=this.width,h=this.height,f=lt.MIN_SIZE/s,m=lt.MIN_SIZE/r,y=this.#D(this.rotation),b=(k,V)=>[y[0]*k+y[2]*V,y[1]*k+y[3]*V],A=this.#D(360-this.rotation),w=(k,V)=>[A[0]*k+A[2]*V,A[1]*k+A[3]*V];let S,E,_=!1,D=!1;switch(t){case"topLeft":_=!0,S=(k,V)=>[0,0],E=(k,V)=>[k,V];break;case"topMiddle":S=(k,V)=>[k/2,0],E=(k,V)=>[k/2,V];break;case"topRight":_=!0,S=(k,V)=>[k,0],E=(k,V)=>[0,V];break;case"middleRight":D=!0,S=(k,V)=>[k,V/2],E=(k,V)=>[0,V/2];break;case"bottomRight":_=!0,S=(k,V)=>[k,V],E=(k,V)=>[0,0];break;case"bottomMiddle":S=(k,V)=>[k/2,V],E=(k,V)=>[k/2,0];break;case"bottomLeft":_=!0,S=(k,V)=>[0,V],E=(k,V)=>[k,0];break;case"middleLeft":D=!0,S=(k,V)=>[0,V/2],E=(k,V)=>[k,V/2];break}const T=S(u,h),B=E(u,h);let O=b(...B);const L=lt._round(l+O[0]),P=lt._round(c+O[1]);let q=1,K=1,J,W;if(i.fromKeyboard)({deltaX:J,deltaY:W}=i);else{const{screenX:k,screenY:V}=i,[tt,pt]=this.#l;[J,W]=this.screenToPageTranslation(k-tt,V-pt),this.#l[0]=k,this.#l[1]=V}if([J,W]=w(J/s,W/r),_){const k=Math.hypot(u,h);q=K=Math.max(Math.min(Math.hypot(B[0]-T[0]-J,B[1]-T[1]-W)/k,1/u,1/h),f/u,m/h)}else D?q=Fe(Math.abs(B[0]-T[0]-J),f,1)/u:K=Fe(Math.abs(B[1]-T[1]-W),m,1)/h;const ht=lt._round(u*q),yt=lt._round(h*K);O=b(...E(ht,yt));const bt=L-O[0],vt=P-O[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=ht,this.height=yt,this.x=bt,this.y=vt,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#y)return this._editToolbar;this._editToolbar=new xr(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[i,s]of t)await this._editToolbar.addButton(i,s);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#n?.destroy()}addContainer(t){const i=this._editToolbar?.div;i?i.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#n||(Vi.initialize(lt._l10n),this.#n=new Vi(this),this.#t&&(this.#n.data=this.#t,this.#t=null)),this.#n}get altTextData(){return this.#n?.data}set altTextData(t){this.#n&&(this.#n.data=t)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(t){await this.#n?.setGuessedText(t)}serializeAltText(t){return this.#n?.serialize(t)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}focusCommentButton(){this.#i?.focusButton()}addCommentButton(){return this.canAddComment?this.#i||=new Jo(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#r){this._uiManager.isEditingMode()&&this.#r.classList.remove("hidden");return}this.hasComment&&(this.#r=this.#i.renderForStandalone(),this.div.append(this.#r))}}removeStandaloneCommentButton(){this.#i.removeStandaloneCommentButton(),this.#r=null}hideStandaloneCommentButton(){this.#r?.classList.add("hidden")}get comment(){const{data:{richText:t,text:i,date:s,deleted:r}}=this.#i;return{text:i,richText:t,date:s,deleted:r,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#i||=new Jo(this),this.#i.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:i,richText:s}){if(!i||(this.#i||=new Jo(this),this.#i.setInitialText(t,s),!this.annotationElementId))return;const r=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);r&&this.updateFromAnnotationLayer(r)}get hasEditedComment(){return this.#i?.hasBeenEdited()}get hasDeletedComment(){return this.#i?.isDeleted()}get hasComment(){return!!this.#i&&!this.#i.isEmpty()&&!this.#i.isDeleted()}async editComment(t){this.#i||=new Jo(this),this.#i.edit(t)}toggleComment(t,i=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,i)}setSelectedCommentButton(t){this.#i.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,r]=t.rect,[l]=this.pageDimensions,[c]=this.pageTranslation,u=c+l+1,h=r-100,f=u+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,h,f,r]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:i}}){this.#i.data=i?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#a?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#H();const[i,s]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*s/i).toFixed(2)}%`,t.style.maxHeight=`${(100*i/s).toFixed(2)}%`);const[r,l]=this.getInitialTranslation();return this.translate(r,l),km(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#C||=new Al({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#q.bind(this),onPinching:this.#T.bind(this),onPinchEnd:this.#w.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#q(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#T(t,i,s){let l=.7*(s/i)+1-.7;if(l===1)return;const c=this.#D(this.rotation),u=(L,P)=>[c[0]*L+c[2]*P,c[1]*L+c[3]*P],[h,f]=this.parentDimensions,m=this.x,y=this.y,b=this.width,A=this.height,w=lt.MIN_SIZE/h,S=lt.MIN_SIZE/f;l=Math.max(Math.min(l,1/b,1/A),w/b,S/A);const E=lt._round(b*l),_=lt._round(A*l);if(E===b&&_===A)return;this.#u||=[m,y,b,A];const D=u(b/2,A/2),T=lt._round(m+D[0]),B=lt._round(y+D[1]),O=u(E/2,_/2);this.x=T-O[0],this.y=B-O[1],this.width=E,this.height=_,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#w(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#U()}pointerdown(t){const{isMac:i}=Oe.platform;if(t.button!==0||t.ctrlKey&&i){t.preventDefault();return}if(this.#g=!0,this._isDraggable){this.#j(t);return}this.#L(t)}#L(t){const{isMac:i}=Oe.platform;t.ctrlKey&&!i||t.shiftKey||t.metaKey&&i?this.parent.toggleSelected(this):this.parent.setSelected(this)}#j(t){const{isSelected:i}=this;this._uiManager.setUpDragSession();let s=!1;const r=new AbortController,l=this._uiManager.combinedSignal(r),c={capture:!0,passive:!1,signal:l},u=f=>{r.abort(),this.#s=null,this.#g=!1,this._uiManager.endDragSession()||this.#L(f),s&&this._onStopDragging()};i&&(this.#E=t.clientX,this.#x=t.clientY,this.#s=t.pointerId,this.#o=t.pointerType,window.addEventListener("pointermove",f=>{s||(s=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:m,clientY:y,pointerId:b}=f;if(b!==this.#s){re(f);return}const[A,w]=this.screenToPageTranslation(m-this.#E,y-this.#x);this.#E=m,this.#x=y,this._uiManager.dragSelectedEditors(A,w)},c),window.addEventListener("touchmove",re,c),window.addEventListener("pointerdown",f=>{f.pointerType===this.#o&&(this.#C||f.isPrimary)&&u(f),re(f)},c));const h=f=>{if(!this.#s||this.#s===f.pointerId){u(f);return}re(f)};window.addEventListener("pointerup",h,{signal:l}),window.addEventListener("blur",h,{signal:l})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#b&&clearTimeout(this.#b),this.#b=setTimeout(()=>{this.#b=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,i,s){t.changeParent(this),this.x=i,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(t,i,s=this.rotation){const r=this.parentScale,[l,c]=this.pageDimensions,[u,h]=this.pageTranslation,f=t/r,m=i/r,y=this.x*l,b=this.y*c,A=this.width*l,w=this.height*c;switch(s){case 0:return[y+f+u,c-b-m-w+h,y+f+A+u,c-b-m+h];case 90:return[y+m+u,c-b+f+h,y+m+w+u,c-b+f+A+h];case 180:return[y-f-A+u,c-b+m+h,y-f+u,c-b+m+w+h];case 270:return[y-m-w+u,c-b-f-A+h,y-m+u,c-b-f+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,i){const[s,r,l,c]=t,u=l-s,h=c-r;switch(this.rotation){case 0:return[s,i-c,u,h];case 90:return[s,i-r,h,u];case 180:return[l,i-r,u,h];case 270:return[l,i-c,h,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&lt._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#i?.onUpdatedColor()}getData(){const{comment:{text:t,color:i,date:s,opacity:r,deleted:l,richText:c},uid:u,pageIndex:h,creationDate:f,modificationDate:m}=this;return{id:u,pageIndex:h,rect:this.getPDFRect(),richText:c,contentsObj:{str:t},creationDate:f,modificationDate:s||m,popupRef:!l,color:i,opacity:r}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#y=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#y=!1,!0):!1}isInEditMode(){return this.#y}shouldGetKeyboardEvents(){return this.#v}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:i,bottom:s,right:r}=this.getClientDimensions(),{innerHeight:l,innerWidth:c}=window;return i<c&&r>0&&t<l&&s>0}#H(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#H()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,i=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,i,s){const r=new this.prototype.constructor({parent:i,id:i.getNextId(),uiManager:s,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});r.rotation=t.rotation,r.#t=t.accessibilityData,r._isCopy=t.isCopy||!1;const[l,c]=r.pageDimensions,[u,h,f,m]=r.getRectInCurrentCoords(t.rect,c);return r.x=u/l,r.y=h/c,r.width=f/l,r.height=m/c,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#b&&(clearTimeout(this.#b),this.#b=null),this.#z(),this.removeEditToolbar(),this.#S){for(const t of this.#S.values())clearTimeout(t);this.#S=null}this.parent=null,this.#C?.destroy(),this.#C=null,this.#h?.remove(),this.#h=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#P(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,i]}=this,[s,r,l,c]=this.getPDFRect();return[lt._round(s+(l-s)*t),lt._round(r+(c-r)*(1-i))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#i.commentPopupPositionInLayer}set commentPopupPosition(t){this.#i.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#i.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#i.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#i?.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const i=this.#c.children;if(!this.#e){this.#e=Array.from(i);const c=this.#Y.bind(this),u=this.#X.bind(this),h=this._uiManager._signal;for(const f of this.#e){const m=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",c,{signal:h}),f.addEventListener("blur",u,{signal:h}),f.addEventListener("focus",this.#$.bind(this,m),{signal:h}),f.setAttribute("data-l10n-id",lt._l10nResizer[m])}}const s=this.#e[0];let r=0;for(const c of i){if(c===s)break;r++}const l=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(l!==r){if(l<r)for(let u=0;u<r-l;u++)this.#c.append(this.#c.firstChild);else if(l>r)for(let u=0;u<l-r;u++)this.#c.firstChild.before(this.#c.lastChild);let c=0;for(const u of i){const f=this.#e[c++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",lt._l10nResizer[f])}}this.#I(0),this.#v=!0,this.#c.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#Y(t){lt._resizerKeyboardManager.exec(this,t)}#X(t){this.#v&&t.relatedTarget?.parentNode!==this.#c&&this.#z()}#$(t){this.#m=this.#v?t:""}#I(t){if(this.#e)for(const i of this.#e)i.tabIndex=t}_resizeWithKeyboard(t,i){this.#v&&this.#B(this.#m,{deltaX:t,deltaY:i,fromKeyboard:!0})}#z(){this.#v=!1,this.#I(-1),this.#U()}_stopResizingWithKeyboard(){this.#z(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(t,i){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(t){this.#p=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,i=!1){if(i){this.#S||=new Map;const{action:s}=t;let r=this.#S.get(s);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(t),this.#S.delete(s),this.#S.size===0&&(this.#S=null)},lt._telemetryTimeout),this.#S.set(s,r);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#a=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#a=!0}updateFakeAnnotationElement(t){if(!this.#h&&!this.deleted){this.#h=t.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let i=t.container.querySelector(".annotationContent");if(!i)i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),t.container.prepend(i);else if(i.nodeName==="CANVAS"){const s=i;i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),s.before(i)}return i}resetAnnotationElement(t){const{firstChild:i}=t.container;i?.nodeName==="DIV"&&i.classList.contains("annotationContent")&&i.remove()}}class xv extends lt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Wg=3285377520,wi=4294901760,Gi=65535;class Bm{constructor(t){this.h1=t?t&4294967295:Wg,this.h2=t?t&4294967295:Wg}update(t){let i,s;if(typeof t=="string"){i=new Uint8Array(t.length*2),s=0;for(let S=0,E=t.length;S<E;S++){const _=t.charCodeAt(S);_<=255?i[s++]=_:(i[s++]=_>>>8,i[s++]=_&255)}}else if(ArrayBuffer.isView(t))i=t.slice(),s=i.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=s>>2,l=s-r*4,c=new Uint32Array(i.buffer,0,r);let u=0,h=0,f=this.h1,m=this.h2;const y=3432918353,b=461845907,A=y&Gi,w=b&Gi;for(let S=0;S<r;S++)S&1?(u=c[S],u=u*y&wi|u*A&Gi,u=u<<15|u>>>17,u=u*b&wi|u*w&Gi,f^=u,f=f<<13|f>>>19,f=f*5+3864292196):(h=c[S],h=h*y&wi|h*A&Gi,h=h<<15|h>>>17,h=h*b&wi|h*w&Gi,m^=h,m=m<<13|m>>>19,m=m*5+3864292196);switch(u=0,l){case 3:u^=i[r*4+2]<<16;case 2:u^=i[r*4+1]<<8;case 1:u^=i[r*4],u=u*y&wi|u*A&Gi,u=u<<15|u>>>17,u=u*b&wi|u*w&Gi,r&1?f^=u:m^=u}this.h1=f,this.h2=m}hexdigest(){let t=this.h1,i=this.h2;return t^=i>>>1,t=t*3981806797&wi|t*36045&Gi,i=i*4283543511&wi|((i<<16|t>>>16)*2950163797&wi)>>>16,t^=i>>>1,t=t*444984403&wi|t*60499&Gi,i=i*3301882366&wi|((i<<16|t>>>16)*3120437893&wi)>>>16,t^=i>>>1,(t>>>0).toString(16).padStart(8,"0")+(i>>>0).toString(16).padStart(8,"0")}}const ch=Object.freeze({map:null,hash:"",transfer:void 0});class wh{#t=!1;#e=null;#n=null;#i=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,i){const s=this.#i.get(t);return s===void 0?i:Object.assign(i,s)}getRawValue(t){return this.#i.get(t)}remove(t){const i=this.#i.get(t);if(i!==void 0&&(i instanceof lt&&this.#n.delete(i.annotationElementId),this.#i.delete(t),this.#i.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const s of this.#i.values())if(s instanceof lt)return;this.onAnnotationEditor(null)}}setValue(t,i){const s=this.#i.get(t);let r=!1;if(s!==void 0)for(const[l,c]of Object.entries(i))s[l]!==c&&(r=!0,s[l]=c);else r=!0,this.#i.set(t,i);r&&this.#r(),i instanceof lt&&((this.#n||=new Map).set(i.annotationElementId,i),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(i.constructor._type))}has(t){return this.#i.has(t)}get size(){return this.#i.size}#r(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new zm(this)}get serializable(){if(this.#i.size===0)return ch;const t=new Map,i=new Bm,s=[],r=Object.create(null);let l=!1;for(const[c,u]of this.#i){const h=u instanceof lt?u.serialize(!1,r):u;h&&(t.set(c,h),i.update(`${c}:${JSON.stringify(h)}`),l||=!!h.bitmap)}if(l)for(const c of t.values())c.bitmap&&s.push(c.bitmap);return t.size>0?{map:t,hash:i.hexdigest(),transfer:s}:ch}get editorStats(){let t=null;const i=new Map;let s=0,r=0;for(const l of this.#i.values()){if(!(l instanceof lt)){l.popup&&(l.popup.deleted?r+=1:s+=1);continue}l.isCommentDeleted?r+=1:l.hasEditedComment&&(s+=1);const c=l.telemetryFinalData;if(!c)continue;const{type:u}=c;i.has(u)||i.set(u,Object.getPrototypeOf(l).constructor),t||=Object.create(null);const h=t[u]||=new Map;for(const[f,m]of Object.entries(c)){if(f==="type")continue;let y=h.get(f);y||(y=new Map,h.set(f,y));const b=y.get(m)??0;y.set(m,b+1)}}if((r>0||s>0)&&(t||=Object.create(null),t.comments={deleted:r,edited:s}),!t)return null;for(const[l,c]of i)t[l]=c.computeTelemetryFinalData(t[l]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,i){const s=this.#n?.get(t);return s?(s.updateFromAnnotationLayer(i),!0):!1}getEditor(t){return this.#n?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#n)for(const i of this.#n.values())i.serialize()&&t.push(i.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#i.entries()}}class zm extends wh{#t;constructor(t){super();const{map:i,hash:s,transfer:r}=t.serializable,l=structuredClone(i,r?{transfer:r}:null);this.#t={map:l,hash:s,transfer:r}}get print(){$t("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return wt(this,"modifiedIds",{ids:new Set,hash:""})}}class _v{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:i=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const i=this.styleElement.sheet;i.insertRule(t,i.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:i,_inspectFont:s}){if(!(!t||this.#t.has(t.loadedName))){if(Nt(!i,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:l,style:c}=t,u=new FontFace(r,l,c);this.addNativeFontFace(u);try{await u.load(),this.#t.add(r),s?.(t)}catch{mt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}$t("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const s=t.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(r){throw mt(`Failed to load font '${s.family}': '${r}'.`),t.disableFontFace=!0,r}}return}const i=t.createFontFaceRule();if(i){if(this.insertRule(i),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const r=this._queueLoadingCallback(s);this._prepareFontLoadEvent(t,r)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return wt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return wt(this,"isSyncFontLoadingSupported",je||Oe.platform.isFirefox)}_queueLoadingCallback(t){function i(){for(Nt(!r.done,"completeRequest() cannot be called twice."),r.done=!0;s.length>0&&s[0].done;){const l=s.shift();setTimeout(l.callback,0)}}const{loadingRequests:s}=this,r={done:!1,complete:i,callback:t};return s.push(r),r}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return wt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,i){function s(B,O){return B.charCodeAt(O)<<24|B.charCodeAt(O+1)<<16|B.charCodeAt(O+2)<<8|B.charCodeAt(O+3)&255}function r(B,O,L,P){const q=B.substring(0,O),K=B.substring(O+L);return q+P+K}let l,c;const u=this._document.createElement("canvas");u.width=1,u.height=1;const h=u.getContext("2d");let f=0;function m(B,O){if(++f>30){mt("Load test font never loaded."),O();return}if(h.font="30px "+B,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){O();return}setTimeout(m.bind(null,B,O))}const y=`lt${Date.now()}${this.loadTestFontId++}`;let b=this._loadTestFont;b=r(b,976,y.length,y);const w=16,S=1482184792;let E=s(b,w);for(l=0,c=y.length-3;l<c;l+=4)E=E-S+s(y,l)|0;l<y.length&&(E=E-S+s(y+"XXX",l)|0),b=r(b,w,4,sv(E));const _=`url(data:font/opentype;base64,${btoa(b)});`,D=`@font-face {font-family:"${y}";src:${_}}`;this.insertRule(D);const T=this._document.createElement("div");T.style.visibility="hidden",T.style.width=T.style.height="10px",T.style.position="absolute",T.style.top=T.style.left="0px";for(const B of[t.loadedName,y]){const O=this._document.createElement("span");O.textContent="Hi",O.style.fontFamily=B,T.append(O)}this._document.body.append(T),m(y,()=>{T.remove(),i.complete()})}}class Ev{#t;constructor(t,i=null,s,r){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=i,s&&Object.assign(this,s),r&&(this.charProcOperatorList=r)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${Rm(this.data)});`;let i;if(!this.cssFontInfo)i=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),i=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${t}}`}return this._inspectFont?.(this,t),i}getPathGenerator(t,i){if(this.compiledGlyphs[i]!==void 0)return this.compiledGlyphs[i];const s=this.loadedName+"_path_"+i;let r;try{r=t.get(s)}catch(c){mt(`getPathGenerator - ignoring character: "${c}".`)}const l=Lm(r);return this.fontExtraProperties||t.delete(s),this.compiledGlyphs[i]=l}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}class ma{#t;#e;#n;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const i=new TextEncoder,s={};let r=0;for(const f of ma.strings){const m=i.encode(t[f]);s[f]=m,r+=4+m.length}const l=new ArrayBuffer(r),c=new Uint8Array(l),u=new DataView(l);let h=0;for(const f of ma.strings){const m=s[f],y=m.length;u.setUint32(h,y),c.set(m,h+4),h+=4+y}return Nt(h===l.byteLength,"CssFontInfo.write: Buffer overflow"),l}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#n=new TextDecoder}#i(t){Nt(t<ma.strings.length,"Invalid string index");let i=0;for(let r=0;r<t;r++)i+=this.#e.getUint32(i)+4;const s=this.#e.getUint32(i);return this.#n.decode(new Uint8Array(this.#t,i+4,s))}get fontFamily(){return this.#i(0)}get fontWeight(){return this.#i(1)}get italicAngle(){return this.#i(2)}}class ya{#t;#e;#n;static strings=["css","loadedName","baseFontName","src"];static write(t){const i=new TextEncoder,s={};let r=0;for(const b of ya.strings){const A=i.encode(t[b]);s[b]=A,r+=4+A.length}r+=4;let l,c,u=1+r;t.style&&(l=i.encode(t.style.style),c=i.encode(t.style.weight),u+=4+l.length+4+c.length);const h=new ArrayBuffer(u),f=new Uint8Array(h),m=new DataView(h);let y=0;m.setUint8(y++,t.guessFallback?1:0),m.setUint32(y,0),y+=4,r=0;for(const b of ya.strings){const A=s[b],w=A.length;r+=4+w,m.setUint32(y,w),f.set(A,y+4),y+=4+w}return m.setUint32(y-r-4,r),t.style&&(m.setUint32(y,l.length),f.set(l,y+4),y+=4+l.length,m.setUint32(y,c.length),f.set(c,y+4),y+=4+c.length),Nt(y<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(y)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#n=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#i(t){Nt(t<ya.strings.length,"Invalid string index");let i=5;for(let r=0;r<t;r++)i+=this.#e.getUint32(i)+4;const s=this.#e.getUint32(i);return this.#n.decode(new Uint8Array(this.#t,i+4,s))}get css(){return this.#i(0)}get loadedName(){return this.#i(1)}get baseFontName(){return this.#i(2)}get src(){return this.#i(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const i=this.#e.getUint32(t),s=this.#n.decode(new Uint8Array(this.#t,t+4,i));t+=4+i;const r=this.#e.getUint32(t),l=this.#n.decode(new Uint8Array(this.#t,t+4,r));return{style:s,weight:l}}}class Xt{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#n=this.#e+1+8;static#i=this.#n+1+48;static#r=this.#i+1+6;#a;#s;#o;constructor({data:t,extra:i}){this.#a=t,this.#s=new TextDecoder,this.#o=new DataView(this.#a),i&&Object.assign(this,i)}#c(t){Nt(t<Xt.bools.length,"Invalid boolean index");const i=Math.floor(t/4),s=t*2%8,r=this.#o.getUint8(i)>>s&3;return r===0?void 0:r===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(t){return Nt(t<Xt.numbers.length,"Invalid number index"),this.#o.getFloat64(Xt.#t+t*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let t=Xt.#e;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let r=0;r<4;r++)s.push(this.#o.getInt16(t,!0)),t+=2;return s}get fontMatrix(){let t=Xt.#n;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let r=0;r<6;r++)s.push(this.#o.getFloat64(t,!0)),t+=8;return s}get defaultVMetrics(){let t=Xt.#i;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let r=0;r<3;r++)s.push(this.#o.getInt16(t,!0)),t+=2;return s}#d(t){Nt(t<Xt.strings.length,"Invalid string index");let i=Xt.#r+4;for(let l=0;l<t;l++)i+=this.#o.getUint32(i)+4;const s=this.#o.getUint32(i),r=new Uint8Array(s);return r.set(new Uint8Array(this.#a,i+4,s)),this.#s.decode(r)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=Xt.#r;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);t+=4+s;const r=this.#o.getUint32(t);t+=4+r;const l=this.#o.getUint32(t);if(l!==0)return new Uint8Array(this.#a,t+4,l)}clearData(){let t=Xt.#r;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);t+=4+s;const r=this.#o.getUint32(t);t+=4+r;const l=this.#o.getUint32(t);new Uint8Array(this.#a,t+4,l).fill(0),this.#o.setUint32(t,0)}get cssFontInfo(){let t=Xt.#r;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);t+=4+s;const r=this.#o.getUint32(t);if(r===0)return null;const l=new Uint8Array(r);return l.set(new Uint8Array(this.#a,t+4,r)),new ma(l.buffer)}get systemFontInfo(){let t=Xt.#r;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);if(s===0)return null;const r=new Uint8Array(s);return r.set(new Uint8Array(this.#a,t+4,s)),new ya(r.buffer)}static write(t){const i=t.systemFontInfo?ya.write(t.systemFontInfo):null,s=t.cssFontInfo?ma.write(t.cssFontInfo):null,r=new TextEncoder,l={};let c=0;for(const S of Xt.strings)l[S]=r.encode(t[S]),c+=4+l[S].length;const u=Xt.#r+4+c+4+(i?i.byteLength:0)+4+(s?s.byteLength:0)+4+(t.data?t.data.length:0),h=new ArrayBuffer(u),f=new Uint8Array(h),m=new DataView(h);let y=0;const b=Xt.bools.length;let A=0,w=0;for(let S=0;S<b;S++){const E=t[Xt.bools[S]];A|=(E===void 0?0:E?2:1)<<w,w+=2,(w===8||S===b-1)&&(m.setUint8(y++,A),A=0,w=0)}Nt(y===Xt.#t,"FontInfo.write: Boolean properties offset mismatch");for(const S of Xt.numbers)m.setFloat64(y,t[S]),y+=8;if(Nt(y===Xt.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){m.setUint8(y++,4);for(const S of t.bbox)m.setInt16(y,S,!0),y+=2}else m.setUint8(y++,0),y+=8;if(Nt(y===Xt.#n,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){m.setUint8(y++,6);for(const S of t.fontMatrix)m.setFloat64(y,S,!0),y+=8}else m.setUint8(y++,0),y+=48;if(Nt(y===Xt.#i,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){m.setUint8(y++,1);for(const S of t.defaultVMetrics)m.setInt16(y,S,!0),y+=2}else m.setUint8(y++,0),y+=6;Nt(y===Xt.#r,"FontInfo.write: DefaultVMetrics properties offset mismatch"),m.setUint32(Xt.#r,0),y+=4;for(const S of Xt.strings){const E=l[S],_=E.length;m.setUint32(y,_),f.set(E,y+4),y+=4+_}if(m.setUint32(Xt.#r,y-Xt.#r-4),!i)m.setUint32(y,0),y+=4;else{const S=i.byteLength;m.setUint32(y,S),Nt(y+4+S<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(i),y+4),y+=4+S}if(!s)m.setUint32(y,0),y+=4;else{const S=s.byteLength;m.setUint32(y,S),Nt(y+4+S<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(s),y+4),y+=4+S}return t.data===void 0?(m.setUint32(y,0),y+=4):(m.setUint32(y,t.data.length),f.set(t.data,y+4),y+=4+t.data.length),Nt(y<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(y)}}class Se{static#t=0;static#e=1;static#n=2;static#i=3;static#r=4;static#a=8;static#s=12;static#o=16;constructor(t){this.buffer=t,this.view=new DataView(t),this.data=new Uint8Array(t)}static write(t){let i,s=null,r=[],l=[],c=[],u=[],h=null,f=null;switch(t[0]){case"RadialAxial":i=t[1]==="axial"?1:2,s=t[2],c=t[3],i===1?r.push(...t[4],...t[5]):r.push(t[4][0],t[4][1],t[6],t[5][0],t[5][1],t[7]);break;case"Mesh":i=3,h=t[1],r=t[2],l=t[3],u=t[4]||[],s=t[6],f=t[7];break;default:throw new Error(`Unsupported pattern type: ${t[0]}`)}const m=Math.floor(r.length/2),y=Math.floor(l.length/3),b=c.length,A=u.length;let w=0;for(const O of u)w+=1,w=Math.ceil(w/4)*4,w+=4+O.coords.length*4,w+=4+O.colors.length*4,O.verticesPerRow!==void 0&&(w+=4);const S=20+m*8+y*3+b*8+(s?16:0)+(f?3:0)+w,E=new ArrayBuffer(S),_=new DataView(E),D=new Uint8Array(E);_.setUint8(Se.#t,i),_.setUint8(Se.#e,s?1:0),_.setUint8(Se.#n,f?1:0),_.setUint8(Se.#i,h),_.setUint32(Se.#r,m,!0),_.setUint32(Se.#a,y,!0),_.setUint32(Se.#s,b,!0),_.setUint32(Se.#o,A,!0);let T=20;new Float32Array(E,T,m*2).set(r),T+=m*8,D.set(l,T),T+=y*3;for(const[O,L]of c)_.setFloat32(T,O,!0),T+=4,_.setUint32(T,parseInt(L.slice(1),16),!0),T+=4;if(s)for(const O of s)_.setFloat32(T,O,!0),T+=4;f&&(D.set(f,T),T+=3);for(let O=0;O<u.length;O++){const L=u[O];_.setUint8(T,L.type),T+=1,T=Math.ceil(T/4)*4,_.setUint32(T,L.coords.length,!0),T+=4,new Int32Array(E,T,L.coords.length).set(L.coords),T+=L.coords.length*4,_.setUint32(T,L.colors.length,!0),T+=4,new Int32Array(E,T,L.colors.length).set(L.colors),T+=L.colors.length*4,L.verticesPerRow!==void 0&&(_.setUint32(T,L.verticesPerRow,!0),T+=4)}return E}getIR(){const t=this.view,i=this.data[Se.#t],s=!!this.data[Se.#e],r=!!this.data[Se.#n],l=t.getUint32(Se.#r,!0),c=t.getUint32(Se.#a,!0),u=t.getUint32(Se.#s,!0),h=t.getUint32(Se.#o,!0);let f=20;const m=new Float32Array(this.buffer,f,l*2);f+=l*8;const y=new Uint8Array(this.buffer,f,c*3);f+=c*3;const b=[];for(let E=0;E<u;++E){const _=t.getFloat32(f,!0);f+=4;const D=t.getUint32(f,!0);f+=4,b.push([_,`#${D.toString(16).padStart(6,"0")}`])}let A=null;if(s){A=[];for(let E=0;E<4;++E)A.push(t.getFloat32(f,!0)),f+=4}let w=null;r&&(w=new Uint8Array(this.buffer,f,3),f+=3);const S=[];for(let E=0;E<h;++E){const _=t.getUint8(f);f+=1,f=Math.ceil(f/4)*4;const D=t.getUint32(f,!0);f+=4;const T=new Int32Array(this.buffer,f,D);f+=D*4;const B=t.getUint32(f,!0);f+=4;const O=new Int32Array(this.buffer,f,B);f+=B*4;const L={type:_,coords:T,colors:O};_===sh.LATTICE&&(L.verticesPerRow=t.getUint32(f,!0),f+=4),S.push(L)}if(i===1)return["RadialAxial","axial",A,b,Array.from(m.slice(0,2)),Array.from(m.slice(2,4)),null,null];if(i===2)return["RadialAxial","radial",A,b,[m[0],m[1]],[m[3],m[4]],m[2],m[5]];if(i===3){const E=this.data[Se.#i];let _=null;if(m.length>0){let D=m[0],T=m[0],B=m[1],O=m[1];for(let L=0;L<m.length;L+=2){const P=m[L],q=m[L+1];D=D>P?P:D,B=B>q?q:B,T=T<P?P:T,O=O<q?q:O}_=[D,B,T,O]}return["Mesh",E,m,y,S,_,A,w]}throw new Error(`Unsupported pattern kind: ${i}`)}}function Tv(g){if(g instanceof URL)return g.href;if(typeof g=="string"){if(je)return g;const t=URL.parse(g,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function Cv(g){if(je&&typeof Buffer<"u"&&g instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(g instanceof Uint8Array&&g.byteLength===g.buffer.byteLength)return g;if(typeof g=="string")return Dr(g);if(g instanceof ArrayBuffer||ArrayBuffer.isView(g)||typeof g=="object"&&!isNaN(g?.length))return new Uint8Array(g);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function tl(g){if(typeof g!="string")return null;if(g.endsWith("/"))return g;throw new Error(`Invalid factory url: "${g}" must include trailing slash.`)}const uh=g=>typeof g=="object"&&Number.isInteger(g?.num)&&g.num>=0&&Number.isInteger(g?.gen)&&g.gen>=0,Mv=g=>typeof g=="object"&&typeof g?.name=="string",Dv=cv.bind(null,uh,Mv);class Rv{#t=new Map;#e=Promise.resolve();postMessage(t,i){const s={data:structuredClone(t,i?{transfer:i}:null)};this.#e.then(()=>{for(const[r]of this.#t)r.call(this,s)})}addEventListener(t,i,s=null){let r=null;if(s?.signal instanceof AbortSignal){const{signal:l}=s;if(l.aborted){mt("LoopbackPort - cannot use an `aborted` signal.");return}const c=()=>this.removeEventListener(t,i);r=()=>l.removeEventListener("abort",c),l.addEventListener("abort",c)}this.#t.set(i,r)}removeEventListener(t,i){this.#t.get(i)?.(),this.#t.delete(i)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const el={DATA:1,ERROR:2},ge={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Jg(){}function Qe(g){if(g instanceof qn||g instanceof ah||g instanceof Vg||g instanceof dl||g instanceof Ku)return g;switch(g instanceof Error||typeof g=="object"&&g!==null||$t('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),g.name){case"AbortException":return new qn(g.message);case"InvalidPDFException":return new ah(g.message);case"PasswordException":return new Vg(g.message,g.code);case"ResponseException":return new dl(g.message,g.status,g.missing);case"UnknownErrorException":return new Ku(g.message,g.details)}return new Ku(g.message,g.toString())}class Sr{#t=new AbortController;constructor(t,i,s){this.sourceName=t,this.targetName=i,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#i(t);return}if(t.callback){const s=t.callbackId,r=this.callbackCapabilities[s];if(!r)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],t.callback===el.DATA)r.resolve(t.data);else if(t.callback===el.ERROR)r.reject(Qe(t.reason));else throw new Error("Unexpected callback case");return}const i=this.actionHandler[t.action];if(!i)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const s=this.sourceName,r=t.sourceName,l=this.comObj;Promise.try(i,t.data).then(function(c){l.postMessage({sourceName:s,targetName:r,callback:el.DATA,callbackId:t.callbackId,data:c})},function(c){l.postMessage({sourceName:s,targetName:r,callback:el.ERROR,callbackId:t.callbackId,reason:Qe(c)})});return}if(t.streamId){this.#n(t);return}i(t.data)}on(t,i){const s=this.actionHandler;if(s[t])throw new Error(`There is already an actionName called "${t}"`);s[t]=i}send(t,i,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:i},s)}sendWithPromise(t,i,s){const r=this.callbackId++,l=Promise.withResolvers();this.callbackCapabilities[r]=l;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:r,data:i},s)}catch(c){l.reject(c)}return l.promise}sendWithStream(t,i,s,r){const l=this.streamId++,c=this.sourceName,u=this.targetName,h=this.comObj;return new ReadableStream({start:f=>{const m=Promise.withResolvers();return this.streamControllers[l]={controller:f,startCall:m,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:c,targetName:u,action:t,streamId:l,data:i,desiredSize:f.desiredSize},r),m.promise},pull:f=>{const m=Promise.withResolvers();return this.streamControllers[l].pullCall=m,h.postMessage({sourceName:c,targetName:u,stream:ge.PULL,streamId:l,desiredSize:f.desiredSize}),m.promise},cancel:f=>{Nt(f instanceof Error,"cancel must have a valid reason");const m=Promise.withResolvers();return this.streamControllers[l].cancelCall=m,this.streamControllers[l].isClosed=!0,h.postMessage({sourceName:c,targetName:u,stream:ge.CANCEL,streamId:l,reason:Qe(f)}),m.promise}},s)}#n(t){const i=t.streamId,s=this.sourceName,r=t.sourceName,l=this.comObj,c=this,u=this.actionHandler[t.action],h={enqueue(f,m=1,y){if(this.isCancelled)return;const b=this.desiredSize;this.desiredSize-=m,b>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),l.postMessage({sourceName:s,targetName:r,stream:ge.ENQUEUE,streamId:i,chunk:f},y)},close(){this.isCancelled||(this.isCancelled=!0,l.postMessage({sourceName:s,targetName:r,stream:ge.CLOSE,streamId:i}),delete c.streamSinks[i])},error(f){Nt(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,l.postMessage({sourceName:s,targetName:r,stream:ge.ERROR,streamId:i,reason:Qe(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[i]=h,Promise.try(u,t.data,h).then(function(){l.postMessage({sourceName:s,targetName:r,stream:ge.START_COMPLETE,streamId:i,success:!0})},function(f){l.postMessage({sourceName:s,targetName:r,stream:ge.START_COMPLETE,streamId:i,reason:Qe(f)})})}#i(t){const i=t.streamId,s=this.sourceName,r=t.sourceName,l=this.comObj,c=this.streamControllers[i],u=this.streamSinks[i];switch(t.stream){case ge.START_COMPLETE:t.success?c.startCall.resolve():c.startCall.reject(Qe(t.reason));break;case ge.PULL_COMPLETE:t.success?c.pullCall.resolve():c.pullCall.reject(Qe(t.reason));break;case ge.PULL:if(!u){l.postMessage({sourceName:s,targetName:r,stream:ge.PULL_COMPLETE,streamId:i,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||Jg).then(function(){l.postMessage({sourceName:s,targetName:r,stream:ge.PULL_COMPLETE,streamId:i,success:!0})},function(f){l.postMessage({sourceName:s,targetName:r,stream:ge.PULL_COMPLETE,streamId:i,reason:Qe(f)})});break;case ge.ENQUEUE:if(Nt(c,"enqueue should have stream controller"),c.isClosed)break;c.controller.enqueue(t.chunk);break;case ge.CLOSE:if(Nt(c,"close should have stream controller"),c.isClosed)break;c.isClosed=!0,c.controller.close(),this.#r(c,i);break;case ge.ERROR:Nt(c,"error should have stream controller"),c.controller.error(Qe(t.reason)),this.#r(c,i);break;case ge.CANCEL_COMPLETE:t.success?c.cancelCall.resolve():c.cancelCall.reject(Qe(t.reason)),this.#r(c,i);break;case ge.CANCEL:if(!u)break;const h=Qe(t.reason);Promise.try(u.onCancel||Jg,h).then(function(){l.postMessage({sourceName:s,targetName:r,stream:ge.CANCEL_COMPLETE,streamId:i,success:!0})},function(f){l.postMessage({sourceName:s,targetName:r,stream:ge.CANCEL_COMPLETE,streamId:i,reason:Qe(f)})}),u.sinkCapability.reject(h),u.isCancelled=!0,delete this.streamSinks[i];break;default:throw new Error("Unexpected stream case")}}async#r(t,i){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[i]}destroy(){this.#t?.abort(),this.#t=null}}class Pm{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,i){if(t<=0||i<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(t,i);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,i,s){if(!t.canvas)throw new Error("Canvas is not specified");if(i<=0||s<=0)throw new Error("Invalid canvas size");t.canvas.width=i,t.canvas.height=s}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,i){$t("Abstract method `_createCanvas` called.")}}class Nv extends Pm{constructor({ownerDocument:t=globalThis.document,enableHWA:i=!1}){super({enableHWA:i}),this._document=t}_createCanvas(t,i){const s=this._document.createElement("canvas");return s.width=t,s.height=i,s}}class Um{constructor({baseUrl:t=null,isCompressed:i=!0}){this.baseUrl=t,this.isCompressed=i}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const i=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(i).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${i}`)})}async _fetch(t){$t("Abstract method `_fetch` called.")}}class tm extends Um{async _fetch(t){const i=await Rr(t,this.isCompressed?"arraybuffer":"text");return i instanceof ArrayBuffer?new Uint8Array(i):Dr(i)}}class jm{addFilter(t){return"none"}addHCMFilter(t,i){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,i,s,r,l){return"none"}destroy(t=!1){}}class Ov extends jm{#t;#e;#n;#i;#r;#a;#s=0;constructor({docId:t,ownerDocument:i=globalThis.document}){super(),this.#i=t,this.#r=i}get#o(){return this.#e||=new Map}get#c(){return this.#a||=new Map}get#l(){if(!this.#n){const t=this.#r.createElement("div"),{style:i}=t;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const s=this.#r.createElementNS(pn,"svg");s.setAttribute("width",0),s.setAttribute("height",0),this.#n=this.#r.createElementNS(pn,"defs"),t.append(s),s.append(this.#n),this.#r.body.append(t)}return this.#n}#d(t){if(t.length===1){const h=t[0],f=new Array(256);for(let y=0;y<256;y++)f[y]=h[y]/255;const m=f.join(",");return[m,m,m]}const[i,s,r]=t,l=new Array(256),c=new Array(256),u=new Array(256);for(let h=0;h<256;h++)l[h]=i[h]/255,c[h]=s[h]/255,u[h]=r[h]/255;return[l.join(","),c.join(","),u.join(",")]}#h(t){if(this.#t===void 0){this.#t="";const i=this.#r.URL;i!==this.#r.baseURI&&(vl(i)?mt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=Cm(i,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let i=this.#o.get(t);if(i)return i;const[s,r,l]=this.#d(t),c=t.length===1?s:`${s}${r}${l}`;if(i=this.#o.get(c),i)return this.#o.set(t,i),i;const u=`g_${this.#i}_transfer_map_${this.#s++}`,h=this.#h(u);this.#o.set(t,h),this.#o.set(c,h);const f=this.#g(u);return this.#p(s,r,l,f),h}addHCMFilter(t,i){const s=`${t}-${i}`,r="base";let l=this.#c.get(r);if(l?.key===s||(l?(l.filter?.remove(),l.key=s,l.url="none",l.filter=null):(l={key:s,url:"none",filter:null},this.#c.set(r,l)),!t||!i))return l.url;const c=this.#v(t);t=st.makeHexColor(...c);const u=this.#v(i);if(i=st.makeHexColor(...u),this.#l.style.color="",t==="#000000"&&i==="#ffffff"||t===i)return l.url;const h=new Array(256);for(let A=0;A<=255;A++){const w=A/255;h[A]=w<=.03928?w/12.92:((w+.055)/1.055)**2.4}const f=h.join(","),m=`g_${this.#i}_hcm_filter`,y=l.filter=this.#g(m);this.#p(f,f,f,y),this.#m(y);const b=(A,w)=>{const S=c[A]/255,E=u[A]/255,_=new Array(w+1);for(let D=0;D<=w;D++)_[D]=S+D/w*(E-S);return _.join(",")};return this.#p(b(0,5),b(1,5),b(2,5),y),l.url=this.#h(m),l.url}addAlphaFilter(t){let i=this.#o.get(t);if(i)return i;const[s]=this.#d([t]),r=`alpha_${s}`;if(i=this.#o.get(r),i)return this.#o.set(t,i),i;const l=`g_${this.#i}_alpha_map_${this.#s++}`,c=this.#h(l);this.#o.set(t,c),this.#o.set(r,c);const u=this.#g(l);return this.#y(s,u),c}addLuminosityFilter(t){let i=this.#o.get(t||"luminosity");if(i)return i;let s,r;if(t?([s]=this.#d([t]),r=`luminosity_${s}`):r="luminosity",i=this.#o.get(r),i)return this.#o.set(t,i),i;const l=`g_${this.#i}_luminosity_map_${this.#s++}`,c=this.#h(l);this.#o.set(t,c),this.#o.set(r,c);const u=this.#g(l);return this.#f(u),t&&this.#y(s,u),c}addHighlightHCMFilter(t,i,s,r,l){const c=`${i}-${s}-${r}-${l}`;let u=this.#c.get(t);if(u?.key===c||(u?(u.filter?.remove(),u.key=c,u.url="none",u.filter=null):(u={key:c,url:"none",filter:null},this.#c.set(t,u)),!i||!s))return u.url;const[h,f]=[i,s].map(this.#v.bind(this));let m=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),y=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[b,A]=[r,l].map(this.#v.bind(this));y<m&&([m,y,b,A]=[y,m,A,b]),this.#l.style.color="";const w=(_,D,T)=>{const B=new Array(256),O=(y-m)/T,L=_/255,P=(D-_)/(255*T);let q=0;for(let K=0;K<=T;K++){const J=Math.round(m+K*O),W=L+K*P;for(let ht=q;ht<=J;ht++)B[ht]=W;q=J+1}for(let K=q;K<256;K++)B[K]=B[q-1];return B.join(",")},S=`g_${this.#i}_hcm_${t}_filter`,E=u.filter=this.#g(S);return this.#m(E),this.#p(w(b[0],A[0],5),w(b[1],A[1],5),w(b[2],A[2],5),E),u.url=this.#h(S),u.url}destroy(t=!1){t&&this.#a?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#e?.clear(),this.#e=null,this.#a?.clear(),this.#a=null,this.#s=0)}#f(t){const i=this.#r.createElementNS(pn,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(i)}#m(t){const i=this.#r.createElementNS(pn,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(i)}#g(t){const i=this.#r.createElementNS(pn,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",t),this.#l.append(i),i}#u(t,i,s){const r=this.#r.createElementNS(pn,i);r.setAttribute("type","discrete"),r.setAttribute("tableValues",s),t.append(r)}#p(t,i,s,r){const l=this.#r.createElementNS(pn,"feComponentTransfer");r.append(l),this.#u(l,"feFuncR",t),this.#u(l,"feFuncG",i),this.#u(l,"feFuncB",s)}#y(t,i){const s=this.#r.createElementNS(pn,"feComponentTransfer");i.append(s),this.#u(s,"feFuncA",t)}#v(t){return this.#l.style.color=t,Or(getComputedStyle(this.#l).getPropertyValue("color"))}}class Fm{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetch(i).catch(s=>{throw new Error(`Unable to load font data at: ${i}`)})}async _fetch(t){$t("Abstract method `_fetch` called.")}}class em extends Fm{async _fetch(t){const i=await Rr(t,"arraybuffer");return new Uint8Array(i)}}class Hm{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetch(i).catch(s=>{throw new Error(`Unable to load wasm data at: ${i}`)})}async _fetch(t){$t("Abstract method `_fetch` called.")}}class im extends Hm{async _fetch(t){const i=await Rr(t,"arraybuffer");return new Uint8Array(i)}}je&&mt("Please use the `legacy` build in Node.js environments.");async function xh(g){const i=await process.getBuiltinModule("fs").promises.readFile(g);return new Uint8Array(i)}class Lv extends jm{}class kv extends Pm{_createCanvas(t,i){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,i)}}class Bv extends Um{async _fetch(t){return xh(t)}}class zv extends Fm{async _fetch(t){return xh(t)}}class Pv extends Hm{async _fetch(t){return xh(t)}}const la="__forcedDependency",{floor:nm,ceil:sm}=Math;function il(g,t,i,s,r,l){g[t*4+0]=Math.min(g[t*4+0],i),g[t*4+1]=Math.min(g[t*4+1],s),g[t*4+2]=Math.max(g[t*4+2],r),g[t*4+3]=Math.max(g[t*4+3],l)}const hh=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class Uv{#t;#e;constructor(t,i){this.#t=t,this.#e=i}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===hh}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const nl=(g,t)=>{if(!g)return;let i=g.get(t);return i||(i={dependencies:new Set,isRenderingOperation:!1},g.set(t,i)),i};class jv{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[la]:[]};#n=new Map;#i=[];#r=[];#a=[[1,0,0,1,0,0]];#s=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#d=new Map;#h=new Map;#f;#m;#g;#u;#p;constructor(t,i,s=!1){this.#f=t.width,this.#m=t.height,this.#y(i),s&&(this.#p=new Map)}growOperationsCount(t){t>=this.#u.length&&this.#y(t,this.#u)}#y(t,i){const s=new ArrayBuffer(t*4);this.#g=new Uint8ClampedArray(s),this.#u=new Uint32Array(s),i&&i.length>0?(this.#u.set(i),this.#u.fill(hh,i.length)):this.#u.fill(hh)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[la]:{__proto__:this.#e[la]}},this.#s={__proto__:this.#s},this.#i.push(t),this}restore(t){const i=Object.getPrototypeOf(this.#t);if(i===null)return this;this.#t=i,this.#e=Object.getPrototypeOf(this.#e),this.#s=Object.getPrototypeOf(this.#s);const s=this.#i.pop();return s!==void 0&&(nl(this.#p,t)?.dependencies.add(s),this.#u[t]=this.#u[s]),this}recordOpenMarker(t){return this.#i.push(t),this}getOpenMarker(){return this.#i.length===0?null:this.#i.at(-1)}recordCloseMarker(t){const i=this.#i.pop();return i!==void 0&&(nl(this.#p,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}beginMarkedContent(t){return this.#r.push(t),this}endMarkedContent(t){const i=this.#r.pop();return i!==void 0&&(nl(this.#p,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}pushBaseTransform(t){return this.#a.push(st.multiplyByDOMMatrix(this.#a.at(-1),t.getTransform())),this}popBaseTransform(){return this.#a.length>1&&this.#a.pop(),this}recordSimpleData(t,i){return this.#t[t]=i,this}recordIncrementalData(t,i){return this.#e[t].push(i),this}resetIncrementalData(t,i){return this.#e[t].length=0,this}recordNamedData(t,i){return this.#n.set(t,i),this}recordSimpleDataFromNamed(t,i,s){this.#t[t]=this.#n.get(i)??s}recordFutureForcedDependency(t,i){return this.recordIncrementalData(la,i),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const i of t)i in this.#t&&this.recordFutureForcedDependency(i,this.#t[i]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#l)this.recordFutureForcedDependency(la,t);return this}resetBBox(t){return this.#c!==t&&(this.#c=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(t,i,s,r,l,c){const u=st.multiplyByDOMMatrix(this.#a.at(-1),i.getTransform()),h=[1/0,1/0,-1/0,-1/0];st.axialAlignedBoundingBox([s,l,r,c],u,h);const f=st.intersect(this.#s,h);return f?(this.#s[0]=f[0],this.#s[1]=f[1],this.#s[2]=f[2],this.#s[3]=f[3]):(this.#s[0]=this.#s[1]=1/0,this.#s[2]=this.#s[3]=-1/0),this}recordBBox(t,i,s,r,l,c){const u=this.#s;if(u[0]===1/0)return this;const h=st.multiplyByDOMMatrix(this.#a.at(-1),i.getTransform());if(u[0]===-1/0)return st.axialAlignedBoundingBox([s,l,r,c],h,this.#o),this;const f=[1/0,1/0,-1/0,-1/0];return st.axialAlignedBoundingBox([s,l,r,c],h,f),this.#o[0]=Math.min(this.#o[0],Math.max(f[0],u[0])),this.#o[1]=Math.min(this.#o[1],Math.max(f[1],u[1])),this.#o[2]=Math.max(this.#o[2],Math.min(f[2],u[2])),this.#o[3]=Math.max(this.#o[3],Math.min(f[3],u[3])),this}recordCharacterBBox(t,i,s,r=1,l=0,c=0,u){const h=s.bbox;let f,m;if(h&&(f=h[2]!==h[0]&&h[3]!==h[1]&&this.#h.get(s),f!==!1&&(m=[0,0,0,0],st.axialAlignedBoundingBox(h,s.fontMatrix,m),(r!==1||l!==0||c!==0)&&st.scaleMinMax([r,0,0,-r,l,c],m),f)))return this.recordBBox(t,i,m[0],m[2],m[1],m[3]);if(!u)return this.recordFullPageBBox(t);const y=u();return h&&m&&f===void 0&&(f=m[0]<=l-y.actualBoundingBoxLeft&&m[2]>=l+y.actualBoundingBoxRight&&m[1]<=c-y.actualBoundingBoxAscent&&m[3]>=c+y.actualBoundingBoxDescent,this.#h.set(s,f),f)?this.recordBBox(t,i,m[0],m[2],m[1],m[3]):this.recordBBox(t,i,l-y.actualBoundingBoxLeft,l+y.actualBoundingBoxRight,c-y.actualBoundingBoxAscent,c+y.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#s[0]),this.#o[1]=Math.max(0,this.#s[1]),this.#o[2]=Math.min(this.#f,this.#s[2]),this.#o[3]=Math.min(this.#m,this.#s[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,i){const s=this.#l,r=this.#t,l=this.#e;for(const c of i)c in this.#t?s.add(r[c]):c in l&&l[c].forEach(s.add,s);return this}recordNamedDependency(t,i){return this.#n.has(i)&&this.#l.add(this.#n.get(i)),this}recordOperation(t,i=!1){if(this.recordDependencies(t,[la]),this.#p){const s=nl(this.#p,t),{dependencies:r}=s;this.#l.forEach(r.add,r),this.#i.forEach(r.add,r),this.#r.forEach(r.add,r),r.delete(t),s.isRenderingOperation=!0}if(this.#c===t){const s=nm(this.#o[0]*256/this.#f),r=nm(this.#o[1]*256/this.#m),l=sm(this.#o[2]*256/this.#f),c=sm(this.#o[3]*256/this.#m);il(this.#g,t,s,r,l,c);for(const u of this.#l)u!==t&&il(this.#g,u,s,r,l,c);for(const u of this.#i)u!==t&&il(this.#g,u,s,r,l,c);for(const u of this.#r)u!==t&&il(this.#g,u,s,r,l,c);i||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(t,i=!1){const s=Array.from(this.#l);this.recordOperation(t,i),this.recordIncrementalData("sameLineText",t);for(const r of s)this.recordIncrementalData("sameLineText",r);return this}bboxToClipBoxDropOperation(t,i=!1){return this.#c===t&&(this.#c=-1,this.#s[0]=Math.max(this.#s[0],this.#o[0]),this.#s[1]=Math.max(this.#s[1],this.#o[1]),this.#s[2]=Math.min(this.#s[2],this.#o[2]),this.#s[3]=Math.min(this.#s[3],this.#o[3]),i||this.#l.clear()),this}_takePendingDependencies(){const t=this.#l;return this.#l=new Set,t}_extractOperation(t){const i=this.#d.get(t);return this.#d.delete(t),i}_pushPendingDependencies(t){for(const i of t)this.#l.add(i)}take(){return this.#h.clear(),new Uv(this.#u,this.#g)}takeDebugMetadata(){return this.#p}}class fl{#t;#e;#n;#i=0;#r=0;constructor(t,i,s){if(t instanceof fl&&t.#n===!!s)return t;this.#t=t,this.#e=i,this.#n=!!s}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#r++,this.#t.save(this.#e),this}restore(t){return this.#r>0&&(this.#t.restore(this.#e),this.#r--),this}recordOpenMarker(t){return this.#i++,this}getOpenMarker(){return this.#i>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#i--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,i){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,i){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,i){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,i){return this}recordSimpleDataFromNamed(t,i,s){return this.#t.recordSimpleDataFromNamed(t,i,this.#e),this}recordFutureForcedDependency(t,i){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#n||this.#t.resetBBox(this.#e),this}recordClipBox(t,i,s,r,l,c){return this.#n||this.#t.recordClipBox(this.#e,i,s,r,l,c),this}recordBBox(t,i,s,r,l,c){return this.#n||this.#t.recordBBox(this.#e,i,s,r,l,c),this}recordCharacterBBox(t,i,s,r,l,c,u){return this.#n||this.#t.recordCharacterBBox(this.#e,i,s,r,l,c,u),this}recordFullPageBBox(t){return this.#n||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,i){return this.#t.recordDependencies(this.#e,i),this}recordNamedDependency(t,i){return this.#t.recordNamedDependency(this.#e,i),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#n||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const xi={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Ne={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function dh(g,t){if(!t)return;const i=t[2]-t[0],s=t[3]-t[1],r=new Path2D;r.rect(t[0],t[1],i,s),g.clip(r)}class _h{isModifyingCurrentTransform(){return!1}getPattern(){$t("Abstract method `getPattern` called.")}}class Fv extends _h{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let i;this._type==="axial"?i=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(i=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)i.addColorStop(s[0],s[1]);return i}getPattern(t,i,s,r){let l;if(r===Ne.STROKE||r===Ne.FILL){const c=i.current.getClippedPathBoundingBox(r,ie(t))||[0,0,0,0],u=Math.ceil(c[2]-c[0])||1,h=Math.ceil(c[3]-c[1])||1,f=i.cachedCanvases.getCanvas("pattern",u,h),m=f.context;m.clearRect(0,0,m.canvas.width,m.canvas.height),m.beginPath(),m.rect(0,0,m.canvas.width,m.canvas.height),m.translate(-c[0],-c[1]),s=st.transform(s,[1,0,0,1,c[0],c[1]]),m.transform(...i.baseTransform),this.matrix&&m.transform(...this.matrix),dh(m,this._bbox),m.fillStyle=this._createGradient(m),m.fill(),l=t.createPattern(f.canvas,"no-repeat");const y=new DOMMatrix(s);l.setTransform(y)}else dh(t,this._bbox),l=this._createGradient(t);return l}}function Wu(g,t,i,s,r,l,c,u){const h=t.coords,f=t.colors,m=g.data,y=g.width*4;let b;h[i+1]>h[s+1]&&(b=i,i=s,s=b,b=l,l=c,c=b),h[s+1]>h[r+1]&&(b=s,s=r,r=b,b=c,c=u,u=b),h[i+1]>h[s+1]&&(b=i,i=s,s=b,b=l,l=c,c=b);const A=(h[i]+t.offsetX)*t.scaleX,w=(h[i+1]+t.offsetY)*t.scaleY,S=(h[s]+t.offsetX)*t.scaleX,E=(h[s+1]+t.offsetY)*t.scaleY,_=(h[r]+t.offsetX)*t.scaleX,D=(h[r+1]+t.offsetY)*t.scaleY;if(w>=D)return;const T=f[l],B=f[l+1],O=f[l+2],L=f[c],P=f[c+1],q=f[c+2],K=f[u],J=f[u+1],W=f[u+2],ht=Math.round(w),yt=Math.round(D);let bt,vt,k,V,tt,pt,xt,R;for(let I=ht;I<=yt;I++){if(I<E){const ut=I<w?0:(w-I)/(w-E);bt=A-(A-S)*ut,vt=T-(T-L)*ut,k=B-(B-P)*ut,V=O-(O-q)*ut}else{let ut;I>D?ut=1:E===D?ut=0:ut=(E-I)/(E-D),bt=S-(S-_)*ut,vt=L-(L-K)*ut,k=P-(P-J)*ut,V=q-(q-W)*ut}let Q;I<w?Q=0:I>D?Q=1:Q=(w-I)/(w-D),tt=A-(A-_)*Q,pt=T-(T-K)*Q,xt=B-(B-J)*Q,R=O-(O-W)*Q;const et=Math.round(Math.min(bt,tt)),ct=Math.round(Math.max(bt,tt));let ft=y*I+et*4;for(let ut=et;ut<=ct;ut++)Q=(bt-ut)/(bt-tt),Q<0?Q=0:Q>1&&(Q=1),m[ft++]=vt-(vt-pt)*Q|0,m[ft++]=k-(k-xt)*Q|0,m[ft++]=V-(V-R)*Q|0,m[ft++]=255}}function Hv(g,t,i){const s=t.coords,r=t.colors;let l,c;switch(t.type){case sh.LATTICE:const u=t.verticesPerRow,h=Math.floor(s.length/u)-1,f=u-1;for(l=0;l<h;l++){let m=l*u;for(let y=0;y<f;y++,m++)Wu(g,i,s[m],s[m+1],s[m+u],r[m],r[m+1],r[m+u]),Wu(g,i,s[m+u+1],s[m+1],s[m+u],r[m+u+1],r[m+1],r[m+u])}break;case sh.TRIANGLES:for(l=0,c=s.length;l<c;l+=3)Wu(g,i,s[l],s[l+1],s[l+2],r[l],r[l+1],r[l+2]);break;default:throw new Error("illegal figure")}}class Iv extends _h{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,i,s){const u=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-u,m=Math.ceil(this._bounds[3])-h,y=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),b=Math.min(Math.ceil(Math.abs(m*t[1]*1.1)),3e3),A=f/y,w=m/b,S={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-h,scaleX:1/A,scaleY:1/w},E=y+4,_=b+4,D=s.getCanvas("mesh",E,_),T=D.context,B=T.createImageData(y,b);if(i){const L=B.data;for(let P=0,q=L.length;P<q;P+=4)L[P]=i[0],L[P+1]=i[1],L[P+2]=i[2],L[P+3]=255}for(const L of this._figures)Hv(B,L,S);return T.putImageData(B,2,2),{canvas:D.canvas,offsetX:u-2*A,offsetY:h-2*w,scaleX:A,scaleY:w}}isModifyingCurrentTransform(){return!0}getPattern(t,i,s,r){dh(t,this._bbox);const l=new Float32Array(2);if(r===Ne.SHADING)st.singularValueDecompose2dScale(ie(t),l);else if(this.matrix){st.singularValueDecompose2dScale(this.matrix,l);const[u,h]=l;st.singularValueDecompose2dScale(i.baseTransform,l),l[0]*=u,l[1]*=h}else st.singularValueDecompose2dScale(i.baseTransform,l);const c=this._createMeshCanvas(l,r===Ne.SHADING?null:this._background,i.cachedCanvases);return r!==Ne.SHADING&&(t.setTransform(...i.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(c.offsetX,c.offsetY),t.scale(c.scaleX,c.scaleY),t.createPattern(c.canvas,"no-repeat")}}class Gv extends _h{getPattern(){return"hotpink"}}function qv(g){switch(g[0]){case"RadialAxial":return new Fv(g);case"Mesh":return new Iv(g);case"Dummy":return new Gv}throw new Error(`Unknown IR type: ${g[0]}`)}const am={COLORED:1,UNCOLORED:2};class Eh{static MAX_PATTERN_SIZE=3e3;constructor(t,i,s,r){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=i,this.canvasGraphicsFactory=s,this.baseTransform=r}createPatternCanvas(t,i){const{bbox:s,operatorList:r,paintType:l,tilingType:c,color:u,canvasGraphicsFactory:h}=this;let{xstep:f,ystep:m}=this;f=Math.abs(f),m=Math.abs(m),bl("TilingType: "+c);const y=s[0],b=s[1],A=s[2],w=s[3],S=A-y,E=w-b,_=new Float32Array(2);st.singularValueDecompose2dScale(this.matrix,_);const[D,T]=_;st.singularValueDecompose2dScale(this.baseTransform,_);const B=D*_[0],O=T*_[1];let L=S,P=E,q=!1,K=!1;const J=Math.ceil(f*B),W=Math.ceil(m*O),ht=Math.ceil(S*B),yt=Math.ceil(E*O);J>=ht?L=f:q=!0,W>=yt?P=m:K=!0;const bt=this.getSizeAndScale(L,this.ctx.canvas.width,B),vt=this.getSizeAndScale(P,this.ctx.canvas.height,O),k=t.cachedCanvases.getCanvas("pattern",bt.size,vt.size),V=k.context,tt=h.createCanvasGraphics(V,i);if(tt.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(tt,l,u),V.translate(-bt.scale*y,-vt.scale*b),tt.transform(0,bt.scale,0,0,vt.scale,0,0),V.save(),tt.dependencyTracker?.save(),this.clipBbox(tt,y,b,A,w),tt.baseTransform=ie(tt.ctx),tt.executeOperatorList(r),tt.endDrawing(),tt.dependencyTracker?.restore(),V.restore(),q||K){const pt=k.canvas;q&&(L=f),K&&(P=m);const xt=this.getSizeAndScale(L,this.ctx.canvas.width,B),R=this.getSizeAndScale(P,this.ctx.canvas.height,O),I=xt.size,Q=R.size,et=t.cachedCanvases.getCanvas("pattern-workaround",I,Q),ct=et.context,ft=q?Math.floor(S/f):0,ut=K?Math.floor(E/m):0;for(let ee=0;ee<=ft;ee++)for(let jt=0;jt<=ut;jt++)ct.drawImage(pt,I*ee,Q*jt,I,Q,0,0,I,Q);return{canvas:et.canvas,scaleX:xt.scale,scaleY:R.scale,offsetX:y,offsetY:b}}return{canvas:k.canvas,scaleX:bt.scale,scaleY:vt.scale,offsetX:y,offsetY:b}}getSizeAndScale(t,i,s){const r=Math.max(Eh.MAX_PATTERN_SIZE,i);let l=Math.ceil(t*s);return l>=r?l=r:s=l/t,{scale:s,size:l}}clipBbox(t,i,s,r,l){const c=r-i,u=l-s;t.ctx.rect(i,s,c,u),st.axialAlignedBoundingBox([i,s,r,l],ie(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,i,s){const r=t.ctx,l=t.current;switch(i){case am.COLORED:const{fillStyle:c,strokeStyle:u}=this.ctx;r.fillStyle=l.fillColor=c,r.strokeStyle=l.strokeColor=u;break;case am.UNCOLORED:r.fillStyle=r.strokeStyle=s,l.fillColor=l.strokeColor=s;break;default:throw new nv(`Unsupported paint type: ${i}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,i,s,r,l){let c=s;r!==Ne.SHADING&&(c=st.transform(c,i.baseTransform),this.matrix&&(c=st.transform(c,this.matrix)));const u=this.createPatternCanvas(i,l);let h=new DOMMatrix(c);h=h.translate(u.offsetX,u.offsetY),h=h.scale(1/u.scaleX,1/u.scaleY);const f=t.createPattern(u.canvas,"repeat");return f.setTransform(h),f}}function Vv({src:g,srcPos:t=0,dest:i,width:s,height:r,nonBlackColor:l=4294967295,inverseDecode:c=!1}){const u=Oe.isLittleEndian?4278190080:255,[h,f]=c?[l,u]:[u,l],m=s>>3,y=s&7,b=g.length;i=new Uint32Array(i.buffer);let A=0;for(let w=0;w<r;w++){for(const E=t+m;t<E;t++){const _=t<b?g[t]:255;i[A++]=_&128?f:h,i[A++]=_&64?f:h,i[A++]=_&32?f:h,i[A++]=_&16?f:h,i[A++]=_&8?f:h,i[A++]=_&4?f:h,i[A++]=_&2?f:h,i[A++]=_&1?f:h}if(y===0)continue;const S=t<b?g[t++]:255;for(let E=0;E<y;E++)i[A++]=S&1<<7-E?f:h}return{srcPos:t,destPos:A}}const rm=16,om=100,Xv=15,lm=10,Ze=16,Ju=new DOMMatrix,ci=new Float32Array(2),pa=new Float32Array([1/0,1/0,-1/0,-1/0]);function Yv(g,t){if(g._removeMirroring)throw new Error("Context is already forwarding operations.");g.__originalSave=g.save,g.__originalRestore=g.restore,g.__originalRotate=g.rotate,g.__originalScale=g.scale,g.__originalTranslate=g.translate,g.__originalTransform=g.transform,g.__originalSetTransform=g.setTransform,g.__originalResetTransform=g.resetTransform,g.__originalClip=g.clip,g.__originalMoveTo=g.moveTo,g.__originalLineTo=g.lineTo,g.__originalBezierCurveTo=g.bezierCurveTo,g.__originalRect=g.rect,g.__originalClosePath=g.closePath,g.__originalBeginPath=g.beginPath,g._removeMirroring=()=>{g.save=g.__originalSave,g.restore=g.__originalRestore,g.rotate=g.__originalRotate,g.scale=g.__originalScale,g.translate=g.__originalTranslate,g.transform=g.__originalTransform,g.setTransform=g.__originalSetTransform,g.resetTransform=g.__originalResetTransform,g.clip=g.__originalClip,g.moveTo=g.__originalMoveTo,g.lineTo=g.__originalLineTo,g.bezierCurveTo=g.__originalBezierCurveTo,g.rect=g.__originalRect,g.closePath=g.__originalClosePath,g.beginPath=g.__originalBeginPath,delete g._removeMirroring},g.save=function(){t.save(),this.__originalSave()},g.restore=function(){t.restore(),this.__originalRestore()},g.translate=function(i,s){t.translate(i,s),this.__originalTranslate(i,s)},g.scale=function(i,s){t.scale(i,s),this.__originalScale(i,s)},g.transform=function(i,s,r,l,c,u){t.transform(i,s,r,l,c,u),this.__originalTransform(i,s,r,l,c,u)},g.setTransform=function(i,s,r,l,c,u){t.setTransform(i,s,r,l,c,u),this.__originalSetTransform(i,s,r,l,c,u)},g.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},g.rotate=function(i){t.rotate(i),this.__originalRotate(i)},g.clip=function(i){t.clip(i),this.__originalClip(i)},g.moveTo=function(i,s){t.moveTo(i,s),this.__originalMoveTo(i,s)},g.lineTo=function(i,s){t.lineTo(i,s),this.__originalLineTo(i,s)},g.bezierCurveTo=function(i,s,r,l,c,u){t.bezierCurveTo(i,s,r,l,c,u),this.__originalBezierCurveTo(i,s,r,l,c,u)},g.rect=function(i,s,r,l){t.rect(i,s,r,l),this.__originalRect(i,s,r,l)},g.closePath=function(){t.closePath(),this.__originalClosePath()},g.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class $v{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,i,s){let r;return this.cache[t]!==void 0?(r=this.cache[t],this.canvasFactory.reset(r,i,s)):(r=this.canvasFactory.create(i,s),this.cache[t]=r),r}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const i=this.cache[t];this.canvasFactory.destroy(i),delete this.cache[t]}}}function sl(g,t,i,s,r,l,c,u,h,f){const[m,y,b,A,w,S]=ie(g);if(y===0&&b===0){const D=c*m+w,T=Math.round(D),B=u*A+S,O=Math.round(B),L=(c+h)*m+w,P=Math.abs(Math.round(L)-T)||1,q=(u+f)*A+S,K=Math.abs(Math.round(q)-O)||1;return g.setTransform(Math.sign(m),0,0,Math.sign(A),T,O),g.drawImage(t,i,s,r,l,0,0,P,K),g.setTransform(m,y,b,A,w,S),[P,K]}if(m===0&&A===0){const D=u*b+w,T=Math.round(D),B=c*y+S,O=Math.round(B),L=(u+f)*b+w,P=Math.abs(Math.round(L)-T)||1,q=(c+h)*y+S,K=Math.abs(Math.round(q)-O)||1;return g.setTransform(0,Math.sign(y),Math.sign(b),0,T,O),g.drawImage(t,i,s,r,l,0,0,K,P),g.setTransform(m,y,b,A,w,S),[K,P]}g.drawImage(t,i,s,r,l,c,u,h,f);const E=Math.hypot(m,y),_=Math.hypot(b,A);return[E*h,_*f]}class cm{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=nh;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=De.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,i,s){s?.(this),this.clipBox=new Float32Array([0,0,t,i]),this.minMax=pa.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=Ne.FILL,i=null){const s=this.minMax.slice();if(t===Ne.STROKE){i||$t("Stroke bounding box must include transform."),st.singularValueDecompose2dScale(i,ci);const r=ci[0]*this.lineWidth/2,l=ci[1]*this.lineWidth/2;s[0]-=r,s[1]-=l,s[2]+=r,s[3]+=l}return s}updateClipFromPath(){const t=st.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(pa,0)}getClippedPathBoundingBox(t=Ne.FILL,i=null){return st.intersect(this.clipBox,this.getPathBoundingBox(t,i))}}function um(g,t){if(t instanceof ImageData){g.putImageData(t,0,0);return}const i=t.height,s=t.width,r=i%Ze,l=(i-r)/Ze,c=r===0?l:l+1,u=g.createImageData(s,Ze);let h=0,f;const m=t.data,y=u.data;let b,A,w,S;if(t.kind===cl.GRAYSCALE_1BPP){const E=m.byteLength,_=new Uint32Array(y.buffer,0,y.byteLength>>2),D=_.length,T=s+7>>3,B=4294967295,O=Oe.isLittleEndian?4278190080:255;for(b=0;b<c;b++){for(w=b<l?Ze:r,f=0,A=0;A<w;A++){const L=E-h;let P=0;const q=L>T?s:L*8-7,K=q&-8;let J=0,W=0;for(;P<K;P+=8)W=m[h++],_[f++]=W&128?B:O,_[f++]=W&64?B:O,_[f++]=W&32?B:O,_[f++]=W&16?B:O,_[f++]=W&8?B:O,_[f++]=W&4?B:O,_[f++]=W&2?B:O,_[f++]=W&1?B:O;for(;P<q;P++)J===0&&(W=m[h++],J=128),_[f++]=W&J?B:O,J>>=1}for(;f<D;)_[f++]=0;g.putImageData(u,0,b*Ze)}}else if(t.kind===cl.RGBA_32BPP){for(A=0,S=s*Ze*4,b=0;b<l;b++)y.set(m.subarray(h,h+S)),h+=S,g.putImageData(u,0,A),A+=Ze;b<c&&(S=s*r*4,y.set(m.subarray(h,h+S)),g.putImageData(u,0,A))}else if(t.kind===cl.RGB_24BPP)for(w=Ze,S=s*w,b=0;b<c;b++){for(b>=l&&(w=r,S=s*w),f=0,A=S;A--;)y[f++]=m[h++],y[f++]=m[h++],y[f++]=m[h++],y[f++]=255;g.putImageData(u,0,b*Ze)}else throw new Error(`bad image kind: ${t.kind}`)}function hm(g,t){if(t.bitmap){g.drawImage(t.bitmap,0,0);return}const i=t.height,s=t.width,r=i%Ze,l=(i-r)/Ze,c=r===0?l:l+1,u=g.createImageData(s,Ze);let h=0;const f=t.data,m=u.data;for(let y=0;y<c;y++){const b=y<l?Ze:r;({srcPos:h}=Vv({src:f,srcPos:h,dest:m,width:s,height:b,nonBlackColor:0})),g.putImageData(u,0,y*Ze)}}function mr(g,t){const i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of i)g[s]!==void 0&&(t[s]=g[s]);g.setLineDash!==void 0&&(t.setLineDash(g.getLineDash()),t.lineDashOffset=g.lineDashOffset)}function al(g){g.strokeStyle=g.fillStyle="#000000",g.fillRule="nonzero",g.globalAlpha=1,g.lineWidth=1,g.lineCap="butt",g.lineJoin="miter",g.miterLimit=10,g.globalCompositeOperation="source-over",g.font="10px sans-serif",g.setLineDash!==void 0&&(g.setLineDash([]),g.lineDashOffset=0);const{filter:t}=g;t!=="none"&&t!==""&&(g.filter="none")}function dm(g,t){if(t)return!0;st.singularValueDecompose2dScale(g,ci);const i=Math.fround(Xi.pixelRatio*Aa.PDF_TO_CSS_UNITS);return ci[0]<=i&&ci[1]<=i}const Kv=["butt","round","square"],Qv=["miter","round","bevel"],Zv={},fm={};class ba{constructor(t,i,s,r,l,{optionalContentConfig:c,markedContentStack:u=null},h,f,m){this.ctx=t,this.current=new cm(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=i,this.objs=s,this.canvasFactory=r,this.filterFactory=l,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=c,this.cachedCanvases=new $v(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=m??null}getObject(t,i,s=null){return typeof i=="string"?(this.dependencyTracker?.recordNamedDependency(t,i),i.startsWith("g_")?this.commonObjs.get(i):this.objs.get(i)):s}beginDrawing({transform:t,viewport:i,transparency:s=!1,background:r=null}){const l=this.ctx.canvas.width,c=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,l,c),this.ctx.fillStyle=u,s){const h=this.cachedCanvases.getCanvas("transparent",l,c);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...ie(this.compositeCtx))}this.ctx.save(),al(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...i.transform),this.viewportScale=i.scale,this.baseTransform=ie(this.ctx)}executeOperatorList(t,i,s,r,l){const c=t.argsArray,u=t.fnArray;let h=i||0;const f=c.length;if(f===h)return h;const m=f-h>lm&&typeof s=="function",y=m?Date.now()+Xv:0;let b=0;const A=this.commonObjs,w=this.objs;let S,E;for(;;){if(r!==void 0&&h===r.nextBreakPoint)return r.breakIt(h,s),h;if(!l||l(h))if(S=u[h],E=c[h]??null,S!==Er.dependency)E===null?this[S](h):this[S](h,...E);else for(const _ of E){this.dependencyTracker?.recordNamedData(_,h);const D=_.startsWith("g_")?A:w;if(!D.has(_))return D.get(_,s),h}if(h++,h===f)return h;if(m&&++b>lm){if(Date.now()>y)return s(),h;b=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const i of t.values())typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&(i.width=i.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const i=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=i}}}_scaleImage(t,i){const s=t.width??t.displayWidth,r=t.height??t.displayHeight;let l=Math.max(Math.hypot(i[0],i[1]),1),c=Math.max(Math.hypot(i[2],i[3]),1),u=s,h=r,f="prescale1",m,y;for(;l>2&&u>1||c>2&&h>1;){let b=u,A=h;l>2&&u>1&&(b=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),l/=u/b),c>2&&h>1&&(A=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,c/=h/A),m=this.cachedCanvases.getCanvas(f,b,A),y=m.context,y.clearRect(0,0,b,A),y.drawImage(t,0,0,u,h,0,0,b,A),t=m.canvas,u=b,h=A,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:h}}_createMaskCanvas(t,i){const s=this.ctx,{width:r,height:l}=i,c=this.current.fillColor,u=this.current.patternFill,h=ie(s);let f,m,y,b;if((i.bitmap||i.data)&&i.count>1){const J=i.bitmap||i.data.buffer;m=JSON.stringify(u?h:[h.slice(0,4),c]),f=this._cachedBitmapsMap.get(J),f||(f=new Map,this._cachedBitmapsMap.set(J,f));const W=f.get(m);if(W&&!u){const ht=Math.round(Math.min(h[0],h[2])+h[4]),yt=Math.round(Math.min(h[1],h[3])+h[5]);return this.dependencyTracker?.recordDependencies(t,xi.transformAndFill),{canvas:W,offsetX:ht,offsetY:yt}}y=W}y||(b=this.cachedCanvases.getCanvas("maskCanvas",r,l),hm(b.context,i));let A=st.transform(h,[1/r,0,0,-1/l,0,0]);A=st.transform(A,[1,0,0,1,0,-l]);const w=pa.slice();st.axialAlignedBoundingBox([0,0,r,l],A,w);const[S,E,_,D]=w,T=Math.round(_-S)||1,B=Math.round(D-E)||1,O=this.cachedCanvases.getCanvas("fillCanvas",T,B),L=O.context,P=S,q=E;L.translate(-P,-q),L.transform(...A),y||(y=this._scaleImage(b.canvas,Ii(L)),y=y.img,f&&u&&f.set(m,y)),L.imageSmoothingEnabled=dm(ie(L),i.interpolate),sl(L,y,0,0,y.width,y.height,0,0,r,l),L.globalCompositeOperation="source-in";const K=st.transform(Ii(L),[1,0,0,1,-P,-q]);return L.fillStyle=u?c.getPattern(s,this,K,Ne.FILL,t):c,L.fillRect(0,0,r,l),f&&!u&&(this.cachedCanvases.delete("fillCanvas"),f.set(m,O.canvas)),this.dependencyTracker?.recordDependencies(t,xi.transformAndFill),{canvas:O.canvas,offsetX:Math.round(P),offsetY:Math.round(q)}}setLineWidth(t,i){this.dependencyTracker?.recordSimpleData("lineWidth",t),i!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=i,this.ctx.lineWidth=i}setLineCap(t,i){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=Kv[i]}setLineJoin(t,i){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=Qv[i]}setMiterLimit(t,i){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=i}setDash(t,i,s){this.dependencyTracker?.recordSimpleData("dash",t);const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(i),r.lineDashOffset=s)}setRenderingIntent(t,i){}setFlatness(t,i){}setGState(t,i){for(const[s,r]of i)switch(s){case"LW":this.setLineWidth(t,r);break;case"LC":this.setLineCap(t,r);break;case"LJ":this.setLineJoin(t,r);break;case"ML":this.setMiterLimit(t,r);break;case"D":this.setDash(t,r[0],r[1]);break;case"RI":this.setRenderingIntent(t,r);break;case"FL":this.setFlatness(t,r);break;case"Font":this.setFont(t,r[0],r[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=r;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=r;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=r;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(r);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const i=this.ctx.canvas.width,s=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,l=this.cachedCanvases.getCanvas(r,i,s);this.suspendedCtx=this.ctx;const c=this.ctx=l.context;c.setTransform(this.suspendedCtx.getTransform()),mr(this.suspendedCtx,c),Yv(c,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),mr(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const i=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,i,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,i,s,r){const l=r[0],c=r[1],u=r[2]-l,h=r[3]-c;u===0||h===0||(this.genericComposeSMask(i.context,s,u,h,i.subtype,i.backdrop,i.transferMap,l,c,i.offsetX,i.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(s.canvas,0,0),t.restore())}genericComposeSMask(t,i,s,r,l,c,u,h,f,m,y){let b=t.canvas,A=h-m,w=f-y;if(c)if(A<0||w<0||A+s>b.width||w+r>b.height){const E=this.cachedCanvases.getCanvas("maskExtension",s,r),_=E.context;_.drawImage(b,-A,-w),_.globalCompositeOperation="destination-atop",_.fillStyle=c,_.fillRect(0,0,s,r),_.globalCompositeOperation="source-over",b=E.canvas,A=w=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const E=new Path2D;E.rect(A,w,s,r),t.clip(E),t.globalCompositeOperation="destination-atop",t.fillStyle=c,t.fillRect(A,w,s,r),t.restore()}i.save(),i.globalAlpha=1,i.setTransform(1,0,0,1,0,0),l==="Alpha"&&u?i.filter=this.filterFactory.addAlphaFilter(u):l==="Luminosity"&&(i.filter=this.filterFactory.addLuminosityFilter(u));const S=new Path2D;S.rect(h,f,s,r),i.clip(S),i.globalCompositeOperation="destination-in",i.drawImage(b,A,w,s,r,h,f,s,r),i.restore()}save(t){this.inSMaskMode&&mr(this.ctx,this.suspendedCtx),this.ctx.save();const i=this.current;this.stateStack.push(i),this.current=i.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&mr(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,i,s,r,l,c,u){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(i,s,r,l,c,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,i,s,r){let[l]=s;if(!r){l||=s[0]=new Path2D,this[i](t,l);return}if(this.dependencyTracker!==null){const c=i===Er.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,r[0]-c,r[2]+c,r[1]-c,r[3]+c).recordDependencies(t,["transform"])}l instanceof Path2D||(l=s[0]=Lm(l)),st.axialAlignedBoundingBox(r,ie(this.ctx),this.current.minMax),this[i](t,l),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,i,s=!0){const r=this.ctx,l=this.current.strokeColor;if(r.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof l=="object"&&l?.getPattern){const c=l.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.strokeStyle=l.getPattern(r,this,Ii(r),Ne.STROKE,t),c){const u=new Path2D;u.addPath(i,r.getTransform().invertSelf().multiplySelf(c)),i=u}this.rescaleAndStroke(i,!1),r.restore()}else this.rescaleAndStroke(i,!0);this.dependencyTracker?.recordDependencies(t,xi.stroke),s&&this.consumePath(t,i,this.current.getClippedPathBoundingBox(Ne.STROKE,ie(this.ctx))),r.globalAlpha=this.current.fillAlpha}closeStroke(t,i){this.stroke(t,i)}fill(t,i,s=!0){const r=this.ctx,l=this.current.fillColor,c=this.current.patternFill;let u=!1;if(c){const f=l.isModifyingCurrentTransform()?r.getTransform():null;if(this.dependencyTracker?.save(t),r.save(),r.fillStyle=l.getPattern(r,this,Ii(r),Ne.FILL,t),f){const m=new Path2D;m.addPath(i,r.getTransform().invertSelf().multiplySelf(f)),i=m}u=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(r.fill(i,"evenodd"),this.pendingEOFill=!1):r.fill(i)),this.dependencyTracker?.recordDependencies(t,xi.fill),u&&(r.restore(),this.dependencyTracker?.restore(t)),s&&this.consumePath(t,i,h)}eoFill(t,i){this.pendingEOFill=!0,this.fill(t,i)}fillStroke(t,i){this.fill(t,i,!1),this.stroke(t,i,!1),this.consumePath(t,i)}eoFillStroke(t,i){this.pendingEOFill=!0,this.fillStroke(t,i)}closeFillStroke(t,i){this.fillStroke(t,i)}closeEOFillStroke(t,i){this.pendingEOFill=!0,this.fillStroke(t,i)}endPath(t,i){this.consumePath(t,i)}rawFillPath(t,i){this.ctx.fill(i),this.dependencyTracker?.recordDependencies(t,xi.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=Zv}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=fm}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const i=this.pendingTextPaths,s=this.ctx;if(this.dependencyTracker){const{dependencyTracker:r}=this;i!==void 0&&r.recordFutureForcedDependency("textClip",r.getOpenMarker()).recordFutureForcedDependency("textClip",t),r.recordCloseMarker(t)}if(i!==void 0){const r=new Path2D,l=s.getTransform().invertSelf();for(const{transform:c,x:u,y:h,fontSize:f,path:m}of i)m&&r.addPath(m,new DOMMatrix(c).preMultiplySelf(l).translate(u,h).scale(f,-f));s.clip(r)}delete this.pendingTextPaths}setCharSpacing(t,i){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=i}setWordSpacing(t,i){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=i}setHScale(t,i){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=i/100}setLeading(t,i){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-i}setFont(t,i,s){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",i,t);const r=this.commonObjs.get(i),l=this.current;if(!r)throw new Error(`Can't find font for ${i}`);if(l.fontMatrix=r.fontMatrix||nh,(l.fontMatrix[0]===0||l.fontMatrix[3]===0)&&mt("Invalid font matrix for font "+i),s<0?(s=-s,l.fontDirection=-1):l.fontDirection=1,this.current.font=r,this.current.fontSize=s,r.isType3Font)return;const c=r.loadedName||"sans-serif",u=r.systemFontInfo?.css||`"${c}", ${r.fallbackName}`;let h="normal";r.black?h="900":r.bold&&(h="bold");const f=r.italic?"italic":"normal";let m=s;s<rm?m=rm:s>om&&(m=om),this.current.fontSizeScale=s/m,this.ctx.font=`${f} ${h} ${m}px ${u}`}setTextRenderingMode(t,i){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=i}setTextRise(t,i){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=i}moveText(t,i,s){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=i,this.current.y=this.current.lineY+=s}setLeadingMoveText(t,i,s){this.setLeading(t,-s),this.moveText(t,i,s)}setTextMatrix(t,i){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",t);const{current:s}=this;s.textMatrix=i,s.textMatrixScale=Math.hypot(i[0],i[1]),s.x=s.lineX=0,s.y=s.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#n(t,i,s){const r=new Path2D;return r.addPath(t,new DOMMatrix(s).invertSelf().multiplySelf(i)),r}paintChar(t,i,s,r,l,c){const u=this.ctx,h=this.current,f=h.font,m=h.textRenderingMode,y=h.fontSize/h.fontSizeScale,b=m&De.FILL_STROKE_MASK,A=!!(m&De.ADD_TO_PATH_FLAG),w=h.patternFill&&!f.missingFile,S=h.patternStroke&&!f.missingFile;let E;if((f.disableFontFace||A||w||S)&&!f.missingFile&&(E=f.getPathGenerator(this.commonObjs,i)),E&&(f.disableFontFace||w||S)){u.save(),u.translate(s,r),u.scale(y,-y),this.dependencyTracker?.recordCharacterBBox(t,u,f);let _;if(b===De.FILL||b===De.FILL_STROKE)if(l){_=u.getTransform(),u.setTransform(...l);const D=this.#n(E,_,l);u.fill(D)}else u.fill(E);if(b===De.STROKE||b===De.FILL_STROKE)if(c){_||=u.getTransform(),u.setTransform(...c);const{a:D,b:T,c:B,d:O}=_,L=st.inverseTransform(c),P=st.transform([D,T,B,O,0,0],L);st.singularValueDecompose2dScale(P,ci),u.lineWidth*=Math.max(ci[0],ci[1])/y,u.stroke(this.#n(E,_,c))}else u.lineWidth/=y,u.stroke(E);u.restore()}else(b===De.FILL||b===De.FILL_STROKE)&&(u.fillText(i,s,r),this.dependencyTracker?.recordCharacterBBox(t,u,f,y,s,r,()=>u.measureText(i))),(b===De.STROKE||b===De.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,u,f,y,s,r,()=>u.measureText(i)).recordDependencies(t,xi.stroke),u.strokeText(i,s,r));A&&((this.pendingTextPaths||=[]).push({transform:ie(u),x:s,y:r,fontSize:y,path:E}),this.dependencyTracker?.recordCharacterBBox(t,u,f,y,s,r))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const i=t.getImageData(0,0,10,10).data;let s=!1;for(let r=3;r<i.length;r+=4)if(i[r]>0&&i[r]<255){s=!0;break}return wt(this,"isFontSubpixelAAEnabled",s)}showText(t,i){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,xi.showText).resetBBox(t),this.current.textRenderingMode&De.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const s=this.current,r=s.font;if(r.isType3Font){this.showType3Text(t,i),this.dependencyTracker?.recordShowTextOperation(t);return}const l=s.fontSize;if(l===0){this.dependencyTracker?.recordOperation(t);return}const c=this.ctx,u=s.fontSizeScale,h=s.charSpacing,f=s.wordSpacing,m=s.fontDirection,y=s.textHScale*m,b=i.length,A=r.vertical,w=A?1:-1,S=r.defaultVMetrics,E=l*s.fontMatrix[0],_=s.textRenderingMode===De.FILL&&!r.disableFontFace&&!s.patternFill;c.save(),s.textMatrix&&c.transform(...s.textMatrix),c.translate(s.x,s.y+s.textRise),m>0?c.scale(y,-1):c.scale(y,1);let D,T;if(s.patternFill){c.save();const q=s.fillColor.getPattern(c,this,Ii(c),Ne.FILL,t);D=ie(c),c.restore(),c.fillStyle=q}if(s.patternStroke){c.save();const q=s.strokeColor.getPattern(c,this,Ii(c),Ne.STROKE,t);T=ie(c),c.restore(),c.strokeStyle=q}let B=s.lineWidth;const O=s.textMatrixScale;if(O===0||B===0){const q=s.textRenderingMode&De.FILL_STROKE_MASK;(q===De.STROKE||q===De.FILL_STROKE)&&(B=this.getSinglePixelWidth())}else B/=O;if(u!==1&&(c.scale(u,u),B/=u),c.lineWidth=B,r.isInvalidPDFjsFont){const q=[];let K=0;for(const W of i)q.push(W.unicode),K+=W.width;const J=q.join("");if(c.fillText(J,0,0),this.dependencyTracker!==null){const W=c.measureText(J);this.dependencyTracker.recordBBox(t,this.ctx,-W.actualBoundingBoxLeft,W.actualBoundingBoxRight,-W.actualBoundingBoxAscent,W.actualBoundingBoxDescent).recordShowTextOperation(t)}s.x+=K*E*y,c.restore(),this.compose();return}let L=0,P;for(P=0;P<b;++P){const q=i[P];if(typeof q=="number"){L+=w*q*l/1e3;continue}let K=!1;const J=(q.isSpace?f:0)+h,W=q.fontChar,ht=q.accent;let yt,bt,vt=q.width;if(A){const tt=q.vmetric||S,pt=-(q.vmetric?tt[1]:vt*.5)*E,xt=tt[2]*E;vt=tt?-tt[0]:vt,yt=pt/u,bt=(L+xt)/u}else yt=L/u,bt=0;let k;if(r.remeasure&&vt>0){k=c.measureText(W);const tt=k.width*1e3/l*u;if(vt<tt&&this.isFontSubpixelAAEnabled){const pt=vt/tt;K=!0,c.save(),c.scale(pt,1),yt/=pt}else vt!==tt&&(yt+=(vt-tt)/2e3*l/u)}if(this.contentVisible&&(q.isInFont||r.missingFile)){if(_&&!ht)c.fillText(W,yt,bt),this.dependencyTracker?.recordCharacterBBox(t,c,k?{bbox:null}:r,l/u,yt,bt,()=>k??c.measureText(W));else if(this.paintChar(t,W,yt,bt,D,T),ht){const tt=yt+l*ht.offset.x/u,pt=bt-l*ht.offset.y/u;this.paintChar(t,ht.fontChar,tt,pt,D,T)}}const V=A?vt*E-J*m:vt*E+J*m;L+=V,K&&c.restore()}A?s.y-=L:s.x+=L*y,c.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,i){const s=this.ctx,r=this.current,l=r.font,c=r.fontSize,u=r.fontDirection,h=l.vertical?1:-1,f=r.charSpacing,m=r.wordSpacing,y=r.textHScale*u,b=r.fontMatrix||nh,A=i.length,w=r.textRenderingMode===De.INVISIBLE;let S,E,_,D;if(w||c===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),r.textMatrix&&s.transform(...r.textMatrix),s.translate(r.x,r.y+r.textRise),s.scale(y,u);const T=this.dependencyTracker;for(this.dependencyTracker=T?new fl(T,t):null,S=0;S<A;++S){if(E=i[S],typeof E=="number"){D=h*E*c/1e3,this.ctx.translate(D,0),r.x+=D*y;continue}const B=(E.isSpace?m:0)+f,O=l.charProcOperatorList[E.operatorListId];O?this.contentVisible&&(this.save(),s.scale(c,c),s.transform(...b),this.executeOperatorList(O),this.restore()):mt(`Type3 character "${E.operatorListId}" is not available.`);const L=[E.width,0];st.applyTransform(L,b),_=L[0]*c+B,s.translate(_,0),r.x+=_*y}s.restore(),T&&(this.dependencyTracker=T)}setCharWidth(t,i,s){}setCharWidthAndBounds(t,i,s,r,l,c,u){const h=new Path2D;h.rect(r,l,c-r,u-l),this.ctx.clip(h),this.dependencyTracker?.recordBBox(t,this.ctx,r,c,l,u).recordClipBox(t,this.ctx,r,c,l,u),this.endPath(t)}getColorN_Pattern(t,i){let s;if(i[0]==="TilingPattern"){const r=this.baseTransform||ie(this.ctx),l={createCanvasGraphics:(c,u)=>new ba(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new fl(this.dependencyTracker,u,!0):null)};s=new Eh(i,this.ctx,l,r)}else s=this._getPattern(t,i[1],i[2]);return s}setStrokeColorN(t,...i){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,i),this.current.patternStroke=!0}setFillColorN(t,...i){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,i),this.current.patternFill=!0}setStrokeRGBColor(t,i){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=i,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,i){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=i,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,i,s=null){let r;return this.cachedPatterns.has(i)?r=this.cachedPatterns.get(i):(r=qv(this.getObject(t,i)),this.cachedPatterns.set(i,r)),s&&(r.matrix=s),r}shadingFill(t,i){if(!this.contentVisible)return;const s=this.ctx;this.save(t);const r=this._getPattern(t,i);s.fillStyle=r.getPattern(s,this,Ii(s),Ne.SHADING,t);const l=Ii(s);if(l){const{width:c,height:u}=s.canvas,h=pa.slice();st.axialAlignedBoundingBox([0,0,c,u],l,h);const[f,m,y,b]=h;this.ctx.fillRect(f,m,y-f,b-m)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,xi.transform).recordDependencies(t,xi.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){$t("Should not call beginInlineImage")}beginImageData(){$t("Should not call beginImageData")}paintFormXObjectBegin(t,i,s){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),i&&this.transform(t,...i),this.baseTransform=ie(this.ctx),s)){st.axialAlignedBoundingBox(s,this.baseTransform,this.current.minMax);const[r,l,c,u]=s,h=new Path2D;h.rect(r,l,c-r,u-l),this.ctx.clip(h),this.dependencyTracker?.recordClipBox(t,this.ctx,r,c,l,u),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,i){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;i.isolated||bl("TODO: Support non-isolated groups."),i.knockout&&mt("Knockout groups not supported.");const r=ie(s);if(i.matrix&&s.transform(...i.matrix),!i.bbox)throw new Error("Bounding box is required.");let l=pa.slice();st.axialAlignedBoundingBox(i.bbox,ie(s),l);const c=[0,0,s.canvas.width,s.canvas.height];l=st.intersect(l,c)||[0,0,0,0];const u=Math.floor(l[0]),h=Math.floor(l[1]),f=Math.max(Math.ceil(l[2])-u,1),m=Math.max(Math.ceil(l[3])-h,1);this.current.startNewPathAndClipBox([0,0,f,m]);let y="groupAt"+this.groupLevel;i.smask&&(y+="_smask_"+this.smaskCounter++%2);const b=this.cachedCanvases.getCanvas(y,f,m),A=b.context;A.translate(-u,-h),A.transform(...r);let w=new Path2D;const[S,E,_,D]=i.bbox;if(w.rect(S,E,_-S,D-E),i.matrix){const T=new Path2D;T.addPath(w,new DOMMatrix(i.matrix)),w=T}A.clip(w),i.smask&&this.smaskStack.push({canvas:b.canvas,context:A,offsetX:u,offsetY:h,subtype:i.smask.subtype,backdrop:i.smask.backdrop,transferMap:i.smask.transferMap||null,startTransformInverse:null}),(!i.smask||this.dependencyTracker)&&(s.setTransform(1,0,0,1,0,0),s.translate(u,h),s.save()),mr(s,A),this.ctx=A,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(s),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(t,i){if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),i.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const l=ie(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...l);const c=pa.slice();st.axialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],l,c),this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(c)}}beginAnnotation(t,i,s,r,l,c){if(this.#t(),al(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),s){const u=s[2]-s[0],h=s[3]-s[1];if(c&&this.annotationCanvasMap){r=r.slice(),r[4]-=s[0],r[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=u,s[3]=h,st.singularValueDecompose2dScale(ie(this.ctx),ci);const{viewportScale:f}=this,m=Math.ceil(u*this.outputScaleX*f),y=Math.ceil(h*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(m,y);const{canvas:b,context:A}=this.annotationCanvas;this.annotationCanvasMap.set(i,b),this.annotationCanvas.savedCtx=this.ctx,this.ctx=A,this.ctx.save(),this.ctx.setTransform(ci[0],0,0,-ci[1],0,h*ci[1]),al(this.ctx)}else{al(this.ctx),this.endPath(t);const f=new Path2D;f.rect(s[0],s[1],u,h),this.ctx.clip(f)}}this.current=new cm(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...r),this.transform(t,...l)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,i){if(!this.contentVisible)return;const s=i.count;i=this.getObject(t,i.data,i),i.count=s;const r=this.ctx,l=this._createMaskCanvas(t,i),c=l.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(c,l.offsetX,l.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,l.offsetX,l.offsetX+c.width,l.offsetY,l.offsetY+c.height).recordOperation(t),r.restore(),this.compose()}paintImageMaskXObjectRepeat(t,i,s,r=0,l=0,c,u){if(!this.contentVisible)return;i=this.getObject(t,i.data,i);const h=this.ctx;h.save();const f=ie(h);h.transform(s,r,l,c,0,0);const m=this._createMaskCanvas(t,i);h.setTransform(1,0,0,1,m.offsetX-f[4],m.offsetY-f[5]),this.dependencyTracker?.resetBBox(t);for(let y=0,b=u.length;y<b;y+=2){const A=st.transform(f,[s,r,l,c,u[y],u[y+1]]);h.drawImage(m.canvas,A[4],A[5]),this.dependencyTracker?.recordBBox(t,this.ctx,A[4],A[4]+m.canvas.width,A[5],A[5]+m.canvas.height)}h.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,i){if(!this.contentVisible)return;const s=this.ctx,r=this.current.fillColor,l=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,xi.transformAndFill);for(const c of i){const{data:u,width:h,height:f,transform:m}=c,y=this.cachedCanvases.getCanvas("maskCanvas",h,f),b=y.context;b.save();const A=this.getObject(t,u,c);hm(b,A),b.globalCompositeOperation="source-in",b.fillStyle=l?r.getPattern(b,this,Ii(s),Ne.FILL,t):r,b.fillRect(0,0,h,f),b.restore(),s.save(),s.transform(...m),s.scale(1,-1),sl(s,y.canvas,0,0,h,f,0,-1,1,1),this.dependencyTracker?.recordBBox(t,s,0,h,0,f),s.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,i){if(!this.contentVisible)return;const s=this.getObject(t,i);if(!s){mt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,s)}paintImageXObjectRepeat(t,i,s,r,l){if(!this.contentVisible)return;const c=this.getObject(t,i);if(!c){mt("Dependent image isn't ready yet");return}const u=c.width,h=c.height,f=[];for(let m=0,y=l.length;m<y;m+=2)f.push({transform:[s,0,0,r,l[m],l[m+1]],x:0,y:0,w:u,h});this.paintInlineImageXObjectGroup(t,c,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:i,width:s,height:r}=t,l=this.cachedCanvases.getCanvas("inlineImage",s,r),c=l.context;return c.filter=this.current.transferMaps,c.drawImage(i,0,0),c.filter="none",l.canvas}paintInlineImageXObject(t,i){if(!this.contentVisible)return;const s=i.width,r=i.height,l=this.ctx;this.save(t);const{filter:c}=l;c!=="none"&&c!==""&&(l.filter="none"),l.scale(1/s,-1/r);let u;if(i.bitmap)u=this.applyTransferMapsToBitmap(i);else if(typeof HTMLElement=="function"&&i instanceof HTMLElement||!i.data)u=i;else{const m=this.cachedCanvases.getCanvas("inlineImage",s,r).context;um(m,i),u=this.applyTransferMapsToCanvas(m)}const h=this._scaleImage(u,Ii(l));l.imageSmoothingEnabled=dm(ie(l),i.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,l,0,s,-r,0).recordDependencies(t,xi.imageXObject).recordOperation(t),sl(l,h.img,0,0,h.paintWidth,h.paintHeight,0,-r,s,r),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,i,s){if(!this.contentVisible)return;const r=this.ctx;let l;if(i.bitmap)l=i.bitmap;else{const c=i.width,u=i.height,f=this.cachedCanvases.getCanvas("inlineImage",c,u).context;um(f,i),l=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(t);for(const c of s)r.save(),r.transform(...c.transform),r.scale(1,-1),sl(r,l,c.x,c.y,c.w,c.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,r,0,1,-1,0),r.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,xi.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,i){}markPointProps(t,i,s){}beginMarkedContent(t,i){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,i,s){this.dependencyTracker?.beginMarkedContent(t),i==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,i,s){const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const l=this.ctx;this.pendingClip?(r||(this.pendingClip===fm?l.clip(i,"evenodd"):l.clip(i)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=ie(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const i=Math.abs(t[0]*t[3]-t[2]*t[1]),s=Math.hypot(t[0],t[2]),r=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(s,r)/i}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:i,b:s,c:r,d:l}=this.ctx.getTransform();let c,u;if(s===0&&r===0){const h=Math.abs(i),f=Math.abs(l);if(h===f)if(t===0)c=u=1/h;else{const m=h*t;c=u=m<1?1/m:1}else if(t===0)c=1/h,u=1/f;else{const m=h*t,y=f*t;c=m<1?1/m:1,u=y<1?1/y:1}}else{const h=Math.abs(i*l-s*r),f=Math.hypot(i,s),m=Math.hypot(r,l);if(t===0)c=m/h,u=f/h;else{const y=t*h;c=m>y?m/y:1,u=f>y?f/y:1}}this._cachedScaleForStroking[0]=c,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t,i){const{ctx:s,current:{lineWidth:r}}=this,[l,c]=this.getScaleForStroking();if(l===c){s.lineWidth=(r||1)*l,s.stroke(t);return}const u=s.getLineDash();i&&s.save(),s.scale(l,c),Ju.a=1/l,Ju.d=1/c;const h=new Path2D;if(h.addPath(t,Ju),u.length>0){const f=Math.max(l,c);s.setLineDash(u.map(m=>m/f)),s.lineDashOffset/=f}s.lineWidth=r||1,s.stroke(h),i&&s.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const g in Er)ba.prototype[g]!==void 0&&(ba.prototype[Er[g]]=ba.prototype[g]);class gs{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class Wv{#t;#e;constructor({parsedData:t,rawData:i}){this.#t=t,this.#e=i}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const ha=Symbol("INTERNAL");class Jv{#t=!1;#e=!1;#n=!1;#i=!0;constructor(t,{name:i,intent:s,usage:r,rbGroups:l}){this.#t=!!(t&li.DISPLAY),this.#e=!!(t&li.PRINT),this.name=i,this.intent=s,this.usage=r,this.rbGroups=l}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;const{print:t,view:i}=this.usage;return this.#t?i?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,i,s=!1){t!==ha&&$t("Internal method `_setVisible` called."),this.#n=s,this.#i=i}}class tA{#t=null;#e=new Map;#n=null;#i=null;constructor(t,i=li.DISPLAY){if(this.renderingIntent=i,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#i=t.order;for(const s of t.groups)this.#e.set(s.id,new Jv(i,s));if(t.baseState==="OFF")for(const s of this.#e.values())s._setVisible(ha,!1);for(const s of t.on)this.#e.get(s)._setVisible(ha,!0);for(const s of t.off)this.#e.get(s)._setVisible(ha,!1);this.#n=this.getHash()}}#r(t){const i=t.length;if(i<2)return!0;const s=t[0];for(let r=1;r<i;r++){const l=t[r];let c;if(Array.isArray(l))c=this.#r(l);else if(this.#e.has(l))c=this.#e.get(l).visible;else return mt(`Optional content group not found: ${l}`),!0;switch(s){case"And":if(!c)return!1;break;case"Or":if(c)return!0;break;case"Not":return!c;default:return!0}}return s==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return bl("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(mt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#r(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const i of t.ids){if(!this.#e.has(i))return mt(`Optional content group not found: ${i}`),!0;if(this.#e.get(i).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const i of t.ids){if(!this.#e.has(i))return mt(`Optional content group not found: ${i}`),!0;if(!this.#e.get(i).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const i of t.ids){if(!this.#e.has(i))return mt(`Optional content group not found: ${i}`),!0;if(!this.#e.get(i).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const i of t.ids){if(!this.#e.has(i))return mt(`Optional content group not found: ${i}`),!0;if(this.#e.get(i).visible)return!1}return!0}return mt(`Unknown optional content policy ${t.policy}.`),!0}return mt(`Unknown group type ${t.type}.`),!0}setVisibility(t,i=!0,s=!0){const r=this.#e.get(t);if(!r){mt(`Optional content group not found: ${t}`);return}if(s&&i&&r.rbGroups.length)for(const l of r.rbGroups)for(const c of l)c!==t&&this.#e.get(c)?._setVisible(ha,!1,!0);r._setVisible(ha,!!i,!0),this.#t=null}setOCGState({state:t,preserveRB:i}){let s;for(const r of t){switch(r){case"ON":case"OFF":case"Toggle":s=r;continue}const l=this.#e.get(r);if(l)switch(s){case"ON":this.setVisibility(r,!0,i);break;case"OFF":this.setVisibility(r,!1,i);break;case"Toggle":this.setVisibility(r,!l.visible,i);break}}this.#t=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new Bm;for(const[i,s]of this.#e)t.update(`${i}:${s.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class eA{constructor(t,{disableRange:i=!1,disableStream:s=!1}){Nt(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:l,progressiveDone:c,contentDispositionFilename:u}=t;if(this._queuedChunks=[],this._progressiveDone=c,this._contentDispositionFilename=u,l?.length>0){const h=l instanceof Uint8Array&&l.byteLength===l.buffer.byteLength?l.buffer:new Uint8Array(l).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!s,this._isRangeSupported=!i,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,f)=>{this._onReceiveData({begin:h,chunk:f})}),t.addProgressListener((h,f)=>{this._onProgress({loaded:h,total:f})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:i}){const s=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const r=this._rangeReaders.some(function(l){return l._begin!==t?!1:(l._enqueue(s),!0)});Nt(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const i=this._rangeReaders.indexOf(t);i>=0&&this._rangeReaders.splice(i,1)}getFullReader(){Nt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new iA(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=new nA(this,t,i);return this._pdfDataRangeTransport.requestDataRange(t,i),this._rangeReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeReaders.slice(0))i.cancel(t);this._pdfDataRangeTransport.abort()}}class iA{constructor(t,i,s=!1,r=null){this._stream=t,this._done=s||!1,this._filename=vh(r)?r:null,this._queuedChunks=i||[],this._loaded=0;for(const l of this._queuedChunks)this._loaded+=l.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class nA{constructor(t,i,s){this._stream=t,this._begin=i,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function sA(g){let t=!0,i=s("filename\\*","i").exec(g);if(i){i=i[1];let m=u(i);return m=unescape(m),m=h(m),m=f(m),l(m)}if(i=c(g),i){const m=f(i);return l(m)}if(i=s("filename","i").exec(g),i){i=i[1];let m=u(i);return m=f(m),l(m)}function s(m,y){return new RegExp("(?:^|;)\\s*"+m+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',y)}function r(m,y){if(m){if(!/^[\x00-\xFF]+$/.test(y))return y;try{const b=new TextDecoder(m,{fatal:!0}),A=Dr(y);y=b.decode(A),t=!1}catch{}}return y}function l(m){return t&&/[\x80-\xff]/.test(m)&&(m=r("utf-8",m),t&&(m=r("iso-8859-1",m))),m}function c(m){const y=[];let b;const A=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(b=A.exec(m))!==null;){let[,S,E,_]=b;if(S=parseInt(S,10),S in y){if(S===0)break;continue}y[S]=[E,_]}const w=[];for(let S=0;S<y.length&&S in y;++S){let[E,_]=y[S];_=u(_),E&&(_=unescape(_),S===0&&(_=h(_))),w.push(_)}return w.join("")}function u(m){if(m.startsWith('"')){const y=m.slice(1).split('\\"');for(let b=0;b<y.length;++b){const A=y[b].indexOf('"');A!==-1&&(y[b]=y[b].slice(0,A),y.length=b+1),y[b]=y[b].replaceAll(/\\(.)/g,"$1")}m=y.join('"')}return m}function h(m){const y=m.indexOf("'");if(y===-1)return m;const b=m.slice(0,y),w=m.slice(y+1).replace(/^[^']*'/,"");return r(b,w)}function f(m){return!m.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(m)?m:m.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(y,b,A,w){if(A==="q"||A==="Q")return w=w.replaceAll("_"," "),w=w.replaceAll(/=([0-9a-fA-F]{2})/g,function(S,E){return String.fromCharCode(parseInt(E,16))}),r(b,w);try{w=atob(w)}catch{}return r(b,w)})}return""}function Im(g,t){const i=new Headers;if(!g||!t||typeof t!="object")return i;for(const s in t){const r=t[s];r!==void 0&&i.append(s,r)}return i}function Sl(g){return URL.parse(g)?.origin??null}function Gm({responseHeaders:g,isHttp:t,rangeChunkSize:i,disableRange:s}){const r={allowRangeRequests:!1,suggestedLength:void 0},l=parseInt(g.get("Content-Length"),10);return!Number.isInteger(l)||(r.suggestedLength=l,l<=2*i)||s||!t||g.get("Accept-Ranges")!=="bytes"||(g.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function qm(g){const t=g.get("Content-Disposition");if(t){let i=sA(t);if(i.includes("%"))try{i=decodeURIComponent(i)}catch{}if(vh(i))return i}return null}function kr(g,t){return new dl(`Unexpected server response (${g}) while retrieving PDF "${t}".`,g,g===404||g===0&&t.startsWith("file:"))}function Vm(g){return g===200||g===206}function Xm(g,t,i){return{method:"GET",headers:g,signal:i.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function Ym(g){return g instanceof Uint8Array?g.buffer:g instanceof ArrayBuffer?g:(mt(`getArrayBuffer - unexpected data format: ${g}`),new Uint8Array(g).buffer)}class aA{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=Im(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Nt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new rA(this),this._fullRequestReader}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=new oA(this,t,i);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class rA{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const i=t.source;this._withCredentials=i.withCredentials||!1,this._contentLength=i.length,this._headersCapability=Promise.withResolvers(),this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange;const s=new Headers(t.headers),r=i.url;fetch(r,Xm(s,this._withCredentials,this._abortController)).then(l=>{if(t._responseOrigin=Sl(l.url),!Vm(l.status))throw kr(l.status,r);this._reader=l.body.getReader(),this._headersCapability.resolve();const c=l.headers,{allowRangeRequests:u,suggestedLength:h}=Gm({responseHeaders:c,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=h||this._contentLength,this._filename=qm(c),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new qn("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Ym(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class oA{constructor(t,i,s){this._stream=t,this._reader=null,this._loaded=0;const r=t.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const l=new Headers(t.headers);l.append("Range",`bytes=${i}-${s-1}`);const c=r.url;fetch(c,Xm(l,this._withCredentials,this._abortController)).then(u=>{const h=Sl(u.url);if(h!==t._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${t._responseOrigin}".`);if(!Vm(u.status))throw kr(u.status,c);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:Ym(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const th=200,eh=206;function lA(g){const t=g.response;return typeof t!="string"?t:Dr(t).buffer}class cA{_responseOrigin=null;constructor({url:t,httpHeaders:i,withCredentials:s}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=Im(this.isHttp,i),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const i=new XMLHttpRequest,s=this.currXhrId++,r=this.pendingRequests[s]={xhr:i};i.open("GET",this.url),i.withCredentials=this.withCredentials;for(const[l,c]of this.headers)i.setRequestHeader(l,c);return this.isHttp&&"begin"in t&&"end"in t?(i.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),r.expectedStatus=eh):r.expectedStatus=th,i.responseType="arraybuffer",Nt(t.onError,"Expected `onError` callback to be provided."),i.onerror=()=>{t.onError(i.status)},i.onreadystatechange=this.onStateChange.bind(this,s),i.onprogress=this.onProgress.bind(this,s),r.onHeadersReceived=t.onHeadersReceived,r.onDone=t.onDone,r.onError=t.onError,r.onProgress=t.onProgress,i.send(null),s}onProgress(t,i){const s=this.pendingRequests[t];s&&s.onProgress?.(i)}onStateChange(t,i){const s=this.pendingRequests[t];if(!s)return;const r=s.xhr;if(r.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),r.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],r.status===0&&this.isHttp){s.onError(r.status);return}const l=r.status||th;if(!(l===th&&s.expectedStatus===eh)&&l!==s.expectedStatus){s.onError(r.status);return}const u=lA(r);if(l===eh){const h=r.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);f?s.onDone({begin:parseInt(f[1],10),chunk:u}):(mt('Missing or invalid "Content-Range" header.'),s.onError(0))}else u?s.onDone({begin:0,chunk:u}):s.onError(r.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const i=this.pendingRequests[t].xhr;delete this.pendingRequests[t],i.abort()}}class uA{constructor(t){this._source=t,this._manager=new cA(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const i=this._rangeRequestReaders.indexOf(t);i>=0&&this._rangeRequestReaders.splice(i,1)}getFullReader(){return Nt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new hA(this._manager,this._source),this._fullRequestReader}getRangeReader(t,i){const s=new dA(this._manager,t,i);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class hA{constructor(t,i){this._manager=t,this._url=i.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=i.disableRange||!1,this._contentLength=i.length,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,i=this._manager.getRequestXhr(t);this._manager._responseOrigin=Sl(i.responseURL);const s=i.getAllResponseHeaders(),r=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(u=>{const[h,...f]=u.split(": ");return[h,f.join(": ")]}):[]),{allowRangeRequests:l,suggestedLength:c}=Gm({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});l&&(this._isRangeSupported=!0),this._contentLength=c||this._contentLength,this._filename=qm(r),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=kr(t,this._url),this._headersCapability.reject(this._storedError);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class dA{constructor(t,i,s){this._manager=t,this._url=t.url,this._requestId=t.request({begin:i,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=Sl(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const i=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:i,done:!1}):this._queuedChunk=i,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=kr(t,this._url);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const fA=/^[a-z][a-z0-9\-+.]+:/i;function pA(g){if(fA.test(g))return new URL(g);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(g))}class gA{constructor(t){this.source=t,this.url=pA(t.url),Nt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Nt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new mA(this),this._fullRequestReader}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=new yA(this,t,i);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class mA{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const i=t.source;this._contentLength=i.length,this._loaded=0,this._filename=null,this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=kr(0,this._url.href)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",i=>{this._error(i)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new qn("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class yA{constructor(t,i,s){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=t.source;this._isStreamingSupported=!r.disableStream;const l=process.getBuiltinModule("fs");this._setReadableStream(l.createReadStream(this._url,{start:i,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",i=>{this._error(i)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const yr=Symbol("INITIAL_DATA");class $m{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:yr}}get(t,i=null){if(i){const r=this.#e(t);return r.promise.then(()=>i(r.data)),null}const s=this.#t[t];if(!s||s.data===yr)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return s.data}has(t){const i=this.#t[t];return!!i&&i.data!==yr}delete(t){const i=this.#t[t];return!i||i.data===yr?!1:(delete this.#t[t],!0)}resolve(t,i=null){const s=this.#e(t);s.data=i,s.resolve()}clear(){for(const t in this.#t){const{data:i}=this.#t[t];i?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:i}=this.#t[t];i!==yr&&(yield[t,i])}}}const bA=1e5,pm=30;class Ue{#t=Promise.withResolvers();#e=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#r=null;#a=null;#s=0;#o=0;#c=null;#l=null;#d=0;#h=0;#f=Object.create(null);#m=[];#g=null;#u=[];#p=new WeakMap;#y=null;static#v=new Map;static#b=new Map;static#E=new WeakMap;static#x=null;static#S=new Set;constructor({textContentSource:t,container:i,viewport:s}){if(t instanceof ReadableStream)this.#g=t;else if(typeof t=="object")this.#g=new ReadableStream({start(h){h.enqueue(t),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#l=i,this.#h=s.scale*Xi.pixelRatio,this.#d=s.rotation,this.#a={div:null,properties:null,ctx:null};const{pageWidth:r,pageHeight:l,pageX:c,pageY:u}=s.rawDims;this.#y=[1,0,0,-1,-c,u+l],this.#o=r,this.#s=l,Ue.#D(),ms(i,s),this.#t.promise.finally(()=>{Ue.#S.delete(this),this.#a=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:i}=Oe.platform;return wt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&i?"Calibri, ":""}sans-serif`],["monospace",`${t&&i?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:i,done:s})=>{if(s){this.#t.resolve();return}this.#r??=i.lang,Object.assign(this.#f,i.styles),this.#C(i.items),t()},this.#t.reject)};return this.#c=this.#g.getReader(),Ue.#S.add(this),t(),this.#t.promise}update({viewport:t,onBefore:i=null}){const s=t.scale*Xi.pixelRatio,r=t.rotation;if(r!==this.#d&&(i?.(),this.#d=r,ms(this.#l,{rotation:r})),s!==this.#h){i?.(),this.#h=s;const l={div:null,properties:null,ctx:Ue.#R(this.#r)};for(const c of this.#u)l.properties=this.#p.get(c),l.div=c,this.#_(l)}}cancel(){const t=new qn("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#m}#C(t){if(this.#n)return;this.#a.ctx??=Ue.#R(this.#r);const i=this.#u,s=this.#m;for(const r of t){if(i.length>bA){mt("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const l=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),r.id&&this.#e.setAttribute("id",`${r.id}`),l.append(this.#e)}else r.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}s.push(r.str),this.#A(r)}}#A(t){const i=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#u.push(i);const r=st.transform(this.#y,t.transform);let l=Math.atan2(r[1],r[0]);const c=this.#f[t.fontName];c.vertical&&(l+=Math.PI/2);let u=this.#i&&c.fontSubstitution||c.fontFamily;u=Ue.fontFamilyMap.get(u)||u;const h=Math.hypot(r[2],r[3]),f=h*Ue.#P(u,c,this.#r);let m,y;l===0?(m=r[4],y=r[5]-f):(m=r[4]+f*Math.sin(l),y=r[5]-f*Math.cos(l));const b="calc(var(--total-scale-factor) *",A=i.style;this.#e===this.#l?(A.left=`${(100*m/this.#o).toFixed(2)}%`,A.top=`${(100*y/this.#s).toFixed(2)}%`):(A.left=`${b}${m.toFixed(2)}px)`,A.top=`${b}${y.toFixed(2)}px)`),A.fontSize=`${b}${(Ue.#x*h).toFixed(2)}px)`,A.fontFamily=u,s.fontSize=h,i.setAttribute("role","presentation"),i.textContent=t.str,i.dir=t.dir,this.#i&&(i.dataset.fontName=c.fontSubstitutionLoadedName||t.fontName),l!==0&&(s.angle=l*(180/Math.PI));let w=!1;if(t.str.length>1)w=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const S=Math.abs(t.transform[0]),E=Math.abs(t.transform[3]);S!==E&&Math.max(S,E)/Math.min(S,E)>1.5&&(w=!0)}if(w&&(s.canvasWidth=c.vertical?t.height:t.width),this.#p.set(i,s),this.#a.div=i,this.#a.properties=s,this.#_(this.#a),s.hasText&&this.#e.append(i),s.hasEOL){const S=document.createElement("br");S.setAttribute("role","presentation"),this.#e.append(S)}}#_(t){const{div:i,properties:s,ctx:r}=t,{style:l}=i;let c="";if(Ue.#x>1&&(c=`scale(${1/Ue.#x})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:u}=l,{canvasWidth:h,fontSize:f}=s;Ue.#M(r,f*this.#h,u);const{width:m}=r.measureText(i.textContent);m>0&&(c=`scaleX(${h*this.#h/m}) ${c}`)}s.angle!==0&&(c=`rotate(${s.angle}deg) ${c}`),c.length>0&&(l.transform=c)}static cleanup(){if(!(this.#S.size>0)){this.#v.clear();for(const{canvas:t}of this.#b.values())t.remove();this.#b.clear()}}static#R(t=null){let i=this.#b.get(t||="");if(!i){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=t,document.body.append(s),i=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#b.set(t,i),this.#E.set(i,{size:0,family:""})}return i}static#M(t,i,s){const r=this.#E.get(t);i===r.size&&s===r.family||(t.font=`${i}px ${s}`,r.size=i,r.family=s)}static#D(){if(this.#x!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#x=t.getBoundingClientRect().height,t.remove()}static#P(t,i,s){const r=this.#v.get(t);if(r)return r;const l=this.#R(s);l.canvas.width=l.canvas.height=pm,this.#M(l,pm,t);const c=l.measureText(""),u=c.fontBoundingBoxAscent,h=Math.abs(c.fontBoundingBoxDescent);l.canvas.width=l.canvas.height=0;let f=.8;return u?f=u/(u+h):(Oe.platform.isFirefox&&mt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),i.ascent?f=i.ascent:i.descent&&(f=1+i.descent)),this.#v.set(t,f),f}}const vA=100;function Th(g={}){typeof g=="string"||g instanceof URL?g={url:g}:(g instanceof ArrayBuffer||ArrayBuffer.isView(g))&&(g={data:g});const t=new Ch,{docId:i}=t,s=g.url?Tv(g.url):null,r=g.data?Cv(g.data):null,l=g.httpHeaders||null,c=g.withCredentials===!0,u=g.password??null,h=g.range instanceof Km?g.range:null,f=Number.isInteger(g.rangeChunkSize)&&g.rangeChunkSize>0?g.rangeChunkSize:2**16;let m=g.worker instanceof Cr?g.worker:null;const y=g.verbosity,b=typeof g.docBaseUrl=="string"&&!vl(g.docBaseUrl)?g.docBaseUrl:null,A=tl(g.cMapUrl),w=g.cMapPacked!==!1,S=g.CMapReaderFactory||(je?Bv:tm),E=tl(g.iccUrl),_=tl(g.standardFontDataUrl),D=g.StandardFontDataFactory||(je?zv:em),T=tl(g.wasmUrl),B=g.WasmFactory||(je?Pv:im),O=g.stopAtErrors!==!0,L=Number.isInteger(g.maxImageSize)&&g.maxImageSize>-1?g.maxImageSize:-1,P=g.isEvalSupported!==!1,q=typeof g.isOffscreenCanvasSupported=="boolean"?g.isOffscreenCanvasSupported:!je,K=typeof g.isImageDecoderSupported=="boolean"?g.isImageDecoderSupported:!je&&(Oe.platform.isFirefox||!globalThis.chrome),J=Number.isInteger(g.canvasMaxAreaInBytes)?g.canvasMaxAreaInBytes:-1,W=typeof g.disableFontFace=="boolean"?g.disableFontFace:je,ht=g.fontExtraProperties===!0,yt=g.enableXfa===!0,bt=g.ownerDocument||globalThis.document,vt=g.disableRange===!0,k=g.disableStream===!0,V=g.disableAutoFetch===!0,tt=g.pdfBug===!0,pt=g.CanvasFactory||(je?kv:Nv),xt=g.FilterFactory||(je?Lv:Ov),R=g.enableHWA===!0,I=g.useWasm!==!1,Q=h?h.length:g.length??NaN,et=typeof g.useSystemFonts=="boolean"?g.useSystemFonts:!je&&!W,ct=typeof g.useWorkerFetch=="boolean"?g.useWorkerFetch:!!(S===tm&&D===em&&B===im&&A&&_&&T&&Ar(A,document.baseURI)&&Ar(_,document.baseURI)&&Ar(T,document.baseURI)),ft=null;tv(y);const ut={canvasFactory:new pt({ownerDocument:bt,enableHWA:R}),filterFactory:new xt({docId:i,ownerDocument:bt}),cMapReaderFactory:ct?null:new S({baseUrl:A,isCompressed:w}),standardFontDataFactory:ct?null:new D({baseUrl:_}),wasmFactory:ct?null:new B({baseUrl:T})};m||(m=Cr.create({verbosity:y,port:gs.workerPort}),t._worker=m);const ee={docId:i,apiVersion:"5.4.394",data:r,password:u,disableAutoFetch:V,rangeChunkSize:f,length:Q,docBaseUrl:b,enableXfa:yt,evaluatorOptions:{maxImageSize:L,disableFontFace:W,ignoreErrors:O,isEvalSupported:P,isOffscreenCanvasSupported:q,isImageDecoderSupported:K,canvasMaxAreaInBytes:J,fontExtraProperties:ht,useSystemFonts:et,useWasm:I,useWorkerFetch:ct,cMapUrl:A,iccUrl:E,standardFontDataUrl:_,wasmUrl:T}},jt={ownerDocument:bt,pdfBug:tt,styleElement:ft,loadingParams:{disableAutoFetch:V,enableXfa:yt}};return m.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(m.destroyed)throw new Error("Worker was destroyed");const Li=m.messageHandler.sendWithPromise("GetDocRequest",ee,r?[r.buffer]:null);let Ti;if(h)Ti=new eA(h,{disableRange:vt,disableStream:k});else if(!r){if(!s)throw new Error("getDocument - no `url` parameter provided.");const ui=Ar(s)?aA:je?gA:uA;Ti=new ui({url:s,length:Q,httpHeaders:l,withCredentials:c,rangeChunkSize:f,disableRange:vt,disableStream:k})}return Li.then(ui=>{if(t.destroyed)throw new Error("Loading aborted");if(m.destroyed)throw new Error("Worker was destroyed");const Je=new Sr(i,ui,m.port),hi=new wA(Je,t,Ti,jt,ut,R);t._transport=hi,Je.send("Ready",null)})}).catch(t._capability.reject),t}class Ch{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${Ch.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class Km{#t=Promise.withResolvers();#e=[];#n=[];#i=[];#r=[];constructor(t,i,s=!1,r=null){this.length=t,this.initialData=i,this.progressiveDone=s,this.contentDispositionFilename=r}addRangeListener(t){this.#r.push(t)}addProgressListener(t){this.#i.push(t)}addProgressiveReadListener(t){this.#n.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,i){for(const s of this.#r)s(t,i)}onDataProgress(t,i){this.#t.promise.then(()=>{for(const s of this.#i)s(t,i)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const i of this.#n)i(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,i){$t("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class AA{constructor(t,i){this._pdfInfo=t,this._transport=i}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return wt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,i){return this._transport.getAnnotationsByType(t,i)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:i}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(i)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class SA{#t=!1;constructor(t,i,s,r=!1){this._pageIndex=t,this._pageInfo=i,this._transport=s,this._stats=r?new Yg:null,this._pdfBug=r,this.commonObjs=s.commonObjs,this.objs=new $m,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:i=this.rotate,offsetX:s=0,offsetY:r=0,dontFlip:l=!1}={}){return new Nr({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:i,offsetX:s,offsetY:r,dontFlip:l})}getAnnotations({intent:t="display"}={}){const{renderingIntent:i}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,i)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return wt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:i=t.canvas,viewport:s,intent:r="display",annotationMode:l=In.ENABLE,transform:c=null,background:u=null,optionalContentConfigPromise:h=null,annotationCanvasMap:f=null,pageColors:m=null,printAnnotationStorage:y=null,isEditing:b=!1,recordOperations:A=!1,operationsFilter:w=null}){this._stats?.time("Overall");const S=this._transport.getRenderingIntent(r,l,y,b),{renderingIntent:E,cacheKey:_}=S;this.#t=!1,h||=this._transport.getOptionalContentConfig(E);let D=this._intentStates.get(_);D||(D=Object.create(null),this._intentStates.set(_,D)),D.streamReaderCancelTimeout&&(clearTimeout(D.streamReaderCancelTimeout),D.streamReaderCancelTimeout=null);const T=!!(E&li.PRINT);D.displayReadyCapability||(D.displayReadyCapability=Promise.withResolvers(),D.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(S));const B=!!(this._pdfBug&&globalThis.StepperManager?.enabled),O=!this.recordedBBoxes&&(A||B),L=K=>{if(D.renderTasks.delete(P),O){const J=P.gfx?.dependencyTracker.take();J&&(P.stepper&&P.stepper.setOperatorBBoxes(J,P.gfx.dependencyTracker.takeDebugMetadata()),A&&(this.recordedBBoxes=J))}T&&(this.#t=!0),this.#e(),K?(P.capability.reject(K),this._abortOperatorList({intentState:D,reason:K instanceof Error?K:new Error(K)})):P.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},P=new ga({callback:L,params:{canvas:i,canvasContext:t,dependencyTracker:O?new jv(i,D.operatorList.length,B):null,viewport:s,transform:c,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:D.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!T,pdfBug:this._pdfBug,pageColors:m,enableHWA:this._transport.enableHWA,operationsFilter:w});(D.renderTasks||=new Set).add(P);const q=P.task;return Promise.all([D.displayReadyCapability.promise,h]).then(([K,J])=>{if(this.destroyed){L();return}if(this._stats?.time("Rendering"),!(J.renderingIntent&E))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");P.initializeGraphics({transparency:K,optionalContentConfig:J}),P.operatorListChanged()}).catch(L),q}getOperatorList({intent:t="display",annotationMode:i=In.ENABLE,printAnnotationStorage:s=null,isEditing:r=!1}={}){function l(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(h))}const c=this._transport.getRenderingIntent(t,i,s,r,!0);let u=this._intentStates.get(c.cacheKey);u||(u=Object.create(null),this._intentStates.set(c.cacheKey,u));let h;return u.opListReadCapability||(h=Object.create(null),h.operatorListChanged=l,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(h),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(c)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:i=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:i===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>Tr.textContent(s));const i=this.streamTextContent(t);return new Promise(function(s,r){function l(){c.read().then(function({value:h,done:f}){if(f){s(u);return}u.lang??=h.lang,Object.assign(u.styles,h.styles),u.items.push(...h.items),l()},r)}const c=i.getReader(),u={items:[],styles:Object.create(null),lang:null};l()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const i of this._intentStates.values())if(this._abortOperatorList({intentState:i,reason:new Error("Page was destroyed."),force:!0}),!i.opListReadCapability)for(const s of i.renderTasks)t.push(s.completed),s.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const i=this.#e();return t&&i&&(this._stats&&=new Yg),i}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:i}of this._intentStates.values())if(t.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,i){const s=this._intentStates.get(i);s&&(this._stats?.timeEnd("Page Request"),s.displayReadyCapability?.resolve(t))}_renderPageChunk(t,i){for(let s=0,r=t.length;s<r;s++)i.operatorList.fnArray.push(t.fnArray[s]),i.operatorList.argsArray.push(t.argsArray[s]);i.operatorList.lastChunk=t.lastChunk,i.operatorList.separateAnnots=t.separateAnnots;for(const s of i.renderTasks)s.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:i,annotationStorageSerializable:s,modifiedIds:r}){const{map:l,transfer:c}=s,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:i,annotationStorage:l,modifiedIds:r},c).getReader(),f=this._intentStates.get(i);f.streamReader=h;const m=()=>{h.read().then(({value:y,done:b})=>{if(b){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(y,f),m())},y=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const b of f.renderTasks)b.operatorListChanged();this.#e()}if(f.displayReadyCapability)f.displayReadyCapability.reject(y);else if(f.opListReadCapability)f.opListReadCapability.reject(y);else throw y}})};m()}_abortOperatorList({intentState:t,reason:i,force:s=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!s){if(t.renderTasks.size>0)return;if(i instanceof bh){let r=vA;i.extraDelay>0&&i.extraDelay<1e3&&(r+=i.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:i,force:!0})},r);return}}if(t.streamReader.cancel(new qn(i.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[r,l]of this._intentStates)if(l===t){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}var Gn,Oi,mn,ds,gl,fs,ps,He,ul,Qm,Zm,wr,va,hl;const te=class te{constructor({name:t=null,port:i=null,verbosity:s=ev()}={}){Fi(this,He);Fi(this,Gn,Promise.withResolvers());Fi(this,Oi,null);Fi(this,mn,null);Fi(this,ds,null);if(this.name=t,this.destroyed=!1,this.verbosity=s,i){if(Jt(te,ps).has(i))throw new Error("Cannot use more than one PDFWorker per port.");Jt(te,ps).set(i,this),Hi(this,He,Qm).call(this,i)}else Hi(this,He,Zm).call(this)}get promise(){return Jt(this,Gn).promise}get port(){return Jt(this,mn)}get messageHandler(){return Jt(this,Oi)}destroy(){this.destroyed=!0,Jt(this,ds)?.terminate(),Ke(this,ds,null),Jt(te,ps).delete(Jt(this,mn)),Ke(this,mn,null),Jt(this,Oi)?.destroy(),Ke(this,Oi,null)}static create(t){const i=Jt(this,ps).get(t?.port);if(i){if(i._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return i}return new te(t)}static get workerSrc(){if(gs.workerSrc)return gs.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return wt(this,"_setupFakeWorkerGlobal",(async()=>Jt(this,va,hl)?Jt(this,va,hl):(await import(this.workerSrc)).WorkerMessageHandler)())}};Gn=new WeakMap,Oi=new WeakMap,mn=new WeakMap,ds=new WeakMap,gl=new WeakMap,fs=new WeakMap,ps=new WeakMap,He=new WeakSet,ul=function(){Jt(this,Gn).resolve(),Jt(this,Oi).send("configure",{verbosity:this.verbosity})},Qm=function(t){Ke(this,mn,t),Ke(this,Oi,new Sr("main","worker",t)),Jt(this,Oi).on("ready",()=>{}),Hi(this,He,ul).call(this)},Zm=function(){if(Jt(te,fs)||Jt(te,va,hl)){Hi(this,He,wr).call(this);return}let{workerSrc:t}=te;try{te._isSameOrigin(window.location,t)||(t=te._createCDNWrapper(new URL(t,window.location).href));const i=new Worker(t,{type:"module"}),s=new Sr("main","worker",i),r=()=>{l.abort(),s.destroy(),i.terminate(),this.destroyed?Jt(this,Gn).reject(new Error("Worker was destroyed")):Hi(this,He,wr).call(this)},l=new AbortController;i.addEventListener("error",()=>{Jt(this,ds)||r()},{signal:l.signal}),s.on("test",u=>{if(l.abort(),this.destroyed||!u){r();return}Ke(this,Oi,s),Ke(this,mn,i),Ke(this,ds,i),Hi(this,He,ul).call(this)}),s.on("ready",u=>{if(l.abort(),this.destroyed){r();return}try{c()}catch{Hi(this,He,wr).call(this)}});const c=()=>{const u=new Uint8Array;s.send("test",u,[u.buffer])};c();return}catch{bl("The worker has been disabled.")}Hi(this,He,wr).call(this)},wr=function(){Jt(te,fs)||(mt("Setting up fake worker."),Ke(te,fs,!0)),te._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Jt(this,Gn).reject(new Error("Worker was destroyed"));return}const i=new Rv;Ke(this,mn,i);const s=`fake${Dg(te,gl)._++}`,r=new Sr(s+"_worker",s,i);t.setup(r,i),Ke(this,Oi,new Sr(s,s+"_worker",i)),Hi(this,He,ul).call(this)}).catch(t=>{Jt(this,Gn).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},va=new WeakSet,hl=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Fi(te,va),Fi(te,gl,0),Fi(te,fs,!1),Fi(te,ps,new WeakMap),je&&(Ke(te,fs,!0),gs.workerSrc||="./pdf.worker.mjs"),te._isSameOrigin=(t,i)=>{const s=URL.parse(t);if(!s?.origin||s.origin==="null")return!1;const r=new URL(i,s);return s.origin===r.origin},te._createCDNWrapper=t=>{const i=`await import("${t}");`;return URL.createObjectURL(new Blob([i],{type:"text/javascript"}))},te.fromPort=t=>{if(fv("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return te.create(t)};let Cr=te;class wA{#t=new Map;#e=new Map;#n=new Map;#i=new Map;#r=null;constructor(t,i,s,r,l,c){this.messageHandler=t,this.loadingTask=i,this.commonObjs=new $m,this.fontLoader=new _v({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=l.canvasFactory,this.filterFactory=l.filterFactory,this.cMapReaderFactory=l.cMapReaderFactory,this.standardFontDataFactory=l.standardFontDataFactory,this.wasmFactory=l.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=c,this.setupMessageHandler()}#a(t,i=null){const s=this.#t.get(t);if(s)return s;const r=this.messageHandler.sendWithPromise(t,i);return this.#t.set(t,r),r}get annotationStorage(){return wt(this,"annotationStorage",new wh)}getRenderingIntent(t,i=In.ENABLE,s=null,r=!1,l=!1){let c=li.DISPLAY,u=ch;switch(t){case"any":c=li.ANY;break;case"display":break;case"print":c=li.PRINT;break;default:mt(`getRenderingIntent - invalid intent: ${t}`)}const h=c&li.PRINT&&s instanceof zm?s:this.annotationStorage;switch(i){case In.DISABLE:c+=li.ANNOTATIONS_DISABLE;break;case In.ENABLE:break;case In.ENABLE_FORMS:c+=li.ANNOTATIONS_FORMS;break;case In.ENABLE_STORAGE:c+=li.ANNOTATIONS_STORAGE,u=h.serializable;break;default:mt(`getRenderingIntent - invalid annotationMode: ${i}`)}r&&(c+=li.IS_EDITING),l&&(c+=li.OPLIST);const{ids:f,hash:m}=h.modifiedIds,y=[c,u.hash,m];return{renderingIntent:c,cacheKey:y.join("_"),annotationStorageSerializable:u,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const s of this.#e.values())t.push(s._destroy());this.#e.clear(),this.#n.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const i=this.messageHandler.sendWithPromise("Terminate",null);return t.push(i),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),Ue.cleanup(),this._networkStream?.cancelAllRequests(new qn("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:i}=this;t.on("GetReader",(s,r)=>{Nt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=l=>{this._lastProgress={loaded:l.loaded,total:l.total}},r.onPull=()=>{this._fullReader.read().then(function({value:l,done:c}){if(c){r.close();return}Nt(l instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{r.error(l)})},r.onCancel=l=>{this._fullReader.cancel(l),r.ready.catch(c=>{if(!this.destroyed)throw c})}}),t.on("ReaderHeadersReady",async s=>{await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:l,contentLength:c}=this._fullReader;return(!r||!l)&&(this._lastProgress&&i.onProgress?.(this._lastProgress),this._fullReader.onProgress=u=>{i.onProgress?.({loaded:u.loaded,total:u.total})}),{isStreamingSupported:r,isRangeSupported:l,contentLength:c}}),t.on("GetRangeReader",(s,r)=>{Nt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const l=this._networkStream.getRangeReader(s.begin,s.end);if(!l){r.close();return}r.onPull=()=>{l.read().then(function({value:c,done:u}){if(u){r.close();return}Nt(c instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(c),1,[c])}).catch(c=>{r.error(c)})},r.onCancel=c=>{l.cancel(c),r.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,i._capability.resolve(new AA(s,this))}),t.on("DocException",s=>{i._capability.reject(Qe(s))}),t.on("PasswordRequest",s=>{this.#r=Promise.withResolvers();try{if(!i.onPassword)throw Qe(s);const r=l=>{l instanceof Error?this.#r.reject(l):this.#r.resolve({password:l})};i.onPassword(r,s.code)}catch(r){this.#r.reject(r)}return this.#r.promise}),t.on("DataLoaded",s=>{i.onProgress?.({loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),t.on("StartRenderPage",s=>{if(this.destroyed)return;this.#e.get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),t.on("commonobj",([s,r,l])=>{if(this.destroyed||this.commonObjs.has(s))return null;switch(r){case"Font":if("error"in l){const y=l.error;mt(`Error during font loading: ${y}`),this.commonObjs.resolve(s,y);break}const c=new Xt(l),u=this._params.pdfBug&&globalThis.FontInspector?.enabled?(y,b)=>globalThis.FontInspector.fontAdded(y,b):null,h=new Ev(c,u,l.extra,l.charProcOperatorList);this.fontLoader.bind(h).catch(()=>t.sendWithPromise("FontFallback",{id:s})).finally(()=>{!h.fontExtraProperties&&h.data&&h.clearData(),this.commonObjs.resolve(s,h)});break;case"CopyLocalImage":const{imageRef:f}=l;Nt(f,"The imageRef must be defined.");for(const y of this.#e.values())for(const[,b]of y.objs)if(b?.ref===f)return b.dataLen?(this.commonObjs.resolve(s,structuredClone(b)),b.dataLen):null;break;case"FontPath":case"Image":this.commonObjs.resolve(s,l);break;case"Pattern":const m=new Se(l);this.commonObjs.resolve(s,m.getIR());break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),t.on("obj",([s,r,l,c])=>{if(this.destroyed)return;const u=this.#e.get(r);if(!u.objs.has(s)){if(u._intentStates.size===0){c?.bitmap?.close();return}switch(l){case"Image":case"Pattern":u.objs.resolve(s,c);break;default:throw new Error(`Got unknown object type ${l}`)}}}),t.on("DocProgress",s=>{this.destroyed||i.onProgress?.({loaded:s.loaded,total:s.total})}),t.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const r=this[s.type];if(!r)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return r.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&mt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:i}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},i).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const i=t-1,s=this.#n.get(i);if(s)return s;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:i}).then(l=>{if(this.destroyed)throw new Error("Transport destroyed");l.refStr&&this.#i.set(l.refStr,t);const c=new SA(i,l,this,this._params.pdfBug);return this.#e.set(i,c),c});return this.#n.set(i,r),r}getPageIndex(t){return uh(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,i){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:i})}getFieldObjects(){return this.#a("GetFieldObjects")}hasJSActions(){return this.#a("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,i){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:i})}getDocJSActions(){return this.#a("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#a("GetOptionalContentConfig").then(i=>new tA(i,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",i=this.#t.get(t);if(i)return i;const s=this.messageHandler.sendWithPromise(t,null).then(r=>({info:r[0],metadata:r[1]?new Wv(r[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const i of this.#e.values())if(!i.cleanup())throw new Error(`startCleanup: Page ${i.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),Ue.cleanup()}}cachedPageNumber(t){if(!uh(t))return null;const i=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#i.get(i)??null}}class xA{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:i}=this.#t;return t.form||t.canvas&&i?.size>0}}class ga{#t=null;static#e=new WeakSet;constructor({callback:t,params:i,objs:s,commonObjs:r,annotationCanvasMap:l,operatorList:c,pageIndex:u,canvasFactory:h,filterFactory:f,useRequestAnimationFrame:m=!1,pdfBug:y=!1,pageColors:b=null,enableHWA:A=!1,operationsFilter:w=null}){this.callback=t,this.params=i,this.objs=s,this.commonObjs=r,this.annotationCanvasMap=l,this.operatorListIdx=null,this.operatorList=c,this._pageIndex=u,this.canvasFactory=h,this.filterFactory=f,this._pdfBug=y,this.pageColors=b,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=m===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new xA(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=i.canvas,this._canvasContext=i.canvas?null:i.canvasContext,this._enableHWA=A,this._dependencyTracker=i.dependencyTracker,this._operationsFilter=w}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:i}){if(this.cancelled)return;if(this._canvas){if(ga.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");ga.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:s,transform:r,background:l,dependencyTracker:c}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new ba(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:i},this.annotationCanvasMap,this.pageColors,c),this.gfx.beginDrawing({transform:r,viewport:s,transparency:t,background:l}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,i=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),ga.#e.delete(this._canvas),t||=new bh(`Rendering cancelled, page ${this._pageIndex+1}`,i),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),ga.#e.delete(this._canvas),this.callback())))}}const _A="5.4.394",EA="2cc809ade";class _i{#t=null;#e=null;#n;#i=null;#r=!1;#a=!1;#s=null;#o;#c=null;#l=null;static#d=null;static get _keyboardManager(){return wt(this,"_keyboardManager",new Lr([[["Escape","mac+Escape"],_i.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],_i.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],_i.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],_i.prototype._moveToPrevious],[["Home","mac+Home"],_i.prototype._moveToBeginning],[["End","mac+End"],_i.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:i=null}){t?(this.#a=!1,this.#s=t):this.#a=!0,this.#l=t?._uiManager||i,this.#o=this.#l._eventBus,this.#n=t?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",_i.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#s&&(t.ariaControls=`${this.#s.id}_colorpicker_dropdown`);const i=this.#l._signal;t.addEventListener("click",this.#g.bind(this),{signal:i}),t.addEventListener("keydown",this.#m.bind(this),{signal:i});const s=this.#e=document.createElement("span");return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=this.#n,t.append(s),t}renderMainDropdown(){const t=this.#i=this.#h();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#h(){const t=document.createElement("div"),i=this.#l._signal;t.addEventListener("contextmenu",Ei,{signal:i}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#s&&(t.id=`${this.#s.id}_colorpicker_dropdown`);for(const[s,r]of this.#l.highlightColors){const l=document.createElement("button");l.tabIndex="0",l.role="option",l.setAttribute("data-color",r),l.title=s,l.setAttribute("data-l10n-id",_i.#d[s]);const c=document.createElement("span");l.append(c),c.className="swatch",c.style.backgroundColor=r,l.ariaSelected=r===this.#n,l.addEventListener("click",this.#f.bind(this,r),{signal:i}),t.append(l)}return t.addEventListener("keydown",this.#m.bind(this),{signal:i}),t}#f(t,i){i.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:Rt.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#g(t);return}const i=t.target.getAttribute("data-color");i&&this.#f(i,t)}_moveToNext(t){if(!this.#p){this.#g(t);return}if(t.target===this.#t){this.#i.firstChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#i?.firstChild||t.target===this.#t){this.#p&&this._hideDropdownFromKeyboard();return}this.#p||this.#g(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#p){this.#g(t);return}this.#i.firstChild?.focus()}_moveToEnd(t){if(!this.#p){this.#g(t);return}this.#i.lastChild?.focus()}#m(t){_i._keyboardManager.exec(this,t)}#g(t){if(this.#p){this.hideDropdown();return}if(this.#r=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#i){this.#i.classList.remove("hidden");return}const i=this.#i=this.#h();this.#t.append(i)}#u(t){this.#i?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#p(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#a){if(!this.#p){this.#s?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#r})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#i)return;const i=this.#l.highlightColors.values();for(const s of this.#i.children)s.ariaSelected=i.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#i?.remove(),this.#i=null}}class Mr{#t=null;#e=null;#n=null;static#i=null;constructor(t){this.#e=t,this.#n=t._uiManager,Mr.#i||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:i,color:s}=this.#e,r=this.#t=document.createElement("input");return r.type="color",r.value=s||"#000000",r.className="basicColorPicker",r.tabIndex=0,r.setAttribute("data-l10n-id",Mr.#i[t]),r.addEventListener("input",()=>{this.#n.updateParams(i,r.value)},{signal:this.#n._signal}),r}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function gm(g){return Math.floor(Math.max(0,Math.min(1,g))*255).toString(16).padStart(2,"0")}function br(g){return Math.max(0,Math.min(255,255*g))}class mm{static CMYK_G([t,i,s,r]){return["G",1-Math.min(1,.3*t+.59*s+.11*i+r)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=br(t),[t,t,t]}static G_HTML([t]){const i=gm(t);return`#${i}${i}${i}`}static RGB_G([t,i,s]){return["G",.3*t+.59*i+.11*s]}static RGB_rgb(t){return t.map(br)}static RGB_HTML(t){return`#${t.map(gm).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,i,s,r]){return["RGB",1-Math.min(1,t+r),1-Math.min(1,s+r),1-Math.min(1,i+r)]}static CMYK_rgb([t,i,s,r]){return[br(1-Math.min(1,t+r)),br(1-Math.min(1,s+r)),br(1-Math.min(1,i+r))]}static CMYK_HTML(t){const i=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(i)}static RGB_CMYK([t,i,s]){const r=1-t,l=1-i,c=1-s,u=Math.min(r,l,c);return["CMYK",r,l,c,u]}}class TA{create(t,i,s=!1){if(t<=0||i<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),s||(r.setAttribute("width",`${t}px`),r.setAttribute("height",`${i}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${t} ${i}`),r}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){$t("Abstract method `_createSVG` called.")}}class pl extends TA{_createSVG(t){return document.createElementNS(pn,t)}}const CA=9,ys=new WeakSet,MA=new Date().getTimezoneOffset()*60*1e3;class ih{static create(t){switch(t.data.annotationType){case me.LINK:return new Mh(t);case me.TEXT:return new RA(t);case me.WIDGET:switch(t.data.fieldType){case"Tx":return new NA(t);case"Btn":return t.data.radioButton?new Wm(t):t.data.checkBox?new LA(t):new kA(t);case"Ch":return new BA(t);case"Sig":return new OA(t)}return new vs(t);case me.POPUP:return new fh(t);case me.FREETEXT:return new Jm(t);case me.LINE:return new PA(t);case me.SQUARE:return new UA(t);case me.CIRCLE:return new jA(t);case me.POLYLINE:return new ty(t);case me.CARET:return new HA(t);case me.INK:return new Dh(t);case me.POLYGON:return new FA(t);case me.HIGHLIGHT:return new ey(t);case me.UNDERLINE:return new IA(t);case me.SQUIGGLY:return new GA(t);case me.STRIKEOUT:return new qA(t);case me.STAMP:return new iy(t);case me.FILEATTACHMENT:return new VA(t);default:return new ne(t)}}}class ne{#t=null;#e=!1;#n=null;constructor(t,{isRenderable:i=!1,ignoreBorder:s=!1,createQuadrilaterals:r=!1}={}){this.isRenderable=i,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,this.hasOwnCommentButton=!1,i&&(this.contentElement=this.container=this._createContainer(s)),r&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:i}){return!!(t?.str||i?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return ne._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,i=this.annotationStorage?.getEditor(t.id);return i?i.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:i,inkLists:s,rect:r}=this.data;let l=-1/0,c=-1/0;if(i?.length>=8){for(let u=0;u<i.length;u+=8)i[u+1]>c?(c=i[u+1],l=i[u+2]):i[u+1]===c&&(l=Math.max(l,i[u+2]));return[l,c]}if(s?.length>=1){for(const u of s)for(let h=0,f=u.length;h<f;h+=2)u[h+1]>c?(c=u[h+1],l=u[h]):u[h+1]===c&&(l=Math.max(l,u[h]));if(l!==1/0)return[l,c]}return r?[r[2],r[3]]:null}_normalizePoint(t){const{page:{view:i},viewport:{rawDims:{pageWidth:s,pageHeight:r,pageX:l,pageY:c}}}=this.parent;return t[1]=i[3]-t[1]+i[1],t[0]=100*(t[0]-l)/s,t[1]=100*(t[1]-c)/r,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${_r}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:i}=this,s={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(i.id,{popup:s})||this.annotationStorage.setValue(`${_r}${i.id}`,{id:i.id,annotationType:i.annotationType,pageIndex:this.parent.page._pageIndex,popup:s,popupRef:i.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#n?.popup||this.popup)?.remove(),this.#n=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:i,popup:s}=t;i&&this.#i(i);let r=this.#n?.popup||this.popup;!r&&s?.text&&(this._createPopup(s),r=this.#n.popup),r&&(r.updateEdited(t),s?.deleted&&(r.remove(),this.#n=null,this.popup=null))}resetEdited(){this.#t&&(this.#i(this.#t.rect),this.#n?.popup.resetEdited(),this.#t=null)}#i(t){const{container:{style:i},data:{rect:s,rotation:r},parent:{viewport:{rawDims:{pageWidth:l,pageHeight:c,pageX:u,pageY:h}}}}=this;s?.splice(0,4,...t),i.left=`${100*(t[0]-u)/l}%`,i.top=`${100*(c-t[3]+h)/c}%`,r===0?(i.width=`${100*(t[2]-t[0])/l}%`,i.height=`${100*(t[3]-t[1])/c}%`):this.setRotation(r)}_createContainer(t){const{data:i,parent:{page:s,viewport:r}}=this,l=document.createElement("section");l.setAttribute("data-annotation-id",i.id),!(this instanceof vs)&&!(this instanceof Mh)&&(l.tabIndex=0);const{style:c}=l;if(c.zIndex=this.parent.zIndex,this.parent.zIndex+=2,i.alternativeText&&(l.title=i.alternativeText),i.noRotate&&l.classList.add("norotate"),!i.rect||this instanceof fh){const{rotation:S}=i;return!i.hasOwnCanvas&&S!==0&&this.setRotation(S,l),l}const{width:u,height:h}=this;if(!t&&i.borderStyle.width>0){c.borderWidth=`${i.borderStyle.width}px`;const S=i.borderStyle.horizontalCornerRadius,E=i.borderStyle.verticalCornerRadius;if(S>0||E>0){const D=`calc(${S}px * var(--total-scale-factor)) / calc(${E}px * var(--total-scale-factor))`;c.borderRadius=D}else if(this instanceof Wm){const D=`calc(${u}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;c.borderRadius=D}switch(i.borderStyle.style){case ua.SOLID:c.borderStyle="solid";break;case ua.DASHED:c.borderStyle="dashed";break;case ua.BEVELED:mt("Unimplemented border style: beveled");break;case ua.INSET:mt("Unimplemented border style: inset");break;case ua.UNDERLINE:c.borderBottomStyle="solid";break}const _=i.borderColor||null;_?(this.#e=!0,c.borderColor=st.makeHexColor(_[0]|0,_[1]|0,_[2]|0)):c.borderWidth=0}const f=st.normalizeRect([i.rect[0],s.view[3]-i.rect[1]+s.view[1],i.rect[2],s.view[3]-i.rect[3]+s.view[1]]),{pageWidth:m,pageHeight:y,pageX:b,pageY:A}=r.rawDims;c.left=`${100*(f[0]-b)/m}%`,c.top=`${100*(f[1]-A)/y}%`;const{rotation:w}=i;return i.hasOwnCanvas||w===0?(c.width=`${100*u/m}%`,c.height=`${100*h/y}%`):this.setRotation(w,l),l}setRotation(t,i=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:r}=this.parent.viewport.rawDims;let{width:l,height:c}=this;t%180!==0&&([l,c]=[c,l]),i.style.width=`${100*l/s}%`,i.style.height=`${100*c/r}%`,i.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(i,s,r)=>{const l=r.detail[i],c=l[0],u=l.slice(1);r.target.style[s]=mm[`${c}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[s]:mm[`${c}_rgb`](u)})};return wt(this,"_commonActions",{display:i=>{const{display:s}=i.detail,r=s%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:s===1||s===2})},print:i=>{this.annotationStorage.setValue(this.data.id,{noPrint:!i.detail.print})},hidden:i=>{const{hidden:s}=i.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:i=>{setTimeout(()=>i.target.focus({preventScroll:!1}),0)},userName:i=>{i.target.title=i.detail.userName},readonly:i=>{i.target.disabled=i.detail.readonly},required:i=>{this._setRequired(i.target,i.detail.required)},bgColor:i=>{t("bgColor","backgroundColor",i)},fillColor:i=>{t("fillColor","backgroundColor",i)},fgColor:i=>{t("fgColor","color",i)},textColor:i=>{t("textColor","color",i)},borderColor:i=>{t("borderColor","borderColor",i)},strokeColor:i=>{t("strokeColor","borderColor",i)},rotation:i=>{const s=i.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(t,i){const s=this._commonActions;for(const r of Object.keys(i.detail))(t[r]||s[r])?.(i)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const i=this.annotationStorage.getRawValue(this.data.id);if(!i)return;const s=this._commonActions;for(const[r,l]of Object.entries(i)){const c=s[r];if(c){const u={detail:{[r]:l},target:t};c(u),delete i[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[i,s,r,l]=this.data.rect.map(S=>Math.fround(S));if(t.length===8){const[S,E,_,D]=t.subarray(2,6);if(r===S&&l===E&&i===_&&s===D)return}const{style:c}=this.container;let u;if(this.#e){const{borderColor:S,borderWidth:E}=c;c.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${S}" stroke-width="${E}">`],this.container.classList.add("hasBorder")}const h=r-i,f=l-s,{svgFactory:m}=this,y=m.createElement("svg");y.classList.add("quadrilateralsContainer"),y.setAttribute("width",0),y.setAttribute("height",0),y.role="none";const b=m.createElement("defs");y.append(b);const A=m.createElement("clipPath"),w=`clippath_${this.data.id}`;A.setAttribute("id",w),A.setAttribute("clipPathUnits","objectBoundingBox"),b.append(A);for(let S=2,E=t.length;S<E;S+=8){const _=t[S],D=t[S+1],T=t[S+2],B=t[S+3],O=m.createElement("rect"),L=(T-i)/h,P=(l-D)/f,q=(_-T)/h,K=(D-B)/f;O.setAttribute("x",L),O.setAttribute("y",P),O.setAttribute("width",q),O.setAttribute("height",K),A.append(O),u?.push(`<rect vector-effect="non-scaling-stroke" x="${L}" y="${P}" width="${q}" height="${K}"/>`)}this.#e&&(u.push("</g></svg>')"),c.backgroundImage=u.join("")),this.container.append(y),this.container.style.clipPath=`url(#${w})`}_createPopup(t=null){const{data:i}=this;let s,r;t?(s={str:t.text},r=t.date):(s=i.contentsObj,r=i.modificationDate),this.#n=new fh({data:{color:i.color,titleObj:i.titleObj,modificationDate:r,contentsObj:s,richText:i.richText,parentRect:i.rect,borderStyle:0,id:`popup_${i.id}`,rotation:i.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#n||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#n}render(){$t("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,i=null){const s=[];if(this._fieldObjects){const r=this._fieldObjects[t];if(r)for(const{page:l,id:c,exportValues:u}of r){if(l===-1||c===i)continue;const h=typeof u=="string"?u:null,f=document.querySelector(`[data-element-id="${c}"]`);if(f&&!ys.has(f)){mt(`_getElementsByName - element not allowed: ${c}`);continue}s.push({id:c,exportValue:h,domElement:f})}return s}for(const r of document.getElementsByName(t)){const{exportValue:l}=r,c=r.getAttribute("data-element-id");c!==i&&ys.has(r)&&s.push({id:c,exportValue:l,domElement:r})}return s}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const i of t)i.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:i}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:i,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class DA extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&this._createPopup(t.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class Mh extends ne{constructor(t,i=null){super(t,{isRenderable:!0,ignoreBorder:!!i?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:i}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let r=!1;return t.url?(i.addLinkAttributes(s,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(s,t.action,t.overlaidText),r=!0):t.attachment?(this.#e(s,t.attachment,t.overlaidText,t.attachmentDest),r=!0):t.setOCGState?(this.#n(s,t.setOCGState,t.overlaidText),r=!0):t.dest?(this._bindLink(s,t.dest,t.overlaidText),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),r=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(s,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&(this.contentElement=s,this.container.append(s)),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,i,s=""){t.href=this.linkService.getDestinationHash(i),t.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&this.#t(),s&&(t.title=s)}_bindNamedAction(t,i,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(i),!1),s&&(t.title=s),this.#t()}#e(t,i,s="",r=null){t.href=this.linkService.getAnchorUrl(""),i.description?t.title=i.description:s&&(t.title=s),t.onclick=()=>(this.downloadManager?.openOrDownloadData(i.content,i.filename,r),!1),this.#t()}#n(t,i,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(i),!1),s&&(t.title=s),this.#t()}_bindJSAction(t,i){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(i.actions)){const l=s.get(r);l&&(t[l]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:r}}),!1))}i.overlaidText&&(t.title=i.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,i){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){mt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{s?.();const{fields:r,refs:l,include:c}=i,u=[];if(r.length!==0||l.length!==0){const m=new Set(l);for(const y of r){const b=this._fieldObjects[y]||[];for(const{id:A}of b)m.add(A)}for(const y of Object.values(this._fieldObjects))for(const b of y)m.has(b.id)===c&&u.push(b)}else for(const m of Object.values(this._fieldObjects))u.push(...m);const h=this.annotationStorage,f=[];for(const m of u){const{id:y}=m;switch(f.push(y),m.type){case"text":{const A=m.defaultValue||"";h.setValue(y,{value:A});break}case"checkbox":case"radiobutton":{const A=m.defaultValue===m.exportValues;h.setValue(y,{value:A});break}case"combobox":case"listbox":{const A=m.defaultValue||"";h.setValue(y,{value:A});break}default:continue}const b=document.querySelector(`[data-element-id="${y}"]`);if(b){if(!ys.has(b)){mt(`_bindResetFormAction - element not allowed: ${y}`);continue}}else continue;b.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class RA extends ne{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(t),this.container}}class vs extends ne{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Oe.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,i,s,r,l){s.includes("mouse")?t.addEventListener(s,c=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:l(c),shift:c.shiftKey,modifier:this._getKeyModifier(c)}})}):t.addEventListener(s,c=>{if(s==="blur"){if(!i.focused||!c.relatedTarget)return;i.focused=!1}else if(s==="focus"){if(i.focused)return;i.focused=!0}l&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:l(c)}})})}_setEventListeners(t,i,s,r){for(const[l,c]of s)(c==="Action"||this.data.actions?.[c])&&((c==="Focus"||c==="Blur")&&(i||={focused:!1}),this._setEventListener(t,i,l,c,r),c==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,i,"blur","Blur",null):c==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,i,"focus","Focus",null))}_setBackgroundColor(t){const i=this.data.backgroundColor||null;t.style.backgroundColor=i===null?"transparent":st.makeHexColor(i[0],i[1],i[2])}_setTextStyle(t){const i=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||CA,l=t.style;let c;const u=2,h=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u),m=Math.round(f/($u*r))||1,y=f/m;c=Math.min(r,h(y/$u))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u);c=Math.min(r,h(f/$u))}l.fontSize=`calc(${c}px * var(--total-scale-factor))`,l.color=st.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(l.textAlign=i[this.data.textAlignment])}_setRequired(t,i){i?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",i)}}class NA extends vs{constructor(t){const i=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:i})}setPropertyOnSiblings(t,i,s,r){const l=this.annotationStorage;for(const c of this._getElementsByName(t.name,t.id))c.domElement&&(c.domElement[i]=s),l.setValue(c.id,{[r]:s})}render(){const t=this.annotationStorage,i=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const r=t.getValue(i,{value:this.data.fieldValue});let l=r.value||"";const c=t.getValue(i,{charLimit:this.data.maxLen}).charLimit;c&&l.length>c&&(l=l.slice(0,c));let u=r.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:l,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??l,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",u??l),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),ys.add(s),this.contentElement=s,s.setAttribute("data-element-id",i),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const{datetimeFormat:f,datetimeType:m,timeStep:y}=this.data,b=!!m&&this.enableScripting;f&&(s.title=f),this._setRequired(s,this.data.required),c&&(s.maxLength=c),s.addEventListener("input",w=>{t.setValue(i,{value:w.target.value}),this.setPropertyOnSiblings(s,"value",w.target.value,"value"),h.formattedValue=null}),s.addEventListener("resetform",w=>{const S=this.data.defaultFieldValue??"";s.value=h.userValue=S,h.formattedValue=null});let A=w=>{const{formattedValue:S}=h;S!=null&&(w.target.value=S),w.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",S=>{if(h.focused)return;const{target:E}=S;if(b&&(E.type=m,y&&(E.step=y)),h.userValue){const _=h.userValue;if(b)if(m==="time"){const D=new Date(_),T=[D.getHours(),D.getMinutes(),D.getSeconds()];E.value=T.map(B=>B.toString().padStart(2,"0")).join(":")}else E.value=new Date(_-MA).toISOString().split(m==="date"?"T":".",1)[0];else E.value=_}h.lastCommittedValue=E.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),s.addEventListener("updatefromsandbox",S=>{this.showElementAndHideCanvas(S.target);const E={value(_){h.userValue=_.detail.value??"",b||t.setValue(i,{value:h.userValue.toString()}),_.target.value=h.userValue},formattedValue(_){const{formattedValue:D}=_.detail;h.formattedValue=D,D!=null&&_.target!==document.activeElement&&(_.target.value=D);const T={formattedValue:D};b&&(T.value=D),t.setValue(i,T)},selRange(_){_.target.setSelectionRange(..._.detail.selRange)},charLimit:_=>{const{charLimit:D}=_.detail,{target:T}=_;if(D===0){T.removeAttribute("maxLength");return}T.setAttribute("maxLength",D);let B=h.userValue;!B||B.length<=D||(B=B.slice(0,D),T.value=h.userValue=B,t.setValue(i,{value:B}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:B,willCommit:!0,commitKey:1,selStart:T.selectionStart,selEnd:T.selectionEnd}}))}};this._dispatchEventFromSandbox(E,S)}),s.addEventListener("keydown",S=>{h.commitKey=1;let E=-1;if(S.key==="Escape"?E=0:S.key==="Enter"&&!this.data.multiLine?E=2:S.key==="Tab"&&(h.commitKey=3),E===-1)return;const{value:_}=S.target;h.lastCommittedValue!==_&&(h.lastCommittedValue=_,h.userValue=_,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:_,willCommit:!0,commitKey:E,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}))});const w=A;A=null,s.addEventListener("blur",S=>{if(!h.focused||!S.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{target:E}=S;let{value:_}=E;if(b){if(_&&m==="time"){const D=_.split(":").map(T=>parseInt(T,10));_=new Date(2e3,0,1,D[0],D[1],D[2]||0).valueOf(),E.step=""}else _.includes("T")||(_=`${_}T00:00`),_=new Date(_).valueOf();E.type="text"}h.userValue=_,h.lastCommittedValue!==_&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:_,willCommit:!0,commitKey:h.commitKey,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}),w(S)}),this.data.actions?.Keystroke&&s.addEventListener("beforeinput",S=>{h.lastCommittedValue=null;const{data:E,target:_}=S,{value:D,selectionStart:T,selectionEnd:B}=_;let O=T,L=B;switch(S.inputType){case"deleteWordBackward":{const P=D.substring(0,T).match(/\w*[^\w]*$/);P&&(O-=P[0].length);break}case"deleteWordForward":{const P=D.substring(T).match(/^[^\w]*\w*/);P&&(L+=P[0].length);break}case"deleteContentBackward":T===B&&(O-=1);break;case"deleteContentForward":T===B&&(L+=1);break}S.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:D,change:E||"",willCommit:!1,selStart:O,selEnd:L}})}),this._setEventListeners(s,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],S=>S.target.value)}if(A&&s.addEventListener("blur",A),this.data.comb){const S=(this.data.rect[2]-this.data.rect[0])/c;s.classList.add("comb"),s.style.letterSpacing=`calc(${S}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class OA extends vs{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class LA extends vs{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,i=this.data,s=i.id;let r=t.getValue(s,{value:i.exportValue===i.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",t.setValue(s,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const l=document.createElement("input");return ys.add(l),l.setAttribute("data-element-id",s),l.disabled=i.readOnly,this._setRequired(l,this.data.required),l.type="checkbox",l.name=i.fieldName,r&&l.setAttribute("checked",!0),l.setAttribute("exportValue",i.exportValue),l.tabIndex=0,l.addEventListener("change",c=>{const{name:u,checked:h}=c.target;for(const f of this._getElementsByName(u,s)){const m=h&&f.exportValue===i.exportValue;f.domElement&&(f.domElement.checked=m),t.setValue(f.id,{value:m})}t.setValue(s,{value:h})}),l.addEventListener("resetform",c=>{const u=i.defaultFieldValue||"Off";c.target.checked=u===i.exportValue}),this.enableScripting&&this.hasJSActions&&(l.addEventListener("updatefromsandbox",c=>{const u={value(h){h.target.checked=h.detail.value!=="Off",t.setValue(s,{value:h.target.checked})}};this._dispatchEventFromSandbox(u,c)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)),this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class Wm extends vs{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,i=this.data,s=i.id;let r=t.getValue(s,{value:i.fieldValue===i.buttonValue}).value;if(typeof r=="string"&&(r=r!==i.buttonValue,t.setValue(s,{value:r})),r)for(const c of this._getElementsByName(i.fieldName,s))t.setValue(c.id,{value:!1});const l=document.createElement("input");if(ys.add(l),l.setAttribute("data-element-id",s),l.disabled=i.readOnly,this._setRequired(l,this.data.required),l.type="radio",l.name=i.fieldName,r&&l.setAttribute("checked",!0),l.tabIndex=0,l.addEventListener("change",c=>{const{name:u,checked:h}=c.target;for(const f of this._getElementsByName(u,s))t.setValue(f.id,{value:!1});t.setValue(s,{value:h})}),l.addEventListener("resetform",c=>{const u=i.defaultFieldValue;c.target.checked=u!=null&&u===i.buttonValue}),this.enableScripting&&this.hasJSActions){const c=i.buttonValue;l.addEventListener("updatefromsandbox",u=>{const h={value:f=>{const m=c===f.detail.value;for(const y of this._getElementsByName(f.target.name)){const b=m&&y.id===s;y.domElement&&(y.domElement.checked=b),t.setValue(y.id,{value:b})}}};this._dispatchEventFromSandbox(h,u)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class kA extends Mh{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const i=t.lastChild;return this.enableScripting&&this.hasJSActions&&i&&(this._setDefaultPropertiesFromJS(i),i.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),t}}class BA extends vs{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,i=this.data.id,s=t.getValue(i,{value:this.data.fieldValue}),r=document.createElement("select");ys.add(r),r.setAttribute("data-element-id",i),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=0;let l=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",m=>{const y=this.data.defaultFieldValue;for(const b of r.options)b.selected=b.value===y});for(const m of this.data.options){const y=document.createElement("option");y.textContent=m.displayValue,y.value=m.exportValue,s.value.includes(m.exportValue)&&(y.setAttribute("selected",!0),l=!1),r.append(y)}let c=null;if(l){const m=document.createElement("option");m.value=" ",m.setAttribute("hidden",!0),m.setAttribute("selected",!0),r.prepend(m),c=()=>{m.remove(),r.removeEventListener("input",c),c=null},r.addEventListener("input",c)}const u=m=>{const y=m?"value":"textContent",{options:b,multiple:A}=r;return A?Array.prototype.filter.call(b,w=>w.selected).map(w=>w[y]):b.selectedIndex===-1?null:b[b.selectedIndex][y]};let h=u(!1);const f=m=>{const y=m.target.options;return Array.prototype.map.call(y,b=>({displayValue:b.textContent,exportValue:b.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",m=>{const y={value(b){c?.();const A=b.detail.value,w=new Set(Array.isArray(A)?A:[A]);for(const S of r.options)S.selected=w.has(S.value);t.setValue(i,{value:u(!0)}),h=u(!1)},multipleSelection(b){r.multiple=!0},remove(b){const A=r.options,w=b.detail.remove;A[w].selected=!1,r.remove(w),A.length>0&&Array.prototype.findIndex.call(A,E=>E.selected)===-1&&(A[0].selected=!0),t.setValue(i,{value:u(!0),items:f(b)}),h=u(!1)},clear(b){for(;r.length!==0;)r.remove(0);t.setValue(i,{value:null,items:[]}),h=u(!1)},insert(b){const{index:A,displayValue:w,exportValue:S}=b.detail.insert,E=r.children[A],_=document.createElement("option");_.textContent=w,_.value=S,E?E.before(_):r.append(_),t.setValue(i,{value:u(!0),items:f(b)}),h=u(!1)},items(b){const{items:A}=b.detail;for(;r.length!==0;)r.remove(0);for(const w of A){const{displayValue:S,exportValue:E}=w,_=document.createElement("option");_.textContent=S,_.value=E,r.append(_)}r.options.length>0&&(r.options[0].selected=!0),t.setValue(i,{value:u(!0),items:f(b)}),h=u(!1)},indices(b){const A=new Set(b.detail.indices);for(const w of b.target.options)w.selected=A.has(w.index);t.setValue(i,{value:u(!0)}),h=u(!1)},editable(b){b.target.disabled=!b.detail.editable}};this._dispatchEventFromSandbox(y,m)}),r.addEventListener("input",m=>{const y=u(!0),b=u(!1);t.setValue(i,{value:y}),m.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:h,change:b,changeEx:y,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],m=>m.target.value)):r.addEventListener("input",function(m){t.setValue(i,{value:u(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class fh extends ne{constructor(t){const{data:i,elements:s,parent:r}=t,l=!!r._commentManager;if(super(t,{isRenderable:!l&&ne._hasPopupData(i)}),this.elements=s,l&&ne._hasPopupData(i)){const c=this.popup=this.#t();for(const u of s)u.popup=c}else this.popup=null}#t(){return new zA({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const i=this.popup=this.#t(),s=[];for(const r of this.elements)r.popup=i,r.container.ariaHasPopup="dialog",s.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(r=>`${fa}${r}`).join(",")),this.container}}class zA{#t=null;#e=this.#q.bind(this);#n=this.#j.bind(this);#i=this.#L.bind(this);#r=this.#w.bind(this);#a=null;#s=null;#o=null;#c=null;#l=null;#d=null;#h=null;#f=!1;#m=null;#g=null;#u=null;#p=null;#y=null;#v=null;#b=null;#E=null;#x=null;#S=null;#C=!1;#A=null;#_=null;constructor({container:t,color:i,elements:s,titleObj:r,modificationDate:l,contentsObj:c,richText:u,parent:h,rect:f,parentRect:m,open:y,commentManager:b=null}){this.#s=t,this.#x=r,this.#o=c,this.#E=u,this.#d=h,this.#a=i,this.#b=f,this.#h=m,this.#l=s,this.#t=b,this.#A=s[0],this.#c=rh.toDateObject(l),this.trigger=s.flatMap(A=>A.getElementsToTriggerPopup()),b||(this.#R(),this.#s.hidden=!0,y&&this.#w())}#R(){if(this.#g)return;this.#g=new AbortController;const{signal:t}=this.#g;for(const i of this.trigger)i.addEventListener("click",this.#r,{signal:t}),i.addEventListener("pointerenter",this.#i,{signal:t}),i.addEventListener("pointerleave",this.#n,{signal:t}),i.classList.add("popupTriggerArea");for(const i of this.#l)i.container?.addEventListener("keydown",this.#e,{signal:t})}#M(){const t=this.#l.find(i=>i.hasCommentButton);t&&(this.#y=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#p){this.#p.parentNode||this.#A.container.after(this.#p);return}if(this.#y||this.#M(),!this.#y)return;const{signal:t}=this.#g=new AbortController,i=this.#A.hasOwnCommentButton,s=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!i)},r=()=>{this.#t.toggleCommentPopup(this,!1,!0,!i)},l=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(i){this.#p=this.#A.container;for(const c of this.trigger)c.ariaHasPopup="dialog",c.ariaControls="commentPopup",c.addEventListener("keydown",this.#e,{signal:t}),c.addEventListener("click",s,{signal:t}),c.addEventListener("pointerenter",r,{signal:t}),c.addEventListener("pointerleave",l,{signal:t}),c.classList.add("popupTriggerArea")}else{const c=this.#p=document.createElement("button");c.className="annotationCommentButton";const u=this.#A.container;c.style.zIndex=u.style.zIndex+1,c.tabIndex=0,c.ariaHasPopup="dialog",c.ariaControls="commentPopup",c.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#P(),this.#D(),c.addEventListener("keydown",this.#e,{signal:t}),c.addEventListener("click",s,{signal:t}),c.addEventListener("pointerenter",r,{signal:t}),c.addEventListener("pointerleave",l,{signal:t}),u.after(c)}}#D(){if(this.#A.extraPopupElement&&!this.#A.editor)return;this.#p||this.renderCommentButton();const[t,i]=this.#y,{style:s}=this.#p;s.left=`calc(${t}%)`,s.top=`calc(${i}% - var(--comment-button-dim))`}#P(){this.#A.extraPopupElement||(this.#p||this.renderCommentButton(),this.#p.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:i}=this.#A.commentData;return t?this.#d._commentManager.makeCommentColor(t,i):null}focusCommentButton(){setTimeout(()=>{this.#p?.focus()},0)}getData(){const{richText:t,color:i,opacity:s,creationDate:r,modificationDate:l}=this.#A.commentData;return{contentsObj:{str:this.comment},richText:t,color:i,opacity:s,creationDate:r,modificationDate:l}}get elementBeforePopup(){return this.#p}get comment(){return this.#_||=this.#A.commentText,this.#_}set comment(t){t!==this.comment&&(this.#A.commentText=this.#_=t)}focus(){this.#A.container?.focus()}get parentBoundingClientRect(){return this.#A.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:i}){this.#p&&(this.#p.classList.toggle("selected",t),this.#p.ariaExpanded=i)}setSelectedCommentButton(t){this.#p.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#v)return this.#v;const{x:t,y:i,height:s}=this.#p.getBoundingClientRect(),{x:r,y:l,width:c,height:u}=this.#A.layer.getBoundingClientRect();return[(t-r)/c,(i+s-l)/u]}set commentPopupPosition(t){this.#v=t}hasDefaultPopupPosition(){return this.#v===null}get commentButtonPosition(){return this.#y}get commentButtonWidth(){return this.#p.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[i,s]=this.#v||this.commentButtonPosition.map(f=>f/100),r=this.parentBoundingClientRect,{x:l,y:c,width:u,height:h}=r;this.#t.showDialog(null,this,l+i*u,c+s*h,{...t,parentDimensions:r})}render(){if(this.#m)return;const t=this.#m=document.createElement("div");if(t.className="popup",this.#a){const s=t.style.outlineColor=st.makeHexColor(...this.#a);t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const i=document.createElement("span");if(i.className="header",this.#x?.str){const s=document.createElement("span");s.className="title",i.append(s),{dir:s.dir,str:s.textContent}=this.#x}if(t.append(i),this.#c){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),s.dateTime=this.#c.toISOString(),i.append(s)}Om({html:this.#O||this.#o.str,dir:this.#o?.dir,className:"popupContent"},t),this.#s.append(t)}get#O(){const t=this.#E,i=this.#o;return t?.str&&(!i?.str||i.str===t.str)&&this.#E.html||null}get#k(){return this.#O?.attributes?.style?.fontSize||0}get#U(){return this.#O?.attributes?.style?.color||null}#B(t){const i=[],s={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:i}]}},r={style:{color:this.#U,fontSize:this.#k?`calc(${this.#k}px * var(--total-scale-factor))`:""}};for(const l of t.split(`
`))i.push({name:"span",value:l,attributes:r});return s}#q(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#w()}updateEdited({rect:t,popup:i,deleted:s}){if(this.#t){s?(this.remove(),this.#_=null):i&&(i.deleted?this.remove():(this.#P(),this.#_=i.text)),t&&(this.#y=null,this.#M(),this.#D());return}if(s||i?.deleted){this.remove();return}this.#R(),this.#S||={contentsObj:this.#o,richText:this.#E},t&&(this.#u=null),i&&i.text&&(this.#E=this.#B(i.text),this.#c=rh.toDateObject(i.date),this.#o=null),this.#m?.remove(),this.#m=null}resetEdited(){this.#S&&({contentsObj:this.#o,richText:this.#E}=this.#S,this.#S=null,this.#m?.remove(),this.#m=null,this.#u=null)}remove(){if(this.#g?.abort(),this.#g=null,this.#m?.remove(),this.#m=null,this.#C=!1,this.#f=!1,this.#p?.remove(),this.#p=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#T(){if(this.#u!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:i,pageHeight:s,pageX:r,pageY:l}}}=this.#d;let c=!!this.#h,u=c?this.#h:this.#b;for(const w of this.#l)if(!u||st.intersect(w.data.rect,u)!==null){u=w.data.rect,c=!0;break}const h=st.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),m=c?u[2]-u[0]+5:0,y=h[0]+m,b=h[1];this.#u=[100*(y-r)/i,100*(b-l)/s];const{style:A}=this.#s;A.left=`${this.#u[0]}%`,A.top=`${this.#u[1]}%`}#w(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#L(),this.#s.addEventListener("click",this.#r),this.#s.addEventListener("keydown",this.#e)):(this.#j(),this.#s.removeEventListener("click",this.#r),this.#s.removeEventListener("keydown",this.#e))}#L(){this.#m||this.render(),this.isVisible?this.#f&&this.#s.classList.add("focused"):(this.#T(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#j(){this.#s.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#C=this.isVisible,this.#C&&(this.#s.hidden=!0)}maybeShow(){this.#t||(this.#R(),this.#C&&(this.#m||this.#L(),this.#C=!1,this.#s.hidden=!1))}get isVisible(){return this.#t?!1:this.#s.hidden===!1}}class Jm extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=At.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=this.contentElement=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const i of this.textContent){const s=document.createElement("span");s.textContent=i,t.append(s)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class PA extends ne{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),l=this.#t=this.svgFactory.createElement("svg:line");return l.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),l.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),l.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),l.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),l.setAttribute("stroke-width",t.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class UA extends ne{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),l=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:rect");return c.setAttribute("x",l/2),c.setAttribute("y",l/2),c.setAttribute("width",i-l),c.setAttribute("height",s-l),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),r.append(c),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class jA extends ne{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),l=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:ellipse");return c.setAttribute("cx",i/2),c.setAttribute("cy",s/2),c.setAttribute("rx",i/2-l/2),c.setAttribute("ry",s/2-l/2),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),r.append(c),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class ty extends ne{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:i,borderStyle:s,popupRef:r},width:l,height:c}=this;if(!i)return this.container;const u=this.svgFactory.create(l,c,!0);let h=[];for(let m=0,y=i.length;m<y;m+=2){const b=i[m]-t[0],A=t[3]-i[m+1];h.push(`${b},${A}`)}h=h.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",h),f.setAttribute("stroke-width",s.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),u.append(f),this.container.append(u),!r&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class FA extends ty{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class HA extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class Dh extends ne{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?At.HIGHLIGHT:At.INK}#n(t,i){switch(t){case 90:return{transform:`rotate(90) translate(${-i[0]},${i[1]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};case 180:return{transform:`rotate(180) translate(${-i[2]},${i[1]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]};case 270:return{transform:`rotate(270) translate(${-i[2]},${i[3]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};default:return{transform:`translate(${-i[0]},${i[3]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:i,inkLists:s,borderStyle:r,popupRef:l}}=this,{transform:c,width:u,height:h}=this.#n(i,t),f=this.svgFactory.create(u,h,!0),m=this.#t=this.svgFactory.createElement("svg:g");f.append(m),m.setAttribute("stroke-width",r.width||1),m.setAttribute("stroke-linecap","round"),m.setAttribute("stroke-linejoin","round"),m.setAttribute("stroke-miterlimit",10),m.setAttribute("stroke","transparent"),m.setAttribute("fill","transparent"),m.setAttribute("transform",c);for(let y=0,b=s.length;y<b;y++){const A=this.svgFactory.createElement(this.svgElementName);this.#e.push(A),A.setAttribute("points",s[y].join(",")),m.append(A)}return!l&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:i,points:s,rect:r}=t,l=this.#t;if(i>=0&&l.setAttribute("stroke-width",i||1),s)for(let c=0,u=this.#e.length;c<u;c++)this.#e[c].setAttribute("points",s[c].join(","));if(r){const{transform:c,width:u,height:h}=this.#n(this.data.rotation,r);l.parentElement.setAttribute("viewBox",`0 0 ${u} ${h}`),l.setAttribute("transform",c)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class ey extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=At.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class IA extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class GA extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class qA extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),t){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class iy extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=At.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class VA extends ne{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:i}=this.data;this.filename=i.filename,this.content=i.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:i}=this;let s;i.hasAppearance||i.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),s.addEventListener("dblclick",this.#e.bind(this)),this.#t=s;const{isMac:r}=Oe.platform;return t.addEventListener("keydown",l=>{l.key==="Enter"&&(r?l.metaKey:l.ctrlKey)&&this.#e()}),!i.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Rh{#t=null;#e=null;#n=null;#i=new Map;#r=null;#a=null;#s=[];#o=!1;constructor({div:t,accessibilityManager:i,annotationCanvasMap:s,annotationEditorUIManager:r,page:l,viewport:c,structTreeLayer:u,commentManager:h,linkService:f,annotationStorage:m}){this.div=t,this.#t=i,this.#e=s,this.#r=u||null,this.#a=f||null,this.#n=m||new wh,this.page=l,this.viewport=c,this.zIndex=0,this._annotationEditorUIManager=r,this._commentManager=h||null}hasEditableAnnotations(){return this.#i.size>0}async render(t){const{annotations:i}=t,s=this.div;ms(s,this.viewport);const r=new Map,l=[],c={data:null,layer:s,linkService:this.#a,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new pl,annotationStorage:this.#n,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const u of i){if(u.noHTML)continue;const h=u.annotationType===me.POPUP;if(h){const y=r.get(u.id);if(!y)continue;if(!this._commentManager){l.push(u);continue}c.elements=y}else if(u.rect[2]===u.rect[0]||u.rect[3]===u.rect[1])continue;c.data=u;const f=ih.create(c);if(!f.isRenderable)continue;if(!h&&(this.#s.push(f),u.popupRef)){const y=r.get(u.popupRef);y?y.push(f):r.set(u.popupRef,[f])}const m=f.render();u.hidden&&(m.style.visibility="hidden"),f._isEditable&&(this.#i.set(f.data.id,f),this._annotationEditorUIManager?.renderAnnotationElement(f))}await this.#c();for(const u of l){const h=c.elements=r.get(u.id);c.data=u;const f=ih.create(c);if(!f.isRenderable)continue;const m=f.render();f.contentElement.id=`${fa}${u.id}`,u.hidden&&(m.style.visibility="hidden"),h.at(-1).container.after(m)}this.#l()}async#c(){if(this.#s.length===0)return;this.div.replaceChildren();const t=[];if(!this.#o){this.#o=!0;for(const{contentElement:s,data:{id:r}}of this.#s){const l=s.id=`${fa}${r}`;t.push(this.#r?.getAriaAttributes(l).then(c=>{if(c)for(const[u,h]of c)s.setAttribute(u,h)}))}}this.#s.sort(({data:{rect:[s,r,l,c]}},{data:{rect:[u,h,f,m]}})=>{if(s===l&&r===c)return 1;if(u===f&&h===m)return-1;const y=c,b=r,A=(r+c)/2,w=m,S=h,E=(h+m)/2;if(A>=w&&E<=b)return-1;if(E>=y&&A<=S)return 1;const _=(s+l)/2,D=(u+f)/2;return _-D});const i=document.createDocumentFragment();for(const s of this.#s)i.append(s.container),this._commentManager?(s.extraPopupElement?.popup||s.popup)?.renderCommentButton():s.extraPopupElement&&i.append(s.extraPopupElement.render());if(this.div.append(i),await Promise.all(t),this.#t)for(const s of this.#s)this.#t.addPointerInTextLayer(s.contentElement,!1)}async addLinkAnnotations(t){const i={data:null,layer:this.div,linkService:this.#a,svgFactory:new pl,parent:this};for(const s of t){s.borderStyle||=Rh._defaultBorderStyle,i.data=s;const r=ih.create(i);r.isRenderable&&(r.render(),r.contentElement.id=`${fa}${s.id}`,this.#s.push(r))}await this.#c()}update({viewport:t}){const i=this.div;this.viewport=t,ms(i,{rotation:t.rotation}),this.#l(),i.hidden=!1}#l(){if(!this.#e)return;const t=this.div;for(const[i,s]of this.#e){const r=t.querySelector(`[data-annotation-id="${i}"]`);if(!r)continue;s.className="annotationContent";const{firstChild:l}=r;l?l.nodeName==="CANVAS"?l.replaceWith(s):l.classList.contains("annotationContent")?l.after(s):l.before(s):r.append(s);const c=this.#i.get(i);c&&(c._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(i,r.id,s),c._hasNoCanvas=!1):c.canvas=s)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#i.values())}getEditableAnnotation(t){return this.#i.get(t)}addFakeAnnotation(t){const{div:i}=this,{id:s,rotation:r}=t,l=new DA({data:{id:s,rect:t.getPDFRect(),rotation:r},editor:t,layer:i,parent:this,enableComment:!!this._commentManager,linkService:this.#a,annotationStorage:this.#n});return l.render(),l.contentElement.id=`${fa}${s}`,l.createOrUpdatePopup(),this.#s.push(l),l}removeAnnotation(t){const i=this.#s.findIndex(r=>r.data.id===t);if(i<0)return;const[s]=this.#s.splice(i,1);this.#t?.removePointerInTextLayer(s.contentElement)}updateFakeAnnotations(t){if(t.length!==0){for(const i of t)i.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}static get _defaultBorderStyle(){return wt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:ua.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const rl=/\r\n?|\n/g;class we extends lt{#t="";#e=`${this.id}-editor`;#n=null;#i;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=we.prototype,i=l=>l.isEmpty(),s=Vn.TRANSLATE_SMALL,r=Vn.TRANSLATE_BIG;return wt(this,"_keyboardManager",new Lr([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:i}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:i}]]))}static _type="freetext";static _editorType=At.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||we._defaultColor||lt._defaultLineColor,this.#i=t.fontSize||we._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(t,i){lt.initialize(t,i);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,i){switch(t){case Rt.FREETEXT_SIZE:we._defaultFontSize=i;break;case Rt.FREETEXT_COLOR:we._defaultColor=i;break}}updateParams(t,i){switch(t){case Rt.FREETEXT_SIZE:this.#r(i);break;case Rt.FREETEXT_COLOR:this.#a(i);break}}static get defaultPropertiesToUpdate(){return[[Rt.FREETEXT_SIZE,we._defaultFontSize],[Rt.FREETEXT_COLOR,we._defaultColor||lt._defaultLineColor]]}get propertiesToUpdate(){return[[Rt.FREETEXT_SIZE,this.#i],[Rt.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new Mr(this),[["colorPicker",this._colorPicker]]}get colorType(){return Rt.FREETEXT_COLOR}#r(t){const i=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-this.#i)*this.parentScale),this.#i=r,this.#o()},s=this.#i;this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Rt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#a(t){const i=r=>{this.color=r,this.onUpdatedColor()},s=this.color;this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Rt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,i){this._uiManager.translateSelectedEditors(t,i,!0)}getInitialTranslation(){const t=this.parentScale;return[-we._internalPadding*t,-(we._internalPadding+this.#i)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#n=new AbortController;const t=this._uiManager.combinedSignal(this.#n);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#n?.abort(),this.#n=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#s(){const t=[];this.editorDiv.normalize();let i=null;for(const s of this.editorDiv.childNodes)i?.nodeType===Node.TEXT_NODE&&s.nodeName==="BR"||(t.push(we.#c(s)),i=s);return t.join(`
`)}#o(){const[t,i]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:r,div:l}=this,c=l.style.display,u=l.classList.contains("hidden");l.classList.remove("hidden"),l.style.display="hidden",r.div.append(this.div),s=l.getBoundingClientRect(),l.remove(),l.style.display=c,l.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/i):(this.width=s.height/t,this.height=s.width/i),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,i=this.#t=this.#s().trimEnd();if(t===i)return;const s=r=>{if(this.#t=r,!r){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{s(i)},undo:()=>{s(t)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){we._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,i;(this._isCopy||this.annotationElementId)&&(t=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,s.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,l]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[u,h]=this.getInitialTranslation();[u,h]=this.pageTranslationToScreen(u,h);const[f,m]=this.pageDimensions,[y,b]=this.pageTranslation;let A,w;switch(this.rotation){case 0:A=t+(c[0]-y)/f,w=i+this.height-(c[1]-b)/m;break;case 90:A=t+(c[0]-y)/f,w=i-(c[1]-b)/m,[u,h]=[h,-u];break;case 180:A=t-this.width+(c[0]-y)/f,w=i-(c[1]-b)/m,[u,h]=[-u,-h];break;case 270:A=t+(c[0]-y-this.height*m)/f,w=i+(c[1]-b-this.width*f)/m,[u,h]=[-h,u];break}this.setAt(A*r,w*l,u,h)}else this._moveAfterPaste(t,i);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(rl,"")}editorDivPaste(t){const i=t.clipboardData||window.clipboardData,{types:s}=i;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const r=we.#h(i.getData("text")||"").replaceAll(rl,`
`);if(!r)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const c=l.getRangeAt(0);if(!r.includes(`
`)){c.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:u,startOffset:h}=c,f=[],m=[];if(u.nodeType===Node.TEXT_NODE){const A=u.parentElement;if(m.push(u.nodeValue.slice(h).replaceAll(rl,"")),A!==this.editorDiv){let w=f;for(const S of this.editorDiv.childNodes){if(S===A){w=m;continue}w.push(we.#c(S))}}f.push(u.nodeValue.slice(0,h).replaceAll(rl,""))}else if(u===this.editorDiv){let A=f,w=0;for(const S of this.editorDiv.childNodes)w++===h&&(A=m),A.push(we.#c(S))}this.#t=`${f.join(`
`)}${r}${m.join(`
`)}`,this.#l();const y=new Range;let b=Math.sumPrecise(f.map(A=>A.length));for(const{firstChild:A}of this.editorDiv.childNodes)if(A.nodeType===Node.TEXT_NODE){const w=A.nodeValue.length;if(b<=w){y.setStart(A,b),y.setEnd(A,b);break}b-=w}l.removeAllRanges(),l.addRange(y)}#l(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const i=document.createElement("div");i.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(i)}}#d(){return this.#t.replaceAll(""," ")}static#h(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=we._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,i,s){let r=null;if(t instanceof Jm){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:h,rotation:f,id:m,popupRef:y,richText:b,contentsObj:A,creationDate:w,modificationDate:S},textContent:E,textPosition:_,parent:{page:{pageNumber:D}}}=t;if(!E||E.length===0)return null;r=t={annotationType:At.FREETEXT,color:Array.from(u),fontSize:c,value:E.join(`
`),position:_,pageIndex:D-1,rect:h.slice(0),rotation:f,annotationElementId:m,id:m,deleted:!1,popupRef:y,comment:A?.str||null,richText:b,creationDate:w,modificationDate:S}}const l=await super.deserialize(t,i,s);return l.#i=t.fontSize,l.color=st.makeHexColor(...t.color),l.#t=we.#h(t.value),l._initialData=r,t.comment&&l.setCommentData(t),l}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=lt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),s=Object.assign(super.serialize(t),{color:i,fontSize:this.#i,value:this.#d()});return this.addComment(s),t?(s.isCopy=!0,s):this.annotationElementId&&!this.#f(s)?null:(s.id=this.annotationElementId,s)}#f(t){const{value:i,fontSize:s,color:r,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==i||t.fontSize!==s||t.color.some((c,u)=>c!==r[u])||t.pageIndex!==l}renderAnnotationElement(t){const i=super.renderAnnotationElement(t);if(!i)return null;const{style:s}=i;s.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,s.color=this.color,i.replaceChildren();for(const r of this.#t.split(`
`)){const l=document.createElement("div");l.append(r?document.createTextNode(r):document.createElement("br")),i.append(l)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),i}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class it{static PRECISION=1e-4;toSVGPath(){$t("Abstract method `toSVGPath` must be implemented.")}get box(){$t("Abstract getter `box` must be implemented.")}serialize(t,i){$t("Abstract method `serialize` must be implemented.")}static _rescale(t,i,s,r,l,c){c||=new Float32Array(t.length);for(let u=0,h=t.length;u<h;u+=2)c[u]=i+t[u]*r,c[u+1]=s+t[u+1]*l;return c}static _rescaleAndSwap(t,i,s,r,l,c){c||=new Float32Array(t.length);for(let u=0,h=t.length;u<h;u+=2)c[u]=i+t[u+1]*r,c[u+1]=s+t[u]*l;return c}static _translate(t,i,s,r){r||=new Float32Array(t.length);for(let l=0,c=t.length;l<c;l+=2)r[l]=i+t[l],r[l+1]=s+t[l+1];return r}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,i,s,r,l){switch(l){case 90:return[1-i/s,t/r];case 180:return[1-t/s,1-i/r];case 270:return[i/s,1-t/r];default:return[t/s,i/r]}}static _normalizePagePoint(t,i,s){switch(s){case 90:return[1-i,t];case 180:return[1-t,1-i];case 270:return[i,1-t];default:return[t,i]}}static createBezierPoints(t,i,s,r,l,c){return[(t+5*s)/6,(i+5*r)/6,(5*s+l)/6,(5*r+c)/6,(s+l)/2,(r+c)/2]}}class hs{#t;#e=[];#n;#i;#r=[];#a=new Float32Array(18);#s;#o;#c;#l;#d;#h;#f=[];static#m=8;static#g=2;static#u=hs.#m+hs.#g;constructor({x:t,y:i},s,r,l,c,u=0){this.#t=s,this.#h=l*r,this.#i=c,this.#a.set([NaN,NaN,NaN,NaN,t,i],6),this.#n=u,this.#l=hs.#m*r,this.#c=hs.#u*r,this.#d=r,this.#f.push(t,i)}isEmpty(){return isNaN(this.#a[8])}#p(){const t=this.#a.subarray(4,6),i=this.#a.subarray(16,18),[s,r,l,c]=this.#t;return[(this.#s+(t[0]-i[0])/2-s)/l,(this.#o+(t[1]-i[1])/2-r)/c,(this.#s+(i[0]-t[0])/2-s)/l,(this.#o+(i[1]-t[1])/2-r)/c]}add({x:t,y:i}){this.#s=t,this.#o=i;const[s,r,l,c]=this.#t;let[u,h,f,m]=this.#a.subarray(8,12);const y=t-f,b=i-m,A=Math.hypot(y,b);if(A<this.#c)return!1;const w=A-this.#l,S=w/A,E=S*y,_=S*b;let D=u,T=h;u=f,h=m,f+=E,m+=_,this.#f?.push(t,i);const B=-_/w,O=E/w,L=B*this.#h,P=O*this.#h;return this.#a.set(this.#a.subarray(2,8),0),this.#a.set([f+L,m+P],4),this.#a.set(this.#a.subarray(14,18),12),this.#a.set([f-L,m-P],16),isNaN(this.#a[6])?(this.#r.length===0&&(this.#a.set([u+L,h+P],2),this.#r.push(NaN,NaN,NaN,NaN,(u+L-s)/l,(h+P-r)/c),this.#a.set([u-L,h-P],14),this.#e.push(NaN,NaN,NaN,NaN,(u-L-s)/l,(h-P-r)/c)),this.#a.set([D,T,u,h,f,m],6),!this.isEmpty()):(this.#a.set([D,T,u,h,f,m],6),Math.abs(Math.atan2(T-h,D-u)-Math.atan2(_,E))<Math.PI/2?([u,h,f,m]=this.#a.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((u+f)/2-s)/l,((h+m)/2-r)/c),[u,h,D,T]=this.#a.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((D+u)/2-s)/l,((T+h)/2-r)/c),!0):([D,T,u,h,f,m]=this.#a.subarray(0,6),this.#r.push(((D+5*u)/6-s)/l,((T+5*h)/6-r)/c,((5*u+f)/6-s)/l,((5*h+m)/6-r)/c,((u+f)/2-s)/l,((h+m)/2-r)/c),[f,m,u,h,D,T]=this.#a.subarray(12,18),this.#e.push(((D+5*u)/6-s)/l,((T+5*h)/6-r)/c,((5*u+f)/6-s)/l,((5*h+m)/6-r)/c,((u+f)/2-s)/l,((h+m)/2-r)/c),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#r,i=this.#e;if(isNaN(this.#a[6])&&!this.isEmpty())return this.#y();const s=[];s.push(`M${t[4]} ${t[5]}`);for(let r=6;r<t.length;r+=6)isNaN(t[r])?s.push(`L${t[r+4]} ${t[r+5]}`):s.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);this.#b(s);for(let r=i.length-6;r>=6;r-=6)isNaN(i[r])?s.push(`L${i[r+4]} ${i[r+5]}`):s.push(`C${i[r]} ${i[r+1]} ${i[r+2]} ${i[r+3]} ${i[r+4]} ${i[r+5]}`);return this.#v(s),s.join(" ")}#y(){const[t,i,s,r]=this.#t,[l,c,u,h]=this.#p();return`M${(this.#a[2]-t)/s} ${(this.#a[3]-i)/r} L${(this.#a[4]-t)/s} ${(this.#a[5]-i)/r} L${l} ${c} L${u} ${h} L${(this.#a[16]-t)/s} ${(this.#a[17]-i)/r} L${(this.#a[14]-t)/s} ${(this.#a[15]-i)/r} Z`}#v(t){const i=this.#e;t.push(`L${i[4]} ${i[5]} Z`)}#b(t){const[i,s,r,l]=this.#t,c=this.#a.subarray(4,6),u=this.#a.subarray(16,18),[h,f,m,y]=this.#p();t.push(`L${(c[0]-i)/r} ${(c[1]-s)/l} L${h} ${f} L${m} ${y} L${(u[0]-i)/r} ${(u[1]-s)/l}`)}newFreeDrawOutline(t,i,s,r,l,c){return new ny(t,i,s,r,l,c)}getOutlines(){const t=this.#r,i=this.#e,s=this.#a,[r,l,c,u]=this.#t,h=new Float32Array((this.#f?.length??0)+2);for(let y=0,b=h.length-2;y<b;y+=2)h[y]=(this.#f[y]-r)/c,h[y+1]=(this.#f[y+1]-l)/u;if(h[h.length-2]=(this.#s-r)/c,h[h.length-1]=(this.#o-l)/u,isNaN(s[6])&&!this.isEmpty())return this.#E(h);const f=new Float32Array(this.#r.length+24+this.#e.length);let m=t.length;for(let y=0;y<m;y+=2){if(isNaN(t[y])){f[y]=f[y+1]=NaN;continue}f[y]=t[y],f[y+1]=t[y+1]}m=this.#S(f,m);for(let y=i.length-6;y>=6;y-=6)for(let b=0;b<6;b+=2){if(isNaN(i[y+b])){f[m]=f[m+1]=NaN,m+=2;continue}f[m]=i[y+b],f[m+1]=i[y+b+1],m+=2}return this.#x(f,m),this.newFreeDrawOutline(f,h,this.#t,this.#d,this.#n,this.#i)}#E(t){const i=this.#a,[s,r,l,c]=this.#t,[u,h,f,m]=this.#p(),y=new Float32Array(36);return y.set([NaN,NaN,NaN,NaN,(i[2]-s)/l,(i[3]-r)/c,NaN,NaN,NaN,NaN,(i[4]-s)/l,(i[5]-r)/c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,f,m,NaN,NaN,NaN,NaN,(i[16]-s)/l,(i[17]-r)/c,NaN,NaN,NaN,NaN,(i[14]-s)/l,(i[15]-r)/c],0),this.newFreeDrawOutline(y,t,this.#t,this.#d,this.#n,this.#i)}#x(t,i){const s=this.#e;return t.set([NaN,NaN,NaN,NaN,s[4],s[5]],i),i+=6}#S(t,i){const s=this.#a.subarray(4,6),r=this.#a.subarray(16,18),[l,c,u,h]=this.#t,[f,m,y,b]=this.#p();return t.set([NaN,NaN,NaN,NaN,(s[0]-l)/u,(s[1]-c)/h,NaN,NaN,NaN,NaN,f,m,NaN,NaN,NaN,NaN,y,b,NaN,NaN,NaN,NaN,(r[0]-l)/u,(r[1]-c)/h],i),i+=24}}class ny extends it{#t;#e=new Float32Array(4);#n;#i;#r;#a;#s;constructor(t,i,s,r,l,c){super(),this.#s=t,this.#r=i,this.#t=s,this.#a=r,this.#n=l,this.#i=c,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(c);const[u,h,f,m]=this.#e;for(let y=0,b=t.length;y<b;y+=2)t[y]=(t[y]-u)/f,t[y+1]=(t[y+1]-h)/m;for(let y=0,b=i.length;y<b;y+=2)i[y]=(i[y]-u)/f,i[y+1]=(i[y+1]-h)/m}toSVGPath(){const t=[`M${this.#s[4]} ${this.#s[5]}`];for(let i=6,s=this.#s.length;i<s;i+=6){if(isNaN(this.#s[i])){t.push(`L${this.#s[i+4]} ${this.#s[i+5]}`);continue}t.push(`C${this.#s[i]} ${this.#s[i+1]} ${this.#s[i+2]} ${this.#s[i+3]} ${this.#s[i+4]} ${this.#s[i+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,i,s,r],l){const c=s-t,u=r-i;let h,f;switch(l){case 0:h=it._rescale(this.#s,t,r,c,-u),f=it._rescale(this.#r,t,r,c,-u);break;case 90:h=it._rescaleAndSwap(this.#s,t,i,c,u),f=it._rescaleAndSwap(this.#r,t,i,c,u);break;case 180:h=it._rescale(this.#s,s,i,-c,u),f=it._rescale(this.#r,s,i,-c,u);break;case 270:h=it._rescaleAndSwap(this.#s,s,r,-c,-u),f=it._rescaleAndSwap(this.#r,s,r,-c,-u);break}return{outline:Array.from(h),points:[Array.from(f)]}}#o(t){const i=this.#s;let s=i[4],r=i[5];const l=[s,r,s,r];let c=s,u=r,h=s,f=r;const m=t?Math.max:Math.min,y=new Float32Array(4);for(let A=6,w=i.length;A<w;A+=6){const S=i[A+4],E=i[A+5];isNaN(i[A])?(st.pointBoundingBox(S,E,l),u>E?(c=S,u=E):u===E&&(c=m(c,S)),f<E?(h=S,f=E):f===E&&(h=m(h,S))):(y[0]=y[1]=1/0,y[2]=y[3]=-1/0,st.bezierBoundingBox(s,r,...i.slice(A,A+6),y),st.rectBoundingBox(y[0],y[1],y[2],y[3],l),u>y[1]?(c=y[0],u=y[1]):u===y[1]&&(c=m(c,y[0])),f<y[3]?(h=y[2],f=y[3]):f===y[3]&&(h=m(h,y[2]))),s=S,r=E}const b=this.#e;b[0]=l[0]-this.#n,b[1]=l[1]-this.#n,b[2]=l[2]-l[0]+2*this.#n,b[3]=l[3]-l[1]+2*this.#n,this.firstPoint=[c,u],this.lastPoint=[h,f]}get box(){return this.#e}newOutliner(t,i,s,r,l,c=0){return new hs(t,i,s,r,l,c)}getNewOutline(t,i){const[s,r,l,c]=this.#e,[u,h,f,m]=this.#t,y=l*f,b=c*m,A=s*f+u,w=r*m+h,S=this.newOutliner({x:this.#r[0]*y+A,y:this.#r[1]*b+w},this.#t,this.#a,t,this.#i,i??this.#n);for(let E=2;E<this.#r.length;E+=2)S.add({x:this.#r[E]*y+A,y:this.#r[E+1]*b+w});return S.getOutlines()}}class ph{#t;#e;#n;#i=[];#r=[];constructor(t,i=0,s=0,r=!0){const l=[1/0,1/0,-1/0,-1/0],c=10**-4;for(const{x:S,y:E,width:_,height:D}of t){const T=Math.floor((S-i)/c)*c,B=Math.ceil((S+_+i)/c)*c,O=Math.floor((E-i)/c)*c,L=Math.ceil((E+D+i)/c)*c,P=[T,O,L,!0],q=[B,O,L,!1];this.#i.push(P,q),st.rectBoundingBox(T,O,B,L,l)}const u=l[2]-l[0]+2*s,h=l[3]-l[1]+2*s,f=l[0]-s,m=l[1]-s;let y=r?-1/0:1/0,b=1/0;const A=this.#i.at(r?-1:-2),w=[A[0],A[2]];for(const S of this.#i){const[E,_,D,T]=S;!T&&r?_<b?(b=_,y=E):_===b&&(y=Math.max(y,E)):T&&!r&&(_<b?(b=_,y=E):_===b&&(y=Math.min(y,E))),S[0]=(E-f)/u,S[1]=(_-m)/h,S[2]=(D-m)/h}this.#t=new Float32Array([f,m,u,h]),this.#e=[y,b],this.#n=w}getOutlines(){this.#i.sort((i,s)=>i[0]-s[0]||i[1]-s[1]||i[2]-s[2]);const t=[];for(const i of this.#i)i[3]?(t.push(...this.#l(i)),this.#o(i)):(this.#c(i),t.push(...this.#l(i)));return this.#a(t)}#a(t){const i=[],s=new Set;for(const c of t){const[u,h,f]=c;i.push([u,h,c],[u,f,c])}i.sort((c,u)=>c[1]-u[1]||c[0]-u[0]);for(let c=0,u=i.length;c<u;c+=2){const h=i[c][2],f=i[c+1][2];h.push(f),f.push(h),s.add(h),s.add(f)}const r=[];let l;for(;s.size>0;){const c=s.values().next().value;let[u,h,f,m,y]=c;s.delete(c);let b=u,A=h;for(l=[u,f],r.push(l);;){let w;if(s.has(m))w=m;else if(s.has(y))w=y;else break;s.delete(w),[u,h,f,m,y]=w,b!==u&&(l.push(b,A,u,A===h?h:f),b=u),A=A===h?f:h}l.push(b,A)}return new XA(r,this.#t,this.#e,this.#n)}#s(t){const i=this.#r;let s=0,r=i.length-1;for(;s<=r;){const l=s+r>>1,c=i[l][0];if(c===t)return l;c<t?s=l+1:r=l-1}return r+1}#o([,t,i]){const s=this.#s(t);this.#r.splice(s,0,[t,i])}#c([,t,i]){const s=this.#s(t);for(let r=s;r<this.#r.length;r++){const[l,c]=this.#r[r];if(l!==t)break;if(l===t&&c===i){this.#r.splice(r,1);return}}for(let r=s-1;r>=0;r--){const[l,c]=this.#r[r];if(l!==t)break;if(l===t&&c===i){this.#r.splice(r,1);return}}}#l(t){const[i,s,r]=t,l=[[i,s,r]],c=this.#s(r);for(let u=0;u<c;u++){const[h,f]=this.#r[u];for(let m=0,y=l.length;m<y;m++){const[,b,A]=l[m];if(!(f<=b||A<=h)){if(b>=h){if(A>f)l[m][1]=f;else{if(y===1)return[];l.splice(m,1),m--,y--}continue}l[m][2]=h,A>f&&l.push([i,f,A])}}}return l}}class XA extends it{#t;#e;constructor(t,i,s,r){super(),this.#e=t,this.#t=i,this.firstPoint=s,this.lastPoint=r}toSVGPath(){const t=[];for(const i of this.#e){let[s,r]=i;t.push(`M${s} ${r}`);for(let l=2;l<i.length;l+=2){const c=i[l],u=i[l+1];c===s?(t.push(`V${u}`),r=u):u===r&&(t.push(`H${c}`),s=c)}t.push("Z")}return t.join(" ")}serialize([t,i,s,r],l){const c=[],u=s-t,h=r-i;for(const f of this.#e){const m=new Array(f.length);for(let y=0;y<f.length;y+=2)m[y]=t+f[y]*u,m[y+1]=r-f[y+1]*h;c.push(m)}return c}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class gh extends hs{newFreeDrawOutline(t,i,s,r,l,c){return new YA(t,i,s,r,l,c)}}class YA extends ny{newOutliner(t,i,s,r,l,c=0){return new gh(t,i,s,r,l,c)}}class ce extends lt{#t=null;#e=0;#n;#i=null;#r=null;#a=null;#s=null;#o=0;#c=null;#l=null;#d=null;#h=!1;#f=null;#m=null;#g=null;#u="";#p;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=At.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=ce.prototype;return wt(this,"_keyboardManager",new Lr([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||ce._defaultColor,this.#p=t.thickness||ce._defaultThickness,this.opacity=t.opacity||ce._defaultOpacity,this.#n=t.boxes||null,this.#y=t.methodOfCreation||"",this.#u=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#h=!0,this.#b(t),this.#A()):this.#n&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#s=t.focusNode,this.#o=t.focusOffset,this.#v(),this.#A(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#p,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#v(){const t=new ph(this.#n,.001);this.#l=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const i=new ph(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#a=i.getOutlines();const{firstPoint:s}=this.#l;this.#f=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height];const{lastPoint:r}=this.#a;this.#m=[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height]}#b({highlightOutlines:t,highlightId:i,clipPathId:s}){this.#l=t;const r=1.5;if(this.#a=t.getNewOutline(this.#p/2+r,.0025),i>=0)this.#d=i,this.#i=s,this.parent.drawLayer.finalizeDraw(i,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#g=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#a.box,path:{d:this.#a.toSVGPath()}},!0);else if(this.parent){const y=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:ce.#_(this.#l.box,(y-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#g,{bbox:ce.#_(this.#a.box,y),path:{d:this.#a.toSVGPath()}})}const[l,c,u,h]=t.box;switch(this.rotation){case 0:this.x=l,this.y=c,this.width=u,this.height=h;break;case 90:{const[y,b]=this.parentDimensions;this.x=c,this.y=1-l,this.width=u*b/y,this.height=h*y/b;break}case 180:this.x=1-l,this.y=1-c,this.width=u,this.height=h;break;case 270:{const[y,b]=this.parentDimensions;this.x=1-c,this.y=l,this.width=u*b/y,this.height=h*y/b;break}}const{firstPoint:f}=t;this.#f=[(f[0]-l)/u,(f[1]-c)/h];const{lastPoint:m}=this.#a;this.#m=[(m[0]-l)/u,(m[1]-c)/h]}static initialize(t,i){lt.initialize(t,i),ce._defaultColor||=i.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,i){switch(t){case Rt.HIGHLIGHT_COLOR:ce._defaultColor=i;break;case Rt.HIGHLIGHT_THICKNESS:ce._defaultThickness=i;break}}translateInPage(t,i){}get toolbarPosition(){return this.#m}get commentButtonPosition(){return this.#f}updateParams(t,i){switch(t){case Rt.HIGHLIGHT_COLOR:this.#E(i);break;case Rt.HIGHLIGHT_THICKNESS:this.#x(i);break}}static get defaultPropertiesToUpdate(){return[[Rt.HIGHLIGHT_COLOR,ce._defaultColor],[Rt.HIGHLIGHT_THICKNESS,ce._defaultThickness]]}get propertiesToUpdate(){return[[Rt.HIGHLIGHT_COLOR,this.color||ce._defaultColor],[Rt.HIGHLIGHT_THICKNESS,this.#p||ce._defaultThickness],[Rt.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#r?.updateColor(this.color),super.onUpdatedColor()}#E(t){const i=(l,c)=>{this.color=l,this.opacity=c,this.onUpdatedColor()},s=this.color,r=this.opacity;this.addCommands({cmd:i.bind(this,t,ce._defaultOpacity),undo:i.bind(this,s,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Rt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#x(t){const i=this.#p,s=r=>{this.#p=r,this.#S(r)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Rt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#r=new _i({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#D())}getBaseTranslation(){return[0,0]}getRect(t,i){return super.getRect(t,i,this.#D())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#C(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#A(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let i=!1;this.parent&&!t?this.#C():t&&(this.#A(t),i=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),i&&this.select()}#S(t){this.#h&&(this.#b({highlightOutlines:this.#l.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())}#C(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#g),this.#g=null)}#A(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#i}=t.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#l.toSVGPath()}},!1,!0),this.#g=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#a.box,path:{d:this.#a.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#i))}static#_([t,i,s,r],l){switch(l){case 90:return[1-i-r,t,r,s];case 180:return[1-t-s,1-i-r,s,r];case 270:return[i,1-t-s,r,s]}return[t,i,s,r]}rotate(t){const{drawLayer:i}=this.parent;let s;this.#h?(t=(t-this.rotation+360)%360,s=ce.#_(this.#l.box,t)):s=ce.#_([this.x,this.y,this.width,this.height],t),i.updateProperties(this.#d,{bbox:s,root:{"data-main-rotation":t}}),i.updateProperties(this.#g,{bbox:ce.#_(this.#a.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#u&&(t.setAttribute("aria-label",this.#u),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#R.bind(this),{signal:this._uiManager._signal});const i=this.#c=document.createElement("div");return t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=this.#i,this.setDims(),km(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1}})}#R(t){ce._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#M(!0);break;case 1:case 3:this.#M(!1);break}}#M(t){if(!this.#t)return;const i=window.getSelection();t?i.setPosition(this.#t,this.#e):i.setPosition(this.#s,this.#o)}select(){super.select(),this.#g&&this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#g&&(this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{selected:!1}}),this.#h||this.#M(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#g,{rootClass:{hidden:!t}}))}#D(){return this.#h?this.rotation:0}#P(){if(this.#h)return null;const[t,i]=this.pageDimensions,[s,r]=this.pageTranslation,l=this.#n,c=new Float32Array(l.length*8);let u=0;for(const{x:h,y:f,width:m,height:y}of l){const b=h*t+s,A=(1-f)*i+r;c[u]=c[u+4]=b,c[u+1]=c[u+3]=A,c[u+2]=c[u+6]=b+m*t,c[u+5]=c[u+7]=A-y*i,u+=8}return c}#O(t){return this.#l.serialize(t,this.#D())}static startHighlighting(t,i,{target:s,x:r,y:l}){const{x:c,y:u,width:h,height:f}=s.getBoundingClientRect(),m=new AbortController,y=t.combinedSignal(m),b=A=>{m.abort(),this.#U(t,A)};window.addEventListener("blur",b,{signal:y}),window.addEventListener("pointerup",b,{signal:y}),window.addEventListener("pointerdown",re,{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",Ei,{signal:y}),s.addEventListener("pointermove",this.#k.bind(this,t),{signal:y}),this._freeHighlight=new gh({x:r,y:l},[c,u,h,f],t.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#k(t,i){this._freeHighlight.add(i)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#U(t,i){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,i,s){let r=null;if(t instanceof ey){const{data:{quadPoints:w,rect:S,rotation:E,id:_,color:D,opacity:T,popupRef:B,richText:O,contentsObj:L,creationDate:P,modificationDate:q},parent:{page:{pageNumber:K}}}=t;r=t={annotationType:At.HIGHLIGHT,color:Array.from(D),opacity:T,quadPoints:w,boxes:null,pageIndex:K-1,rect:S.slice(0),rotation:E,annotationElementId:_,id:_,deleted:!1,popupRef:B,richText:O,comment:L?.str||null,creationDate:P,modificationDate:q}}else if(t instanceof Dh){const{data:{inkLists:w,rect:S,rotation:E,id:_,color:D,borderStyle:{rawWidth:T},popupRef:B,richText:O,contentsObj:L,creationDate:P,modificationDate:q},parent:{page:{pageNumber:K}}}=t;r=t={annotationType:At.HIGHLIGHT,color:Array.from(D),thickness:T,inkLists:w,boxes:null,pageIndex:K-1,rect:S.slice(0),rotation:E,annotationElementId:_,id:_,deleted:!1,popupRef:B,richText:O,comment:L?.str||null,creationDate:P,modificationDate:q}}const{color:l,quadPoints:c,inkLists:u,opacity:h}=t,f=await super.deserialize(t,i,s);f.color=st.makeHexColor(...l),f.opacity=h||1,u&&(f.#p=t.thickness),f._initialData=r,t.comment&&f.setCommentData(t);const[m,y]=f.pageDimensions,[b,A]=f.pageTranslation;if(c){const w=f.#n=[];for(let S=0;S<c.length;S+=8)w.push({x:(c[S]-b)/m,y:1-(c[S+1]-A)/y,width:(c[S+2]-c[S])/m,height:(c[S+1]-c[S+5])/y});f.#v(),f.#A(),f.rotate(f.rotation)}else if(u){f.#h=!0;const w=u[0],S={x:w[0]-b,y:y-(w[1]-A)},E=new gh(S,[0,0,m,y],1,f.#p/2,!0,.001);for(let T=0,B=w.length;T<B;T+=2)S.x=w[T]-b,S.y=y-(w[T+1]-A),E.add(S);const{id:_,clipPathId:D}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:E.toSVGPath()}},!0,!0);f.#b({highlightOutlines:E.getOutlines(),highlightId:_,clipPathId:D}),f.#A(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const i=lt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s=super.serialize(t);return Object.assign(s,{color:i,opacity:this.opacity,thickness:this.#p,quadPoints:this.#P(),outlines:this.#O(s.rect)}),this.addComment(s),this.annotationElementId&&!this.#B(s)?null:(s.id=this.annotationElementId,s)}#B(t){const{color:i}=this._initialData;return this.hasEditedComment||t.color.some((s,r)=>s!==i[r])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class sy{#t=Object.create(null);updateProperty(t,i){this[t]=i,this.updateSVGProperty(t,i)}updateProperties(t){if(t)for(const[i,s]of Object.entries(t))i.startsWith("_")||this.updateProperty(i,s)}updateSVGProperty(t,i){this.#t[t]=i}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){$t("Not implemented")}}class Pt extends lt{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#i=null;static#r=null;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#a(t),this.#c())}#a({drawOutlines:t,drawId:i,drawingOptions:s}){this.#t=t,this._drawingOptions||=s,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,t.defaultProperties)):this._drawId=this.#s(t,this.parent),this.#h(t.box)}#s(t,i){const{id:s}=i.drawLayer.draw(Pt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s}static _mergeSVGProperties(t,i){const s=new Set(Object.keys(t));for(const[r,l]of Object.entries(i))s.has(r)?Object.assign(t[r],l):t[r]=l;return t}static getDefaultDrawingOptions(t){$t("Not implemented")}static get typesMap(){$t("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,i){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,i),this._currentParent&&(Pt.#n.updateProperty(s,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,i){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,i)}static get defaultPropertiesToUpdate(){const t=[],i=this._defaultDrawingOptions;for(const[s,r]of this.typesMap)t.push([s,i[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:i}=this;for(const[s,r]of this.constructor.typesMap)t.push([s,i[r]]);return t}_updateProperty(t,i,s){const r=this._drawingOptions,l=r[i],c=u=>{r.updateProperty(i,u);const h=this.#t.updateProperty(i,u);h&&this.#h(h),this.parent?.drawLayer.updateProperties(this._drawId,r.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:c.bind(this,s),undo:c.bind(this,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Pt._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#d()),{bbox:this.#f()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Pt._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#d()),{bbox:this.#f()}))}_onTranslating(t,i){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#f()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Pt._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#d(),this.parentDimensions),{bbox:this.#f()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#o(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let i=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#o()):t&&(this._uiManager.addShouldRescale(this),this.#c(t),i=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),i&&this.select()}#o(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#s(this.#t,t)}}#l([t,i,s,r]){const{parentDimensions:[l,c],rotation:u}=this;switch(u){case 90:return[i,1-t,s*(c/l),r*(l/c)];case 180:return[1-t,1-i,s,r];case 270:return[1-i,t,s*(c/l),r*(l/c)];default:return[t,i,s,r]}}#d(){const{x:t,y:i,width:s,height:r,parentDimensions:[l,c],rotation:u}=this;switch(u){case 90:return[1-i,t,s*(l/c),r*(c/l)];case 180:return[1-t,1-i,s,r];case 270:return[i,1-t,s*(l/c),r*(c/l)];default:return[t,i,s,r]}}#h(t){[this.x,this.y,this.width,this.height]=this.#l(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#f(){const{x:t,y:i,width:s,height:r,rotation:l,parentRotation:c,parentDimensions:[u,h]}=this;switch((l*4+c)/90){case 1:return[1-i-r,t,r,s];case 2:return[1-t-s,1-i-r,s,r];case 3:return[i,1-t-s,r,s];case 4:return[t,i-s*(u/h),r*(h/u),s*(u/h)];case 5:return[1-i,t,s*(u/h),r*(h/u)];case 6:return[1-t-r*(h/u),1-i,r*(h/u),s*(u/h)];case 7:return[i-s*(u/h),1-t-r*(h/u),s*(u/h),r*(h/u)];case 8:return[t-s,i-r,s,r];case 9:return[1-i,t-s,r,s];case 10:return[1-t,1-i,s,r];case 11:return[i-r,1-t,r,s];case 12:return[t-r*(h/u),i,r*(h/u),s*(u/h)];case 13:return[1-i-s*(u/h),t-r*(h/u),s*(u/h),r*(h/u)];case 14:return[1-t,1-i-s*(u/h),r*(h/u),s*(u/h)];case 15:return[i,1-t,s*(u/h),r*(h/u)];default:return[t,i,s,r]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Pt._mergeSVGProperties({bbox:this.#f()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,i;this._isCopy&&(t=this.x,i=this.y);const s=super.render();s.classList.add("draw");const r=document.createElement("div");return s.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,i),s}static createDrawerInstance(t,i,s,r,l){$t("Not implemented")}static startDrawing(t,i,s,r){const{target:l,offsetX:c,offsetY:u,pointerId:h,pointerType:f}=r;if(Ut.isInitializedAndDifferentPointerType(f))return;const{viewport:{rotation:m}}=t,{width:y,height:b}=l.getBoundingClientRect(),A=Pt.#i=new AbortController,w=t.combinedSignal(A);if(Ut.setPointer(f,h),window.addEventListener("pointerup",S=>{Ut.isSamePointerIdOrRemove(S.pointerId)&&this._endDraw(S)},{signal:w}),window.addEventListener("pointercancel",S=>{Ut.isSamePointerIdOrRemove(S.pointerId)&&this._currentParent.endDrawingSession()},{signal:w}),window.addEventListener("pointerdown",S=>{Ut.isSamePointerType(S.pointerType)&&(Ut.initializeAndAddPointerId(S.pointerId),Pt.#n.isCancellable()&&(Pt.#n.removeLastElement(),Pt.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:w}),window.addEventListener("contextmenu",Ei,{signal:w}),l.addEventListener("pointermove",this._drawMove.bind(this),{signal:w}),l.addEventListener("touchmove",S=>{Ut.isSameTimeStamp(S.timeStamp)&&re(S)},{signal:w}),t.toggleDrawing(),i._editorUndoBar?.hide(),Pt.#n){t.drawLayer.updateProperties(this._currentDrawId,Pt.#n.startNew(c,u,y,b,m));return}i.updateUIForDefaultProperties(this),Pt.#n=this.createDrawerInstance(c,u,y,b,m),Pt.#r=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(Pt.#r.toSVGProperties(),Pt.#n.defaultSVGProperties),!0,!1)}static _drawMove(t){if(Ut.isSameTimeStamp(t.timeStamp),!Pt.#n)return;const{offsetX:i,offsetY:s,pointerId:r}=t;if(Ut.isSamePointerId(r)){if(Ut.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,Pt.#n.add(i,s)),Ut.setTimeStamp(t.timeStamp),re(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,Pt.#n=null,Pt.#r=null,Ut.clearPointerType(),Ut.clearTimeStamp()),Pt.#i&&(Pt.#i.abort(),Pt.#i=null,Ut.clearPointerIds())}static _endDraw(t){const i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),t?.target===i.div&&i.drawLayer.updateProperties(this._currentDrawId,Pt.#n.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=Pt.#n,r=this._currentDrawId,l=s.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(r,s.setLastElement(l))},undo:()=>{i.drawLayer.updateProperties(r,s.removeLastElement())},mustExec:!1,type:Rt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack(Rt.DRAW_STEP),!Pt.#n.isEmpty()){const{pageDimensions:[s,r],scale:l}=i,c=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Pt.#n.getOutlines(s*l,r*l,l,this._INNER_MARGIN),drawingOptions:Pt.#r,mustBeCommitted:!t});return this._cleanup(!0),c}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,i,s,r,l,c){$t("Not implemented")}static async deserialize(t,i,s){const{rawDims:{pageWidth:r,pageHeight:l,pageX:c,pageY:u}}=i.viewport,h=this.deserializeDraw(c,u,r,l,this._INNER_MARGIN,t),f=await super.deserialize(t,i,s);return f.createDrawingOptions(t),f.#a({drawOutlines:h}),f.#c(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[i,s]=this.pageTranslation,[r,l]=this.pageDimensions;return this.#t.serialize([i,s,r,l],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class $A{#t=new Float64Array(6);#e;#n;#i;#r;#a;#s="";#o=0;#c=new Br;#l;#d;constructor(t,i,s,r,l,c){this.#l=s,this.#d=r,this.#i=l,this.#r=c,[t,i]=this.#h(t,i);const u=this.#e=[NaN,NaN,NaN,NaN,t,i];this.#a=[t,i],this.#n=[{line:u,points:this.#a}],this.#t.set(u,0)}updateProperty(t,i){t==="stroke-width"&&(this.#r=i)}#h(t,i){return it._normalizePoint(t,i,this.#l,this.#d,this.#i)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#a.length<=10}add(t,i){[t,i]=this.#h(t,i);const[s,r,l,c]=this.#t.subarray(2,6),u=t-l,h=i-c;return Math.hypot(this.#l*u,this.#d*h)<=2?null:(this.#a.push(t,i),isNaN(s)?(this.#t.set([l,c,t,i],2),this.#e.push(NaN,NaN,NaN,NaN,t,i),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([s,r,l,c,t,i],0),this.#e.push(...it.createBezierPoints(s,r,l,c,t,i)),{path:{d:this.toSVGPath()}}))}end(t,i){const s=this.add(t,i);return s||(this.#a.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,i,s,r,l){this.#l=s,this.#d=r,this.#i=l,[t,i]=this.#h(t,i);const c=this.#e=[NaN,NaN,NaN,NaN,t,i];this.#a=[t,i];const u=this.#n.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#n.push({line:c,points:this.#a}),this.#t.set(c,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(t){return this.#n?(this.#n.push(t),this.#e=t.line,this.#a=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#n)return this.#c.removeLastElement();this.#n.pop(),this.#s="";for(let t=0,i=this.#n.length;t<i;t++){const{line:s,points:r}=this.#n[t];this.#e=s,this.#a=r,this.#o=0,this.toSVGPath()}return{path:{d:this.#s}}}toSVGPath(){const t=it.svgRound(this.#e[4]),i=it.svgRound(this.#e[5]);if(this.#a.length===2)return this.#s=`${this.#s} M ${t} ${i} Z`,this.#s;if(this.#a.length<=6){const r=this.#s.lastIndexOf("M");this.#s=`${this.#s.slice(0,r)} M ${t} ${i}`,this.#o=6}if(this.#a.length===4){const r=it.svgRound(this.#e[10]),l=it.svgRound(this.#e[11]);return this.#s=`${this.#s} L ${r} ${l}`,this.#o=12,this.#s}const s=[];this.#o===0&&(s.push(`M ${t} ${i}`),this.#o=6);for(let r=this.#o,l=this.#e.length;r<l;r+=6){const[c,u,h,f,m,y]=this.#e.slice(r,r+6).map(it.svgRound);s.push(`C${c} ${u} ${h} ${f} ${m} ${y}`)}return this.#s+=s.join(" "),this.#o=this.#e.length,this.#s}getOutlines(t,i,s,r){const l=this.#n.at(-1);return l.line=new Float32Array(l.line),l.points=new Float32Array(l.points),this.#c.build(this.#n,t,i,s,this.#i,this.#r,r),this.#t=null,this.#e=null,this.#n=null,this.#s=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Br extends it{#t;#e=0;#n;#i;#r;#a;#s;#o;#c;build(t,i,s,r,l,c,u){this.#r=i,this.#a=s,this.#s=r,this.#o=l,this.#c=c,this.#n=u??0,this.#i=t,this.#h()}get thickness(){return this.#c}setLastElement(t){return this.#i.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:i}of this.#i){if(t.push(`M${it.svgRound(i[4])} ${it.svgRound(i[5])}`),i.length===6){t.push("Z");continue}if(i.length===12&&isNaN(i[6])){t.push(`L${it.svgRound(i[10])} ${it.svgRound(i[11])}`);continue}for(let s=6,r=i.length;s<r;s+=6){const[l,c,u,h,f,m]=i.subarray(s,s+6).map(it.svgRound);t.push(`C${l} ${c} ${u} ${h} ${f} ${m}`)}}return t.join("")}serialize([t,i,s,r],l){const c=[],u=[],[h,f,m,y]=this.#d();let b,A,w,S,E,_,D,T,B;switch(this.#o){case 0:B=it._rescale,b=t,A=i+r,w=s,S=-r,E=t+h*s,_=i+(1-f-y)*r,D=t+(h+m)*s,T=i+(1-f)*r;break;case 90:B=it._rescaleAndSwap,b=t,A=i,w=s,S=r,E=t+f*s,_=i+h*r,D=t+(f+y)*s,T=i+(h+m)*r;break;case 180:B=it._rescale,b=t+s,A=i,w=-s,S=r,E=t+(1-h-m)*s,_=i+f*r,D=t+(1-h)*s,T=i+(f+y)*r;break;case 270:B=it._rescaleAndSwap,b=t+s,A=i+r,w=-s,S=-r,E=t+(1-f-y)*s,_=i+(1-h-m)*r,D=t+(1-f)*s,T=i+(1-h)*r;break}for(const{line:O,points:L}of this.#i)c.push(B(O,b,A,w,S,l?new Array(O.length):null)),u.push(B(L,b,A,w,S,l?new Array(L.length):null));return{lines:c,points:u,rect:[E,_,D,T]}}static deserialize(t,i,s,r,l,{paths:{lines:c,points:u},rotation:h,thickness:f}){const m=[];let y,b,A,w,S;switch(h){case 0:S=it._rescale,y=-t/s,b=i/r+1,A=1/s,w=-1/r;break;case 90:S=it._rescaleAndSwap,y=-i/r,b=-t/s,A=1/r,w=1/s;break;case 180:S=it._rescale,y=t/s+1,b=-i/r,A=-1/s,w=1/r;break;case 270:S=it._rescaleAndSwap,y=i/r+1,b=t/s+1,A=-1/r,w=-1/s;break}if(!c){c=[];for(const _ of u){const D=_.length;if(D===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,_[0],_[1]]));continue}if(D===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,_[0],_[1],NaN,NaN,NaN,NaN,_[2],_[3]]));continue}const T=new Float32Array(3*(D-2));c.push(T);let[B,O,L,P]=_.subarray(0,4);T.set([NaN,NaN,NaN,NaN,B,O],0);for(let q=4;q<D;q+=2){const K=_[q],J=_[q+1];T.set(it.createBezierPoints(B,O,L,P,K,J),(q-2)*3),[B,O,L,P]=[L,P,K,J]}}}for(let _=0,D=c.length;_<D;_++)m.push({line:S(c[_].map(T=>T??NaN),y,b,A,w),points:S(u[_].map(T=>T??NaN),y,b,A,w)});const E=new this.prototype.constructor;return E.build(m,s,r,1,h,f,l),E}#l(t=this.#c){const i=this.#n+t/2*this.#s;return this.#o%180===0?[i/this.#r,i/this.#a]:[i/this.#a,i/this.#r]}#d(){const[t,i,s,r]=this.#t,[l,c]=this.#l(0);return[t+l,i+c,s-2*l,r-2*c]}#h(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:r}of this.#i){if(r.length<=12){for(let u=4,h=r.length;u<h;u+=6)st.pointBoundingBox(r[u],r[u+1],t);continue}let l=r[4],c=r[5];for(let u=6,h=r.length;u<h;u+=6){const[f,m,y,b,A,w]=r.subarray(u,u+6);st.bezierBoundingBox(l,c,f,m,y,b,A,w,t),l=A,c=w}}const[i,s]=this.#l();t[0]=Fe(t[0]-i,0,1),t[1]=Fe(t[1]-s,0,1),t[2]=Fe(t[2]+i,0,1),t[3]=Fe(t[3]+s,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,i){return t==="stroke-width"?this.#f(i):null}#f(t){const[i,s]=this.#l();this.#c=t;const[r,l]=this.#l(),[c,u]=[r-i,l-s],h=this.#t;return h[0]-=c,h[1]-=u,h[2]+=2*c,h[3]+=2*u,h}updateParentDimensions([t,i],s){const[r,l]=this.#l();this.#r=t,this.#a=i,this.#s=s;const[c,u]=this.#l(),h=c-r,f=u-l,m=this.#t;return m[0]-=h,m[1]-=f,m[2]+=2*h,m[3]+=2*f,m}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(it.svgRound).join(" ")}get defaultProperties(){const[t,i]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${it.svgRound(t)} ${it.svgRound(i)}`}}}get rotationTransform(){const[,,t,i]=this.#t;let s=0,r=0,l=0,c=0,u=0,h=0;switch(this.#e){case 90:r=i/t,l=-t/i,u=t;break;case 180:s=-1,c=-1,u=t,h=i;break;case 270:r=-i/t,l=t/i,h=i;break;default:return""}return`matrix(${s} ${r} ${l} ${c} ${it.svgRound(u)} ${it.svgRound(h)})`}getPathResizingSVGProperties([t,i,s,r]){const[l,c]=this.#l(),[u,h,f,m]=this.#t;if(Math.abs(f-l)<=it.PRECISION||Math.abs(m-c)<=it.PRECISION){const S=t+s/2-(u+f/2),E=i+r/2-(h+m/2);return{path:{"transform-origin":`${it.svgRound(t)} ${it.svgRound(i)}`,transform:`${this.rotationTransform} translate(${S} ${E})`}}}const y=(s-2*l)/(f-2*l),b=(r-2*c)/(m-2*c),A=f/s,w=m/r;return{path:{"transform-origin":`${it.svgRound(u)} ${it.svgRound(h)}`,transform:`${this.rotationTransform} scale(${A} ${w}) translate(${it.svgRound(l)} ${it.svgRound(c)}) scale(${y} ${b}) translate(${it.svgRound(-l)} ${it.svgRound(-c)})`}}}getPathResizedSVGProperties([t,i,s,r]){const[l,c]=this.#l(),u=this.#t,[h,f,m,y]=u;if(u[0]=t,u[1]=i,u[2]=s,u[3]=r,Math.abs(m-l)<=it.PRECISION||Math.abs(y-c)<=it.PRECISION){const E=t+s/2-(h+m/2),_=i+r/2-(f+y/2);for(const{line:D,points:T}of this.#i)it._translate(D,E,_,D),it._translate(T,E,_,T);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${it.svgRound(t)} ${it.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const b=(s-2*l)/(m-2*l),A=(r-2*c)/(y-2*c),w=-b*(h+l)+t+l,S=-A*(f+c)+i+c;if(b!==1||A!==1||w!==0||S!==0)for(const{line:E,points:_}of this.#i)it._rescale(E,w,S,b,A,E),it._rescale(_,w,S,b,A,_);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${it.svgRound(t)} ${it.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,i],s){const[r,l]=s,c=this.#t,u=t-c[0],h=i-c[1];if(this.#r===r&&this.#a===l)for(const{line:f,points:m}of this.#i)it._translate(f,u,h,f),it._translate(m,u,h,m);else{const f=this.#r/r,m=this.#a/l;this.#r=r,this.#a=l;for(const{line:y,points:b}of this.#i)it._rescale(y,u,h,f,m,y),it._rescale(b,u,h,f,m,b);c[2]*=f,c[3]*=m}return c[0]=t,c[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${it.svgRound(t)} ${it.svgRound(i)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${it.svgRound(t[0])} ${it.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class wl extends sy{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:lt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,i){t==="stroke-width"&&(i??=this["stroke-width"],i*=this._viewParameters.realScale),super.updateSVGProperty(t,i)}clone(){const t=new wl(this._viewParameters);return t.updateAll(this),t}}class Nh extends Pt{static _type="ink";static _editorType=At.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,i){lt.initialize(t,i),this._defaultDrawingOptions=new wl(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!0}static get typesMap(){return wt(this,"typesMap",new Map([[Rt.INK_THICKNESS,"stroke-width"],[Rt.INK_COLOR,"stroke"],[Rt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,i,s,r,l){return new $A(t,i,s,r,l,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,i,s,r,l,c){return Br.deserialize(t,i,s,r,l,c)}static async deserialize(t,i,s){let r=null;if(t instanceof Dh){const{data:{inkLists:c,rect:u,rotation:h,id:f,color:m,opacity:y,borderStyle:{rawWidth:b},popupRef:A,richText:w,contentsObj:S,creationDate:E,modificationDate:_},parent:{page:{pageNumber:D}}}=t;r=t={annotationType:At.INK,color:Array.from(m),thickness:b,opacity:y,paths:{points:c},boxes:null,pageIndex:D-1,rect:u.slice(0),rotation:h,annotationElementId:f,id:f,deleted:!1,popupRef:A,richText:w,comment:S?.str||null,creationDate:E,modificationDate:_}}const l=await super.deserialize(t,i,s);return l._initialData=r,t.comment&&l.setCommentData(t),l}get toolbarButtons(){return this._colorPicker||=new Mr(this),[["colorPicker",this._colorPicker]]}get colorType(){return Rt.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:i,parent:s}=this;i.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,i.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:i,opacity:s}){this._drawingOptions=Nh.getDefaultDrawingOptions({stroke:st.makeHexColor(...t),"stroke-width":i,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:i,points:s}=this.serializeDraw(t),{_drawingOptions:{stroke:r,"stroke-opacity":l,"stroke-width":c}}=this,u=Object.assign(super.serialize(t),{color:lt._colorManager.convert(r),opacity:l,thickness:c,paths:{lines:i,points:s}});return this.addComment(u),t?(u.isCopy=!0,u):this.annotationElementId&&!this.#t(u)?null:(u.id=this.annotationElementId,u)}#t(t){const{color:i,thickness:s,opacity:r,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((c,u)=>c!==i[u])||t.thickness!==s||t.opacity!==r||t.pageIndex!==l}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:i,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:i,popup:this.comment}),null}}class mh extends Br{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const ol=8,vr=3;class da{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,i,s,r){return s-=t,r-=i,s===0?r>0?0:4:s===1?r+6:2-r}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#i(t,i,s,r,l,c,u){const h=this.#e(s,r,l,c);for(let f=0;f<8;f++){const m=(-f+h-u+16)%8,y=this.#n[2*m],b=this.#n[2*m+1];if(t[(s+y)*i+(r+b)]!==0)return m}return-1}static#r(t,i,s,r,l,c,u){const h=this.#e(s,r,l,c);for(let f=0;f<8;f++){const m=(f+h+u+16)%8,y=this.#n[2*m],b=this.#n[2*m+1];if(t[(s+y)*i+(r+b)]!==0)return m}return-1}static#a(t,i,s,r){const l=t.length,c=new Int32Array(l);for(let m=0;m<l;m++)c[m]=t[m]<=r?1:0;for(let m=1;m<s-1;m++)c[m*i]=c[m*i+i-1]=0;for(let m=0;m<i;m++)c[m]=c[i*s-1-m]=0;let u=1,h;const f=[];for(let m=1;m<s-1;m++){h=1;for(let y=1;y<i-1;y++){const b=m*i+y,A=c[b];if(A===0)continue;let w=m,S=y;if(A===1&&c[b-1]===0)u+=1,S-=1;else if(A>=1&&c[b+1]===0)u+=1,S+=1,A>1&&(h=A);else{A!==1&&(h=Math.abs(A));continue}const E=[y,m],_=S===y+1,D={isHole:_,points:E,id:u,parent:0};f.push(D);let T;for(const W of f)if(W.id===h){T=W;break}T?T.isHole?D.parent=_?T.parent:h:D.parent=_?h:T.parent:D.parent=_?h:0;const B=this.#i(c,i,m,y,w,S,0);if(B===-1){c[b]=-u,c[b]!==1&&(h=Math.abs(c[b]));continue}let O=this.#n[2*B],L=this.#n[2*B+1];const P=m+O,q=y+L;w=P,S=q;let K=m,J=y;for(;;){const W=this.#r(c,i,K,J,w,S,1);O=this.#n[2*W],L=this.#n[2*W+1];const ht=K+O,yt=J+L;E.push(yt,ht);const bt=K*i+J;if(c[bt+1]===0?c[bt]=-u:c[bt]===1&&(c[bt]=u),ht===m&&yt===y&&K===P&&J===q){c[b]!==1&&(h=Math.abs(c[b]));break}else w=K,S=J,K=ht,J=yt}}}return f}static#s(t,i,s,r){if(s-i<=4){for(let P=i;P<s-2;P+=2)r.push(t[P],t[P+1]);return}const l=t[i],c=t[i+1],u=t[s-4]-l,h=t[s-3]-c,f=Math.hypot(u,h),m=u/f,y=h/f,b=m*c-y*l,A=h/u,w=1/f,S=Math.atan(A),E=Math.cos(S),_=Math.sin(S),D=w*(Math.abs(E)+Math.abs(_)),T=w*(1-D+D**2),B=Math.max(Math.atan(Math.abs(_+E)*T),Math.atan(Math.abs(_-E)*T));let O=0,L=i;for(let P=i+2;P<s-2;P+=2){const q=Math.abs(b-m*t[P+1]+y*t[P]);q>O&&(L=P,O=q)}O>(f*B)**2?(this.#s(t,i,L+2,r),this.#s(t,L,s,r)):r.push(l,c)}static#o(t){const i=[],s=t.length;return this.#s(t,0,s,i),i.push(t[s-2],t[s-1]),i.length<=4?null:i}static#c(t,i,s,r,l,c){const u=new Float32Array(c**2),h=-2*r**2,f=c>>1;for(let S=0;S<c;S++){const E=(S-f)**2;for(let _=0;_<c;_++)u[S*c+_]=Math.exp((E+(_-f)**2)/h)}const m=new Float32Array(256),y=-2*l**2;for(let S=0;S<256;S++)m[S]=Math.exp(S**2/y);const b=t.length,A=new Uint8Array(b),w=new Uint32Array(256);for(let S=0;S<s;S++)for(let E=0;E<i;E++){const _=S*i+E,D=t[_];let T=0,B=0;for(let L=0;L<c;L++){const P=S+L-f;if(!(P<0||P>=s))for(let q=0;q<c;q++){const K=E+q-f;if(K<0||K>=i)continue;const J=t[P*i+K],W=u[L*c+q]*m[Math.abs(J-D)];T+=J*W,B+=W}}const O=A[_]=Math.round(T/B);w[O]++}return[A,w]}static#l(t){const i=new Uint32Array(256);for(const s of t)i[s]++;return i}static#d(t){const i=t.length,s=new Uint8ClampedArray(i>>2);let r=-1/0,l=1/0;for(let u=0,h=s.length;u<h;u++){const f=s[u]=t[u<<2];r=Math.max(r,f),l=Math.min(l,f)}const c=255/(r-l);for(let u=0,h=s.length;u<h;u++)s[u]=(s[u]-l)*c;return s}static#h(t){let i,s=-1/0,r=-1/0;const l=t.findIndex(h=>h!==0);let c=l,u=l;for(i=l;i<256;i++){const h=t[i];h>s&&(i-c>r&&(r=i-c,u=i-1),s=h,c=i)}for(i=u-1;i>=0&&!(t[i]>t[i+1]);i--);return i}static#f(t){const i=t,{width:s,height:r}=t,{maxDim:l}=this.#t;let c=s,u=r;if(s>l||r>l){let b=s,A=r,w=Math.log2(Math.max(s,r)/l);const S=Math.floor(w);w=w===S?S-1:S;for(let _=0;_<w;_++){c=Math.ceil(b/2),u=Math.ceil(A/2);const D=new OffscreenCanvas(c,u);D.getContext("2d").drawImage(t,0,0,b,A,0,0,c,u),b=c,A=u,t!==i&&t.close(),t=D.transferToImageBitmap()}const E=Math.min(l/c,l/u);c=Math.round(c*E),u=Math.round(u*E)}const f=new OffscreenCanvas(c,u).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,c,u),f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,c,u);const m=f.getImageData(0,0,c,u).data;return[this.#d(m),c,u]}static extractContoursFromText(t,{fontFamily:i,fontStyle:s,fontWeight:r},l,c,u,h){let f=new OffscreenCanvas(1,1),m=f.getContext("2d",{alpha:!1});const y=200,b=m.font=`${s} ${r} ${y}px ${i}`,{actualBoundingBoxLeft:A,actualBoundingBoxRight:w,actualBoundingBoxAscent:S,actualBoundingBoxDescent:E,fontBoundingBoxAscent:_,fontBoundingBoxDescent:D,width:T}=m.measureText(t),B=1.5,O=Math.ceil(Math.max(Math.abs(A)+Math.abs(w)||0,T)*B),L=Math.ceil(Math.max(Math.abs(S)+Math.abs(E)||y,Math.abs(_)+Math.abs(D)||y)*B);f=new OffscreenCanvas(O,L),m=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),m.font=b,m.filter="grayscale(1)",m.fillStyle="white",m.fillRect(0,0,O,L),m.fillStyle="black",m.fillText(t,O*(B-1)/2,L*(3-B)/2);const P=this.#d(m.getImageData(0,0,O,L).data),q=this.#l(P),K=this.#h(q),J=this.#a(P,O,L,K);return this.processDrawnLines({lines:{curves:J,width:O,height:L},pageWidth:l,pageHeight:c,rotation:u,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(t,i,s,r,l){const[c,u,h]=this.#f(t),[f,m]=this.#c(c,u,h,Math.hypot(u,h)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),y=this.#h(m),b=this.#a(f,u,h,y);return this.processDrawnLines({lines:{curves:b,width:u,height:h},pageWidth:i,pageHeight:s,rotation:r,innerMargin:l,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:i,pageHeight:s,rotation:r,innerMargin:l,mustSmooth:c,areContours:u}){r%180!==0&&([i,s]=[s,i]);const{curves:h,width:f,height:m}=t,y=t.thickness??0,b=[],A=Math.min(i/f,s/m),w=A/i,S=A/s,E=[];for(const{points:D}of h){const T=c?this.#o(D):D;if(!T)continue;E.push(T);const B=T.length,O=new Float32Array(B),L=new Float32Array(3*(B===2?2:B-2));if(b.push({line:L,points:O}),B===2){O[0]=T[0]*w,O[1]=T[1]*S,L.set([NaN,NaN,NaN,NaN,O[0],O[1]],0);continue}let[P,q,K,J]=T;P*=w,q*=S,K*=w,J*=S,O.set([P,q,K,J],0),L.set([NaN,NaN,NaN,NaN,P,q],0);for(let W=4;W<B;W+=2){const ht=O[W]=T[W]*w,yt=O[W+1]=T[W+1]*S;L.set(it.createBezierPoints(P,q,K,J,ht,yt),(W-2)*3),[P,q,K,J]=[K,J,ht,yt]}}if(b.length===0)return null;const _=u?new mh:new Br;return _.build(b,i,s,1,r,u?0:y,l),{outline:_,newCurves:E,areContours:u,thickness:y,width:f,height:m}}static async compressSignature({outlines:t,areContours:i,thickness:s,width:r,height:l}){let c=1/0,u=-1/0,h=0;for(const T of t){h+=T.length;for(let B=2,O=T.length;B<O;B++){const L=T[B]-T[B-2];c=Math.min(c,L),u=Math.max(u,L)}}let f;c>=-128&&u<=127?f=Int8Array:c>=-32768&&u<=32767?f=Int16Array:f=Int32Array;const m=t.length,y=ol+vr*m,b=new Uint32Array(y);let A=0;b[A++]=y*Uint32Array.BYTES_PER_ELEMENT+(h-2*m)*f.BYTES_PER_ELEMENT,b[A++]=0,b[A++]=r,b[A++]=l,b[A++]=i?0:1,b[A++]=Math.max(0,Math.floor(s??0)),b[A++]=m,b[A++]=f.BYTES_PER_ELEMENT;for(const T of t)b[A++]=T.length-2,b[A++]=T[0],b[A++]=T[1];const w=new CompressionStream("deflate-raw"),S=w.writable.getWriter();await S.ready,S.write(b);const E=f.prototype.constructor;for(const T of t){const B=new E(T.length-2);for(let O=2,L=T.length;O<L;O++)B[O-2]=T[O]-T[O-2];S.write(B)}S.close();const _=await new Response(w.readable).arrayBuffer(),D=new Uint8Array(_);return Rm(D)}static async decompressSignature(t){try{const i=uv(t),{readable:s,writable:r}=new DecompressionStream("deflate-raw"),l=r.getWriter();await l.ready,l.write(i).then(async()=>{await l.ready,await l.close()}).catch(()=>{});let c=null,u=0;for await(const T of s)c||=new Uint8Array(new Uint32Array(T.buffer,0,4)[0]),c.set(T,u),u+=T.length;const h=new Uint32Array(c.buffer,0,c.length>>2),f=h[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const m=h[2],y=h[3],b=h[4]===0,A=h[5],w=h[6],S=h[7],E=[],_=(ol+vr*w)*Uint32Array.BYTES_PER_ELEMENT;let D;switch(S){case Int8Array.BYTES_PER_ELEMENT:D=new Int8Array(c.buffer,_);break;case Int16Array.BYTES_PER_ELEMENT:D=new Int16Array(c.buffer,_);break;case Int32Array.BYTES_PER_ELEMENT:D=new Int32Array(c.buffer,_);break}u=0;for(let T=0;T<w;T++){const B=h[vr*T+ol],O=new Float32Array(B+2);E.push(O);for(let L=0;L<vr-1;L++)O[L]=h[vr*T+ol+L+1];for(let L=0;L<B;L++)O[L+2]=O[L]+D[u++]}return{areContours:b,thickness:A,outlines:E,width:m,height:y}}catch(i){return mt(`decompressSignature: ${i}`),null}}}class Oh extends sy{constructor(){super(),super.updateProperties({fill:lt._defaultLineColor,"stroke-width":0})}clone(){const t=new Oh;return t.updateAll(this),t}}class Lh extends wl{constructor(t){super(t),super.updateProperties({stroke:lt._defaultLineColor,"stroke-width":1})}clone(){const t=new Lh(this._viewParameters);return t.updateAll(this),t}}class qi extends Pt{#t=!1;#e=null;#n=null;#i=null;static _type="signature";static _editorType=At.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,i){lt.initialize(t,i),this._defaultDrawingOptions=new Oh,this._defaultDrawnSignatureOptions=new Lh(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!1}static get typesMap(){return wt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const i=t.get("hasDescription");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,i;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,t=this.x,i=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:r,mustSmooth:l,areContours:c,description:u,uuid:h,heightInPage:f}=this.#n,{rawDims:{pageWidth:m,pageHeight:y},rotation:b}=this.parent.viewport,A=da.processDrawnLines({lines:r,pageWidth:m,pageHeight:y,rotation:b,innerMargin:qi._INNER_MARGIN,mustSmooth:l,areContours:c});this.addSignature(A,f,u,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return s&&(this._isCopy=!0,this._moveAfterPaste(t,i)),this.div}setUuid(t){this.#i=t,this.addEditToolbar()}getUuid(){return this.#i}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(i=>{i?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:i,thickness:s,width:r,height:l}=this.#n,c=Math.max(r,l),u=da.processDrawnLines({lines:{curves:t.map(h=>({points:h})),thickness:s,width:r,height:l},pageWidth:c,pageHeight:c,rotation:0,innerMargin:0,mustSmooth:!1,areContours:i});return{areContours:i,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,i,s,r){const{x:l,y:c}=this,{outline:u}=this.#n=t;this.#t=u instanceof mh,this.description=s;let h;this.#t?h=qi.getDefaultDrawingOptions():(h=qi._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:h});const[,f]=this.pageDimensions;let m=i/f;m=m>=1?.5:m,this.width*=m/this.height,this.width>=1&&(m*=.9/this.width,this.width=.9),this.height=m,this.setDims(),this.x=l,this.y=c,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:r}=this.parent.viewport;return da.process(t,i,s,r,qi._INNER_MARGIN)}getFromText(t,i){const{rawDims:{pageWidth:s,pageHeight:r},rotation:l}=this.parent.viewport;return da.extractContoursFromText(t,i,s,r,l,qi._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:r}=this.parent.viewport;return da.processDrawnLines({lines:t,pageWidth:i,pageHeight:s,rotation:r,innerMargin:qi._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:i}){t?this._drawingOptions=qi.getDefaultDrawingOptions():(this._drawingOptions=qi._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":i}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:i,points:s}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":r}}=this,l=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:r});return this.addComment(l),t?(l.paths={lines:i,points:s},l.uuid=this.#i,l.isCopy=!0):l.lines=i,this.#e&&(l.accessibilityData={type:"Figure",alt:this.#e}),l}static deserializeDraw(t,i,s,r,l,c){return c.areContours?mh.deserialize(t,i,s,r,l,c):Br.deserialize(t,i,s,r,l,c)}static async deserialize(t,i,s){const r=await super.deserialize(t,i,s);return r.#t=t.areContours,r.description=t.accessibilityData?.alt||"",r.#i=t.uuid,r}}class KA extends lt{#t=null;#e=null;#n=null;#i=null;#r=null;#a="";#s=null;#o=!1;#c=null;#l=!1;#d=!1;static _type="stamp";static _editorType=At.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#i=t.bitmapUrl,this.#r=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,i){lt.initialize(t,i)}static isHandlingMimeForPasting(t){return oh.includes(t)}static paste(t,i){i.pasteEditor({mode:At.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const i=t.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}#h(t,i=!1){if(!t){this.remove();return}this.#t=t.bitmap,i||(this.#e=t.id,this.#l=t.isSvg),t.file&&(this.#a=t.file.name),this.#g()}#f(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#s){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:l,height:c}=t||this.copyCanvas(null,null,!0).imageData,u=await s.guess({name:"altText",request:{data:r,width:l,height:c,channels:r.length/(l*c)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const h=u.output;return await this.setGuessedAltText(h),i&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#m(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(s=>this.#h(s,!0)).finally(()=>this.#f());return}if(this.#i){const s=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(s).then(r=>this.#h(r)).finally(()=>this.#f());return}if(this.#r){const s=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(s).then(r=>this.#h(r)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=oh.join(",");const i=this._uiManager._signal;this.#n=new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(r)}s()},{signal:i}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:i})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#s?.remove(),this.#s=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#m();return}super.rebuild(),this.div!==null&&(this.#e&&this.#s===null&&this.#m(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#n||this.#t||this.#i||this.#r||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,i;return this._isCopy&&(t=this.x,i=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#g():this.#m()),this._isCopy&&this._moveAfterPaste(t,i),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,i){const{id:s,bitmap:r}=this._uiManager.imageManager.getFromCanvas(t,i);i.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(this.#e=s,r&&(this.#t=r),this.#o=!1,this.#g())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#p()},t)}#g(){const{div:t}=this;let{width:i,height:s}=this.#t;const[r,l]=this.pageDimensions,c=.75;if(this.width)i=this.width*r,s=this.height*l;else if(i>c*r||s>c*l){const h=Math.min(c*r/i,c*l/s);i*=h,s*=h}this._uiManager.enableWaiting(!1);const u=this.#s=document.createElement("canvas");u.setAttribute("role","img"),this.addContainer(u),this.width=i/r,this.height=s/l,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#p(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#a&&this.div.setAttribute("aria-description",this.#a),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,i,s=!1){t||(t=224);const{width:r,height:l}=this.#t,c=new Xi;let u=this.#t,h=r,f=l,m=null;if(i){if(r>i||l>i){const L=Math.min(i/r,i/l);h=Math.floor(r*L),f=Math.floor(l*L)}m=document.createElement("canvas");const b=m.width=Math.ceil(h*c.sx),A=m.height=Math.ceil(f*c.sy);this.#l||(u=this.#u(b,A));const w=m.getContext("2d");w.filter=this._uiManager.hcmFilter;let S="white",E="#cfcfd8";this._uiManager.hcmFilter!=="none"?E="black":mv.isDarkMode&&(S="#8f8f9d",E="#42414d");const _=15,D=_*c.sx,T=_*c.sy,B=new OffscreenCanvas(D*2,T*2),O=B.getContext("2d");O.fillStyle=S,O.fillRect(0,0,D*2,T*2),O.fillStyle=E,O.fillRect(0,0,D,T),O.fillRect(D,T,D,T),w.fillStyle=w.createPattern(B,"repeat"),w.fillRect(0,0,b,A),w.drawImage(u,0,0,u.width,u.height,0,0,b,A)}let y=null;if(s){let b,A;if(c.symmetric&&u.width<t&&u.height<t)b=u.width,A=u.height;else if(u=this.#t,r>t||l>t){const E=Math.min(t/r,t/l);b=Math.floor(r*E),A=Math.floor(l*E),this.#l||(u=this.#u(b,A))}const S=new OffscreenCanvas(b,A).getContext("2d",{willReadFrequently:!0});S.drawImage(u,0,0,u.width,u.height,0,0,b,A),y={width:b,height:A,data:S.getImageData(0,0,b,A).data}}return{canvas:m,width:h,height:f,imageData:y}}#u(t,i){const{width:s,height:r}=this.#t;let l=s,c=r,u=this.#t;for(;l>2*t||c>2*i;){const h=l,f=c;l>2*t&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),c>2*i&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const m=new OffscreenCanvas(l,c);m.getContext("2d").drawImage(u,0,0,h,f,0,0,l,c),u=m.transferToImageBitmap()}return u}#p(){const[t,i]=this.parentDimensions,{width:s,height:r}=this,l=new Xi,c=Math.ceil(s*t*l.sx),u=Math.ceil(r*i*l.sy),h=this.#s;if(!h||h.width===c&&h.height===u)return;h.width=c,h.height=u;const f=this.#l?this.#t:this.#u(c,u),m=h.getContext("2d");m.filter=this._uiManager.hcmFilter,m.drawImage(f,0,0,f.width,f.height,0,0,c,u)}#y(t){if(t){if(this.#l){const r=this._uiManager.imageManager.getSvgUrl(this.#e);if(r)return r}const i=document.createElement("canvas");return{width:i.width,height:i.height}=this.#t,i.getContext("2d").drawImage(this.#t,0,0),i.toDataURL()}if(this.#l){const[i,s]=this.pageDimensions,r=Math.round(this.width*i*Aa.PDF_TO_CSS_UNITS),l=Math.round(this.height*s*Aa.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(r,l);return c.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,r,l),c.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,i,s){let r=null,l=!1;if(t instanceof iy){const{data:{rect:S,rotation:E,id:_,structParent:D,popupRef:T,richText:B,contentsObj:O,creationDate:L,modificationDate:P},container:q,parent:{page:{pageNumber:K}},canvas:J}=t;let W,ht;J?(delete t.canvas,{id:W,bitmap:ht}=s.imageManager.getFromCanvas(q.id,J),J.remove()):(l=!0,t._hasNoCanvas=!0);const yt=(await i._structTree.getAriaAttributes(`${fa}${_}`))?.get("aria-label")||"";r=t={annotationType:At.STAMP,bitmapId:W,bitmap:ht,pageIndex:K-1,rect:S.slice(0),rotation:E,annotationElementId:_,id:_,deleted:!1,accessibilityData:{decorative:!1,altText:yt},isSvg:!1,structParent:D,popupRef:T,richText:B,comment:O?.str||null,creationDate:L,modificationDate:P}}const c=await super.deserialize(t,i,s),{rect:u,bitmap:h,bitmapUrl:f,bitmapId:m,isSvg:y,accessibilityData:b}=t;l?(s.addMissingCanvas(t.id,c),c.#o=!0):m&&s.imageManager.isValidId(m)?(c.#e=m,h&&(c.#t=h)):c.#i=f,c.#l=y;const[A,w]=c.pageDimensions;return c.width=(u[2]-u[0])/A,c.height=(u[3]-u[1])/w,b&&(c.altTextData=b),c._initialData=r,t.comment&&c.setCommentData(t),c.#d=!!r,c}serialize(t=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#l});if(this.addComment(s),t)return s.bitmapUrl=this.#y(!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:r,altText:l}=this.serializeAltText(!1);if(!r&&l&&(s.accessibilityData={type:"Figure",alt:l}),this.annotationElementId){const u=this.#v(s);return u.isSame?null:(u.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1,s.id=this.annotationElementId,delete s.bitmapId,s)}if(i===null)return s;i.stamps||=new Map;const c=this.#l?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!i.stamps.has(this.#e))i.stamps.set(this.#e,{area:c,serialized:s}),s.bitmap=this.#y(!1);else if(this.#l){const u=i.stamps.get(this.#e);c>u.area&&(u.area=c,u.serialized.bitmap.close(),u.serialized.bitmap=this.#y(!1))}return s}#v(t){const{pageIndex:i,accessibilityData:{altText:s}}=this._initialData,r=t.pageIndex===i,l=(t.accessibilityData?.alt||"")===s;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&r&&l,isSameAltText:l}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class gn{#t;#e=!1;#n=null;#i=null;#r=null;#a=new Map;#s=!1;#o=!1;#c=!1;#l=null;#d=null;#h=null;#f=null;#m=null;#g=-1;#u;static _initialized=!1;static#p=new Map([we,Nh,KA,ce,qi].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:i,div:s,structTreeLayer:r,accessibilityManager:l,annotationLayer:c,drawLayer:u,textLayer:h,viewport:f,l10n:m}){const y=[...gn.#p.values()];if(!gn._initialized){gn._initialized=!0;for(const b of y)b.initialize(m,t)}t.registerEditorTypes(y),this.#u=t,this.pageIndex=i,this.div=s,this.#t=l,this.#n=c,this.viewport=f,this.#h=h,this.drawLayer=u,this._structTree=r,this.#u.addLayer(this)}get isEmpty(){return this.#a.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===At.NONE}updateToolbar(t){this.#u.updateToolbar(t)}updateMode(t=this.#u.getMode()){switch(this.#S(),t){case At.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case At.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case At.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:i}=this.div;if(i.toggle("nonEditing",!1),t===At.POPUP)i.toggle("commentEditing",!0);else{i.toggle("commentEditing",!1);for(const s of gn.#p.values())i.toggle(`${s._type}Editing`,t===s._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}setEditingState(t){this.#u.setEditingState(t)}addCommands(t){this.#u.addCommands(t)}cleanUndoStack(t){this.#u.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.togglePointerEvents(t)}get#y(){return this.#a.size!==0?this.#a.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#m?.abort(),this.#m=null;const t=new Set;for(const s of this.#y)s.enableEditing(),s.show(!0),s.annotationElementId&&(this.#u.removeChangedExistingAnnotation(s),t.add(s.annotationElementId));const i=this.#n;if(i)for(const s of i.getEditableAnnotations()){if(s.hide(),this.#u.isDeletedAnnotationElement(s.data.id)||t.has(s.data.id))continue;const r=await this.deserialize(s);r&&(this.addOrRebuild(r),r.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#m){this.#m=new AbortController;const r=this.#u.combinedSignal(this.#m);this.#h.div.addEventListener("pointerdown",l=>{const{clientX:u,clientY:h,timeStamp:f}=l,m=this.#g;if(f-m>500){this.#g=f;return}this.#g=-1;const{classList:y}=this.div;y.toggle("getElements",!0);const b=document.elementsFromPoint(u,h);if(y.toggle("getElements",!1),!this.div.contains(b[0]))return;let A;const w=new RegExp(`^${_r}[0-9]+$`);for(const E of b)if(w.test(E.id)){A=E.id;break}if(!A)return;const S=this.#a.get(A);S?.annotationElementId===null&&(l.stopPropagation(),l.preventDefault(),S.dblclick(l))},{signal:r,capture:!0})}const t=this.#n,i=[];if(t){const r=new Map,l=new Map;for(const u of this.#y){if(u.disableEditing(),!u.annotationElementId){i.push(u);continue}if(u.serialize()!==null){r.set(u.annotationElementId,u);continue}else l.set(u.annotationElementId,u);this.getEditableAnnotation(u.annotationElementId)?.show(),u.remove()}const c=t.getEditableAnnotations();for(const u of c){const{id:h}=u.data;if(this.#u.isDeletedAnnotationElement(h)){u.updateEdited({deleted:!0});continue}let f=l.get(h);if(f){f.resetAnnotationElement(u),f.show(!1),u.show();continue}f=r.get(h),f&&(this.#u.addChangedExistingAnnotation(f),f.renderAnnotationElement(u)&&f.show(!1)),u.show()}}this.#S(),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const r of gn.#p.values())s.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),t?.updateFakeAnnotations(i),this.#o=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#u.getActive()!==t&&this.#u.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const t=this.#u.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#v.bind(this),{signal:t}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#v(t){this.#u.unselectAll();const{target:i}=t;if(i===this.#h.div||(i.getAttribute("role")==="img"||i.classList.contains("endOfContent"))&&this.#h.div.contains(i)){const{isMac:s}=Oe.platform;if(t.button!==0||t.ctrlKey&&s)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),ce.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:t.x,y:t.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const t=this.#u.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const i=this.pointerup.bind(this);this.div.addEventListener("pointerup",i,{signal:t}),this.div.addEventListener("pointercancel",i,{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#a.set(t.id,t);const{annotationElementId:i}=t;i&&this.#u.isDeletedAnnotationElement(i)&&this.#u.removeDeletedAnnotationElement(t)}detach(t){this.#a.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#u.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#u.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#u.addDeletedAnnotationElement(t.annotationElementId),lt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#u.addEditor(t),this.attach(t),!t.isAttachedToDOM){const i=t.render();this.div.append(i),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#u.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:i}=document;t.div.contains(i)&&!this.#r&&(t._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),i.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const i=()=>t._uiManager.rebuild(t),s=()=>{t.remove()};this.addCommands({cmd:i,undo:s,mustExec:!1})}getEditorByUID(t){for(const i of this.#a.values())if(i.uid===t)return i;return null}getNextId(){return this.#u.getId()}get#b(){return gn.#p.get(this.#u.getMode())}combinedSignal(t){return this.#u.combinedSignal(t)}#E(t){const i=this.#b;return i?new i.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#b?.canCreateNewEmptyEditor()}async pasteEditor(t,i){this.updateToolbar(t),await this.#u.updateMode(t.mode);const{offsetX:s,offsetY:r}=this.#x(),l=this.getNextId(),c=this.#E({parent:this,id:l,x:s,y:r,uiManager:this.#u,isCentered:!0,...i});c&&this.add(c)}async deserialize(t){return await gn.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#u)||null}createAndAddNewEditor(t,i,s={}){const r=this.getNextId(),l=this.#E({parent:this,id:r,x:t.offsetX,y:t.offsetY,uiManager:this.#u,isCentered:i,...s});return l&&this.add(l),l}get boundingClientRect(){return this.div.getBoundingClientRect()}#x(){const{x:t,y:i,width:s,height:r}=this.boundingClientRect,l=Math.max(0,t),c=Math.max(0,i),u=Math.min(window.innerWidth,t+s),h=Math.min(window.innerHeight,i+r),f=(l+u)/2-t,m=(c+h)/2-i,[y,b]=this.viewport.rotation%180===0?[f,m]:[m,f];return{offsetX:y,offsetY:b}}addNewEditor(t={}){this.createAndAddNewEditor(this.#x(),!0,t)}setSelected(t){this.#u.setSelected(t)}toggleSelected(t){this.#u.toggleSelected(t)}unselect(t){this.#u.unselect(t)}pointerup(t){const{isMac:i}=Oe.platform;if(t.button!==0||t.ctrlKey&&i||t.target!==this.div||!this.#s||(this.#s=!1,this.#b?.isDrawer&&this.#b.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const s=this.#u.getMode();if(s===At.STAMP||s===At.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#u.getMode()===At.HIGHLIGHT&&this.enableTextSelection(),this.#s){this.#s=!1;return}const{isMac:i}=Oe.platform;if(t.button!==0||t.ctrlKey&&i||t.target!==this.div)return;if(this.#s=!0,this.#b?.isDrawer){this.startDrawingSession(t);return}const s=this.#u.getActive();this.#e=!s||s.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#l){this.#b.startDrawing(this,this.#u,!1,t);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const i=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(this.#d=null,this.commitOrRemove())},{signal:i}),this.#b.startDrawing(this,this.#u,!1,t)}pause(t){if(t){const{activeElement:i}=document;this.div.contains(i)&&(this.#d=i);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#b.endDrawing(t)):null}findNewParent(t,i,s){const r=this.#u.findParent(i,s);return r===null||r===this?!1:(r.changeParent(t),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#b.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(const t of this.#a.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#a.clear(),this.#u.removeLayer(this)}#S(){for(const t of this.#a.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,ms(this.div,t);for(const i of this.#u.getEditors(this.pageIndex))this.add(i),i.rebuild();this.updateMode()}update({viewport:t}){this.#u.commitOrRemove(),this.#S();const i=this.viewport.rotation,s=t.rotation;if(this.viewport=t,ms(this.div,{rotation:s}),i!==s)for(const r of this.#a.values())r.rotate(s)}get pageDimensions(){const{pageWidth:t,pageHeight:i}=this.viewport.rawDims;return[t,i]}get scale(){return this.#u.viewParameters.realScale}}class Re{#t=null;#e=new Map;#n=new Map;static#i=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const i of this.#e.values())i.remove(),t.append(i);this.#t=t}}static get _svgFactory(){return wt(this,"_svgFactory",new pl)}static#r(t,[i,s,r,l]){const{style:c}=t;c.top=`${100*s}%`,c.left=`${100*i}%`,c.width=`${100*r}%`,c.height=`${100*l}%`}#a(){const t=Re._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#s(t,i){const s=Re._svgFactory.createElement("clipPath");t.append(s);const r=`clip_${i}`;s.setAttribute("id",r),s.setAttribute("clipPathUnits","objectBoundingBox");const l=Re._svgFactory.createElement("use");return s.append(l),l.setAttribute("href",`#${i}`),l.classList.add("clip"),r}#o(t,i){for(const[s,r]of Object.entries(i))r===null?t.removeAttribute(s):t.setAttribute(s,r)}draw(t,i=!1,s=!1){const r=Re.#i++,l=this.#a(),c=Re._svgFactory.createElement("defs");l.append(c);const u=Re._svgFactory.createElement("path");c.append(u);const h=`path_p${this.pageIndex}_${r}`;u.setAttribute("id",h),u.setAttribute("vector-effect","non-scaling-stroke"),i&&this.#n.set(r,u);const f=s?this.#s(c,h):null,m=Re._svgFactory.createElement("use");return l.append(m),m.setAttribute("href",`#${h}`),this.updateProperties(l,t),this.#e.set(r,l),{id:r,clipPathId:`url(#${f})`}}drawOutline(t,i){const s=Re.#i++,r=this.#a(),l=Re._svgFactory.createElement("defs");r.append(l);const c=Re._svgFactory.createElement("path");l.append(c);const u=`path_p${this.pageIndex}_${s}`;c.setAttribute("id",u),c.setAttribute("vector-effect","non-scaling-stroke");let h;if(i){const y=Re._svgFactory.createElement("mask");l.append(y),h=`mask_p${this.pageIndex}_${s}`,y.setAttribute("id",h),y.setAttribute("maskUnits","objectBoundingBox");const b=Re._svgFactory.createElement("rect");y.append(b),b.setAttribute("width","1"),b.setAttribute("height","1"),b.setAttribute("fill","white");const A=Re._svgFactory.createElement("use");y.append(A),A.setAttribute("href",`#${u}`),A.setAttribute("stroke","none"),A.setAttribute("fill","black"),A.setAttribute("fill-rule","nonzero"),A.classList.add("mask")}const f=Re._svgFactory.createElement("use");r.append(f),f.setAttribute("href",`#${u}`),h&&f.setAttribute("mask",`url(#${h})`);const m=f.cloneNode();return r.append(m),f.classList.add("mainOutline"),m.classList.add("secondaryOutline"),this.updateProperties(r,t),this.#e.set(s,r),s}finalizeDraw(t,i){this.#n.delete(t),this.updateProperties(t,i)}updateProperties(t,i){if(!i)return;const{root:s,bbox:r,rootClass:l,path:c}=i,u=typeof t=="number"?this.#e.get(t):t;if(u){if(s&&this.#o(u,s),r&&Re.#r(u,r),l){const{classList:h}=u;for(const[f,m]of Object.entries(l))h.toggle(f,m)}if(c){const f=u.firstChild.firstChild;this.#o(f,c)}}}updateParent(t,i){if(i===this)return;const s=this.#e.get(t);s&&(i.#t.append(s),this.#e.delete(t),i.#e.set(t,s))}remove(t){this.#n.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#n.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:ph};globalThis.pdfjsLib={AbortException:qn,AnnotationEditorLayer:gn,AnnotationEditorParamsType:Rt,AnnotationEditorType:At,AnnotationEditorUIManager:Vn,AnnotationLayer:Rh,AnnotationMode:In,AnnotationType:me,applyOpacity:bv,build:EA,ColorPicker:_i,createValidAbsoluteUrl:Tm,CSSConstants:yv,DOMSVGFactory:pl,DrawLayer:Re,FeatureTest:Oe,fetchData:Rr,findContrastColor:vv,getDocument:Th,getFilenameFromUrl:hv,getPdfFilenameFromUrl:dv,getRGB:Or,getUuid:Dm,getXfaPageViewport:pv,GlobalWorkerOptions:gs,ImageKind:cl,InvalidPDFException:ah,isDataScheme:vl,isPdfFile:vh,isValidExplicitDest:Dv,MathClamp:Fe,noContextMenu:Ei,normalizeUnicode:lv,OPS:Er,OutputScale:Xi,PasswordResponses:J0,PDFDataRangeTransport:Km,PDFDateString:rh,PDFWorker:Cr,PermissionFlag:W0,PixelsPerInch:Aa,RenderingCancelledException:bh,renderRichText:Om,ResponseException:dl,setLayerDimensions:ms,shadow:wt,SignatureExtractor:da,stopEvent:re,SupportedImageMimeTypes:oh,TextLayer:Ue,TouchManager:Al,updateUrlHash:Cm,Util:st,VerbosityLevel:ml,version:_A,XfaLayer:Nm};const ay="/assets/pdf.worker.min-Cpi8b8z3.mjs";gs.workerSrc=ay;async function QA(g){const t=await g.arrayBuffer(),i=await Th({data:t}).promise;try{const r=(await i.getPage(1)).getViewport({scale:1}),l=r.width,c=r.height,u=l/72,h=c/72,f=xm();return f.push("Vector PDF detected. DPI and scaling are determined at print time; verify artwork before rasterization."),{fileType:"pdf",fileSizeMB:We(g.size/(1024*1024),2),pixels:void 0,dpi:null,hasICC:!1,bitDepth:void 0,hasAlpha:!1,iccProfile:void 0,alphaStats:void 0,imageCategory:"Vector",recommendedSizes:X0(u,h),aspectRatio:Em(l,c),rating:"VectorPDF",notes:f}}finally{i.cleanup(),i.destroy()}}function ZA(g){return`#${g.map(t=>t.toString(16).padStart(2,"0")).join("")}`}function WA(g){const t=new Blob([JSON.stringify(g,null,2)],{type:"application/json"}),i=g.top.length?g.top:g.allGrouped,s=["hex,percent,count"];s.push(...i.map(l=>{const c=typeof l.percent=="number"?l.percent.toFixed(2):"",u=l.count??"";return`${l.hex},${c},${u}`}));const r=new Blob([s.join(`
`)],{type:"text/csv"});return{jsonUrl:URL.createObjectURL(t),csvUrl:URL.createObjectURL(r)}}function ym(g){return g.map(t=>({...t,hex:t.hex.toUpperCase(),percent:typeof t.percent=="number"?Number(t.percent.toFixed(2)):t.percent}))}const JA=1024,tS=12e4,ca=24,eS=32;function iS(g,t){if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(g,t);const i=document.createElement("canvas");return i.width=g,i.height=t,i}async function nS(g){return await new Promise((t,i)=>{const s=new Image;s.crossOrigin="anonymous",s.onload=()=>t(s),s.onerror=r=>i(r),s.src=g})}async function sS(g){const t=URL.createObjectURL(g);try{const i=await nS(t),s=Math.min(1,JA/Math.max(i.width,i.height)),r=Math.max(1,Math.round(i.width*s)),l=Math.max(1,Math.round(i.height*s)),u=iS(r,l).getContext("2d");if(!u)return{top:[],allGrouped:[]};u.drawImage(i,0,0,r,l);const{data:h}=u.getImageData(0,0,r,l),f=Math.max(1,Math.floor(Math.sqrt(r*l/tS))),m=new Map;let y=0,b=0,A=0,w=0,S=255,E=0;for(let O=0;O<l;O+=f)for(let L=0;L<r;L+=f){const P=(O*r+L)*4,q=h[P+3];if(y+=1,q<S&&(S=q),q>E&&(E=q),q===0?b+=1:q===255?w+=1:A+=1,q<eS)continue;const K=h[P],J=h[P+1],W=h[P+2],ht=Math.round(K/ca)*ca,yt=Math.round(J/ca)*ca,bt=Math.round(W/ca)*ca,vt=`${ht}-${yt}-${bt}`,k=m.get(vt)??{r:0,g:0,b:0,count:0};k.r+=K,k.g+=J,k.b+=W,k.count+=1,m.set(vt,k)}const _=Array.from(m.values());if(!_.length)return{top:[],allGrouped:[]};const D=_.reduce((O,L)=>O+L.count,0),T=_.map(O=>{const L=O.count,P=[Math.round(O.r/L),Math.round(O.g/L),Math.round(O.b/L)],q=D>0?L/D*100:void 0;return{rgb:P,hex:ZA(P),percent:q,count:L}}).sort((O,L)=>(L.count??0)-(O.count??0));let B;if(y>0){const O=We(b/y*100,2),L=We(A/y*100,2),P=We(w/y*100,2);B={present:b>0||A>0,min:S,max:E,transparentPercent:O,semiTransparentPercent:L,opaquePercent:P,transparentCount:b,semiTransparentCount:A,opaqueCount:w,sampleSize:y}}return{top:ym(T.slice(0,8)),allGrouped:ym(T),alphaStats:B}}finally{URL.revokeObjectURL(t)}}const aS=new Set(["image/png","image/x-png"]),rS=new Set(["application/pdf"]);function oS(g){const t=g.toLowerCase();return t.endsWith(".png")?"png":t.endsWith(".pdf")?"pdf":null}function lS(g){return aS.has(g.type)?"png":rS.has(g.type)?"pdf":oS(g.name)}async function cS(g){const t=lS(g);if(t==="png"){const[i,s]=await Promise.all([Z0(g),sS(g).catch(()=>null)]);return s?.alphaStats&&(i.alphaStats=s.alphaStats),{quality:i,colors:s??void 0}}if(t==="pdf")return{quality:await QA(g)};throw new Error("Unsupported file type. Please upload a PNG or PDF artwork file.")}gs.workerSrc=ay;async function uS(g){return await new Promise((t,i)=>{const s=new Image;s.onload=()=>t(s),s.onerror=r=>i(r),s.src=g})}async function hS(g,t){const i=URL.createObjectURL(g);try{let s=t.pixels?.w??0,r=t.pixels?.h??0;if(!s||!r){const l=await uS(i);s=l.naturalWidth,r=l.naturalHeight}return{url:i,width:s,height:r,cleanup:()=>URL.revokeObjectURL(i)}}catch(s){throw URL.revokeObjectURL(i),s}}async function dS(g){const t=await g.arrayBuffer(),i=await Th({data:t}).promise;try{const s=await i.getPage(1),r=s.getViewport({scale:1}),l=document.createElement("canvas"),c=l.getContext("2d");return c?(l.width=r.width,l.height=r.height,await s.render({canvas:l,canvasContext:c,viewport:r}).promise,{url:l.toDataURL("image/png"),width:r.width,height:r.height,cleanup:()=>{l.width=0,l.height=0}}):void 0}finally{i.cleanup(),i.destroy()}}async function bm(g,t){if(t.fileType==="png")return hS(g,t);if(t.fileType==="pdf")return dS(g)}const fS=new Set(["image/png","application/pdf"]),vm=[".png",".pdf"],pS=[".svg",".ai",".eps",".psd"],Am=6;function gS(){return typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():Math.random().toString(36).slice(2)}const mS=[{id:"analyze",label:"Analyzer",icon:B0},{id:"admin",label:"Admin",icon:H0}],yS=["md","markdown","txt"],Sm=1024*1024*2,ll=g=>{if(g===0)return"0 B";const t=1024,i=["B","KB","MB","GB"],s=Math.floor(Math.log(g)/Math.log(t)),r=g/Math.pow(t,s);return`${r.toFixed(r>=10||s===0?0:1)} ${i[s]}`};function bS(g){const t=g.toLowerCase().split(".");return t.length<2?!1:yS.includes(t.pop())}function vS(g){return typeof g!="number"||Number.isNaN(g)?"N/A":`${g.toFixed(2)} MB`}function AS(g){const t=new Date(g);return Number.isNaN(t.getTime())?g:t.toLocaleString()}function SS(){const[g,t]=at.useState("analyze"),[i,s]=at.useState(!1),[r,l]=at.useState(null),[c,u]=at.useState(null),[h,f]=at.useState(!1),[m,y]=at.useState(null),[b,A]=at.useState("How ready is this file for DTF printing?"),[w,S]=at.useState(null),[E,_]=at.useState(null),[D,T]=at.useState(!1),[B,O]=at.useState([]),[L,P]=at.useState(null),[q,K]=at.useState(!1),[J,W]=at.useState(null),[ht,yt]=at.useState(""),[bt,vt]=at.useState(!1),[k,V]=at.useState(!1),[tt,pt]=at.useState(null),[xt,R]=at.useState(null),[I,Q]=at.useState(""),[et,ct]=at.useState(!0),[ft,ut]=at.useState([]),[ee,jt]=at.useState(!1),[Li,Ti]=at.useState(!1),[ui,Je]=at.useState(null),[hi,Le]=at.useState(null),[As,ki]=at.useState("info"),Xn=at.useRef(null),[Bi,Yi]=at.useState(null),$i=at.useRef(null),yn=at.useRef(null),xl=at.useMemo(()=>{switch(As){case"success":return"text-emerald-500";case"error":return"text-destructive";default:return"text-muted-foreground"}},[As]);at.useEffect(()=>{if(!r?.colors||r.colors.top.length===0){y(Z=>(Z&&(URL.revokeObjectURL(Z.csvUrl),URL.revokeObjectURL(Z.jsonUrl)),null));return}const F=WA(r.colors);return y(Z=>(Z&&(URL.revokeObjectURL(Z.csvUrl),URL.revokeObjectURL(Z.jsonUrl)),F)),()=>{URL.revokeObjectURL(F.csvUrl),URL.revokeObjectURL(F.jsonUrl)}},[r]),at.useEffect(()=>{A("How ready is this file for DTF printing?"),S(null),_(null)},[r?.fileName]);const ke=at.useCallback(async F=>{f(!0),u(null),P(null),$i.current?.(),$i.current=null;try{const{quality:Z,colors:Ot}=await cS(F);let Lt;try{Lt=await bm(F,Z)}catch(It){console.warn("Failed to generate artwork preview:",It)}return Lt&&($i.current=Lt.cleanup),l({fileName:F.name,quality:Z,colors:Ot,preview:Lt}),{success:!0}}catch(Z){const Ot=Z instanceof Error?Z.message:"Unexpected error analysing artwork.";return u(Ot),l(null),{success:!1,message:Ot}}finally{f(!1)}},[bm]),wa=at.useCallback(F=>{if(!F)return;const Z=Array.from(F),Ot=[],Lt=[];for(const It of Z){const xe=It.name.toLowerCase(),Mi=fS.has(It.type),xs=vm.some(Ur=>xe.endsWith(Ur));Mi||xs?Ot.push({id:gS(),name:It.name,size:It.size,type:It.type,status:"queued",progress:0,file:It}):Lt.push(It.name)}if(Lt.length?P(`Unsupported file type: ${Lt.join(", ")}. Currently only PNG and PDF are supported.`):P(null),!Ot.length){yn.current&&(yn.current.value="");return}O(It=>[...Ot,...It].slice(0,Am)),yn.current&&(yn.current.value="")},[]),xa=at.useCallback(async(F,Z)=>{O(Lt=>Lt.map(It=>It.id===F?{...It,status:"processing",progress:25}:It));const Ot=await ke(Z);Ot.success?O(Lt=>Lt.filter(It=>It.id!==F)):O(Lt=>Lt.map(It=>It.id===F?{...It,status:"error",progress:0,message:Ot.message,file:void 0}:It))},[ke]);at.useEffect(()=>{if(h)return;const F=B.find(Z=>Z.status==="queued"&&Z.file);!F||!F.file||xa(F.id,F.file)},[B,h,xa]);const zr=at.useCallback(F=>{O(Z=>Z.filter(Ot=>Ot.id!==F))},[]),Ss=at.useCallback(()=>{yn.current?.click()},[]),_l=at.useCallback(F=>{F.preventDefault(),F.stopPropagation(),K(!1),F.dataTransfer?.files?.length&&wa(F.dataTransfer.files)},[wa]),Pr=at.useCallback(F=>{F.preventDefault(),F.stopPropagation(),K(!0)},[]),El=at.useCallback(()=>{K(!1)},[]),Tl=at.useCallback(async()=>{if(!r)return;const F=b.trim();if(!F){_("Please enter a question for the assistant.");return}T(!0),_(null);try{const Z=await fetch("/api/ai/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:F,quality:r.quality,colors:r.colors})});if(!Z.ok){const Lt=await Z.text();throw new Error(Lt||`Request failed with status ${Z.status}`)}const Ot=await Z.json();S(Ot.answer)}catch(Z){S(null),_(Z instanceof Error?Z.message:"AI assistant request failed.")}finally{T(!1)}},[r,b]),Yn=at.useCallback(F=>{const Z=F.target.files?.[0]??null;if(Je(null),!Z){Yi(null);return}if(!bS(Z.name)){Yi(null),Le("Only Markdown (.md) or plain text (.txt) files are supported."),ki("error"),F.target.value="";return}if(Z.size>Sm){Yi(null),Le(`Document is too large (${ll(Z.size)}). Maximum allowed is ${ll(Sm)}.`),ki("error"),F.target.value="";return}Yi(Z),Le(`Ready to upload ${Z.name} (${ll(Z.size)}).`),ki("info")},[]),Zt=at.useCallback(async(F,Z)=>{const Ot=new Headers(Z?.headers);return I.trim()&&Ot.set("Authorization",`Bearer ${I.trim()}`),fetch(F,{...Z,headers:Ot})},[I]),Ci=at.useCallback(async()=>{vt(!0),R(null);try{const F=await Zt("/api/config");if(!F.ok){const Ot=await F.text();throw new Error(Ot||`Failed to load config (${F.status})`)}const Z=await F.json();W(Z),yt("")}catch(F){R(F instanceof Error?F.message:"Unable to load configuration.")}finally{vt(!1)}},[Zt]),ue=at.useCallback(async()=>{jt(!0),Le(null);try{const F=await Zt("/api/docs");if(!F.ok){const Ot=await F.text();throw new Error(Ot||`Failed to load documents (${F.status})`)}const Z=await F.json();ut(Z)}catch(F){Le(F instanceof Error?F.message:"Unable to load documents.")}finally{jt(!1)}},[Zt]);at.useEffect(()=>{if(g==="admin"){const F=window.localStorage.getItem("artwork-admin-token");F&&Q(F)}},[g]),at.useEffect(()=>{g==="admin"&&(Ci(),ue())},[g,Ci,ue]);const Cl=at.useCallback(async()=>{if(J){et&&(I.trim()?window.localStorage.setItem("artwork-admin-token",I.trim()):window.localStorage.removeItem("artwork-admin-token")),V(!0),pt(null),R(null);try{const F={provider:J.provider,model:J.model,embeddingModel:J.embeddingModel,systemPrompt:J.systemPrompt};ht.trim()&&(F.apiKey=ht.trim());const Z=await Zt("/api/config",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(F)});if(!Z.ok){const Lt=await Z.text();throw new Error(Lt||`Failed to save configuration (${Z.status})`)}const Ot=await Z.json();W(Ot),yt(""),pt("Configuration saved successfully.")}catch(F){R(F instanceof Error?F.message:"Unable to save configuration.")}finally{V(!1)}}},[J,ht,I,et,Zt]),Ml=at.useCallback(async()=>{if(!Bi){Le("Select a .md or .txt file to upload first."),ki("error");return}Ti(!0),Je(0),Le("Reading document..."),ki("info");try{const F=await new Promise((Lt,It)=>{const xe=new FileReader;xe.onerror=()=>It(xe.error??new Error("Failed to read document.")),xe.onabort=()=>It(new Error("Document read aborted.")),xe.onprogress=Mi=>{if(Mi.lengthComputable){const xs=Math.min(80,Math.round(Mi.loaded/Mi.total*80));Je(xs)}},xe.onload=()=>{Je(Mi=>Mi!==null&&Mi>80?Mi:80),Lt(typeof xe.result=="string"?xe.result:"")},xe.readAsText(Bi)});Le("Uploading to worker..."),ki("info"),Je(Lt=>Lt!==null&&Lt>90?Lt:90);const Z=await Zt("/api/docs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filename:Bi.name,content:F})});if(!Z.ok){const Lt=await Z.text();throw new Error(Lt||`Failed to upload document (${Z.status})`)}const Ot=await Z.json();Je(100),Le(`Uploaded ${Bi.name} (${Ot.chunks} chunks).`),ki("success"),Yi(null),Xn.current&&(Xn.current.value=""),ue()}catch(F){Le(F instanceof Error?F.message:"Document upload failed."),ki("error")}finally{Ti(!1),setTimeout(()=>Je(null),250)}},[Bi,ue,Zt,Xn]),Dl=at.useCallback(async F=>{try{const Z=await Zt(`/api/docs/${encodeURIComponent(F)}`,{method:"DELETE"});if(!Z.ok){const Ot=await Z.text();throw new Error(Ot||`Failed to delete document (${Z.status})`)}Le(`Removed document ${F}.`),ue()}catch(Z){Le(Z instanceof Error?Z.message:"Unable to remove document.")}},[ue,Zt]),ws=at.useMemo(()=>[{value:"claude",label:"Claude (Workers AI)"},{value:"openai",label:"OpenAI (coming soon)",disabled:!0}],[]),ze=r?.quality.alphaStats??r?.colors?.alphaStats??null,ye=r?.preview,ti=at.useMemo(()=>{if(!ye)return null;const F=ye.width&&ye.width>0?ye.width:0,Z=ye.height&&ye.height>0?ye.height:0,Ot=240;if(!F||!Z)return{width:160,height:0,scalePercent:25};const Lt=Math.min(1,Ot/Math.max(F,Z));return{width:Math.round(F*Lt),height:Math.round(Z*Lt),scalePercent:Math.round(Lt*100)}},[ye]);return at.useEffect(()=>()=>{$i.current?.(),$i.current=null},[]),C.jsxs("div",{className:"flex min-h-screen bg-background text-foreground",children:[C.jsxs("aside",{className:`relative flex h-screen flex-col border-r border-border/60 bg-card/80 shadow-sm transition-all duration-300 ${i?"w-16":"w-60"}`,children:[C.jsxs("div",{className:"flex items-center justify-between px-4 py-5",children:[C.jsxs("div",{className:`flex flex-col ${i?"hidden":"gap-1"}`,children:[C.jsx("span",{className:"text-xs font-semibold uppercase tracking-wider text-primary",children:"Artwork Suite"}),C.jsx("span",{className:"text-lg font-semibold",children:"Analyzer AI Agent"})]}),C.jsx("button",{type:"button","aria-label":i?"Expand navigation":"Collapse navigation",onClick:()=>s(F=>!F),className:"inline-flex h-7 w-7 items-center justify-center rounded-md border border-border/60 bg-background text-sm text-muted-foreground transition hover:border-primary hover:text-primary",children:i?">":"<"})]}),C.jsx("nav",{className:"mt-2 flex flex-1 flex-col gap-1 px-2",children:mS.map(F=>{const Z=F.icon,Ot=g===F.id;return C.jsxs("button",{type:"button",onClick:()=>t(F.id),className:`flex items-center gap-3 rounded-md px-3 py-2 text-sm font-medium transition ${Ot?"bg-primary text-primary-foreground shadow":"text-muted-foreground hover:bg-muted/70 hover:text-foreground"} ${i?"justify-center":"justify-start"}`,title:i?F.label:void 0,children:[C.jsx(Z,{className:"h-4 w-4","aria-hidden":"true"}),C.jsx("span",{className:`${i?"sr-only":""}`,children:F.label})]},F.id)})}),C.jsx("div",{className:"px-4 pb-6 text-xs text-muted-foreground",children:i?null:C.jsx("p",{children:"Manage analysis tools and AI settings."})})]}),C.jsx("main",{className:"flex-1 overflow-y-auto",children:C.jsxs("div",{className:"mx-auto flex w-full max-w-5xl flex-col gap-10 px-6 py-12",children:[C.jsxs("header",{className:"flex flex-col gap-3",children:[C.jsx("h1",{className:"text-3xl font-bold tracking-tight sm:text-4xl",children:"Artwork Analyzer AI Agent"}),C.jsx("p",{className:"text-sm text-muted-foreground",children:"Analyse artwork files, review auto-generated reports, and manage AI configuration & knowledge documents."})]}),g==="analyze"?C.jsxs(C.Fragment,{children:[C.jsxs("section",{className:"space-y-6",children:[C.jsxs("div",{className:"rounded-2xl border border-border/70 bg-card/80 p-6 shadow-sm backdrop-blur",children:[C.jsxs("div",{className:"flex flex-col gap-2",children:[C.jsx("h2",{className:"text-2xl font-semibold",children:"Analyse artwork files in the browser"}),C.jsx("p",{className:"max-w-2xl text-sm text-muted-foreground",children:"Upload PNG or PDF artwork to generate a print-readiness report. Support for SVG, AI, EPS, and PSD is coming soon."})]}),L&&C.jsx("p",{className:"mt-3 rounded-md border border-destructive/40 bg-destructive/10 px-3 py-2 text-sm text-destructive",children:L}),C.jsxs("div",{className:"mt-6 grid gap-6 lg:grid-cols-[minmax(0,1fr)_260px]",children:[C.jsxs("div",{onDragOver:Pr,onDragLeave:El,onDrop:_l,className:`flex flex-col items-center justify-center rounded-xl border-2 border-dashed px-6 py-10 text-center transition ${q?"border-primary bg-primary/5":"border-border/70 bg-background/80 hover:border-primary"}`,children:[C.jsx(L0,{className:"h-8 w-8 text-primary","aria-hidden":"true"}),C.jsx("p",{className:"mt-3 text-sm font-medium text-foreground",children:"Drag & drop artwork here"}),C.jsx("p",{className:"text-xs text-muted-foreground",children:"or"}),C.jsx("button",{type:"button",onClick:Ss,disabled:h,className:"mt-3 inline-flex items-center rounded-full bg-primary px-4 py-2 text-sm font-semibold text-primary-foreground shadow transition hover:bg-primary/90 disabled:cursor-not-allowed disabled:opacity-60",children:h?"Processing":"Browse files"}),C.jsxs("p",{className:"mt-4 text-xs text-muted-foreground",children:["Supported now: ",vm.join(", "),". Coming soon: ",pS.join(", "),"."]}),C.jsx("input",{ref:yn,type:"file",accept:".png,.pdf,image/png,application/pdf",multiple:!0,className:"hidden",onChange:F=>wa(F.target.files),disabled:h})]}),B.length>0&&C.jsxs("div",{className:"rounded-xl border border-border/70 bg-background/80 p-4",children:[C.jsxs("div",{className:"flex items-center justify-between",children:[C.jsx("h3",{className:"text-sm font-semibold uppercase tracking-wide text-muted-foreground",children:"Uploaded files"}),C.jsxs("span",{className:"text-xs text-muted-foreground",children:[B.length,"/",Am]})]}),C.jsx("ul",{className:"mt-4 space-y-2",children:B.map(F=>C.jsxs("li",{className:"flex items-start gap-3 rounded-md border border-border/60 bg-background/70 px-3 py-2 text-sm",children:[C.jsx(P0,{className:"mt-1 h-4 w-4 text-muted-foreground","aria-hidden":"true"}),C.jsxs("div",{className:"flex-1",children:[C.jsxs("div",{className:"flex items-center justify-between gap-2",children:[C.jsx("span",{className:"font-medium text-foreground truncate",title:F.name,children:F.name}),C.jsx("span",{className:"text-xs text-muted-foreground",children:ll(F.size)})]}),C.jsxs("div",{className:"mt-1 flex items-center gap-2 text-xs text-muted-foreground",children:[F.status==="processing"?C.jsxs("span",{className:"inline-flex items-center gap-1 text-primary",children:[C.jsx(j0,{className:"h-3 w-3 animate-spin","aria-hidden":"true"}),"Processing"]}):F.status==="queued"?C.jsx("span",{children:"Queued"}):F.status==="complete"?C.jsx("span",{className:"text-emerald-500",children:"Complete"}):C.jsx("span",{className:"text-destructive",children:"Failed"}),F.message&&F.status==="error"&&C.jsxs("span",{className:"text-destructive",children:[" ",F.message]})]}),F.status==="processing"&&C.jsx("div",{className:"mt-2 h-1 w-full overflow-hidden rounded bg-muted",children:C.jsx("div",{className:"h-full bg-primary transition-[width] duration-300",style:{width:`${Math.max(10,Math.min(100,F.progress))}%`}})}),F.status==="queued"&&C.jsx("div",{className:"mt-2 h-1 w-full overflow-hidden rounded bg-muted",children:C.jsx("div",{className:"h-full bg-muted-foreground/40",style:{width:"12%"}})})]}),C.jsx("button",{type:"button",className:"mt-1 inline-flex h-7 w-7 items-center justify-center rounded-md border border-transparent text-muted-foreground transition hover:border-destructive hover:text-destructive disabled:cursor-not-allowed disabled:opacity-40",onClick:()=>zr(F.id),disabled:F.status==="processing","aria-label":`Remove ${F.name}`,children:C.jsx(G0,{className:"h-3.5 w-3.5","aria-hidden":"true"})})]},F.id))})]})]})]}),c&&C.jsx("div",{className:"rounded-lg border border-destructive/30 bg-destructive/10 px-4 py-3 text-sm text-destructive",children:c})]}),r?C.jsxs("section",{className:"grid gap-6 rounded-2xl border border-border/70 bg-card/80 p-6 shadow-sm backdrop-blur",children:[C.jsxs("header",{className:"space-y-1",children:[C.jsx("h3",{className:"text-2xl font-semibold",children:r.fileName}),C.jsxs("p",{className:"text-sm text-muted-foreground",children:[r.quality.fileType.toUpperCase(),"  ",vS(r.quality.fileSizeMB),"  Rating:"," ",C.jsx("span",{className:"font-medium text-primary",children:r.quality.rating})]})]}),ye&&ti&&C.jsxs("div",{className:"rounded-lg border border-border/70 bg-background/80 p-4",children:[C.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-muted-foreground",children:"Artwork preview"}),C.jsx("div",{className:"mt-3 flex justify-center",children:C.jsx("img",{src:ye.url,alt:`Preview of ${r.fileName}`,loading:"lazy",style:{width:`${ti.width}px`,height:ti.height?`${ti.height}px`:"auto"},className:"rounded border border-border/60 bg-muted object-contain shadow-sm"})}),C.jsxs("p",{className:"mt-2 text-xs text-muted-foreground",children:["Displayed at approximately ",ti.scalePercent,"% scale. Original size:"," ",ye.width?`${ye.width}px`:"unknown","  ",ye.height?`${ye.height}px`:"unknown"," px."]})]}),C.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[C.jsxs("div",{className:"rounded-lg border border-border/70 bg-background/80 p-4",children:[C.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-muted-foreground",children:"Dimensions & DPI"}),C.jsxs("dl",{className:"mt-2 space-y-1 text-sm",children:[C.jsxs("div",{className:"flex justify-between",children:[C.jsx("dt",{children:"Category"}),C.jsx("dd",{children:r.quality.imageCategory})]}),C.jsxs("div",{className:"flex justify-between",children:[C.jsx("dt",{children:"Pixels"}),C.jsx("dd",{children:r.quality.pixels?`${r.quality.pixels.w} x ${r.quality.pixels.h}`:"Vector / N/A"})]}),C.jsxs("div",{className:"flex justify-between",children:[C.jsx("dt",{children:"DPI"}),C.jsx("dd",{children:r.quality.dpi??"Not embedded"})]}),C.jsxs("div",{className:"flex justify-between",children:[C.jsx("dt",{children:"Aspect ratio"}),C.jsx("dd",{children:r.quality.aspectRatio})]}),C.jsxs("div",{className:"flex justify-between",children:[C.jsx("dt",{children:"Bit depth"}),C.jsx("dd",{children:r.quality.bitDepth??"N/A"})]}),C.jsxs("div",{className:"flex justify-between",children:[C.jsx("dt",{children:"Alpha channel"}),C.jsx("dd",{children:r.quality.hasAlpha?"Yes":"No"})]})]})]}),C.jsxs("div",{className:"rounded-lg border border-border/70 bg-background/80 p-4",children:[C.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-muted-foreground",children:"Recommended print sizes"}),C.jsxs("dl",{className:"mt-2 space-y-1 text-sm",children:[C.jsxs("div",{className:"flex justify-between",children:[C.jsx("dt",{children:"300 DPI"}),C.jsxs("dd",{children:[`${r.quality.recommendedSizes.at300dpi.w_in}"  ${r.quality.recommendedSizes.at300dpi.h_in}"`,C.jsx("span",{className:"text-xs text-muted-foreground",children:` (${r.quality.recommendedSizes.at300dpi.w_cm}  ${r.quality.recommendedSizes.at300dpi.h_cm} cm)`})]})]}),C.jsxs("div",{className:"flex justify-between",children:[C.jsx("dt",{children:"150 DPI"}),C.jsxs("dd",{children:[`${r.quality.recommendedSizes.at150dpi.w_in}"  ${r.quality.recommendedSizes.at150dpi.h_in}"`,C.jsx("span",{className:"text-xs text-muted-foreground",children:` (${r.quality.recommendedSizes.at150dpi.w_cm}  ${r.quality.recommendedSizes.at150dpi.h_cm} cm)`})]})]}),C.jsxs("div",{className:"flex justify-between",children:[C.jsx("dt",{children:"ICC profile"}),C.jsx("dd",{children:r.quality.hasICC?r.quality.iccProfile??"Embedded":"Not embedded"})]})]})]})]}),ze&&C.jsxs("div",{className:"rounded-lg border border-border/70 bg-background/80 p-4",children:[C.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-muted-foreground",children:"Alpha channel details"}),C.jsxs("dl",{className:"mt-2 grid gap-2 text-sm sm:grid-cols-3",children:[C.jsxs("div",{className:"flex justify-between",children:[C.jsx("dt",{children:"Sample size"}),C.jsx("dd",{children:ze.sampleSize.toLocaleString()})]}),C.jsxs("div",{className:"flex justify-between",children:[C.jsx("dt",{children:"Minimum value"}),C.jsx("dd",{children:ze.min})]}),C.jsxs("div",{className:"flex justify-between",children:[C.jsx("dt",{children:"Maximum value"}),C.jsx("dd",{children:ze.max})]})]}),C.jsx("div",{className:"mt-3 overflow-x-auto",children:C.jsxs("table",{className:"min-w-full divide-y divide-border/60 text-sm",children:[C.jsx("thead",{className:"bg-muted/20 text-left text-xs uppercase tracking-wide text-muted-foreground",children:C.jsxs("tr",{children:[C.jsx("th",{className:"px-3 py-2",children:"Alpha range"}),C.jsx("th",{className:"px-3 py-2",children:"Transparency"}),C.jsx("th",{className:"px-3 py-2 text-right",children:"Pixels"}),C.jsx("th",{className:"px-3 py-2 text-right",children:"Percent"})]})}),C.jsxs("tbody",{className:"divide-y divide-border/60",children:[C.jsxs("tr",{children:[C.jsx("td",{className:"px-3 py-2 font-medium text-foreground",children:"0"}),C.jsx("td",{className:"px-3 py-2",children:"Fully transparent"}),C.jsx("td",{className:"px-3 py-2 text-right",children:ze.transparentCount.toLocaleString()}),C.jsxs("td",{className:"px-3 py-2 text-right",children:[ze.transparentPercent.toFixed(2),"%"]})]}),C.jsxs("tr",{children:[C.jsx("td",{className:"px-3 py-2 font-medium text-foreground",children:"1-254"}),C.jsx("td",{className:"px-3 py-2",children:"Semi transparent"}),C.jsx("td",{className:"px-3 py-2 text-right",children:ze.semiTransparentCount.toLocaleString()}),C.jsxs("td",{className:"px-3 py-2 text-right",children:[ze.semiTransparentPercent.toFixed(2),"%"]})]}),C.jsxs("tr",{children:[C.jsx("td",{className:"px-3 py-2 font-medium text-foreground",children:"255"}),C.jsx("td",{className:"px-3 py-2",children:"Fully opaque"}),C.jsx("td",{className:"px-3 py-2 text-right",children:ze.opaqueCount.toLocaleString()}),C.jsxs("td",{className:"px-3 py-2 text-right",children:[ze.opaquePercent.toFixed(2),"%"]})]})]})]})})]}),r.colors&&r.colors.top.length>0&&C.jsxs("div",{className:"rounded-lg border border-border/70 bg-background/80 p-4",children:[C.jsxs("div",{className:"flex items-center justify-between",children:[C.jsxs("div",{children:[C.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-muted-foreground",children:"Palette overview"}),C.jsx("p",{className:"text-xs text-muted-foreground",children:"Dominant colours detected across the artwork; exported alongside the AI prompt."})]}),m&&C.jsxs("div",{className:"flex gap-2 text-xs",children:[C.jsx("a",{href:m.csvUrl,download:`${r.fileName}-palette.csv`,className:"rounded-md border border-border/70 bg-background px-2 py-1 font-medium text-foreground transition hover:border-primary",children:"Download CSV"}),C.jsx("a",{href:m.jsonUrl,download:`${r.fileName}-palette.json`,className:"rounded-md border border-border/70 bg-background px-2 py-1 font-medium text-foreground transition hover:border-primary",children:"Download JSON"})]})]}),C.jsx("div",{className:"mt-4 grid gap-3 sm:grid-cols-2 lg:grid-cols-4",children:r.colors.top.map(F=>C.jsxs("div",{className:"flex flex-col overflow-hidden rounded-lg border border-border/60 bg-background/90",children:[C.jsx("div",{className:"h-20 w-full",style:{backgroundColor:F.hex},"aria-hidden":"true"}),C.jsxs("div",{className:"flex flex-col gap-1 px-3 py-2 text-xs text-muted-foreground",children:[C.jsx("span",{className:"font-medium text-foreground",children:F.hex}),typeof F.percent=="number"&&C.jsxs("span",{children:[F.percent.toFixed(2),"% of sampled pixels"]}),typeof F.count=="number"&&F.count>0&&C.jsxs("span",{children:[F.count," samples"]}),C.jsxs("span",{children:["RGB ",`(${F.rgb[0]}, ${F.rgb[1]}, ${F.rgb[2]})`]})]})]},F.hex))})]}),C.jsxs("div",{className:"rounded-lg border border-border/70 bg-background/80 p-4",children:[C.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-muted-foreground",children:"Notes"}),C.jsx("ul",{className:"mt-2 list-disc space-y-1 pl-5 text-sm text-muted-foreground",children:r.quality.notes.map(F=>C.jsx("li",{children:F},F))})]}),C.jsxs("div",{className:"rounded-lg border border-border/70 bg-background/80 p-4",children:[C.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-muted-foreground",children:"Ask the AI assistant"}),C.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"The assistant uses the analysis summary and any uploaded knowledge-base documents to answer."}),C.jsxs("div",{className:"mt-3 space-y-3",children:[C.jsx("textarea",{value:b,onChange:F=>A(F.target.value),rows:3,className:"w-full resize-y rounded-lg border border-border/70 bg-background px-3 py-2 text-sm text-foreground shadow-sm focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30",placeholder:"Ask something about print readiness, colour accuracy, or file preparation...",disabled:D}),C.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[C.jsx("button",{type:"button",onClick:()=>void Tl(),disabled:D||!b.trim(),className:"inline-flex items-center rounded-lg bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow transition hover:bg-primary/90 disabled:cursor-not-allowed disabled:opacity-60",children:D?"Thinking":"Send to assistant"}),E&&C.jsx("span",{className:"text-sm text-destructive",role:"alert",children:E})]}),w&&C.jsx("div",{className:"rounded-md border border-border/60 bg-muted/30 p-3 text-sm leading-relaxed text-muted-foreground",children:w})]})]})]}):C.jsxs("section",{className:"rounded-2xl border border-dashed border-border/60 bg-card/60 p-8 text-center backdrop-blur",children:[C.jsx("h3",{className:"text-xl font-semibold text-foreground",children:"Awaiting your first upload"}),C.jsx("p",{className:"mt-3 text-sm text-muted-foreground",children:"Use the upload panel above to drop a PNG or PDF and generate your initial analysis report."})]})]}):C.jsxs("section",{className:"grid gap-6 rounded-2xl border border-border/70 bg-card/80 p-6 shadow-sm backdrop-blur",children:[C.jsxs("header",{className:"space-y-1",children:[C.jsx("h3",{className:"text-2xl font-semibold",children:"Admin configuration"}),C.jsx("p",{className:"text-sm text-muted-foreground",children:"Update AI provider settings and manage RAG documents. API keys are stored encrypted in KV; leave the field blank to keep the current key unchanged."})]}),C.jsx("div",{className:"grid gap-6 rounded-lg border border-border/70 bg-background/80 p-4",children:bt?C.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading configuration..."}):J?C.jsxs("div",{className:"grid gap-4",children:[C.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[C.jsx("span",{className:"font-medium text-foreground",children:"Admin token"}),C.jsx("input",{className:"rounded-md border border-border/60 bg-background px-3 py-2 text-sm",value:I,onChange:F=>{Q(F.target.value),et&&(F.target.value.trim()?window.localStorage.setItem("artwork-admin-token",F.target.value.trim()):window.localStorage.removeItem("artwork-admin-token"))},placeholder:"Enter admin token to access secured endpoints",type:"password"}),C.jsxs("label",{className:"mt-1 inline-flex items-center gap-2 text-xs text-muted-foreground",children:[C.jsx("input",{type:"checkbox",checked:et,onChange:F=>{ct(F.target.checked),F.target.checked?I.trim()&&window.localStorage.setItem("artwork-admin-token",I.trim()):window.localStorage.removeItem("artwork-admin-token")}}),"Remember token in this browser"]})]}),C.jsxs("div",{className:"grid gap-2 sm:grid-cols-2",children:[C.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[C.jsx("span",{className:"font-medium text-foreground",children:"Provider"}),C.jsx("select",{className:"rounded-md border border-border/60 bg-background px-3 py-2 text-sm",value:J.provider,onChange:F=>W(Z=>Z&&{...Z,provider:F.target.value}),children:ws.map(F=>C.jsx("option",{value:F.value,disabled:F.disabled,children:F.label},F.value))})]}),C.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[C.jsx("span",{className:"font-medium text-foreground",children:"Chat model"}),C.jsx("input",{className:"rounded-md border border-border/60 bg-background px-3 py-2 text-sm",value:J.model,onChange:F=>W(Z=>Z&&{...Z,model:F.target.value})})]}),C.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[C.jsx("span",{className:"font-medium text-foreground",children:"Embedding model"}),C.jsx("input",{className:"rounded-md border border-border/60 bg-background px-3 py-2 text-sm",value:J.embeddingModel,onChange:F=>W(Z=>Z&&{...Z,embeddingModel:F.target.value})})]}),C.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[C.jsx("span",{className:"font-medium text-foreground",children:"API key"}),C.jsx("input",{className:"rounded-md border border-border/60 bg-background px-3 py-2 text-sm",value:ht,onChange:F=>yt(F.target.value),placeholder:J.apiKey?"Current key hidden - enter to replace":"Enter provider API key",type:"password"})]})]}),C.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[C.jsx("span",{className:"font-medium text-foreground",children:"System prompt"}),C.jsx("textarea",{className:"min-h-[120px] rounded-md border border-border/60 bg-background px-3 py-2 text-sm",value:J.systemPrompt,onChange:F=>W(Z=>Z&&{...Z,systemPrompt:F.target.value})})]}),C.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[C.jsx("button",{type:"button",onClick:()=>void Cl(),disabled:k,className:"inline-flex items-center rounded-lg bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow transition hover:bg-primary/90 disabled:cursor-not-allowed disabled:opacity-60",children:k?"Saving...":"Save configuration"}),tt&&C.jsx("span",{className:"text-sm text-muted-foreground",children:tt}),xt&&C.jsx("span",{className:"text-sm text-destructive",role:"alert",children:xt})]})]}):C.jsx("p",{className:"text-sm text-destructive",role:"alert",children:xt??"No configuration loaded."})}),C.jsxs("div",{className:"grid gap-4 rounded-lg border border-border/70 bg-background/80 p-4",children:[C.jsxs("div",{className:"flex items-center justify-between",children:[C.jsxs("div",{children:[C.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-muted-foreground",children:"Knowledge-base documents"}),C.jsx("p",{className:"text-xs text-muted-foreground",children:"Upload Markdown or plain text files; they will be chunked, embedded, and added to the RAG store."})]}),C.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[C.jsx("input",{ref:Xn,type:"file",accept:".txt,.md,.markdown,.TXT,.MD,.MARKDOWN",onChange:Yn,className:"text-xs text-muted-foreground"}),C.jsx("button",{type:"button",onClick:()=>void Ml(),disabled:Li||!Bi,className:"inline-flex items-center rounded-md border border-border/60 bg-background px-3 py-1 text-xs font-medium transition hover:border-primary disabled:cursor-not-allowed disabled:opacity-60",children:Li?`Uploading${ui!==null?` ${ui}%`:"..."}`:"Upload"})]}),ui!==null&&C.jsx("div",{className:"h-2 w-full overflow-hidden rounded bg-muted",children:C.jsx("div",{className:"h-full bg-primary transition-[width] duration-200",style:{width:`${Math.max(0,Math.min(100,ui))}%`}})})]}),hi&&C.jsx("span",{className:`text-xs ${xl}`,children:hi}),C.jsx("div",{className:"overflow-hidden rounded-lg border border-border/70",children:C.jsxs("table",{className:"min-w-full divide-y divide-border/70 text-sm",children:[C.jsx("thead",{className:"bg-muted/30",children:C.jsxs("tr",{children:[C.jsx("th",{className:"px-3 py-2 text-left font-medium text-muted-foreground",children:"Document"}),C.jsx("th",{className:"px-3 py-2 text-left font-medium text-muted-foreground",children:"Chunks"}),C.jsx("th",{className:"px-3 py-2 text-left font-medium text-muted-foreground",children:"Updated"}),C.jsx("th",{className:"px-3 py-2 text-right font-medium text-muted-foreground",children:"Actions"})]})}),C.jsx("tbody",{className:"divide-y divide-border/70 bg-background/60",children:ee?C.jsx("tr",{children:C.jsx("td",{colSpan:4,className:"px-3 py-4 text-center text-muted-foreground",children:"Loading documents..."})}):ft.length?ft.map(F=>C.jsxs("tr",{children:[C.jsx("td",{className:"px-3 py-2 font-medium text-foreground",children:F.source}),C.jsx("td",{className:"px-3 py-2 text-muted-foreground",children:F.chunks}),C.jsx("td",{className:"px-3 py-2 text-muted-foreground",children:AS(F.updated_at)}),C.jsx("td",{className:"px-3 py-2 text-right",children:C.jsx("button",{type:"button",onClick:()=>void Dl(F.source),className:"rounded-md border border-border/60 px-2 py-1 text-xs text-destructive transition hover:border-destructive",children:"Remove"})})]},F.source)):C.jsx("tr",{children:C.jsx("td",{colSpan:4,className:"px-3 py-4 text-center text-muted-foreground",children:"No documents uploaded yet."})})})]})})]})]})]})})]})}T0.createRoot(document.getElementById("root")).render(C.jsx(at.StrictMode,{children:C.jsx(SS,{})}));
