var wp=m=>{throw TypeError(m)};var Nu=(m,t,i)=>t.has(m)||wp("Cannot "+i);var Qt=(m,t,i)=>(Nu(m,t,"read from private field"),i?i.call(m):t.get(m)),Pi=(m,t,i)=>t.has(m)?wp("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(m):t.set(m,i),$e=(m,t,i,s)=>(Nu(m,t,"write to private field"),s?s.call(m,i):t.set(m,i),i),Ui=(m,t,i)=>(Nu(m,t,"access private method"),i);var _p=(m,t,i,s)=>({set _(r){$e(m,t,r,i)},get _(){return Qt(m,t,s)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function i(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(r){if(r.ep)return;r.ep=!0;const l=i(r);fetch(r.href,l)}})();var Ou={exports:{}},sr={};var xp;function h0(){if(xp)return sr;xp=1;var m=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function i(s,r,l){var c=null;if(l!==void 0&&(c=""+l),r.key!==void 0&&(c=""+r.key),"key"in r){l={};for(var u in r)u!=="key"&&(l[u]=r[u])}else l=r;return r=l.ref,{$$typeof:m,type:s,key:c,ref:r!==void 0?r:null,props:l}}return sr.Fragment=t,sr.jsx=i,sr.jsxs=i,sr}var Ep;function d0(){return Ep||(Ep=1,Ou.exports=h0()),Ou.exports}var D=d0(),Lu={exports:{}},yt={};var Tp;function f0(){if(Tp)return yt;Tp=1;var m=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),b=Symbol.iterator;function A(R){return R===null||typeof R!="object"?null:(R=b&&R[b]||R["@@iterator"],typeof R=="function"?R:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,E={};function x(R,I,K){this.props=R,this.context=I,this.refs=E,this.updater=K||w}x.prototype.isReactComponent={},x.prototype.setState=function(R,I){if(typeof R!="object"&&typeof R!="function"&&R!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,R,I,"setState")},x.prototype.forceUpdate=function(R){this.updater.enqueueForceUpdate(this,R,"forceUpdate")};function C(){}C.prototype=x.prototype;function T(R,I,K){this.props=R,this.context=I,this.refs=E,this.updater=K||w}var B=T.prototype=new C;B.constructor=T,S(B,x.prototype),B.isPureReactComponent=!0;var O=Array.isArray;function L(){}var P={H:null,A:null,T:null,S:null},G=Object.prototype.hasOwnProperty;function Q(R,I,K){var et=K.ref;return{$$typeof:m,type:R,key:I,ref:et!==void 0?et:null,props:K}}function tt(R,I){return Q(R.type,I,R.props)}function W(R){return typeof R=="object"&&R!==null&&R.$$typeof===m}function ut(R){var I={"=":"=0",":":"=2"};return"$"+R.replace(/[=:]/g,function(K){return I[K]})}var mt=/\/+/g;function ht(R,I){return typeof R=="object"&&R!==null&&R.key!=null?ut(""+R.key):I.toString(36)}function vt(R){switch(R.status){case"fulfilled":return R.value;case"rejected":throw R.reason;default:switch(typeof R.status=="string"?R.then(L,L):(R.status="pending",R.then(function(I){R.status==="pending"&&(R.status="fulfilled",R.value=I)},function(I){R.status==="pending"&&(R.status="rejected",R.reason=I)})),R.status){case"fulfilled":return R.value;case"rejected":throw R.reason}}throw R}function k(R,I,K,et,ot){var ft=typeof R;(ft==="undefined"||ft==="boolean")&&(R=null);var at=!1;if(R===null)at=!0;else switch(ft){case"bigint":case"string":case"number":at=!0;break;case"object":switch(R.$$typeof){case m:case t:at=!0;break;case p:return at=R._init,k(at(R._payload),I,K,et,ot)}}if(at)return ot=ot(R),at=et===""?"."+ht(R,0):et,O(ot)?(K="",at!=null&&(K=at.replace(mt,"$&/")+"/"),k(ot,I,K,"",function(ci){return ci})):ot!=null&&(W(ot)&&(ot=tt(ot,K+(ot.key==null||R&&R.key===ot.key?"":(""+ot.key).replace(mt,"$&/")+"/")+at)),I.push(ot)),1;at=0;var $t=et===""?".":et+":";if(O(R))for(var Ct=0;Ct<R.length;Ct++)et=R[Ct],ft=$t+ht(et,Ct),at+=k(et,I,K,ft,ot);else if(Ct=A(R),typeof Ct=="function")for(R=Ct.call(R),Ct=0;!(et=R.next()).done;)et=et.value,ft=$t+ht(et,Ct++),at+=k(et,I,K,ft,ot);else if(ft==="object"){if(typeof R.then=="function")return k(vt(R),I,K,et,ot);throw I=String(R),Error("Objects are not valid as a React child (found: "+(I==="[object Object]"?"object with keys {"+Object.keys(R).join(", ")+"}":I)+"). If you meant to render a collection of children, use an array instead.")}return at}function q(R,I,K){if(R==null)return R;var et=[],ot=0;return k(R,et,"","",function(ft){return I.call(K,ft,ot++)}),et}function Z(R){if(R._status===-1){var I=R._result;I=I(),I.then(function(K){(R._status===0||R._status===-1)&&(R._status=1,R._result=K)},function(K){(R._status===0||R._status===-1)&&(R._status=2,R._result=K)}),R._status===-1&&(R._status=0,R._result=I)}if(R._status===1)return R._result.default;throw R._result}var gt=typeof reportError=="function"?reportError:function(R){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var I=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof R=="object"&&R!==null&&typeof R.message=="string"?String(R.message):String(R),error:R});if(!window.dispatchEvent(I))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",R);return}console.error(R)},xt={map:q,forEach:function(R,I,K){q(R,function(){I.apply(this,arguments)},K)},count:function(R){var I=0;return q(R,function(){I++}),I},toArray:function(R){return q(R,function(I){return I})||[]},only:function(R){if(!W(R))throw Error("React.Children.only expected to receive a single React element child.");return R}};return yt.Activity=y,yt.Children=xt,yt.Component=x,yt.Fragment=i,yt.Profiler=r,yt.PureComponent=T,yt.StrictMode=s,yt.Suspense=h,yt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=P,yt.__COMPILER_RUNTIME={__proto__:null,c:function(R){return P.H.useMemoCache(R)}},yt.cache=function(R){return function(){return R.apply(null,arguments)}},yt.cacheSignal=function(){return null},yt.cloneElement=function(R,I,K){if(R==null)throw Error("The argument must be a React element, but you passed "+R+".");var et=S({},R.props),ot=R.key;if(I!=null)for(ft in I.key!==void 0&&(ot=""+I.key),I)!G.call(I,ft)||ft==="key"||ft==="__self"||ft==="__source"||ft==="ref"&&I.ref===void 0||(et[ft]=I[ft]);var ft=arguments.length-2;if(ft===1)et.children=K;else if(1<ft){for(var at=Array(ft),$t=0;$t<ft;$t++)at[$t]=arguments[$t+2];et.children=at}return Q(R.type,ot,et)},yt.createContext=function(R){return R={$$typeof:c,_currentValue:R,_currentValue2:R,_threadCount:0,Provider:null,Consumer:null},R.Provider=R,R.Consumer={$$typeof:l,_context:R},R},yt.createElement=function(R,I,K){var et,ot={},ft=null;if(I!=null)for(et in I.key!==void 0&&(ft=""+I.key),I)G.call(I,et)&&et!=="key"&&et!=="__self"&&et!=="__source"&&(ot[et]=I[et]);var at=arguments.length-2;if(at===1)ot.children=K;else if(1<at){for(var $t=Array(at),Ct=0;Ct<at;Ct++)$t[Ct]=arguments[Ct+2];ot.children=$t}if(R&&R.defaultProps)for(et in at=R.defaultProps,at)ot[et]===void 0&&(ot[et]=at[et]);return Q(R,ft,ot)},yt.createRef=function(){return{current:null}},yt.forwardRef=function(R){return{$$typeof:u,render:R}},yt.isValidElement=W,yt.lazy=function(R){return{$$typeof:p,_payload:{_status:-1,_result:R},_init:Z}},yt.memo=function(R,I){return{$$typeof:f,type:R,compare:I===void 0?null:I}},yt.startTransition=function(R){var I=P.T,K={};P.T=K;try{var et=R(),ot=P.S;ot!==null&&ot(K,et),typeof et=="object"&&et!==null&&typeof et.then=="function"&&et.then(L,gt)}catch(ft){gt(ft)}finally{I!==null&&K.types!==null&&(I.types=K.types),P.T=I}},yt.unstable_useCacheRefresh=function(){return P.H.useCacheRefresh()},yt.use=function(R){return P.H.use(R)},yt.useActionState=function(R,I,K){return P.H.useActionState(R,I,K)},yt.useCallback=function(R,I){return P.H.useCallback(R,I)},yt.useContext=function(R){return P.H.useContext(R)},yt.useDebugValue=function(){},yt.useDeferredValue=function(R,I){return P.H.useDeferredValue(R,I)},yt.useEffect=function(R,I){return P.H.useEffect(R,I)},yt.useEffectEvent=function(R){return P.H.useEffectEvent(R)},yt.useId=function(){return P.H.useId()},yt.useImperativeHandle=function(R,I,K){return P.H.useImperativeHandle(R,I,K)},yt.useInsertionEffect=function(R,I){return P.H.useInsertionEffect(R,I)},yt.useLayoutEffect=function(R,I){return P.H.useLayoutEffect(R,I)},yt.useMemo=function(R,I){return P.H.useMemo(R,I)},yt.useOptimistic=function(R,I){return P.H.useOptimistic(R,I)},yt.useReducer=function(R,I,K){return P.H.useReducer(R,I,K)},yt.useRef=function(R){return P.H.useRef(R)},yt.useState=function(R){return P.H.useState(R)},yt.useSyncExternalStore=function(R,I,K){return P.H.useSyncExternalStore(R,I,K)},yt.useTransition=function(){return P.H.useTransition()},yt.version="19.2.0",yt}var Cp;function lh(){return Cp||(Cp=1,Lu.exports=f0()),Lu.exports}var pt=lh(),ku={exports:{}},ar={},Bu={exports:{}},zu={};var Mp;function g0(){return Mp||(Mp=1,(function(m){function t(k,q){var Z=k.length;k.push(q);t:for(;0<Z;){var gt=Z-1>>>1,xt=k[gt];if(0<r(xt,q))k[gt]=q,k[Z]=xt,Z=gt;else break t}}function i(k){return k.length===0?null:k[0]}function s(k){if(k.length===0)return null;var q=k[0],Z=k.pop();if(Z!==q){k[0]=Z;t:for(var gt=0,xt=k.length,R=xt>>>1;gt<R;){var I=2*(gt+1)-1,K=k[I],et=I+1,ot=k[et];if(0>r(K,Z))et<xt&&0>r(ot,K)?(k[gt]=ot,k[et]=Z,gt=et):(k[gt]=K,k[I]=Z,gt=I);else if(et<xt&&0>r(ot,Z))k[gt]=ot,k[et]=Z,gt=et;else break t}}return q}function r(k,q){var Z=k.sortIndex-q.sortIndex;return Z!==0?Z:k.id-q.id}if(m.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;m.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();m.unstable_now=function(){return c.now()-u}}var h=[],f=[],p=1,y=null,b=3,A=!1,w=!1,S=!1,E=!1,x=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function B(k){for(var q=i(f);q!==null;){if(q.callback===null)s(f);else if(q.startTime<=k)s(f),q.sortIndex=q.expirationTime,t(h,q);else break;q=i(f)}}function O(k){if(S=!1,B(k),!w)if(i(h)!==null)w=!0,L||(L=!0,ut());else{var q=i(f);q!==null&&vt(O,q.startTime-k)}}var L=!1,P=-1,G=5,Q=-1;function tt(){return E?!0:!(m.unstable_now()-Q<G)}function W(){if(E=!1,L){var k=m.unstable_now();Q=k;var q=!0;try{t:{w=!1,S&&(S=!1,C(P),P=-1),A=!0;var Z=b;try{e:{for(B(k),y=i(h);y!==null&&!(y.expirationTime>k&&tt());){var gt=y.callback;if(typeof gt=="function"){y.callback=null,b=y.priorityLevel;var xt=gt(y.expirationTime<=k);if(k=m.unstable_now(),typeof xt=="function"){y.callback=xt,B(k),q=!0;break e}y===i(h)&&s(h),B(k)}else s(h);y=i(h)}if(y!==null)q=!0;else{var R=i(f);R!==null&&vt(O,R.startTime-k),q=!1}}break t}finally{y=null,b=Z,A=!1}q=void 0}}finally{q?ut():L=!1}}}var ut;if(typeof T=="function")ut=function(){T(W)};else if(typeof MessageChannel<"u"){var mt=new MessageChannel,ht=mt.port2;mt.port1.onmessage=W,ut=function(){ht.postMessage(null)}}else ut=function(){x(W,0)};function vt(k,q){P=x(function(){k(m.unstable_now())},q)}m.unstable_IdlePriority=5,m.unstable_ImmediatePriority=1,m.unstable_LowPriority=4,m.unstable_NormalPriority=3,m.unstable_Profiling=null,m.unstable_UserBlockingPriority=2,m.unstable_cancelCallback=function(k){k.callback=null},m.unstable_forceFrameRate=function(k){0>k||125<k?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<k?Math.floor(1e3/k):5},m.unstable_getCurrentPriorityLevel=function(){return b},m.unstable_next=function(k){switch(b){case 1:case 2:case 3:var q=3;break;default:q=b}var Z=b;b=q;try{return k()}finally{b=Z}},m.unstable_requestPaint=function(){E=!0},m.unstable_runWithPriority=function(k,q){switch(k){case 1:case 2:case 3:case 4:case 5:break;default:k=3}var Z=b;b=k;try{return q()}finally{b=Z}},m.unstable_scheduleCallback=function(k,q,Z){var gt=m.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?gt+Z:gt):Z=gt,k){case 1:var xt=-1;break;case 2:xt=250;break;case 5:xt=1073741823;break;case 4:xt=1e4;break;default:xt=5e3}return xt=Z+xt,k={id:p++,callback:q,priorityLevel:k,startTime:Z,expirationTime:xt,sortIndex:-1},Z>gt?(k.sortIndex=Z,t(f,k),i(h)===null&&k===i(f)&&(S?(C(P),P=-1):S=!0,vt(O,Z-gt))):(k.sortIndex=xt,t(h,k),w||A||(w=!0,L||(L=!0,ut()))),k},m.unstable_shouldYield=tt,m.unstable_wrapCallback=function(k){var q=b;return function(){var Z=b;b=q;try{return k.apply(this,arguments)}finally{b=Z}}}})(zu)),zu}var Dp;function p0(){return Dp||(Dp=1,Bu.exports=g0()),Bu.exports}var Pu={exports:{}},Ne={};var Rp;function m0(){if(Rp)return Ne;Rp=1;var m=lh();function t(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var s={d:{f:i,r:function(){throw Error(t(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},r=Symbol.for("react.portal");function l(h,f,p){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:y==null?null:""+y,children:h,containerInfo:f,implementation:p}}var c=m.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Ne.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Ne.createPortal=function(h,f){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return l(h,f,null,p)},Ne.flushSync=function(h){var f=c.T,p=s.p;try{if(c.T=null,s.p=2,h)return h()}finally{c.T=f,s.p=p,s.d.f()}},Ne.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,s.d.C(h,f))},Ne.prefetchDNS=function(h){typeof h=="string"&&s.d.D(h)},Ne.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var p=f.as,y=u(p,f.crossOrigin),b=typeof f.integrity=="string"?f.integrity:void 0,A=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;p==="style"?s.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:y,integrity:b,fetchPriority:A}):p==="script"&&s.d.X(h,{crossOrigin:y,integrity:b,fetchPriority:A,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Ne.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var p=u(f.as,f.crossOrigin);s.d.M(h,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&s.d.M(h)},Ne.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var p=f.as,y=u(p,f.crossOrigin);s.d.L(h,p,{crossOrigin:y,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Ne.preloadModule=function(h,f){if(typeof h=="string")if(f){var p=u(f.as,f.crossOrigin);s.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else s.d.m(h)},Ne.requestFormReset=function(h){s.d.r(h)},Ne.unstable_batchedUpdates=function(h,f){return h(f)},Ne.useFormState=function(h,f,p){return c.H.useFormState(h,f,p)},Ne.useFormStatus=function(){return c.H.useHostTransitionStatus()},Ne.version="19.2.0",Ne}var Np;function y0(){if(Np)return Pu.exports;Np=1;function m(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(m)}catch(t){console.error(t)}}return m(),Pu.exports=m0(),Pu.exports}var Op;function b0(){if(Op)return ar;Op=1;var m=p0(),t=lh(),i=y0();function s(e){var n="https://react.dev/errors/"+e;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)n+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function l(e){var n=e,a=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(a=n.return),e=n.return;while(e)}return n.tag===3?a:null}function c(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function u(e){if(e.tag===31){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function h(e){if(l(e)!==e)throw Error(s(188))}function f(e){var n=e.alternate;if(!n){if(n=l(e),n===null)throw Error(s(188));return n!==e?null:e}for(var a=e,o=n;;){var d=a.return;if(d===null)break;var g=d.alternate;if(g===null){if(o=d.return,o!==null){a=o;continue}break}if(d.child===g.child){for(g=d.child;g;){if(g===a)return h(d),e;if(g===o)return h(d),n;g=g.sibling}throw Error(s(188))}if(a.return!==o.return)a=d,o=g;else{for(var v=!1,_=d.child;_;){if(_===a){v=!0,a=d,o=g;break}if(_===o){v=!0,o=d,a=g;break}_=_.sibling}if(!v){for(_=g.child;_;){if(_===a){v=!0,a=g,o=d;break}if(_===o){v=!0,o=g,a=d;break}_=_.sibling}if(!v)throw Error(s(189))}}if(a.alternate!==o)throw Error(s(190))}if(a.tag!==3)throw Error(s(188));return a.stateNode.current===a?e:n}function p(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e;for(e=e.child;e!==null;){if(n=p(e),n!==null)return n;e=e.sibling}return null}var y=Object.assign,b=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),T=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),Q=Symbol.for("react.activity"),tt=Symbol.for("react.memo_cache_sentinel"),W=Symbol.iterator;function ut(e){return e===null||typeof e!="object"?null:(e=W&&e[W]||e["@@iterator"],typeof e=="function"?e:null)}var mt=Symbol.for("react.client.reference");function ht(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===mt?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case S:return"Fragment";case x:return"Profiler";case E:return"StrictMode";case O:return"Suspense";case L:return"SuspenseList";case Q:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case w:return"Portal";case T:return e.displayName||"Context";case C:return(e._context.displayName||"Context")+".Consumer";case B:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case P:return n=e.displayName||null,n!==null?n:ht(e.type)||"Memo";case G:n=e._payload,e=e._init;try{return ht(e(n))}catch{}}return null}var vt=Array.isArray,k=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z={pending:!1,data:null,method:null,action:null},gt=[],xt=-1;function R(e){return{current:e}}function I(e){0>xt||(e.current=gt[xt],gt[xt]=null,xt--)}function K(e,n){xt++,gt[xt]=e.current,e.current=n}var et=R(null),ot=R(null),ft=R(null),at=R(null);function $t(e,n){switch(K(ft,n),K(ot,e),K(et,null),n.nodeType){case 9:case 11:e=(e=n.documentElement)&&(e=e.namespaceURI)?Vg(e):0;break;default:if(e=n.tagName,n=n.namespaceURI)n=Vg(n),e=Xg(n,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}I(et),K(et,e)}function Ct(){I(et),I(ot),I(ft)}function ci(e){e.memoizedState!==null&&K(at,e);var n=et.current,a=Xg(n,e.type);n!==a&&(K(ot,e),K(et,a))}function Oe(e){ot.current===e&&(I(et),I(ot)),at.current===e&&(I(at),tr._currentValue=Z)}var We,xi;function Ei(e){if(We===void 0)try{throw Error()}catch(a){var n=a.stack.trim().match(/\n( *(at )?)/);We=n&&n[1]||"",xi=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+We+e+xi}var fs=!1;function da(e,n){if(!e||fs)return"";fs=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var o={DetermineComponentFrameRoot:function(){try{if(n){var Y=function(){throw Error()};if(Object.defineProperty(Y.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Y,[])}catch(H){var j=H}Reflect.construct(e,[],Y)}else{try{Y.call()}catch(H){j=H}e.call(Y.prototype)}}else{try{throw Error()}catch(H){j=H}(Y=e())&&typeof Y.catch=="function"&&Y.catch(function(){})}}catch(H){if(H&&j&&typeof H.stack=="string")return[H.stack,j.stack]}return[null,null]}};o.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var d=Object.getOwnPropertyDescriptor(o.DetermineComponentFrameRoot,"name");d&&d.configurable&&Object.defineProperty(o.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=o.DetermineComponentFrameRoot(),v=g[0],_=g[1];if(v&&_){var M=v.split(`
`),F=_.split(`
`);for(d=o=0;o<M.length&&!M[o].includes("DetermineComponentFrameRoot");)o++;for(;d<F.length&&!F[d].includes("DetermineComponentFrameRoot");)d++;if(o===M.length||d===F.length)for(o=M.length-1,d=F.length-1;1<=o&&0<=d&&M[o]!==F[d];)d--;for(;1<=o&&0<=d;o--,d--)if(M[o]!==F[d]){if(o!==1||d!==1)do if(o--,d--,0>d||M[o]!==F[d]){var V=`
`+M[o].replace(" at new "," at ");return e.displayName&&V.includes("<anonymous>")&&(V=V.replace("<anonymous>",e.displayName)),V}while(1<=o&&0<=d);break}}}finally{fs=!1,Error.prepareStackTrace=a}return(a=e?e.displayName||e.name:"")?Ei(a):""}function pl(e,n){switch(e.tag){case 26:case 27:case 5:return Ei(e.type);case 16:return Ei("Lazy");case 13:return e.child!==n&&n!==null?Ei("Suspense Fallback"):Ei("Suspense");case 19:return Ei("SuspenseList");case 0:case 15:return da(e.type,!1);case 11:return da(e.type.render,!1);case 1:return da(e.type,!0);case 31:return Ei("Activity");default:return""}}function Cr(e){try{var n="",a=null;do n+=pl(e,a),a=e,e=e.return;while(e);return n}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}var je=Object.prototype.hasOwnProperty,gs=m.unstable_scheduleCallback,Ri=m.unstable_cancelCallback,ml=m.unstable_shouldYield,yl=m.unstable_requestPaint,Le=m.unstable_now,bl=m.unstable_getCurrentPriorityLevel,Je=m.unstable_ImmediatePriority,Ae=m.unstable_UserBlockingPriority,Ni=m.unstable_NormalPriority,$=m.unstable_LowPriority,J=m.unstable_IdlePriority,Wt=m.log,pe=m.unstable_setDisableYieldValue,Oi=null,ee=null;function Re(e){if(typeof Wt=="function"&&pe(e),ee&&typeof ee.setStrictMode=="function")try{ee.setStrictMode(Oi,e)}catch{}}var ke=Math.clz32?Math.clz32:Zm,Km=Math.log,Qm=Math.LN2;function Zm(e){return e>>>=0,e===0?32:31-(Km(e)/Qm|0)|0}var Mr=256,Dr=262144,Rr=4194304;function jn(e){var n=e&42;if(n!==0)return n;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Nr(e,n,a){var o=e.pendingLanes;if(o===0)return 0;var d=0,g=e.suspendedLanes,v=e.pingedLanes;e=e.warmLanes;var _=o&134217727;return _!==0?(o=_&~g,o!==0?d=jn(o):(v&=_,v!==0?d=jn(v):a||(a=_&~e,a!==0&&(d=jn(a))))):(_=o&~g,_!==0?d=jn(_):v!==0?d=jn(v):a||(a=o&~e,a!==0&&(d=jn(a)))),d===0?0:n!==0&&n!==d&&(n&g)===0&&(g=d&-d,a=n&-n,g>=a||g===32&&(a&4194048)!==0)?n:d}function fa(e,n){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&n)===0}function Wm(e,n){switch(e){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Eh(){var e=Rr;return Rr<<=1,(Rr&62914560)===0&&(Rr=4194304),e}function vl(e){for(var n=[],a=0;31>a;a++)n.push(e);return n}function ga(e,n){e.pendingLanes|=n,n!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Jm(e,n,a,o,d,g){var v=e.pendingLanes;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=a,e.entangledLanes&=a,e.errorRecoveryDisabledLanes&=a,e.shellSuspendCounter=0;var _=e.entanglements,M=e.expirationTimes,F=e.hiddenUpdates;for(a=v&~a;0<a;){var V=31-ke(a),Y=1<<V;_[V]=0,M[V]=-1;var j=F[V];if(j!==null)for(F[V]=null,V=0;V<j.length;V++){var H=j[V];H!==null&&(H.lane&=-536870913)}a&=~Y}o!==0&&Th(e,o,0),g!==0&&d===0&&e.tag!==0&&(e.suspendedLanes|=g&~(v&~n))}function Th(e,n,a){e.pendingLanes|=n,e.suspendedLanes&=~n;var o=31-ke(n);e.entangledLanes|=n,e.entanglements[o]=e.entanglements[o]|1073741824|a&261930}function Ch(e,n){var a=e.entangledLanes|=n;for(e=e.entanglements;a;){var o=31-ke(a),d=1<<o;d&n|e[o]&n&&(e[o]|=n),a&=~d}}function Mh(e,n){var a=n&-n;return a=(a&42)!==0?1:Al(a),(a&(e.suspendedLanes|n))!==0?0:a}function Al(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Sl(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Dh(){var e=q.p;return e!==0?e:(e=window.event,e===void 0?32:pp(e.type))}function Rh(e,n){var a=q.p;try{return q.p=e,n()}finally{q.p=a}}var dn=Math.random().toString(36).slice(2),Se="__reactFiber$"+dn,He="__reactProps$"+dn,ps="__reactContainer$"+dn,wl="__reactEvents$"+dn,ty="__reactListeners$"+dn,ey="__reactHandles$"+dn,Nh="__reactResources$"+dn,pa="__reactMarker$"+dn;function _l(e){delete e[Se],delete e[He],delete e[wl],delete e[ty],delete e[ey]}function ms(e){var n=e[Se];if(n)return n;for(var a=e.parentNode;a;){if(n=a[ps]||a[Se]){if(a=n.alternate,n.child!==null||a!==null&&a.child!==null)for(e=Jg(e);e!==null;){if(a=e[Se])return a;e=Jg(e)}return n}e=a,a=e.parentNode}return null}function ys(e){if(e=e[Se]||e[ps]){var n=e.tag;if(n===5||n===6||n===13||n===31||n===26||n===27||n===3)return e}return null}function ma(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e.stateNode;throw Error(s(33))}function bs(e){var n=e[Nh];return n||(n=e[Nh]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function me(e){e[pa]=!0}var Oh=new Set,Lh={};function Hn(e,n){vs(e,n),vs(e+"Capture",n)}function vs(e,n){for(Lh[e]=n,e=0;e<n.length;e++)Oh.add(n[e])}var iy=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),kh={},Bh={};function ny(e){return je.call(Bh,e)?!0:je.call(kh,e)?!1:iy.test(e)?Bh[e]=!0:(kh[e]=!0,!1)}function Or(e,n,a){if(ny(n))if(a===null)e.removeAttribute(n);else{switch(typeof a){case"undefined":case"function":case"symbol":e.removeAttribute(n);return;case"boolean":var o=n.toLowerCase().slice(0,5);if(o!=="data-"&&o!=="aria-"){e.removeAttribute(n);return}}e.setAttribute(n,""+a)}}function Lr(e,n,a){if(a===null)e.removeAttribute(n);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttribute(n,""+a)}}function qi(e,n,a,o){if(o===null)e.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(a);return}e.setAttributeNS(n,a,""+o)}}function ui(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function zh(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function sy(e,n,a){var o=Object.getOwnPropertyDescriptor(e.constructor.prototype,n);if(!e.hasOwnProperty(n)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var d=o.get,g=o.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return d.call(this)},set:function(v){a=""+v,g.call(this,v)}}),Object.defineProperty(e,n,{enumerable:o.enumerable}),{getValue:function(){return a},setValue:function(v){a=""+v},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function xl(e){if(!e._valueTracker){var n=zh(e)?"checked":"value";e._valueTracker=sy(e,n,""+e[n])}}function Ph(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var a=n.getValue(),o="";return e&&(o=zh(e)?e.checked?"true":"false":e.value),e=o,e!==a?(n.setValue(e),!0):!1}function kr(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var ay=/[\n"\\]/g;function hi(e){return e.replace(ay,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function El(e,n,a,o,d,g,v,_){e.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?e.type=v:e.removeAttribute("type"),n!=null?v==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+ui(n)):e.value!==""+ui(n)&&(e.value=""+ui(n)):v!=="submit"&&v!=="reset"||e.removeAttribute("value"),n!=null?Tl(e,v,ui(n)):a!=null?Tl(e,v,ui(a)):o!=null&&e.removeAttribute("value"),d==null&&g!=null&&(e.defaultChecked=!!g),d!=null&&(e.checked=d&&typeof d!="function"&&typeof d!="symbol"),_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"?e.name=""+ui(_):e.removeAttribute("name")}function Uh(e,n,a,o,d,g,v,_){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(e.type=g),n!=null||a!=null){if(!(g!=="submit"&&g!=="reset"||n!=null)){xl(e);return}a=a!=null?""+ui(a):"",n=n!=null?""+ui(n):a,_||n===e.value||(e.value=n),e.defaultValue=n}o=o??d,o=typeof o!="function"&&typeof o!="symbol"&&!!o,e.checked=_?e.checked:!!o,e.defaultChecked=!!o,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(e.name=v),xl(e)}function Tl(e,n,a){n==="number"&&kr(e.ownerDocument)===e||e.defaultValue===""+a||(e.defaultValue=""+a)}function As(e,n,a,o){if(e=e.options,n){n={};for(var d=0;d<a.length;d++)n["$"+a[d]]=!0;for(a=0;a<e.length;a++)d=n.hasOwnProperty("$"+e[a].value),e[a].selected!==d&&(e[a].selected=d),d&&o&&(e[a].defaultSelected=!0)}else{for(a=""+ui(a),n=null,d=0;d<e.length;d++){if(e[d].value===a){e[d].selected=!0,o&&(e[d].defaultSelected=!0);return}n!==null||e[d].disabled||(n=e[d])}n!==null&&(n.selected=!0)}}function Fh(e,n,a){if(n!=null&&(n=""+ui(n),n!==e.value&&(e.value=n),a==null)){e.defaultValue!==n&&(e.defaultValue=n);return}e.defaultValue=a!=null?""+ui(a):""}function jh(e,n,a,o){if(n==null){if(o!=null){if(a!=null)throw Error(s(92));if(vt(o)){if(1<o.length)throw Error(s(93));o=o[0]}a=o}a==null&&(a=""),n=a}a=ui(n),e.defaultValue=a,o=e.textContent,o===a&&o!==""&&o!==null&&(e.value=o),xl(e)}function Ss(e,n){if(n){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=n;return}}e.textContent=n}var ry=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Hh(e,n,a){var o=n.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?o?e.setProperty(n,""):n==="float"?e.cssFloat="":e[n]="":o?e.setProperty(n,a):typeof a!="number"||a===0||ry.has(n)?n==="float"?e.cssFloat=a:e[n]=(""+a).trim():e[n]=a+"px"}function Ih(e,n,a){if(n!=null&&typeof n!="object")throw Error(s(62));if(e=e.style,a!=null){for(var o in a)!a.hasOwnProperty(o)||n!=null&&n.hasOwnProperty(o)||(o.indexOf("--")===0?e.setProperty(o,""):o==="float"?e.cssFloat="":e[o]="");for(var d in n)o=n[d],n.hasOwnProperty(d)&&a[d]!==o&&Hh(e,d,o)}else for(var g in n)n.hasOwnProperty(g)&&Hh(e,g,n[g])}function Cl(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var oy=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ly=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Br(e){return ly.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Vi(){}var Ml=null;function Dl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ws=null,_s=null;function Gh(e){var n=ys(e);if(n&&(e=n.stateNode)){var a=e[He]||null;t:switch(e=n.stateNode,n.type){case"input":if(El(e,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),n=a.name,a.type==="radio"&&n!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+hi(""+n)+'"][type="radio"]'),n=0;n<a.length;n++){var o=a[n];if(o!==e&&o.form===e.form){var d=o[He]||null;if(!d)throw Error(s(90));El(o,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name)}}for(n=0;n<a.length;n++)o=a[n],o.form===e.form&&Ph(o)}break t;case"textarea":Fh(e,a.value,a.defaultValue);break t;case"select":n=a.value,n!=null&&As(e,!!a.multiple,n,!1)}}}var Rl=!1;function qh(e,n,a){if(Rl)return e(n,a);Rl=!0;try{var o=e(n);return o}finally{if(Rl=!1,(ws!==null||_s!==null)&&(_o(),ws&&(n=ws,e=_s,_s=ws=null,Gh(n),e)))for(n=0;n<e.length;n++)Gh(e[n])}}function ya(e,n){var a=e.stateNode;if(a===null)return null;var o=a[He]||null;if(o===null)return null;a=o[n];t:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break t;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(s(231,n,typeof a));return a}var Xi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Nl=!1;if(Xi)try{var ba={};Object.defineProperty(ba,"passive",{get:function(){Nl=!0}}),window.addEventListener("test",ba,ba),window.removeEventListener("test",ba,ba)}catch{Nl=!1}var fn=null,Ol=null,zr=null;function Vh(){if(zr)return zr;var e,n=Ol,a=n.length,o,d="value"in fn?fn.value:fn.textContent,g=d.length;for(e=0;e<a&&n[e]===d[e];e++);var v=a-e;for(o=1;o<=v&&n[a-o]===d[g-o];o++);return zr=d.slice(e,1<o?1-o:void 0)}function Pr(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function Ur(){return!0}function Xh(){return!1}function Ie(e){function n(a,o,d,g,v){this._reactName=a,this._targetInst=d,this.type=o,this.nativeEvent=g,this.target=v,this.currentTarget=null;for(var _ in e)e.hasOwnProperty(_)&&(a=e[_],this[_]=a?a(g):g[_]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Ur:Xh,this.isPropagationStopped=Xh,this}return y(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=Ur)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=Ur)},persist:function(){},isPersistent:Ur}),n}var In={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fr=Ie(In),va=y({},In,{view:0,detail:0}),cy=Ie(va),Ll,kl,Aa,jr=y({},va,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zl,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Aa&&(Aa&&e.type==="mousemove"?(Ll=e.screenX-Aa.screenX,kl=e.screenY-Aa.screenY):kl=Ll=0,Aa=e),Ll)},movementY:function(e){return"movementY"in e?e.movementY:kl}}),Yh=Ie(jr),uy=y({},jr,{dataTransfer:0}),hy=Ie(uy),dy=y({},va,{relatedTarget:0}),Bl=Ie(dy),fy=y({},In,{animationName:0,elapsedTime:0,pseudoElement:0}),gy=Ie(fy),py=y({},In,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),my=Ie(py),yy=y({},In,{data:0}),$h=Ie(yy),by={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vy={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ay={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sy(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=Ay[e])?!!n[e]:!1}function zl(){return Sy}var wy=y({},va,{key:function(e){if(e.key){var n=by[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=Pr(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?vy[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zl,charCode:function(e){return e.type==="keypress"?Pr(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Pr(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),_y=Ie(wy),xy=y({},jr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Kh=Ie(xy),Ey=y({},va,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zl}),Ty=Ie(Ey),Cy=y({},In,{propertyName:0,elapsedTime:0,pseudoElement:0}),My=Ie(Cy),Dy=y({},jr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ry=Ie(Dy),Ny=y({},In,{newState:0,oldState:0}),Oy=Ie(Ny),Ly=[9,13,27,32],Pl=Xi&&"CompositionEvent"in window,Sa=null;Xi&&"documentMode"in document&&(Sa=document.documentMode);var ky=Xi&&"TextEvent"in window&&!Sa,Qh=Xi&&(!Pl||Sa&&8<Sa&&11>=Sa),Zh=" ",Wh=!1;function Jh(e,n){switch(e){case"keyup":return Ly.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function td(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var xs=!1;function By(e,n){switch(e){case"compositionend":return td(n);case"keypress":return n.which!==32?null:(Wh=!0,Zh);case"textInput":return e=n.data,e===Zh&&Wh?null:e;default:return null}}function zy(e,n){if(xs)return e==="compositionend"||!Pl&&Jh(e,n)?(e=Vh(),zr=Ol=fn=null,xs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Qh&&n.locale!=="ko"?null:n.data;default:return null}}var Py={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ed(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!Py[e.type]:n==="textarea"}function id(e,n,a,o){ws?_s?_s.push(o):_s=[o]:ws=o,n=Ro(n,"onChange"),0<n.length&&(a=new Fr("onChange","change",null,a,o),e.push({event:a,listeners:n}))}var wa=null,_a=null;function Uy(e){Fg(e,0)}function Hr(e){var n=ma(e);if(Ph(n))return e}function nd(e,n){if(e==="change")return n}var sd=!1;if(Xi){var Ul;if(Xi){var Fl="oninput"in document;if(!Fl){var ad=document.createElement("div");ad.setAttribute("oninput","return;"),Fl=typeof ad.oninput=="function"}Ul=Fl}else Ul=!1;sd=Ul&&(!document.documentMode||9<document.documentMode)}function rd(){wa&&(wa.detachEvent("onpropertychange",od),_a=wa=null)}function od(e){if(e.propertyName==="value"&&Hr(_a)){var n=[];id(n,_a,e,Dl(e)),qh(Uy,n)}}function Fy(e,n,a){e==="focusin"?(rd(),wa=n,_a=a,wa.attachEvent("onpropertychange",od)):e==="focusout"&&rd()}function jy(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Hr(_a)}function Hy(e,n){if(e==="click")return Hr(n)}function Iy(e,n){if(e==="input"||e==="change")return Hr(n)}function Gy(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var ti=typeof Object.is=="function"?Object.is:Gy;function xa(e,n){if(ti(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var a=Object.keys(e),o=Object.keys(n);if(a.length!==o.length)return!1;for(o=0;o<a.length;o++){var d=a[o];if(!je.call(n,d)||!ti(e[d],n[d]))return!1}return!0}function ld(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cd(e,n){var a=ld(e);e=0;for(var o;a;){if(a.nodeType===3){if(o=e+a.textContent.length,e<=n&&o>=n)return{node:a,offset:n-e};e=o}t:{for(;a;){if(a.nextSibling){a=a.nextSibling;break t}a=a.parentNode}a=void 0}a=ld(a)}}function ud(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?ud(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function hd(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var n=kr(e.document);n instanceof e.HTMLIFrameElement;){try{var a=typeof n.contentWindow.location.href=="string"}catch{a=!1}if(a)e=n.contentWindow;else break;n=kr(e.document)}return n}function jl(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}var qy=Xi&&"documentMode"in document&&11>=document.documentMode,Es=null,Hl=null,Ea=null,Il=!1;function dd(e,n,a){var o=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Il||Es==null||Es!==kr(o)||(o=Es,"selectionStart"in o&&jl(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Ea&&xa(Ea,o)||(Ea=o,o=Ro(Hl,"onSelect"),0<o.length&&(n=new Fr("onSelect","select",null,n,a),e.push({event:n,listeners:o}),n.target=Es)))}function Gn(e,n){var a={};return a[e.toLowerCase()]=n.toLowerCase(),a["Webkit"+e]="webkit"+n,a["Moz"+e]="moz"+n,a}var Ts={animationend:Gn("Animation","AnimationEnd"),animationiteration:Gn("Animation","AnimationIteration"),animationstart:Gn("Animation","AnimationStart"),transitionrun:Gn("Transition","TransitionRun"),transitionstart:Gn("Transition","TransitionStart"),transitioncancel:Gn("Transition","TransitionCancel"),transitionend:Gn("Transition","TransitionEnd")},Gl={},fd={};Xi&&(fd=document.createElement("div").style,"AnimationEvent"in window||(delete Ts.animationend.animation,delete Ts.animationiteration.animation,delete Ts.animationstart.animation),"TransitionEvent"in window||delete Ts.transitionend.transition);function qn(e){if(Gl[e])return Gl[e];if(!Ts[e])return e;var n=Ts[e],a;for(a in n)if(n.hasOwnProperty(a)&&a in fd)return Gl[e]=n[a];return e}var gd=qn("animationend"),pd=qn("animationiteration"),md=qn("animationstart"),Vy=qn("transitionrun"),Xy=qn("transitionstart"),Yy=qn("transitioncancel"),yd=qn("transitionend"),bd=new Map,ql="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ql.push("scrollEnd");function Ti(e,n){bd.set(e,n),Hn(n,[e])}var Ir=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},di=[],Cs=0,Vl=0;function Gr(){for(var e=Cs,n=Vl=Cs=0;n<e;){var a=di[n];di[n++]=null;var o=di[n];di[n++]=null;var d=di[n];di[n++]=null;var g=di[n];if(di[n++]=null,o!==null&&d!==null){var v=o.pending;v===null?d.next=d:(d.next=v.next,v.next=d),o.pending=d}g!==0&&vd(a,d,g)}}function qr(e,n,a,o){di[Cs++]=e,di[Cs++]=n,di[Cs++]=a,di[Cs++]=o,Vl|=o,e.lanes|=o,e=e.alternate,e!==null&&(e.lanes|=o)}function Xl(e,n,a,o){return qr(e,n,a,o),Vr(e)}function Vn(e,n){return qr(e,null,null,n),Vr(e)}function vd(e,n,a){e.lanes|=a;var o=e.alternate;o!==null&&(o.lanes|=a);for(var d=!1,g=e.return;g!==null;)g.childLanes|=a,o=g.alternate,o!==null&&(o.childLanes|=a),g.tag===22&&(e=g.stateNode,e===null||e._visibility&1||(d=!0)),e=g,g=g.return;return e.tag===3?(g=e.stateNode,d&&n!==null&&(d=31-ke(a),e=g.hiddenUpdates,o=e[d],o===null?e[d]=[n]:o.push(n),n.lane=a|536870912),g):null}function Vr(e){if(50<Ya)throw Ya=0,eu=null,Error(s(185));for(var n=e.return;n!==null;)e=n,n=e.return;return e.tag===3?e.stateNode:null}var Ms={};function $y(e,n,a,o){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ei(e,n,a,o){return new $y(e,n,a,o)}function Yl(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Yi(e,n){var a=e.alternate;return a===null?(a=ei(e.tag,n,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=n,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&65011712,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,n=e.dependencies,a.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a.refCleanup=e.refCleanup,a}function Ad(e,n){e.flags&=65011714;var a=e.alternate;return a===null?(e.childLanes=0,e.lanes=n,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=a.childLanes,e.lanes=a.lanes,e.child=a.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,e.type=a.type,n=a.dependencies,e.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),e}function Xr(e,n,a,o,d,g){var v=0;if(o=e,typeof e=="function")Yl(e)&&(v=1);else if(typeof e=="string")v=Jb(e,a,et.current)?26:e==="html"||e==="head"||e==="body"?27:5;else t:switch(e){case Q:return e=ei(31,a,n,d),e.elementType=Q,e.lanes=g,e;case S:return Xn(a.children,d,g,n);case E:v=8,d|=24;break;case x:return e=ei(12,a,n,d|2),e.elementType=x,e.lanes=g,e;case O:return e=ei(13,a,n,d),e.elementType=O,e.lanes=g,e;case L:return e=ei(19,a,n,d),e.elementType=L,e.lanes=g,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case T:v=10;break t;case C:v=9;break t;case B:v=11;break t;case P:v=14;break t;case G:v=16,o=null;break t}v=29,a=Error(s(130,e===null?"null":typeof e,"")),o=null}return n=ei(v,a,n,d),n.elementType=e,n.type=o,n.lanes=g,n}function Xn(e,n,a,o){return e=ei(7,e,o,n),e.lanes=a,e}function $l(e,n,a){return e=ei(6,e,null,n),e.lanes=a,e}function Sd(e){var n=ei(18,null,null,0);return n.stateNode=e,n}function Kl(e,n,a){return n=ei(4,e.children!==null?e.children:[],e.key,n),n.lanes=a,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}var wd=new WeakMap;function fi(e,n){if(typeof e=="object"&&e!==null){var a=wd.get(e);return a!==void 0?a:(n={value:e,source:n,stack:Cr(n)},wd.set(e,n),n)}return{value:e,source:n,stack:Cr(n)}}var Ds=[],Rs=0,Yr=null,Ta=0,gi=[],pi=0,gn=null,Li=1,ki="";function $i(e,n){Ds[Rs++]=Ta,Ds[Rs++]=Yr,Yr=e,Ta=n}function _d(e,n,a){gi[pi++]=Li,gi[pi++]=ki,gi[pi++]=gn,gn=e;var o=Li;e=ki;var d=32-ke(o)-1;o&=~(1<<d),a+=1;var g=32-ke(n)+d;if(30<g){var v=d-d%5;g=(o&(1<<v)-1).toString(32),o>>=v,d-=v,Li=1<<32-ke(n)+d|a<<d|o,ki=g+e}else Li=1<<g|a<<d|o,ki=e}function Ql(e){e.return!==null&&($i(e,1),_d(e,1,0))}function Zl(e){for(;e===Yr;)Yr=Ds[--Rs],Ds[Rs]=null,Ta=Ds[--Rs],Ds[Rs]=null;for(;e===gn;)gn=gi[--pi],gi[pi]=null,ki=gi[--pi],gi[pi]=null,Li=gi[--pi],gi[pi]=null}function xd(e,n){gi[pi++]=Li,gi[pi++]=ki,gi[pi++]=gn,Li=n.id,ki=n.overflow,gn=e}var we=null,Xt=null,Rt=!1,pn=null,mi=!1,Wl=Error(s(519));function mn(e){var n=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ca(fi(n,e)),Wl}function Ed(e){var n=e.stateNode,a=e.type,o=e.memoizedProps;switch(n[Se]=e,n[He]=o,a){case"dialog":Tt("cancel",n),Tt("close",n);break;case"iframe":case"object":case"embed":Tt("load",n);break;case"video":case"audio":for(a=0;a<Ka.length;a++)Tt(Ka[a],n);break;case"source":Tt("error",n);break;case"img":case"image":case"link":Tt("error",n),Tt("load",n);break;case"details":Tt("toggle",n);break;case"input":Tt("invalid",n),Uh(n,o.value,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name,!0);break;case"select":Tt("invalid",n);break;case"textarea":Tt("invalid",n),jh(n,o.value,o.defaultValue,o.children)}a=o.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||n.textContent===""+a||o.suppressHydrationWarning===!0||Gg(n.textContent,a)?(o.popover!=null&&(Tt("beforetoggle",n),Tt("toggle",n)),o.onScroll!=null&&Tt("scroll",n),o.onScrollEnd!=null&&Tt("scrollend",n),o.onClick!=null&&(n.onclick=Vi),n=!0):n=!1,n||mn(e,!0)}function Td(e){for(we=e.return;we;)switch(we.tag){case 5:case 31:case 13:mi=!1;return;case 27:case 3:mi=!0;return;default:we=we.return}}function Ns(e){if(e!==we)return!1;if(!Rt)return Td(e),Rt=!0,!1;var n=e.tag,a;if((a=n!==3&&n!==27)&&((a=n===5)&&(a=e.type,a=!(a!=="form"&&a!=="button")||mu(e.type,e.memoizedProps)),a=!a),a&&Xt&&mn(e),Td(e),n===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));Xt=Wg(e)}else if(n===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));Xt=Wg(e)}else n===27?(n=Xt,Rn(e.type)?(e=Su,Su=null,Xt=e):Xt=n):Xt=we?bi(e.stateNode.nextSibling):null;return!0}function Yn(){Xt=we=null,Rt=!1}function Jl(){var e=pn;return e!==null&&(Xe===null?Xe=e:Xe.push.apply(Xe,e),pn=null),e}function Ca(e){pn===null?pn=[e]:pn.push(e)}var tc=R(null),$n=null,Ki=null;function yn(e,n,a){K(tc,n._currentValue),n._currentValue=a}function Qi(e){e._currentValue=tc.current,I(tc)}function ec(e,n,a){for(;e!==null;){var o=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,o!==null&&(o.childLanes|=n)):o!==null&&(o.childLanes&n)!==n&&(o.childLanes|=n),e===a)break;e=e.return}}function ic(e,n,a,o){var d=e.child;for(d!==null&&(d.return=e);d!==null;){var g=d.dependencies;if(g!==null){var v=d.child;g=g.firstContext;t:for(;g!==null;){var _=g;g=d;for(var M=0;M<n.length;M++)if(_.context===n[M]){g.lanes|=a,_=g.alternate,_!==null&&(_.lanes|=a),ec(g.return,a,e),o||(v=null);break t}g=_.next}}else if(d.tag===18){if(v=d.return,v===null)throw Error(s(341));v.lanes|=a,g=v.alternate,g!==null&&(g.lanes|=a),ec(v,a,e),v=null}else v=d.child;if(v!==null)v.return=d;else for(v=d;v!==null;){if(v===e){v=null;break}if(d=v.sibling,d!==null){d.return=v.return,v=d;break}v=v.return}d=v}}function Os(e,n,a,o){e=null;for(var d=n,g=!1;d!==null;){if(!g){if((d.flags&524288)!==0)g=!0;else if((d.flags&262144)!==0)break}if(d.tag===10){var v=d.alternate;if(v===null)throw Error(s(387));if(v=v.memoizedProps,v!==null){var _=d.type;ti(d.pendingProps.value,v.value)||(e!==null?e.push(_):e=[_])}}else if(d===at.current){if(v=d.alternate,v===null)throw Error(s(387));v.memoizedState.memoizedState!==d.memoizedState.memoizedState&&(e!==null?e.push(tr):e=[tr])}d=d.return}e!==null&&ic(n,e,a,o),n.flags|=262144}function $r(e){for(e=e.firstContext;e!==null;){if(!ti(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Kn(e){$n=e,Ki=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function _e(e){return Cd($n,e)}function Kr(e,n){return $n===null&&Kn(e),Cd(e,n)}function Cd(e,n){var a=n._currentValue;if(n={context:n,memoizedValue:a,next:null},Ki===null){if(e===null)throw Error(s(308));Ki=n,e.dependencies={lanes:0,firstContext:n},e.flags|=524288}else Ki=Ki.next=n;return a}var Ky=typeof AbortController<"u"?AbortController:function(){var e=[],n=this.signal={aborted:!1,addEventListener:function(a,o){e.push(o)}};this.abort=function(){n.aborted=!0,e.forEach(function(a){return a()})}},Qy=m.unstable_scheduleCallback,Zy=m.unstable_NormalPriority,le={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function nc(){return{controller:new Ky,data:new Map,refCount:0}}function Ma(e){e.refCount--,e.refCount===0&&Qy(Zy,function(){e.controller.abort()})}var Da=null,sc=0,Ls=0,ks=null;function Wy(e,n){if(Da===null){var a=Da=[];sc=0,Ls=ou(),ks={status:"pending",value:void 0,then:function(o){a.push(o)}}}return sc++,n.then(Md,Md),n}function Md(){if(--sc===0&&Da!==null){ks!==null&&(ks.status="fulfilled");var e=Da;Da=null,Ls=0,ks=null;for(var n=0;n<e.length;n++)(0,e[n])()}}function Jy(e,n){var a=[],o={status:"pending",value:null,reason:null,then:function(d){a.push(d)}};return e.then(function(){o.status="fulfilled",o.value=n;for(var d=0;d<a.length;d++)(0,a[d])(n)},function(d){for(o.status="rejected",o.reason=d,d=0;d<a.length;d++)(0,a[d])(void 0)}),o}var Dd=k.S;k.S=function(e,n){fg=Le(),typeof n=="object"&&n!==null&&typeof n.then=="function"&&Wy(e,n),Dd!==null&&Dd(e,n)};var Qn=R(null);function ac(){var e=Qn.current;return e!==null?e:qt.pooledCache}function Qr(e,n){n===null?K(Qn,Qn.current):K(Qn,n.pool)}function Rd(){var e=ac();return e===null?null:{parent:le._currentValue,pool:e}}var Bs=Error(s(460)),rc=Error(s(474)),Zr=Error(s(542)),Wr={then:function(){}};function Nd(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Od(e,n,a){switch(a=e[a],a===void 0?e.push(n):a!==n&&(n.then(Vi,Vi),n=a),n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,kd(e),e;default:if(typeof n.status=="string")n.then(Vi,Vi);else{if(e=qt,e!==null&&100<e.shellSuspendCounter)throw Error(s(482));e=n,e.status="pending",e.then(function(o){if(n.status==="pending"){var d=n;d.status="fulfilled",d.value=o}},function(o){if(n.status==="pending"){var d=n;d.status="rejected",d.reason=o}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,kd(e),e}throw Wn=n,Bs}}function Zn(e){try{var n=e._init;return n(e._payload)}catch(a){throw a!==null&&typeof a=="object"&&typeof a.then=="function"?(Wn=a,Bs):a}}var Wn=null;function Ld(){if(Wn===null)throw Error(s(459));var e=Wn;return Wn=null,e}function kd(e){if(e===Bs||e===Zr)throw Error(s(483))}var zs=null,Ra=0;function Jr(e){var n=Ra;return Ra+=1,zs===null&&(zs=[]),Od(zs,e,n)}function Na(e,n){n=n.props.ref,e.ref=n!==void 0?n:null}function to(e,n){throw n.$$typeof===b?Error(s(525)):(e=Object.prototype.toString.call(n),Error(s(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)))}function Bd(e){function n(z,N){if(e){var U=z.deletions;U===null?(z.deletions=[N],z.flags|=16):U.push(N)}}function a(z,N){if(!e)return null;for(;N!==null;)n(z,N),N=N.sibling;return null}function o(z){for(var N=new Map;z!==null;)z.key!==null?N.set(z.key,z):N.set(z.index,z),z=z.sibling;return N}function d(z,N){return z=Yi(z,N),z.index=0,z.sibling=null,z}function g(z,N,U){return z.index=U,e?(U=z.alternate,U!==null?(U=U.index,U<N?(z.flags|=67108866,N):U):(z.flags|=67108866,N)):(z.flags|=1048576,N)}function v(z){return e&&z.alternate===null&&(z.flags|=67108866),z}function _(z,N,U,X){return N===null||N.tag!==6?(N=$l(U,z.mode,X),N.return=z,N):(N=d(N,U),N.return=z,N)}function M(z,N,U,X){var lt=U.type;return lt===S?V(z,N,U.props.children,X,U.key):N!==null&&(N.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===G&&Zn(lt)===N.type)?(N=d(N,U.props),Na(N,U),N.return=z,N):(N=Xr(U.type,U.key,U.props,null,z.mode,X),Na(N,U),N.return=z,N)}function F(z,N,U,X){return N===null||N.tag!==4||N.stateNode.containerInfo!==U.containerInfo||N.stateNode.implementation!==U.implementation?(N=Kl(U,z.mode,X),N.return=z,N):(N=d(N,U.children||[]),N.return=z,N)}function V(z,N,U,X,lt){return N===null||N.tag!==7?(N=Xn(U,z.mode,X,lt),N.return=z,N):(N=d(N,U),N.return=z,N)}function Y(z,N,U){if(typeof N=="string"&&N!==""||typeof N=="number"||typeof N=="bigint")return N=$l(""+N,z.mode,U),N.return=z,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case A:return U=Xr(N.type,N.key,N.props,null,z.mode,U),Na(U,N),U.return=z,U;case w:return N=Kl(N,z.mode,U),N.return=z,N;case G:return N=Zn(N),Y(z,N,U)}if(vt(N)||ut(N))return N=Xn(N,z.mode,U,null),N.return=z,N;if(typeof N.then=="function")return Y(z,Jr(N),U);if(N.$$typeof===T)return Y(z,Kr(z,N),U);to(z,N)}return null}function j(z,N,U,X){var lt=N!==null?N.key:null;if(typeof U=="string"&&U!==""||typeof U=="number"||typeof U=="bigint")return lt!==null?null:_(z,N,""+U,X);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case A:return U.key===lt?M(z,N,U,X):null;case w:return U.key===lt?F(z,N,U,X):null;case G:return U=Zn(U),j(z,N,U,X)}if(vt(U)||ut(U))return lt!==null?null:V(z,N,U,X,null);if(typeof U.then=="function")return j(z,N,Jr(U),X);if(U.$$typeof===T)return j(z,N,Kr(z,U),X);to(z,U)}return null}function H(z,N,U,X,lt){if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return z=z.get(U)||null,_(N,z,""+X,lt);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case A:return z=z.get(X.key===null?U:X.key)||null,M(N,z,X,lt);case w:return z=z.get(X.key===null?U:X.key)||null,F(N,z,X,lt);case G:return X=Zn(X),H(z,N,U,X,lt)}if(vt(X)||ut(X))return z=z.get(U)||null,V(N,z,X,lt,null);if(typeof X.then=="function")return H(z,N,U,Jr(X),lt);if(X.$$typeof===T)return H(z,N,U,Kr(N,X),lt);to(N,X)}return null}function nt(z,N,U,X){for(var lt=null,Lt=null,rt=N,_t=N=0,Dt=null;rt!==null&&_t<U.length;_t++){rt.index>_t?(Dt=rt,rt=null):Dt=rt.sibling;var kt=j(z,rt,U[_t],X);if(kt===null){rt===null&&(rt=Dt);break}e&&rt&&kt.alternate===null&&n(z,rt),N=g(kt,N,_t),Lt===null?lt=kt:Lt.sibling=kt,Lt=kt,rt=Dt}if(_t===U.length)return a(z,rt),Rt&&$i(z,_t),lt;if(rt===null){for(;_t<U.length;_t++)rt=Y(z,U[_t],X),rt!==null&&(N=g(rt,N,_t),Lt===null?lt=rt:Lt.sibling=rt,Lt=rt);return Rt&&$i(z,_t),lt}for(rt=o(rt);_t<U.length;_t++)Dt=H(rt,z,_t,U[_t],X),Dt!==null&&(e&&Dt.alternate!==null&&rt.delete(Dt.key===null?_t:Dt.key),N=g(Dt,N,_t),Lt===null?lt=Dt:Lt.sibling=Dt,Lt=Dt);return e&&rt.forEach(function(Bn){return n(z,Bn)}),Rt&&$i(z,_t),lt}function dt(z,N,U,X){if(U==null)throw Error(s(151));for(var lt=null,Lt=null,rt=N,_t=N=0,Dt=null,kt=U.next();rt!==null&&!kt.done;_t++,kt=U.next()){rt.index>_t?(Dt=rt,rt=null):Dt=rt.sibling;var Bn=j(z,rt,kt.value,X);if(Bn===null){rt===null&&(rt=Dt);break}e&&rt&&Bn.alternate===null&&n(z,rt),N=g(Bn,N,_t),Lt===null?lt=Bn:Lt.sibling=Bn,Lt=Bn,rt=Dt}if(kt.done)return a(z,rt),Rt&&$i(z,_t),lt;if(rt===null){for(;!kt.done;_t++,kt=U.next())kt=Y(z,kt.value,X),kt!==null&&(N=g(kt,N,_t),Lt===null?lt=kt:Lt.sibling=kt,Lt=kt);return Rt&&$i(z,_t),lt}for(rt=o(rt);!kt.done;_t++,kt=U.next())kt=H(rt,z,_t,kt.value,X),kt!==null&&(e&&kt.alternate!==null&&rt.delete(kt.key===null?_t:kt.key),N=g(kt,N,_t),Lt===null?lt=kt:Lt.sibling=kt,Lt=kt);return e&&rt.forEach(function(u0){return n(z,u0)}),Rt&&$i(z,_t),lt}function It(z,N,U,X){if(typeof U=="object"&&U!==null&&U.type===S&&U.key===null&&(U=U.props.children),typeof U=="object"&&U!==null){switch(U.$$typeof){case A:t:{for(var lt=U.key;N!==null;){if(N.key===lt){if(lt=U.type,lt===S){if(N.tag===7){a(z,N.sibling),X=d(N,U.props.children),X.return=z,z=X;break t}}else if(N.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===G&&Zn(lt)===N.type){a(z,N.sibling),X=d(N,U.props),Na(X,U),X.return=z,z=X;break t}a(z,N);break}else n(z,N);N=N.sibling}U.type===S?(X=Xn(U.props.children,z.mode,X,U.key),X.return=z,z=X):(X=Xr(U.type,U.key,U.props,null,z.mode,X),Na(X,U),X.return=z,z=X)}return v(z);case w:t:{for(lt=U.key;N!==null;){if(N.key===lt)if(N.tag===4&&N.stateNode.containerInfo===U.containerInfo&&N.stateNode.implementation===U.implementation){a(z,N.sibling),X=d(N,U.children||[]),X.return=z,z=X;break t}else{a(z,N);break}else n(z,N);N=N.sibling}X=Kl(U,z.mode,X),X.return=z,z=X}return v(z);case G:return U=Zn(U),It(z,N,U,X)}if(vt(U))return nt(z,N,U,X);if(ut(U)){if(lt=ut(U),typeof lt!="function")throw Error(s(150));return U=lt.call(U),dt(z,N,U,X)}if(typeof U.then=="function")return It(z,N,Jr(U),X);if(U.$$typeof===T)return It(z,N,Kr(z,U),X);to(z,U)}return typeof U=="string"&&U!==""||typeof U=="number"||typeof U=="bigint"?(U=""+U,N!==null&&N.tag===6?(a(z,N.sibling),X=d(N,U),X.return=z,z=X):(a(z,N),X=$l(U,z.mode,X),X.return=z,z=X),v(z)):a(z,N)}return function(z,N,U,X){try{Ra=0;var lt=It(z,N,U,X);return zs=null,lt}catch(rt){if(rt===Bs||rt===Zr)throw rt;var Lt=ei(29,rt,null,z.mode);return Lt.lanes=X,Lt.return=z,Lt}finally{}}}var Jn=Bd(!0),zd=Bd(!1),bn=!1;function oc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function lc(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function vn(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function An(e,n,a){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,(Bt&2)!==0){var d=o.pending;return d===null?n.next=n:(n.next=d.next,d.next=n),o.pending=n,n=Vr(e),vd(e,null,a),n}return qr(e,o,n,a),Vr(e)}function Oa(e,n,a){if(n=n.updateQueue,n!==null&&(n=n.shared,(a&4194048)!==0)){var o=n.lanes;o&=e.pendingLanes,a|=o,n.lanes=a,Ch(e,a)}}function cc(e,n){var a=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,a===o)){var d=null,g=null;if(a=a.firstBaseUpdate,a!==null){do{var v={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};g===null?d=g=v:g=g.next=v,a=a.next}while(a!==null);g===null?d=g=n:g=g.next=n}else d=g=n;a={baseState:o.baseState,firstBaseUpdate:d,lastBaseUpdate:g,shared:o.shared,callbacks:o.callbacks},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=n:e.next=n,a.lastBaseUpdate=n}var uc=!1;function La(){if(uc){var e=ks;if(e!==null)throw e}}function ka(e,n,a,o){uc=!1;var d=e.updateQueue;bn=!1;var g=d.firstBaseUpdate,v=d.lastBaseUpdate,_=d.shared.pending;if(_!==null){d.shared.pending=null;var M=_,F=M.next;M.next=null,v===null?g=F:v.next=F,v=M;var V=e.alternate;V!==null&&(V=V.updateQueue,_=V.lastBaseUpdate,_!==v&&(_===null?V.firstBaseUpdate=F:_.next=F,V.lastBaseUpdate=M))}if(g!==null){var Y=d.baseState;v=0,V=F=M=null,_=g;do{var j=_.lane&-536870913,H=j!==_.lane;if(H?(Mt&j)===j:(o&j)===j){j!==0&&j===Ls&&(uc=!0),V!==null&&(V=V.next={lane:0,tag:_.tag,payload:_.payload,callback:null,next:null});t:{var nt=e,dt=_;j=n;var It=a;switch(dt.tag){case 1:if(nt=dt.payload,typeof nt=="function"){Y=nt.call(It,Y,j);break t}Y=nt;break t;case 3:nt.flags=nt.flags&-65537|128;case 0:if(nt=dt.payload,j=typeof nt=="function"?nt.call(It,Y,j):nt,j==null)break t;Y=y({},Y,j);break t;case 2:bn=!0}}j=_.callback,j!==null&&(e.flags|=64,H&&(e.flags|=8192),H=d.callbacks,H===null?d.callbacks=[j]:H.push(j))}else H={lane:j,tag:_.tag,payload:_.payload,callback:_.callback,next:null},V===null?(F=V=H,M=Y):V=V.next=H,v|=j;if(_=_.next,_===null){if(_=d.shared.pending,_===null)break;H=_,_=H.next,H.next=null,d.lastBaseUpdate=H,d.shared.pending=null}}while(!0);V===null&&(M=Y),d.baseState=M,d.firstBaseUpdate=F,d.lastBaseUpdate=V,g===null&&(d.shared.lanes=0),En|=v,e.lanes=v,e.memoizedState=Y}}function Pd(e,n){if(typeof e!="function")throw Error(s(191,e));e.call(n)}function Ud(e,n){var a=e.callbacks;if(a!==null)for(e.callbacks=null,e=0;e<a.length;e++)Pd(a[e],n)}var Ps=R(null),eo=R(0);function Fd(e,n){e=rn,K(eo,e),K(Ps,n),rn=e|n.baseLanes}function hc(){K(eo,rn),K(Ps,Ps.current)}function dc(){rn=eo.current,I(Ps),I(eo)}var ii=R(null),yi=null;function Sn(e){var n=e.alternate;K(ae,ae.current&1),K(ii,e),yi===null&&(n===null||Ps.current!==null||n.memoizedState!==null)&&(yi=e)}function fc(e){K(ae,ae.current),K(ii,e),yi===null&&(yi=e)}function jd(e){e.tag===22?(K(ae,ae.current),K(ii,e),yi===null&&(yi=e)):wn()}function wn(){K(ae,ae.current),K(ii,ii.current)}function ni(e){I(ii),yi===e&&(yi=null),I(ae)}var ae=R(0);function io(e){for(var n=e;n!==null;){if(n.tag===13){var a=n.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||vu(a)||Au(a)))return n}else if(n.tag===19&&(n.memoizedProps.revealOrder==="forwards"||n.memoizedProps.revealOrder==="backwards"||n.memoizedProps.revealOrder==="unstable_legacy-backwards"||n.memoizedProps.revealOrder==="together")){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var Zi=0,St=null,jt=null,ce=null,no=!1,Us=!1,ts=!1,so=0,Ba=0,Fs=null,tb=0;function ie(){throw Error(s(321))}function gc(e,n){if(n===null)return!1;for(var a=0;a<n.length&&a<e.length;a++)if(!ti(e[a],n[a]))return!1;return!0}function pc(e,n,a,o,d,g){return Zi=g,St=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,k.H=e===null||e.memoizedState===null?xf:Rc,ts=!1,g=a(o,d),ts=!1,Us&&(g=Id(n,a,o,d)),Hd(e),g}function Hd(e){k.H=Ua;var n=jt!==null&&jt.next!==null;if(Zi=0,ce=jt=St=null,no=!1,Ba=0,Fs=null,n)throw Error(s(300));e===null||ue||(e=e.dependencies,e!==null&&$r(e)&&(ue=!0))}function Id(e,n,a,o){St=e;var d=0;do{if(Us&&(Fs=null),Ba=0,Us=!1,25<=d)throw Error(s(301));if(d+=1,ce=jt=null,e.updateQueue!=null){var g=e.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}k.H=Ef,g=n(a,o)}while(Us);return g}function eb(){var e=k.H,n=e.useState()[0];return n=typeof n.then=="function"?za(n):n,e=e.useState()[0],(jt!==null?jt.memoizedState:null)!==e&&(St.flags|=1024),n}function mc(){var e=so!==0;return so=0,e}function yc(e,n,a){n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~a}function bc(e){if(no){for(e=e.memoizedState;e!==null;){var n=e.queue;n!==null&&(n.pending=null),e=e.next}no=!1}Zi=0,ce=jt=St=null,Us=!1,Ba=so=0,Fs=null}function Be(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ce===null?St.memoizedState=ce=e:ce=ce.next=e,ce}function re(){if(jt===null){var e=St.alternate;e=e!==null?e.memoizedState:null}else e=jt.next;var n=ce===null?St.memoizedState:ce.next;if(n!==null)ce=n,jt=e;else{if(e===null)throw St.alternate===null?Error(s(467)):Error(s(310));jt=e,e={memoizedState:jt.memoizedState,baseState:jt.baseState,baseQueue:jt.baseQueue,queue:jt.queue,next:null},ce===null?St.memoizedState=ce=e:ce=ce.next=e}return ce}function ao(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function za(e){var n=Ba;return Ba+=1,Fs===null&&(Fs=[]),e=Od(Fs,e,n),n=St,(ce===null?n.memoizedState:ce.next)===null&&(n=n.alternate,k.H=n===null||n.memoizedState===null?xf:Rc),e}function ro(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return za(e);if(e.$$typeof===T)return _e(e)}throw Error(s(438,String(e)))}function vc(e){var n=null,a=St.updateQueue;if(a!==null&&(n=a.memoCache),n==null){var o=St.alternate;o!==null&&(o=o.updateQueue,o!==null&&(o=o.memoCache,o!=null&&(n={data:o.data.map(function(d){return d.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),a===null&&(a=ao(),St.updateQueue=a),a.memoCache=n,a=n.data[n.index],a===void 0)for(a=n.data[n.index]=Array(e),o=0;o<e;o++)a[o]=tt;return n.index++,a}function Wi(e,n){return typeof n=="function"?n(e):n}function oo(e){var n=re();return Ac(n,jt,e)}function Ac(e,n,a){var o=e.queue;if(o===null)throw Error(s(311));o.lastRenderedReducer=a;var d=e.baseQueue,g=o.pending;if(g!==null){if(d!==null){var v=d.next;d.next=g.next,g.next=v}n.baseQueue=d=g,o.pending=null}if(g=e.baseState,d===null)e.memoizedState=g;else{n=d.next;var _=v=null,M=null,F=n,V=!1;do{var Y=F.lane&-536870913;if(Y!==F.lane?(Mt&Y)===Y:(Zi&Y)===Y){var j=F.revertLane;if(j===0)M!==null&&(M=M.next={lane:0,revertLane:0,gesture:null,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null}),Y===Ls&&(V=!0);else if((Zi&j)===j){F=F.next,j===Ls&&(V=!0);continue}else Y={lane:0,revertLane:F.revertLane,gesture:null,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null},M===null?(_=M=Y,v=g):M=M.next=Y,St.lanes|=j,En|=j;Y=F.action,ts&&a(g,Y),g=F.hasEagerState?F.eagerState:a(g,Y)}else j={lane:Y,revertLane:F.revertLane,gesture:F.gesture,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null},M===null?(_=M=j,v=g):M=M.next=j,St.lanes|=Y,En|=Y;F=F.next}while(F!==null&&F!==n);if(M===null?v=g:M.next=_,!ti(g,e.memoizedState)&&(ue=!0,V&&(a=ks,a!==null)))throw a;e.memoizedState=g,e.baseState=v,e.baseQueue=M,o.lastRenderedState=g}return d===null&&(o.lanes=0),[e.memoizedState,o.dispatch]}function Sc(e){var n=re(),a=n.queue;if(a===null)throw Error(s(311));a.lastRenderedReducer=e;var o=a.dispatch,d=a.pending,g=n.memoizedState;if(d!==null){a.pending=null;var v=d=d.next;do g=e(g,v.action),v=v.next;while(v!==d);ti(g,n.memoizedState)||(ue=!0),n.memoizedState=g,n.baseQueue===null&&(n.baseState=g),a.lastRenderedState=g}return[g,o]}function Gd(e,n,a){var o=St,d=re(),g=Rt;if(g){if(a===void 0)throw Error(s(407));a=a()}else a=n();var v=!ti((jt||d).memoizedState,a);if(v&&(d.memoizedState=a,ue=!0),d=d.queue,xc(Xd.bind(null,o,d,e),[e]),d.getSnapshot!==n||v||ce!==null&&ce.memoizedState.tag&1){if(o.flags|=2048,js(9,{destroy:void 0},Vd.bind(null,o,d,a,n),null),qt===null)throw Error(s(349));g||(Zi&127)!==0||qd(o,n,a)}return a}function qd(e,n,a){e.flags|=16384,e={getSnapshot:n,value:a},n=St.updateQueue,n===null?(n=ao(),St.updateQueue=n,n.stores=[e]):(a=n.stores,a===null?n.stores=[e]:a.push(e))}function Vd(e,n,a,o){n.value=a,n.getSnapshot=o,Yd(n)&&$d(e)}function Xd(e,n,a){return a(function(){Yd(n)&&$d(e)})}function Yd(e){var n=e.getSnapshot;e=e.value;try{var a=n();return!ti(e,a)}catch{return!0}}function $d(e){var n=Vn(e,2);n!==null&&Ye(n,e,2)}function wc(e){var n=Be();if(typeof e=="function"){var a=e;if(e=a(),ts){Re(!0);try{a()}finally{Re(!1)}}}return n.memoizedState=n.baseState=e,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wi,lastRenderedState:e},n}function Kd(e,n,a,o){return e.baseState=a,Ac(e,jt,typeof o=="function"?o:Wi)}function ib(e,n,a,o,d){if(uo(e))throw Error(s(485));if(e=n.action,e!==null){var g={payload:d,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){g.listeners.push(v)}};k.T!==null?a(!0):g.isTransition=!1,o(g),a=n.pending,a===null?(g.next=n.pending=g,Qd(n,g)):(g.next=a.next,n.pending=a.next=g)}}function Qd(e,n){var a=n.action,o=n.payload,d=e.state;if(n.isTransition){var g=k.T,v={};k.T=v;try{var _=a(d,o),M=k.S;M!==null&&M(v,_),Zd(e,n,_)}catch(F){_c(e,n,F)}finally{g!==null&&v.types!==null&&(g.types=v.types),k.T=g}}else try{g=a(d,o),Zd(e,n,g)}catch(F){_c(e,n,F)}}function Zd(e,n,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(o){Wd(e,n,o)},function(o){return _c(e,n,o)}):Wd(e,n,a)}function Wd(e,n,a){n.status="fulfilled",n.value=a,Jd(n),e.state=a,n=e.pending,n!==null&&(a=n.next,a===n?e.pending=null:(a=a.next,n.next=a,Qd(e,a)))}function _c(e,n,a){var o=e.pending;if(e.pending=null,o!==null){o=o.next;do n.status="rejected",n.reason=a,Jd(n),n=n.next;while(n!==o)}e.action=null}function Jd(e){e=e.listeners;for(var n=0;n<e.length;n++)(0,e[n])()}function tf(e,n){return n}function ef(e,n){if(Rt){var a=qt.formState;if(a!==null){t:{var o=St;if(Rt){if(Xt){e:{for(var d=Xt,g=mi;d.nodeType!==8;){if(!g){d=null;break e}if(d=bi(d.nextSibling),d===null){d=null;break e}}g=d.data,d=g==="F!"||g==="F"?d:null}if(d){Xt=bi(d.nextSibling),o=d.data==="F!";break t}}mn(o)}o=!1}o&&(n=a[0])}}return a=Be(),a.memoizedState=a.baseState=n,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:tf,lastRenderedState:n},a.queue=o,a=Sf.bind(null,St,o),o.dispatch=a,o=wc(!1),g=Dc.bind(null,St,!1,o.queue),o=Be(),d={state:n,dispatch:null,action:e,pending:null},o.queue=d,a=ib.bind(null,St,d,g,a),d.dispatch=a,o.memoizedState=e,[n,a,!1]}function nf(e){var n=re();return sf(n,jt,e)}function sf(e,n,a){if(n=Ac(e,n,tf)[0],e=oo(Wi)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var o=za(n)}catch(v){throw v===Bs?Zr:v}else o=n;n=re();var d=n.queue,g=d.dispatch;return a!==n.memoizedState&&(St.flags|=2048,js(9,{destroy:void 0},nb.bind(null,d,a),null)),[o,g,e]}function nb(e,n){e.action=n}function af(e){var n=re(),a=jt;if(a!==null)return sf(n,a,e);re(),n=n.memoizedState,a=re();var o=a.queue.dispatch;return a.memoizedState=e,[n,o,!1]}function js(e,n,a,o){return e={tag:e,create:a,deps:o,inst:n,next:null},n=St.updateQueue,n===null&&(n=ao(),St.updateQueue=n),a=n.lastEffect,a===null?n.lastEffect=e.next=e:(o=a.next,a.next=e,e.next=o,n.lastEffect=e),e}function rf(){return re().memoizedState}function lo(e,n,a,o){var d=Be();St.flags|=e,d.memoizedState=js(1|n,{destroy:void 0},a,o===void 0?null:o)}function co(e,n,a,o){var d=re();o=o===void 0?null:o;var g=d.memoizedState.inst;jt!==null&&o!==null&&gc(o,jt.memoizedState.deps)?d.memoizedState=js(n,g,a,o):(St.flags|=e,d.memoizedState=js(1|n,g,a,o))}function of(e,n){lo(8390656,8,e,n)}function xc(e,n){co(2048,8,e,n)}function sb(e){St.flags|=4;var n=St.updateQueue;if(n===null)n=ao(),St.updateQueue=n,n.events=[e];else{var a=n.events;a===null?n.events=[e]:a.push(e)}}function lf(e){var n=re().memoizedState;return sb({ref:n,nextImpl:e}),function(){if((Bt&2)!==0)throw Error(s(440));return n.impl.apply(void 0,arguments)}}function cf(e,n){return co(4,2,e,n)}function uf(e,n){return co(4,4,e,n)}function hf(e,n){if(typeof n=="function"){e=e();var a=n(e);return function(){typeof a=="function"?a():n(null)}}if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function df(e,n,a){a=a!=null?a.concat([e]):null,co(4,4,hf.bind(null,n,e),a)}function Ec(){}function ff(e,n){var a=re();n=n===void 0?null:n;var o=a.memoizedState;return n!==null&&gc(n,o[1])?o[0]:(a.memoizedState=[e,n],e)}function gf(e,n){var a=re();n=n===void 0?null:n;var o=a.memoizedState;if(n!==null&&gc(n,o[1]))return o[0];if(o=e(),ts){Re(!0);try{e()}finally{Re(!1)}}return a.memoizedState=[o,n],o}function Tc(e,n,a){return a===void 0||(Zi&1073741824)!==0&&(Mt&261930)===0?e.memoizedState=n:(e.memoizedState=a,e=pg(),St.lanes|=e,En|=e,a)}function pf(e,n,a,o){return ti(a,n)?a:Ps.current!==null?(e=Tc(e,a,o),ti(e,n)||(ue=!0),e):(Zi&42)===0||(Zi&1073741824)!==0&&(Mt&261930)===0?(ue=!0,e.memoizedState=a):(e=pg(),St.lanes|=e,En|=e,n)}function mf(e,n,a,o,d){var g=q.p;q.p=g!==0&&8>g?g:8;var v=k.T,_={};k.T=_,Dc(e,!1,n,a);try{var M=d(),F=k.S;if(F!==null&&F(_,M),M!==null&&typeof M=="object"&&typeof M.then=="function"){var V=Jy(M,o);Pa(e,n,V,ri(e))}else Pa(e,n,o,ri(e))}catch(Y){Pa(e,n,{then:function(){},status:"rejected",reason:Y},ri())}finally{q.p=g,v!==null&&_.types!==null&&(v.types=_.types),k.T=v}}function ab(){}function Cc(e,n,a,o){if(e.tag!==5)throw Error(s(476));var d=yf(e).queue;mf(e,d,n,Z,a===null?ab:function(){return bf(e),a(o)})}function yf(e){var n=e.memoizedState;if(n!==null)return n;n={memoizedState:Z,baseState:Z,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wi,lastRenderedState:Z},next:null};var a={};return n.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wi,lastRenderedState:a},next:null},e.memoizedState=n,e=e.alternate,e!==null&&(e.memoizedState=n),n}function bf(e){var n=yf(e);n.next===null&&(n=e.alternate.memoizedState),Pa(e,n.next.queue,{},ri())}function Mc(){return _e(tr)}function vf(){return re().memoizedState}function Af(){return re().memoizedState}function rb(e){for(var n=e.return;n!==null;){switch(n.tag){case 24:case 3:var a=ri();e=vn(a);var o=An(n,e,a);o!==null&&(Ye(o,n,a),Oa(o,n,a)),n={cache:nc()},e.payload=n;return}n=n.return}}function ob(e,n,a){var o=ri();a={lane:o,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},uo(e)?wf(n,a):(a=Xl(e,n,a,o),a!==null&&(Ye(a,e,o),_f(a,n,o)))}function Sf(e,n,a){var o=ri();Pa(e,n,a,o)}function Pa(e,n,a,o){var d={lane:o,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(uo(e))wf(n,d);else{var g=e.alternate;if(e.lanes===0&&(g===null||g.lanes===0)&&(g=n.lastRenderedReducer,g!==null))try{var v=n.lastRenderedState,_=g(v,a);if(d.hasEagerState=!0,d.eagerState=_,ti(_,v))return qr(e,n,d,0),qt===null&&Gr(),!1}catch{}finally{}if(a=Xl(e,n,d,o),a!==null)return Ye(a,e,o),_f(a,n,o),!0}return!1}function Dc(e,n,a,o){if(o={lane:2,revertLane:ou(),gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},uo(e)){if(n)throw Error(s(479))}else n=Xl(e,a,o,2),n!==null&&Ye(n,e,2)}function uo(e){var n=e.alternate;return e===St||n!==null&&n===St}function wf(e,n){Us=no=!0;var a=e.pending;a===null?n.next=n:(n.next=a.next,a.next=n),e.pending=n}function _f(e,n,a){if((a&4194048)!==0){var o=n.lanes;o&=e.pendingLanes,a|=o,n.lanes=a,Ch(e,a)}}var Ua={readContext:_e,use:ro,useCallback:ie,useContext:ie,useEffect:ie,useImperativeHandle:ie,useLayoutEffect:ie,useInsertionEffect:ie,useMemo:ie,useReducer:ie,useRef:ie,useState:ie,useDebugValue:ie,useDeferredValue:ie,useTransition:ie,useSyncExternalStore:ie,useId:ie,useHostTransitionStatus:ie,useFormState:ie,useActionState:ie,useOptimistic:ie,useMemoCache:ie,useCacheRefresh:ie};Ua.useEffectEvent=ie;var xf={readContext:_e,use:ro,useCallback:function(e,n){return Be().memoizedState=[e,n===void 0?null:n],e},useContext:_e,useEffect:of,useImperativeHandle:function(e,n,a){a=a!=null?a.concat([e]):null,lo(4194308,4,hf.bind(null,n,e),a)},useLayoutEffect:function(e,n){return lo(4194308,4,e,n)},useInsertionEffect:function(e,n){lo(4,2,e,n)},useMemo:function(e,n){var a=Be();n=n===void 0?null:n;var o=e();if(ts){Re(!0);try{e()}finally{Re(!1)}}return a.memoizedState=[o,n],o},useReducer:function(e,n,a){var o=Be();if(a!==void 0){var d=a(n);if(ts){Re(!0);try{a(n)}finally{Re(!1)}}}else d=n;return o.memoizedState=o.baseState=d,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:d},o.queue=e,e=e.dispatch=ob.bind(null,St,e),[o.memoizedState,e]},useRef:function(e){var n=Be();return e={current:e},n.memoizedState=e},useState:function(e){e=wc(e);var n=e.queue,a=Sf.bind(null,St,n);return n.dispatch=a,[e.memoizedState,a]},useDebugValue:Ec,useDeferredValue:function(e,n){var a=Be();return Tc(a,e,n)},useTransition:function(){var e=wc(!1);return e=mf.bind(null,St,e.queue,!0,!1),Be().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,n,a){var o=St,d=Be();if(Rt){if(a===void 0)throw Error(s(407));a=a()}else{if(a=n(),qt===null)throw Error(s(349));(Mt&127)!==0||qd(o,n,a)}d.memoizedState=a;var g={value:a,getSnapshot:n};return d.queue=g,of(Xd.bind(null,o,g,e),[e]),o.flags|=2048,js(9,{destroy:void 0},Vd.bind(null,o,g,a,n),null),a},useId:function(){var e=Be(),n=qt.identifierPrefix;if(Rt){var a=ki,o=Li;a=(o&~(1<<32-ke(o)-1)).toString(32)+a,n="_"+n+"R_"+a,a=so++,0<a&&(n+="H"+a.toString(32)),n+="_"}else a=tb++,n="_"+n+"r_"+a.toString(32)+"_";return e.memoizedState=n},useHostTransitionStatus:Mc,useFormState:ef,useActionState:ef,useOptimistic:function(e){var n=Be();n.memoizedState=n.baseState=e;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=a,n=Dc.bind(null,St,!0,a),a.dispatch=n,[e,n]},useMemoCache:vc,useCacheRefresh:function(){return Be().memoizedState=rb.bind(null,St)},useEffectEvent:function(e){var n=Be(),a={impl:e};return n.memoizedState=a,function(){if((Bt&2)!==0)throw Error(s(440));return a.impl.apply(void 0,arguments)}}},Rc={readContext:_e,use:ro,useCallback:ff,useContext:_e,useEffect:xc,useImperativeHandle:df,useInsertionEffect:cf,useLayoutEffect:uf,useMemo:gf,useReducer:oo,useRef:rf,useState:function(){return oo(Wi)},useDebugValue:Ec,useDeferredValue:function(e,n){var a=re();return pf(a,jt.memoizedState,e,n)},useTransition:function(){var e=oo(Wi)[0],n=re().memoizedState;return[typeof e=="boolean"?e:za(e),n]},useSyncExternalStore:Gd,useId:vf,useHostTransitionStatus:Mc,useFormState:nf,useActionState:nf,useOptimistic:function(e,n){var a=re();return Kd(a,jt,e,n)},useMemoCache:vc,useCacheRefresh:Af};Rc.useEffectEvent=lf;var Ef={readContext:_e,use:ro,useCallback:ff,useContext:_e,useEffect:xc,useImperativeHandle:df,useInsertionEffect:cf,useLayoutEffect:uf,useMemo:gf,useReducer:Sc,useRef:rf,useState:function(){return Sc(Wi)},useDebugValue:Ec,useDeferredValue:function(e,n){var a=re();return jt===null?Tc(a,e,n):pf(a,jt.memoizedState,e,n)},useTransition:function(){var e=Sc(Wi)[0],n=re().memoizedState;return[typeof e=="boolean"?e:za(e),n]},useSyncExternalStore:Gd,useId:vf,useHostTransitionStatus:Mc,useFormState:af,useActionState:af,useOptimistic:function(e,n){var a=re();return jt!==null?Kd(a,jt,e,n):(a.baseState=e,[e,a.queue.dispatch])},useMemoCache:vc,useCacheRefresh:Af};Ef.useEffectEvent=lf;function Nc(e,n,a,o){n=e.memoizedState,a=a(o,n),a=a==null?n:y({},n,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var Oc={enqueueSetState:function(e,n,a){e=e._reactInternals;var o=ri(),d=vn(o);d.payload=n,a!=null&&(d.callback=a),n=An(e,d,o),n!==null&&(Ye(n,e,o),Oa(n,e,o))},enqueueReplaceState:function(e,n,a){e=e._reactInternals;var o=ri(),d=vn(o);d.tag=1,d.payload=n,a!=null&&(d.callback=a),n=An(e,d,o),n!==null&&(Ye(n,e,o),Oa(n,e,o))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var a=ri(),o=vn(a);o.tag=2,n!=null&&(o.callback=n),n=An(e,o,a),n!==null&&(Ye(n,e,a),Oa(n,e,a))}};function Tf(e,n,a,o,d,g,v){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,g,v):n.prototype&&n.prototype.isPureReactComponent?!xa(a,o)||!xa(d,g):!0}function Cf(e,n,a,o){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(a,o),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(a,o),n.state!==e&&Oc.enqueueReplaceState(n,n.state,null)}function es(e,n){var a=n;if("ref"in n){a={};for(var o in n)o!=="ref"&&(a[o]=n[o])}if(e=e.defaultProps){a===n&&(a=y({},a));for(var d in e)a[d]===void 0&&(a[d]=e[d])}return a}function Mf(e){Ir(e)}function Df(e){console.error(e)}function Rf(e){Ir(e)}function ho(e,n){try{var a=e.onUncaughtError;a(n.value,{componentStack:n.stack})}catch(o){setTimeout(function(){throw o})}}function Nf(e,n,a){try{var o=e.onCaughtError;o(a.value,{componentStack:a.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(d){setTimeout(function(){throw d})}}function Lc(e,n,a){return a=vn(a),a.tag=3,a.payload={element:null},a.callback=function(){ho(e,n)},a}function Of(e){return e=vn(e),e.tag=3,e}function Lf(e,n,a,o){var d=a.type.getDerivedStateFromError;if(typeof d=="function"){var g=o.value;e.payload=function(){return d(g)},e.callback=function(){Nf(n,a,o)}}var v=a.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(e.callback=function(){Nf(n,a,o),typeof d!="function"&&(Tn===null?Tn=new Set([this]):Tn.add(this));var _=o.stack;this.componentDidCatch(o.value,{componentStack:_!==null?_:""})})}function lb(e,n,a,o,d){if(a.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){if(n=a.alternate,n!==null&&Os(n,a,d,!0),a=ii.current,a!==null){switch(a.tag){case 31:case 13:return yi===null?xo():a.alternate===null&&ne===0&&(ne=3),a.flags&=-257,a.flags|=65536,a.lanes=d,o===Wr?a.flags|=16384:(n=a.updateQueue,n===null?a.updateQueue=new Set([o]):n.add(o),su(e,o,d)),!1;case 22:return a.flags|=65536,o===Wr?a.flags|=16384:(n=a.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([o])},a.updateQueue=n):(a=n.retryQueue,a===null?n.retryQueue=new Set([o]):a.add(o)),su(e,o,d)),!1}throw Error(s(435,a.tag))}return su(e,o,d),xo(),!1}if(Rt)return n=ii.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=d,o!==Wl&&(e=Error(s(422),{cause:o}),Ca(fi(e,a)))):(o!==Wl&&(n=Error(s(423),{cause:o}),Ca(fi(n,a))),e=e.current.alternate,e.flags|=65536,d&=-d,e.lanes|=d,o=fi(o,a),d=Lc(e.stateNode,o,d),cc(e,d),ne!==4&&(ne=2)),!1;var g=Error(s(520),{cause:o});if(g=fi(g,a),Xa===null?Xa=[g]:Xa.push(g),ne!==4&&(ne=2),n===null)return!0;o=fi(o,a),a=n;do{switch(a.tag){case 3:return a.flags|=65536,e=d&-d,a.lanes|=e,e=Lc(a.stateNode,o,e),cc(a,e),!1;case 1:if(n=a.type,g=a.stateNode,(a.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Tn===null||!Tn.has(g))))return a.flags|=65536,d&=-d,a.lanes|=d,d=Of(d),Lf(d,e,a,o),cc(a,d),!1}a=a.return}while(a!==null);return!1}var kc=Error(s(461)),ue=!1;function xe(e,n,a,o){n.child=e===null?zd(n,null,a,o):Jn(n,e.child,a,o)}function kf(e,n,a,o,d){a=a.render;var g=n.ref;if("ref"in o){var v={};for(var _ in o)_!=="ref"&&(v[_]=o[_])}else v=o;return Kn(n),o=pc(e,n,a,v,g,d),_=mc(),e!==null&&!ue?(yc(e,n,d),Ji(e,n,d)):(Rt&&_&&Ql(n),n.flags|=1,xe(e,n,o,d),n.child)}function Bf(e,n,a,o,d){if(e===null){var g=a.type;return typeof g=="function"&&!Yl(g)&&g.defaultProps===void 0&&a.compare===null?(n.tag=15,n.type=g,zf(e,n,g,o,d)):(e=Xr(a.type,null,o,n,n.mode,d),e.ref=n.ref,e.return=n,n.child=e)}if(g=e.child,!Ic(e,d)){var v=g.memoizedProps;if(a=a.compare,a=a!==null?a:xa,a(v,o)&&e.ref===n.ref)return Ji(e,n,d)}return n.flags|=1,e=Yi(g,o),e.ref=n.ref,e.return=n,n.child=e}function zf(e,n,a,o,d){if(e!==null){var g=e.memoizedProps;if(xa(g,o)&&e.ref===n.ref)if(ue=!1,n.pendingProps=o=g,Ic(e,d))(e.flags&131072)!==0&&(ue=!0);else return n.lanes=e.lanes,Ji(e,n,d)}return Bc(e,n,a,o,d)}function Pf(e,n,a,o){var d=o.children,g=e!==null?e.memoizedState:null;if(e===null&&n.stateNode===null&&(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.mode==="hidden"){if((n.flags&128)!==0){if(g=g!==null?g.baseLanes|a:a,e!==null){for(o=n.child=e.child,d=0;o!==null;)d=d|o.lanes|o.childLanes,o=o.sibling;o=d&~g}else o=0,n.child=null;return Uf(e,n,g,a,o)}if((a&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},e!==null&&Qr(n,g!==null?g.cachePool:null),g!==null?Fd(n,g):hc(),jd(n);else return o=n.lanes=536870912,Uf(e,n,g!==null?g.baseLanes|a:a,a,o)}else g!==null?(Qr(n,g.cachePool),Fd(n,g),wn(),n.memoizedState=null):(e!==null&&Qr(n,null),hc(),wn());return xe(e,n,d,a),n.child}function Fa(e,n){return e!==null&&e.tag===22||n.stateNode!==null||(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.sibling}function Uf(e,n,a,o,d){var g=ac();return g=g===null?null:{parent:le._currentValue,pool:g},n.memoizedState={baseLanes:a,cachePool:g},e!==null&&Qr(n,null),hc(),jd(n),e!==null&&Os(e,n,o,!0),n.childLanes=d,null}function fo(e,n){return n=po({mode:n.mode,children:n.children},e.mode),n.ref=e.ref,e.child=n,n.return=e,n}function Ff(e,n,a){return Jn(n,e.child,null,a),e=fo(n,n.pendingProps),e.flags|=2,ni(n),n.memoizedState=null,e}function cb(e,n,a){var o=n.pendingProps,d=(n.flags&128)!==0;if(n.flags&=-129,e===null){if(Rt){if(o.mode==="hidden")return e=fo(n,o),n.lanes=536870912,Fa(null,e);if(fc(n),(e=Xt)?(e=Zg(e,mi),e=e!==null&&e.data==="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:gn!==null?{id:Li,overflow:ki}:null,retryLane:536870912,hydrationErrors:null},a=Sd(e),a.return=n,n.child=a,we=n,Xt=null)):e=null,e===null)throw mn(n);return n.lanes=536870912,null}return fo(n,o)}var g=e.memoizedState;if(g!==null){var v=g.dehydrated;if(fc(n),d)if(n.flags&256)n.flags&=-257,n=Ff(e,n,a);else if(n.memoizedState!==null)n.child=e.child,n.flags|=128,n=null;else throw Error(s(558));else if(ue||Os(e,n,a,!1),d=(a&e.childLanes)!==0,ue||d){if(o=qt,o!==null&&(v=Mh(o,a),v!==0&&v!==g.retryLane))throw g.retryLane=v,Vn(e,v),Ye(o,e,v),kc;xo(),n=Ff(e,n,a)}else e=g.treeContext,Xt=bi(v.nextSibling),we=n,Rt=!0,pn=null,mi=!1,e!==null&&xd(n,e),n=fo(n,o),n.flags|=4096;return n}return e=Yi(e.child,{mode:o.mode,children:o.children}),e.ref=n.ref,n.child=e,e.return=n,e}function go(e,n){var a=n.ref;if(a===null)e!==null&&e.ref!==null&&(n.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(s(284));(e===null||e.ref!==a)&&(n.flags|=4194816)}}function Bc(e,n,a,o,d){return Kn(n),a=pc(e,n,a,o,void 0,d),o=mc(),e!==null&&!ue?(yc(e,n,d),Ji(e,n,d)):(Rt&&o&&Ql(n),n.flags|=1,xe(e,n,a,d),n.child)}function jf(e,n,a,o,d,g){return Kn(n),n.updateQueue=null,a=Id(n,o,a,d),Hd(e),o=mc(),e!==null&&!ue?(yc(e,n,g),Ji(e,n,g)):(Rt&&o&&Ql(n),n.flags|=1,xe(e,n,a,g),n.child)}function Hf(e,n,a,o,d){if(Kn(n),n.stateNode===null){var g=Ms,v=a.contextType;typeof v=="object"&&v!==null&&(g=_e(v)),g=new a(o,g),n.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Oc,n.stateNode=g,g._reactInternals=n,g=n.stateNode,g.props=o,g.state=n.memoizedState,g.refs={},oc(n),v=a.contextType,g.context=typeof v=="object"&&v!==null?_e(v):Ms,g.state=n.memoizedState,v=a.getDerivedStateFromProps,typeof v=="function"&&(Nc(n,a,v,o),g.state=n.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(v=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),v!==g.state&&Oc.enqueueReplaceState(g,g.state,null),ka(n,o,g,d),La(),g.state=n.memoizedState),typeof g.componentDidMount=="function"&&(n.flags|=4194308),o=!0}else if(e===null){g=n.stateNode;var _=n.memoizedProps,M=es(a,_);g.props=M;var F=g.context,V=a.contextType;v=Ms,typeof V=="object"&&V!==null&&(v=_e(V));var Y=a.getDerivedStateFromProps;V=typeof Y=="function"||typeof g.getSnapshotBeforeUpdate=="function",_=n.pendingProps!==_,V||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(_||F!==v)&&Cf(n,g,o,v),bn=!1;var j=n.memoizedState;g.state=j,ka(n,o,g,d),La(),F=n.memoizedState,_||j!==F||bn?(typeof Y=="function"&&(Nc(n,a,Y,o),F=n.memoizedState),(M=bn||Tf(n,a,M,o,j,F,v))?(V||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(n.flags|=4194308)):(typeof g.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=o,n.memoizedState=F),g.props=o,g.state=F,g.context=v,o=M):(typeof g.componentDidMount=="function"&&(n.flags|=4194308),o=!1)}else{g=n.stateNode,lc(e,n),v=n.memoizedProps,V=es(a,v),g.props=V,Y=n.pendingProps,j=g.context,F=a.contextType,M=Ms,typeof F=="object"&&F!==null&&(M=_e(F)),_=a.getDerivedStateFromProps,(F=typeof _=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(v!==Y||j!==M)&&Cf(n,g,o,M),bn=!1,j=n.memoizedState,g.state=j,ka(n,o,g,d),La();var H=n.memoizedState;v!==Y||j!==H||bn||e!==null&&e.dependencies!==null&&$r(e.dependencies)?(typeof _=="function"&&(Nc(n,a,_,o),H=n.memoizedState),(V=bn||Tf(n,a,V,o,j,H,M)||e!==null&&e.dependencies!==null&&$r(e.dependencies))?(F||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(o,H,M),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(o,H,M)),typeof g.componentDidUpdate=="function"&&(n.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof g.componentDidUpdate!="function"||v===e.memoizedProps&&j===e.memoizedState||(n.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&j===e.memoizedState||(n.flags|=1024),n.memoizedProps=o,n.memoizedState=H),g.props=o,g.state=H,g.context=M,o=V):(typeof g.componentDidUpdate!="function"||v===e.memoizedProps&&j===e.memoizedState||(n.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&j===e.memoizedState||(n.flags|=1024),o=!1)}return g=o,go(e,n),o=(n.flags&128)!==0,g||o?(g=n.stateNode,a=o&&typeof a.getDerivedStateFromError!="function"?null:g.render(),n.flags|=1,e!==null&&o?(n.child=Jn(n,e.child,null,d),n.child=Jn(n,null,a,d)):xe(e,n,a,d),n.memoizedState=g.state,e=n.child):e=Ji(e,n,d),e}function If(e,n,a,o){return Yn(),n.flags|=256,xe(e,n,a,o),n.child}var zc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Pc(e){return{baseLanes:e,cachePool:Rd()}}function Uc(e,n,a){return e=e!==null?e.childLanes&~a:0,n&&(e|=ai),e}function Gf(e,n,a){var o=n.pendingProps,d=!1,g=(n.flags&128)!==0,v;if((v=g)||(v=e!==null&&e.memoizedState===null?!1:(ae.current&2)!==0),v&&(d=!0,n.flags&=-129),v=(n.flags&32)!==0,n.flags&=-33,e===null){if(Rt){if(d?Sn(n):wn(),(e=Xt)?(e=Zg(e,mi),e=e!==null&&e.data!=="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:gn!==null?{id:Li,overflow:ki}:null,retryLane:536870912,hydrationErrors:null},a=Sd(e),a.return=n,n.child=a,we=n,Xt=null)):e=null,e===null)throw mn(n);return Au(e)?n.lanes=32:n.lanes=536870912,null}var _=o.children;return o=o.fallback,d?(wn(),d=n.mode,_=po({mode:"hidden",children:_},d),o=Xn(o,d,a,null),_.return=n,o.return=n,_.sibling=o,n.child=_,o=n.child,o.memoizedState=Pc(a),o.childLanes=Uc(e,v,a),n.memoizedState=zc,Fa(null,o)):(Sn(n),Fc(n,_))}var M=e.memoizedState;if(M!==null&&(_=M.dehydrated,_!==null)){if(g)n.flags&256?(Sn(n),n.flags&=-257,n=jc(e,n,a)):n.memoizedState!==null?(wn(),n.child=e.child,n.flags|=128,n=null):(wn(),_=o.fallback,d=n.mode,o=po({mode:"visible",children:o.children},d),_=Xn(_,d,a,null),_.flags|=2,o.return=n,_.return=n,o.sibling=_,n.child=o,Jn(n,e.child,null,a),o=n.child,o.memoizedState=Pc(a),o.childLanes=Uc(e,v,a),n.memoizedState=zc,n=Fa(null,o));else if(Sn(n),Au(_)){if(v=_.nextSibling&&_.nextSibling.dataset,v)var F=v.dgst;v=F,o=Error(s(419)),o.stack="",o.digest=v,Ca({value:o,source:null,stack:null}),n=jc(e,n,a)}else if(ue||Os(e,n,a,!1),v=(a&e.childLanes)!==0,ue||v){if(v=qt,v!==null&&(o=Mh(v,a),o!==0&&o!==M.retryLane))throw M.retryLane=o,Vn(e,o),Ye(v,e,o),kc;vu(_)||xo(),n=jc(e,n,a)}else vu(_)?(n.flags|=192,n.child=e.child,n=null):(e=M.treeContext,Xt=bi(_.nextSibling),we=n,Rt=!0,pn=null,mi=!1,e!==null&&xd(n,e),n=Fc(n,o.children),n.flags|=4096);return n}return d?(wn(),_=o.fallback,d=n.mode,M=e.child,F=M.sibling,o=Yi(M,{mode:"hidden",children:o.children}),o.subtreeFlags=M.subtreeFlags&65011712,F!==null?_=Yi(F,_):(_=Xn(_,d,a,null),_.flags|=2),_.return=n,o.return=n,o.sibling=_,n.child=o,Fa(null,o),o=n.child,_=e.child.memoizedState,_===null?_=Pc(a):(d=_.cachePool,d!==null?(M=le._currentValue,d=d.parent!==M?{parent:M,pool:M}:d):d=Rd(),_={baseLanes:_.baseLanes|a,cachePool:d}),o.memoizedState=_,o.childLanes=Uc(e,v,a),n.memoizedState=zc,Fa(e.child,o)):(Sn(n),a=e.child,e=a.sibling,a=Yi(a,{mode:"visible",children:o.children}),a.return=n,a.sibling=null,e!==null&&(v=n.deletions,v===null?(n.deletions=[e],n.flags|=16):v.push(e)),n.child=a,n.memoizedState=null,a)}function Fc(e,n){return n=po({mode:"visible",children:n},e.mode),n.return=e,e.child=n}function po(e,n){return e=ei(22,e,null,n),e.lanes=0,e}function jc(e,n,a){return Jn(n,e.child,null,a),e=Fc(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function qf(e,n,a){e.lanes|=n;var o=e.alternate;o!==null&&(o.lanes|=n),ec(e.return,n,a)}function Hc(e,n,a,o,d,g){var v=e.memoizedState;v===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:o,tail:a,tailMode:d,treeForkCount:g}:(v.isBackwards=n,v.rendering=null,v.renderingStartTime=0,v.last=o,v.tail=a,v.tailMode=d,v.treeForkCount=g)}function Vf(e,n,a){var o=n.pendingProps,d=o.revealOrder,g=o.tail;o=o.children;var v=ae.current,_=(v&2)!==0;if(_?(v=v&1|2,n.flags|=128):v&=1,K(ae,v),xe(e,n,o,a),o=Rt?Ta:0,!_&&e!==null&&(e.flags&128)!==0)t:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&qf(e,a,n);else if(e.tag===19)qf(e,a,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break t;for(;e.sibling===null;){if(e.return===null||e.return===n)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(d){case"forwards":for(a=n.child,d=null;a!==null;)e=a.alternate,e!==null&&io(e)===null&&(d=a),a=a.sibling;a=d,a===null?(d=n.child,n.child=null):(d=a.sibling,a.sibling=null),Hc(n,!1,d,a,g,o);break;case"backwards":case"unstable_legacy-backwards":for(a=null,d=n.child,n.child=null;d!==null;){if(e=d.alternate,e!==null&&io(e)===null){n.child=d;break}e=d.sibling,d.sibling=a,a=d,d=e}Hc(n,!0,a,null,g,o);break;case"together":Hc(n,!1,null,null,void 0,o);break;default:n.memoizedState=null}return n.child}function Ji(e,n,a){if(e!==null&&(n.dependencies=e.dependencies),En|=n.lanes,(a&n.childLanes)===0)if(e!==null){if(Os(e,n,a,!1),(a&n.childLanes)===0)return null}else return null;if(e!==null&&n.child!==e.child)throw Error(s(153));if(n.child!==null){for(e=n.child,a=Yi(e,e.pendingProps),n.child=a,a.return=n;e.sibling!==null;)e=e.sibling,a=a.sibling=Yi(e,e.pendingProps),a.return=n;a.sibling=null}return n.child}function Ic(e,n){return(e.lanes&n)!==0?!0:(e=e.dependencies,!!(e!==null&&$r(e)))}function ub(e,n,a){switch(n.tag){case 3:$t(n,n.stateNode.containerInfo),yn(n,le,e.memoizedState.cache),Yn();break;case 27:case 5:ci(n);break;case 4:$t(n,n.stateNode.containerInfo);break;case 10:yn(n,n.type,n.memoizedProps.value);break;case 31:if(n.memoizedState!==null)return n.flags|=128,fc(n),null;break;case 13:var o=n.memoizedState;if(o!==null)return o.dehydrated!==null?(Sn(n),n.flags|=128,null):(a&n.child.childLanes)!==0?Gf(e,n,a):(Sn(n),e=Ji(e,n,a),e!==null?e.sibling:null);Sn(n);break;case 19:var d=(e.flags&128)!==0;if(o=(a&n.childLanes)!==0,o||(Os(e,n,a,!1),o=(a&n.childLanes)!==0),d){if(o)return Vf(e,n,a);n.flags|=128}if(d=n.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),K(ae,ae.current),o)break;return null;case 22:return n.lanes=0,Pf(e,n,a,n.pendingProps);case 24:yn(n,le,e.memoizedState.cache)}return Ji(e,n,a)}function Xf(e,n,a){if(e!==null)if(e.memoizedProps!==n.pendingProps)ue=!0;else{if(!Ic(e,a)&&(n.flags&128)===0)return ue=!1,ub(e,n,a);ue=(e.flags&131072)!==0}else ue=!1,Rt&&(n.flags&1048576)!==0&&_d(n,Ta,n.index);switch(n.lanes=0,n.tag){case 16:t:{var o=n.pendingProps;if(e=Zn(n.elementType),n.type=e,typeof e=="function")Yl(e)?(o=es(e,o),n.tag=1,n=Hf(null,n,e,o,a)):(n.tag=0,n=Bc(null,n,e,o,a));else{if(e!=null){var d=e.$$typeof;if(d===B){n.tag=11,n=kf(null,n,e,o,a);break t}else if(d===P){n.tag=14,n=Bf(null,n,e,o,a);break t}}throw n=ht(e)||e,Error(s(306,n,""))}}return n;case 0:return Bc(e,n,n.type,n.pendingProps,a);case 1:return o=n.type,d=es(o,n.pendingProps),Hf(e,n,o,d,a);case 3:t:{if($t(n,n.stateNode.containerInfo),e===null)throw Error(s(387));o=n.pendingProps;var g=n.memoizedState;d=g.element,lc(e,n),ka(n,o,null,a);var v=n.memoizedState;if(o=v.cache,yn(n,le,o),o!==g.cache&&ic(n,[le],a,!0),La(),o=v.element,g.isDehydrated)if(g={element:o,isDehydrated:!1,cache:v.cache},n.updateQueue.baseState=g,n.memoizedState=g,n.flags&256){n=If(e,n,o,a);break t}else if(o!==d){d=fi(Error(s(424)),n),Ca(d),n=If(e,n,o,a);break t}else{switch(e=n.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Xt=bi(e.firstChild),we=n,Rt=!0,pn=null,mi=!0,a=zd(n,null,o,a),n.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(Yn(),o===d){n=Ji(e,n,a);break t}xe(e,n,o,a)}n=n.child}return n;case 26:return go(e,n),e===null?(a=np(n.type,null,n.pendingProps,null))?n.memoizedState=a:Rt||(a=n.type,e=n.pendingProps,o=No(ft.current).createElement(a),o[Se]=n,o[He]=e,Ee(o,a,e),me(o),n.stateNode=o):n.memoizedState=np(n.type,e.memoizedProps,n.pendingProps,e.memoizedState),null;case 27:return ci(n),e===null&&Rt&&(o=n.stateNode=tp(n.type,n.pendingProps,ft.current),we=n,mi=!0,d=Xt,Rn(n.type)?(Su=d,Xt=bi(o.firstChild)):Xt=d),xe(e,n,n.pendingProps.children,a),go(e,n),e===null&&(n.flags|=4194304),n.child;case 5:return e===null&&Rt&&((d=o=Xt)&&(o=jb(o,n.type,n.pendingProps,mi),o!==null?(n.stateNode=o,we=n,Xt=bi(o.firstChild),mi=!1,d=!0):d=!1),d||mn(n)),ci(n),d=n.type,g=n.pendingProps,v=e!==null?e.memoizedProps:null,o=g.children,mu(d,g)?o=null:v!==null&&mu(d,v)&&(n.flags|=32),n.memoizedState!==null&&(d=pc(e,n,eb,null,null,a),tr._currentValue=d),go(e,n),xe(e,n,o,a),n.child;case 6:return e===null&&Rt&&((e=a=Xt)&&(a=Hb(a,n.pendingProps,mi),a!==null?(n.stateNode=a,we=n,Xt=null,e=!0):e=!1),e||mn(n)),null;case 13:return Gf(e,n,a);case 4:return $t(n,n.stateNode.containerInfo),o=n.pendingProps,e===null?n.child=Jn(n,null,o,a):xe(e,n,o,a),n.child;case 11:return kf(e,n,n.type,n.pendingProps,a);case 7:return xe(e,n,n.pendingProps,a),n.child;case 8:return xe(e,n,n.pendingProps.children,a),n.child;case 12:return xe(e,n,n.pendingProps.children,a),n.child;case 10:return o=n.pendingProps,yn(n,n.type,o.value),xe(e,n,o.children,a),n.child;case 9:return d=n.type._context,o=n.pendingProps.children,Kn(n),d=_e(d),o=o(d),n.flags|=1,xe(e,n,o,a),n.child;case 14:return Bf(e,n,n.type,n.pendingProps,a);case 15:return zf(e,n,n.type,n.pendingProps,a);case 19:return Vf(e,n,a);case 31:return cb(e,n,a);case 22:return Pf(e,n,a,n.pendingProps);case 24:return Kn(n),o=_e(le),e===null?(d=ac(),d===null&&(d=qt,g=nc(),d.pooledCache=g,g.refCount++,g!==null&&(d.pooledCacheLanes|=a),d=g),n.memoizedState={parent:o,cache:d},oc(n),yn(n,le,d)):((e.lanes&a)!==0&&(lc(e,n),ka(n,null,null,a),La()),d=e.memoizedState,g=n.memoizedState,d.parent!==o?(d={parent:o,cache:o},n.memoizedState=d,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=d),yn(n,le,o)):(o=g.cache,yn(n,le,o),o!==d.cache&&ic(n,[le],a,!0))),xe(e,n,n.pendingProps.children,a),n.child;case 29:throw n.pendingProps}throw Error(s(156,n.tag))}function tn(e){e.flags|=4}function Gc(e,n,a,o,d){if((n=(e.mode&32)!==0)&&(n=!1),n){if(e.flags|=16777216,(d&335544128)===d)if(e.stateNode.complete)e.flags|=8192;else if(vg())e.flags|=8192;else throw Wn=Wr,rc}else e.flags&=-16777217}function Yf(e,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!lp(n))if(vg())e.flags|=8192;else throw Wn=Wr,rc}function mo(e,n){n!==null&&(e.flags|=4),e.flags&16384&&(n=e.tag!==22?Eh():536870912,e.lanes|=n,qs|=n)}function ja(e,n){if(!Rt)switch(e.tailMode){case"hidden":n=e.tail;for(var a=null;n!==null;)n.alternate!==null&&(a=n),n=n.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function Yt(e){var n=e.alternate!==null&&e.alternate.child===e.child,a=0,o=0;if(n)for(var d=e.child;d!==null;)a|=d.lanes|d.childLanes,o|=d.subtreeFlags&65011712,o|=d.flags&65011712,d.return=e,d=d.sibling;else for(d=e.child;d!==null;)a|=d.lanes|d.childLanes,o|=d.subtreeFlags,o|=d.flags,d.return=e,d=d.sibling;return e.subtreeFlags|=o,e.childLanes=a,n}function hb(e,n,a){var o=n.pendingProps;switch(Zl(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yt(n),null;case 1:return Yt(n),null;case 3:return a=n.stateNode,o=null,e!==null&&(o=e.memoizedState.cache),n.memoizedState.cache!==o&&(n.flags|=2048),Qi(le),Ct(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(Ns(n)?tn(n):e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,Jl())),Yt(n),null;case 26:var d=n.type,g=n.memoizedState;return e===null?(tn(n),g!==null?(Yt(n),Yf(n,g)):(Yt(n),Gc(n,d,null,o,a))):g?g!==e.memoizedState?(tn(n),Yt(n),Yf(n,g)):(Yt(n),n.flags&=-16777217):(e=e.memoizedProps,e!==o&&tn(n),Yt(n),Gc(n,d,e,o,a)),null;case 27:if(Oe(n),a=ft.current,d=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==o&&tn(n);else{if(!o){if(n.stateNode===null)throw Error(s(166));return Yt(n),null}e=et.current,Ns(n)?Ed(n):(e=tp(d,o,a),n.stateNode=e,tn(n))}return Yt(n),null;case 5:if(Oe(n),d=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==o&&tn(n);else{if(!o){if(n.stateNode===null)throw Error(s(166));return Yt(n),null}if(g=et.current,Ns(n))Ed(n);else{var v=No(ft.current);switch(g){case 1:g=v.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:g=v.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":g=v.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":g=v.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":g=v.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof o.is=="string"?v.createElement("select",{is:o.is}):v.createElement("select"),o.multiple?g.multiple=!0:o.size&&(g.size=o.size);break;default:g=typeof o.is=="string"?v.createElement(d,{is:o.is}):v.createElement(d)}}g[Se]=n,g[He]=o;t:for(v=n.child;v!==null;){if(v.tag===5||v.tag===6)g.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===n)break t;for(;v.sibling===null;){if(v.return===null||v.return===n)break t;v=v.return}v.sibling.return=v.return,v=v.sibling}n.stateNode=g;t:switch(Ee(g,d,o),d){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break t;case"img":o=!0;break t;default:o=!1}o&&tn(n)}}return Yt(n),Gc(n,n.type,e===null?null:e.memoizedProps,n.pendingProps,a),null;case 6:if(e&&n.stateNode!=null)e.memoizedProps!==o&&tn(n);else{if(typeof o!="string"&&n.stateNode===null)throw Error(s(166));if(e=ft.current,Ns(n)){if(e=n.stateNode,a=n.memoizedProps,o=null,d=we,d!==null)switch(d.tag){case 27:case 5:o=d.memoizedProps}e[Se]=n,e=!!(e.nodeValue===a||o!==null&&o.suppressHydrationWarning===!0||Gg(e.nodeValue,a)),e||mn(n,!0)}else e=No(e).createTextNode(o),e[Se]=n,n.stateNode=e}return Yt(n),null;case 31:if(a=n.memoizedState,e===null||e.memoizedState!==null){if(o=Ns(n),a!==null){if(e===null){if(!o)throw Error(s(318));if(e=n.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(557));e[Se]=n}else Yn(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Yt(n),e=!1}else a=Jl(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=a),e=!0;if(!e)return n.flags&256?(ni(n),n):(ni(n),null);if((n.flags&128)!==0)throw Error(s(558))}return Yt(n),null;case 13:if(o=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(d=Ns(n),o!==null&&o.dehydrated!==null){if(e===null){if(!d)throw Error(s(318));if(d=n.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(s(317));d[Se]=n}else Yn(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Yt(n),d=!1}else d=Jl(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=d),d=!0;if(!d)return n.flags&256?(ni(n),n):(ni(n),null)}return ni(n),(n.flags&128)!==0?(n.lanes=a,n):(a=o!==null,e=e!==null&&e.memoizedState!==null,a&&(o=n.child,d=null,o.alternate!==null&&o.alternate.memoizedState!==null&&o.alternate.memoizedState.cachePool!==null&&(d=o.alternate.memoizedState.cachePool.pool),g=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(g=o.memoizedState.cachePool.pool),g!==d&&(o.flags|=2048)),a!==e&&a&&(n.child.flags|=8192),mo(n,n.updateQueue),Yt(n),null);case 4:return Ct(),e===null&&hu(n.stateNode.containerInfo),Yt(n),null;case 10:return Qi(n.type),Yt(n),null;case 19:if(I(ae),o=n.memoizedState,o===null)return Yt(n),null;if(d=(n.flags&128)!==0,g=o.rendering,g===null)if(d)ja(o,!1);else{if(ne!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(g=io(e),g!==null){for(n.flags|=128,ja(o,!1),e=g.updateQueue,n.updateQueue=e,mo(n,e),n.subtreeFlags=0,e=a,a=n.child;a!==null;)Ad(a,e),a=a.sibling;return K(ae,ae.current&1|2),Rt&&$i(n,o.treeForkCount),n.child}e=e.sibling}o.tail!==null&&Le()>So&&(n.flags|=128,d=!0,ja(o,!1),n.lanes=4194304)}else{if(!d)if(e=io(g),e!==null){if(n.flags|=128,d=!0,e=e.updateQueue,n.updateQueue=e,mo(n,e),ja(o,!0),o.tail===null&&o.tailMode==="hidden"&&!g.alternate&&!Rt)return Yt(n),null}else 2*Le()-o.renderingStartTime>So&&a!==536870912&&(n.flags|=128,d=!0,ja(o,!1),n.lanes=4194304);o.isBackwards?(g.sibling=n.child,n.child=g):(e=o.last,e!==null?e.sibling=g:n.child=g,o.last=g)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Le(),e.sibling=null,a=ae.current,K(ae,d?a&1|2:a&1),Rt&&$i(n,o.treeForkCount),e):(Yt(n),null);case 22:case 23:return ni(n),dc(),o=n.memoizedState!==null,e!==null?e.memoizedState!==null!==o&&(n.flags|=8192):o&&(n.flags|=8192),o?(a&536870912)!==0&&(n.flags&128)===0&&(Yt(n),n.subtreeFlags&6&&(n.flags|=8192)):Yt(n),a=n.updateQueue,a!==null&&mo(n,a.retryQueue),a=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),o=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),o!==a&&(n.flags|=2048),e!==null&&I(Qn),null;case 24:return a=null,e!==null&&(a=e.memoizedState.cache),n.memoizedState.cache!==a&&(n.flags|=2048),Qi(le),Yt(n),null;case 25:return null;case 30:return null}throw Error(s(156,n.tag))}function db(e,n){switch(Zl(n),n.tag){case 1:return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return Qi(le),Ct(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 26:case 27:case 5:return Oe(n),null;case 31:if(n.memoizedState!==null){if(ni(n),n.alternate===null)throw Error(s(340));Yn()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 13:if(ni(n),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(s(340));Yn()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return I(ae),null;case 4:return Ct(),null;case 10:return Qi(n.type),null;case 22:case 23:return ni(n),dc(),e!==null&&I(Qn),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 24:return Qi(le),null;case 25:return null;default:return null}}function $f(e,n){switch(Zl(n),n.tag){case 3:Qi(le),Ct();break;case 26:case 27:case 5:Oe(n);break;case 4:Ct();break;case 31:n.memoizedState!==null&&ni(n);break;case 13:ni(n);break;case 19:I(ae);break;case 10:Qi(n.type);break;case 22:case 23:ni(n),dc(),e!==null&&I(Qn);break;case 24:Qi(le)}}function Ha(e,n){try{var a=n.updateQueue,o=a!==null?a.lastEffect:null;if(o!==null){var d=o.next;a=d;do{if((a.tag&e)===e){o=void 0;var g=a.create,v=a.inst;o=g(),v.destroy=o}a=a.next}while(a!==d)}}catch(_){Ft(n,n.return,_)}}function _n(e,n,a){try{var o=n.updateQueue,d=o!==null?o.lastEffect:null;if(d!==null){var g=d.next;o=g;do{if((o.tag&e)===e){var v=o.inst,_=v.destroy;if(_!==void 0){v.destroy=void 0,d=n;var M=a,F=_;try{F()}catch(V){Ft(d,M,V)}}}o=o.next}while(o!==g)}}catch(V){Ft(n,n.return,V)}}function Kf(e){var n=e.updateQueue;if(n!==null){var a=e.stateNode;try{Ud(n,a)}catch(o){Ft(e,e.return,o)}}}function Qf(e,n,a){a.props=es(e.type,e.memoizedProps),a.state=e.memoizedState;try{a.componentWillUnmount()}catch(o){Ft(e,n,o)}}function Ia(e,n){try{var a=e.ref;if(a!==null){switch(e.tag){case 26:case 27:case 5:var o=e.stateNode;break;case 30:o=e.stateNode;break;default:o=e.stateNode}typeof a=="function"?e.refCleanup=a(o):a.current=o}}catch(d){Ft(e,n,d)}}function Bi(e,n){var a=e.ref,o=e.refCleanup;if(a!==null)if(typeof o=="function")try{o()}catch(d){Ft(e,n,d)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(d){Ft(e,n,d)}else a.current=null}function Zf(e){var n=e.type,a=e.memoizedProps,o=e.stateNode;try{t:switch(n){case"button":case"input":case"select":case"textarea":a.autoFocus&&o.focus();break t;case"img":a.src?o.src=a.src:a.srcSet&&(o.srcset=a.srcSet)}}catch(d){Ft(e,e.return,d)}}function qc(e,n,a){try{var o=e.stateNode;kb(o,e.type,a,n),o[He]=n}catch(d){Ft(e,e.return,d)}}function Wf(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Rn(e.type)||e.tag===4}function Vc(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||Wf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Rn(e.type)||e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Xc(e,n,a){var o=e.tag;if(o===5||o===6)e=e.stateNode,n?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(e,n):(n=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,n.appendChild(e),a=a._reactRootContainer,a!=null||n.onclick!==null||(n.onclick=Vi));else if(o!==4&&(o===27&&Rn(e.type)&&(a=e.stateNode,n=null),e=e.child,e!==null))for(Xc(e,n,a),e=e.sibling;e!==null;)Xc(e,n,a),e=e.sibling}function yo(e,n,a){var o=e.tag;if(o===5||o===6)e=e.stateNode,n?a.insertBefore(e,n):a.appendChild(e);else if(o!==4&&(o===27&&Rn(e.type)&&(a=e.stateNode),e=e.child,e!==null))for(yo(e,n,a),e=e.sibling;e!==null;)yo(e,n,a),e=e.sibling}function Jf(e){var n=e.stateNode,a=e.memoizedProps;try{for(var o=e.type,d=n.attributes;d.length;)n.removeAttributeNode(d[0]);Ee(n,o,a),n[Se]=e,n[He]=a}catch(g){Ft(e,e.return,g)}}var en=!1,he=!1,Yc=!1,tg=typeof WeakSet=="function"?WeakSet:Set,ye=null;function fb(e,n){if(e=e.containerInfo,gu=Uo,e=hd(e),jl(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else t:{a=(a=e.ownerDocument)&&a.defaultView||window;var o=a.getSelection&&a.getSelection();if(o&&o.rangeCount!==0){a=o.anchorNode;var d=o.anchorOffset,g=o.focusNode;o=o.focusOffset;try{a.nodeType,g.nodeType}catch{a=null;break t}var v=0,_=-1,M=-1,F=0,V=0,Y=e,j=null;e:for(;;){for(var H;Y!==a||d!==0&&Y.nodeType!==3||(_=v+d),Y!==g||o!==0&&Y.nodeType!==3||(M=v+o),Y.nodeType===3&&(v+=Y.nodeValue.length),(H=Y.firstChild)!==null;)j=Y,Y=H;for(;;){if(Y===e)break e;if(j===a&&++F===d&&(_=v),j===g&&++V===o&&(M=v),(H=Y.nextSibling)!==null)break;Y=j,j=Y.parentNode}Y=H}a=_===-1||M===-1?null:{start:_,end:M}}else a=null}a=a||{start:0,end:0}}else a=null;for(pu={focusedElem:e,selectionRange:a},Uo=!1,ye=n;ye!==null;)if(n=ye,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,ye=e;else for(;ye!==null;){switch(n=ye,g=n.alternate,e=n.flags,n.tag){case 0:if((e&4)!==0&&(e=n.updateQueue,e=e!==null?e.events:null,e!==null))for(a=0;a<e.length;a++)d=e[a],d.ref.impl=d.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&g!==null){e=void 0,a=n,d=g.memoizedProps,g=g.memoizedState,o=a.stateNode;try{var nt=es(a.type,d);e=o.getSnapshotBeforeUpdate(nt,g),o.__reactInternalSnapshotBeforeUpdate=e}catch(dt){Ft(a,a.return,dt)}}break;case 3:if((e&1024)!==0){if(e=n.stateNode.containerInfo,a=e.nodeType,a===9)bu(e);else if(a===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":bu(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(s(163))}if(e=n.sibling,e!==null){e.return=n.return,ye=e;break}ye=n.return}}function eg(e,n,a){var o=a.flags;switch(a.tag){case 0:case 11:case 15:sn(e,a),o&4&&Ha(5,a);break;case 1:if(sn(e,a),o&4)if(e=a.stateNode,n===null)try{e.componentDidMount()}catch(v){Ft(a,a.return,v)}else{var d=es(a.type,n.memoizedProps);n=n.memoizedState;try{e.componentDidUpdate(d,n,e.__reactInternalSnapshotBeforeUpdate)}catch(v){Ft(a,a.return,v)}}o&64&&Kf(a),o&512&&Ia(a,a.return);break;case 3:if(sn(e,a),o&64&&(e=a.updateQueue,e!==null)){if(n=null,a.child!==null)switch(a.child.tag){case 27:case 5:n=a.child.stateNode;break;case 1:n=a.child.stateNode}try{Ud(e,n)}catch(v){Ft(a,a.return,v)}}break;case 27:n===null&&o&4&&Jf(a);case 26:case 5:sn(e,a),n===null&&o&4&&Zf(a),o&512&&Ia(a,a.return);break;case 12:sn(e,a);break;case 31:sn(e,a),o&4&&sg(e,a);break;case 13:sn(e,a),o&4&&ag(e,a),o&64&&(e=a.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(a=wb.bind(null,a),Ib(e,a))));break;case 22:if(o=a.memoizedState!==null||en,!o){n=n!==null&&n.memoizedState!==null||he,d=en;var g=he;en=o,(he=n)&&!g?an(e,a,(a.subtreeFlags&8772)!==0):sn(e,a),en=d,he=g}break;case 30:break;default:sn(e,a)}}function ig(e){var n=e.alternate;n!==null&&(e.alternate=null,ig(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&_l(n)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Kt=null,Ge=!1;function nn(e,n,a){for(a=a.child;a!==null;)ng(e,n,a),a=a.sibling}function ng(e,n,a){if(ee&&typeof ee.onCommitFiberUnmount=="function")try{ee.onCommitFiberUnmount(Oi,a)}catch{}switch(a.tag){case 26:he||Bi(a,n),nn(e,n,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:he||Bi(a,n);var o=Kt,d=Ge;Rn(a.type)&&(Kt=a.stateNode,Ge=!1),nn(e,n,a),Za(a.stateNode),Kt=o,Ge=d;break;case 5:he||Bi(a,n);case 6:if(o=Kt,d=Ge,Kt=null,nn(e,n,a),Kt=o,Ge=d,Kt!==null)if(Ge)try{(Kt.nodeType===9?Kt.body:Kt.nodeName==="HTML"?Kt.ownerDocument.body:Kt).removeChild(a.stateNode)}catch(g){Ft(a,n,g)}else try{Kt.removeChild(a.stateNode)}catch(g){Ft(a,n,g)}break;case 18:Kt!==null&&(Ge?(e=Kt,Kg(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,a.stateNode),Ws(e)):Kg(Kt,a.stateNode));break;case 4:o=Kt,d=Ge,Kt=a.stateNode.containerInfo,Ge=!0,nn(e,n,a),Kt=o,Ge=d;break;case 0:case 11:case 14:case 15:_n(2,a,n),he||_n(4,a,n),nn(e,n,a);break;case 1:he||(Bi(a,n),o=a.stateNode,typeof o.componentWillUnmount=="function"&&Qf(a,n,o)),nn(e,n,a);break;case 21:nn(e,n,a);break;case 22:he=(o=he)||a.memoizedState!==null,nn(e,n,a),he=o;break;default:nn(e,n,a)}}function sg(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Ws(e)}catch(a){Ft(n,n.return,a)}}}function ag(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Ws(e)}catch(a){Ft(n,n.return,a)}}function gb(e){switch(e.tag){case 31:case 13:case 19:var n=e.stateNode;return n===null&&(n=e.stateNode=new tg),n;case 22:return e=e.stateNode,n=e._retryCache,n===null&&(n=e._retryCache=new tg),n;default:throw Error(s(435,e.tag))}}function bo(e,n){var a=gb(e);n.forEach(function(o){if(!a.has(o)){a.add(o);var d=_b.bind(null,e,o);o.then(d,d)}})}function qe(e,n){var a=n.deletions;if(a!==null)for(var o=0;o<a.length;o++){var d=a[o],g=e,v=n,_=v;t:for(;_!==null;){switch(_.tag){case 27:if(Rn(_.type)){Kt=_.stateNode,Ge=!1;break t}break;case 5:Kt=_.stateNode,Ge=!1;break t;case 3:case 4:Kt=_.stateNode.containerInfo,Ge=!0;break t}_=_.return}if(Kt===null)throw Error(s(160));ng(g,v,d),Kt=null,Ge=!1,g=d.alternate,g!==null&&(g.return=null),d.return=null}if(n.subtreeFlags&13886)for(n=n.child;n!==null;)rg(n,e),n=n.sibling}var Ci=null;function rg(e,n){var a=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:qe(n,e),Ve(e),o&4&&(_n(3,e,e.return),Ha(3,e),_n(5,e,e.return));break;case 1:qe(n,e),Ve(e),o&512&&(he||a===null||Bi(a,a.return)),o&64&&en&&(e=e.updateQueue,e!==null&&(o=e.callbacks,o!==null&&(a=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=a===null?o:a.concat(o))));break;case 26:var d=Ci;if(qe(n,e),Ve(e),o&512&&(he||a===null||Bi(a,a.return)),o&4){var g=a!==null?a.memoizedState:null;if(o=e.memoizedState,a===null)if(o===null)if(e.stateNode===null){t:{o=e.type,a=e.memoizedProps,d=d.ownerDocument||d;e:switch(o){case"title":g=d.getElementsByTagName("title")[0],(!g||g[pa]||g[Se]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=d.createElement(o),d.head.insertBefore(g,d.querySelector("head > title"))),Ee(g,o,a),g[Se]=e,me(g),o=g;break t;case"link":var v=rp("link","href",d).get(o+(a.href||""));if(v){for(var _=0;_<v.length;_++)if(g=v[_],g.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&g.getAttribute("rel")===(a.rel==null?null:a.rel)&&g.getAttribute("title")===(a.title==null?null:a.title)&&g.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){v.splice(_,1);break e}}g=d.createElement(o),Ee(g,o,a),d.head.appendChild(g);break;case"meta":if(v=rp("meta","content",d).get(o+(a.content||""))){for(_=0;_<v.length;_++)if(g=v[_],g.getAttribute("content")===(a.content==null?null:""+a.content)&&g.getAttribute("name")===(a.name==null?null:a.name)&&g.getAttribute("property")===(a.property==null?null:a.property)&&g.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&g.getAttribute("charset")===(a.charSet==null?null:a.charSet)){v.splice(_,1);break e}}g=d.createElement(o),Ee(g,o,a),d.head.appendChild(g);break;default:throw Error(s(468,o))}g[Se]=e,me(g),o=g}e.stateNode=o}else op(d,e.type,e.stateNode);else e.stateNode=ap(d,o,e.memoizedProps);else g!==o?(g===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):g.count--,o===null?op(d,e.type,e.stateNode):ap(d,o,e.memoizedProps)):o===null&&e.stateNode!==null&&qc(e,e.memoizedProps,a.memoizedProps)}break;case 27:qe(n,e),Ve(e),o&512&&(he||a===null||Bi(a,a.return)),a!==null&&o&4&&qc(e,e.memoizedProps,a.memoizedProps);break;case 5:if(qe(n,e),Ve(e),o&512&&(he||a===null||Bi(a,a.return)),e.flags&32){d=e.stateNode;try{Ss(d,"")}catch(nt){Ft(e,e.return,nt)}}o&4&&e.stateNode!=null&&(d=e.memoizedProps,qc(e,d,a!==null?a.memoizedProps:d)),o&1024&&(Yc=!0);break;case 6:if(qe(n,e),Ve(e),o&4){if(e.stateNode===null)throw Error(s(162));o=e.memoizedProps,a=e.stateNode;try{a.nodeValue=o}catch(nt){Ft(e,e.return,nt)}}break;case 3:if(ko=null,d=Ci,Ci=Oo(n.containerInfo),qe(n,e),Ci=d,Ve(e),o&4&&a!==null&&a.memoizedState.isDehydrated)try{Ws(n.containerInfo)}catch(nt){Ft(e,e.return,nt)}Yc&&(Yc=!1,og(e));break;case 4:o=Ci,Ci=Oo(e.stateNode.containerInfo),qe(n,e),Ve(e),Ci=o;break;case 12:qe(n,e),Ve(e);break;case 31:qe(n,e),Ve(e),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,bo(e,o)));break;case 13:qe(n,e),Ve(e),e.child.flags&8192&&e.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(Ao=Le()),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,bo(e,o)));break;case 22:d=e.memoizedState!==null;var M=a!==null&&a.memoizedState!==null,F=en,V=he;if(en=F||d,he=V||M,qe(n,e),he=V,en=F,Ve(e),o&8192)t:for(n=e.stateNode,n._visibility=d?n._visibility&-2:n._visibility|1,d&&(a===null||M||en||he||is(e)),a=null,n=e;;){if(n.tag===5||n.tag===26){if(a===null){M=a=n;try{if(g=M.stateNode,d)v=g.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{_=M.stateNode;var Y=M.memoizedProps.style,j=Y!=null&&Y.hasOwnProperty("display")?Y.display:null;_.style.display=j==null||typeof j=="boolean"?"":(""+j).trim()}}catch(nt){Ft(M,M.return,nt)}}}else if(n.tag===6){if(a===null){M=n;try{M.stateNode.nodeValue=d?"":M.memoizedProps}catch(nt){Ft(M,M.return,nt)}}}else if(n.tag===18){if(a===null){M=n;try{var H=M.stateNode;d?Qg(H,!0):Qg(M.stateNode,!1)}catch(nt){Ft(M,M.return,nt)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===e)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break t;for(;n.sibling===null;){if(n.return===null||n.return===e)break t;a===n&&(a=null),n=n.return}a===n&&(a=null),n.sibling.return=n.return,n=n.sibling}o&4&&(o=e.updateQueue,o!==null&&(a=o.retryQueue,a!==null&&(o.retryQueue=null,bo(e,a))));break;case 19:qe(n,e),Ve(e),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,bo(e,o)));break;case 30:break;case 21:break;default:qe(n,e),Ve(e)}}function Ve(e){var n=e.flags;if(n&2){try{for(var a,o=e.return;o!==null;){if(Wf(o)){a=o;break}o=o.return}if(a==null)throw Error(s(160));switch(a.tag){case 27:var d=a.stateNode,g=Vc(e);yo(e,g,d);break;case 5:var v=a.stateNode;a.flags&32&&(Ss(v,""),a.flags&=-33);var _=Vc(e);yo(e,_,v);break;case 3:case 4:var M=a.stateNode.containerInfo,F=Vc(e);Xc(e,F,M);break;default:throw Error(s(161))}}catch(V){Ft(e,e.return,V)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function og(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var n=e;og(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),e=e.sibling}}function sn(e,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)eg(e,n.alternate,n),n=n.sibling}function is(e){for(e=e.child;e!==null;){var n=e;switch(n.tag){case 0:case 11:case 14:case 15:_n(4,n,n.return),is(n);break;case 1:Bi(n,n.return);var a=n.stateNode;typeof a.componentWillUnmount=="function"&&Qf(n,n.return,a),is(n);break;case 27:Za(n.stateNode);case 26:case 5:Bi(n,n.return),is(n);break;case 22:n.memoizedState===null&&is(n);break;case 30:is(n);break;default:is(n)}e=e.sibling}}function an(e,n,a){for(a=a&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var o=n.alternate,d=e,g=n,v=g.flags;switch(g.tag){case 0:case 11:case 15:an(d,g,a),Ha(4,g);break;case 1:if(an(d,g,a),o=g,d=o.stateNode,typeof d.componentDidMount=="function")try{d.componentDidMount()}catch(F){Ft(o,o.return,F)}if(o=g,d=o.updateQueue,d!==null){var _=o.stateNode;try{var M=d.shared.hiddenCallbacks;if(M!==null)for(d.shared.hiddenCallbacks=null,d=0;d<M.length;d++)Pd(M[d],_)}catch(F){Ft(o,o.return,F)}}a&&v&64&&Kf(g),Ia(g,g.return);break;case 27:Jf(g);case 26:case 5:an(d,g,a),a&&o===null&&v&4&&Zf(g),Ia(g,g.return);break;case 12:an(d,g,a);break;case 31:an(d,g,a),a&&v&4&&sg(d,g);break;case 13:an(d,g,a),a&&v&4&&ag(d,g);break;case 22:g.memoizedState===null&&an(d,g,a),Ia(g,g.return);break;case 30:break;default:an(d,g,a)}n=n.sibling}}function $c(e,n){var a=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),e=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(e=n.memoizedState.cachePool.pool),e!==a&&(e!=null&&e.refCount++,a!=null&&Ma(a))}function Kc(e,n){e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&Ma(e))}function Mi(e,n,a,o){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)lg(e,n,a,o),n=n.sibling}function lg(e,n,a,o){var d=n.flags;switch(n.tag){case 0:case 11:case 15:Mi(e,n,a,o),d&2048&&Ha(9,n);break;case 1:Mi(e,n,a,o);break;case 3:Mi(e,n,a,o),d&2048&&(e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&Ma(e)));break;case 12:if(d&2048){Mi(e,n,a,o),e=n.stateNode;try{var g=n.memoizedProps,v=g.id,_=g.onPostCommit;typeof _=="function"&&_(v,n.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(M){Ft(n,n.return,M)}}else Mi(e,n,a,o);break;case 31:Mi(e,n,a,o);break;case 13:Mi(e,n,a,o);break;case 23:break;case 22:g=n.stateNode,v=n.alternate,n.memoizedState!==null?g._visibility&2?Mi(e,n,a,o):Ga(e,n):g._visibility&2?Mi(e,n,a,o):(g._visibility|=2,Hs(e,n,a,o,(n.subtreeFlags&10256)!==0||!1)),d&2048&&$c(v,n);break;case 24:Mi(e,n,a,o),d&2048&&Kc(n.alternate,n);break;default:Mi(e,n,a,o)}}function Hs(e,n,a,o,d){for(d=d&&((n.subtreeFlags&10256)!==0||!1),n=n.child;n!==null;){var g=e,v=n,_=a,M=o,F=v.flags;switch(v.tag){case 0:case 11:case 15:Hs(g,v,_,M,d),Ha(8,v);break;case 23:break;case 22:var V=v.stateNode;v.memoizedState!==null?V._visibility&2?Hs(g,v,_,M,d):Ga(g,v):(V._visibility|=2,Hs(g,v,_,M,d)),d&&F&2048&&$c(v.alternate,v);break;case 24:Hs(g,v,_,M,d),d&&F&2048&&Kc(v.alternate,v);break;default:Hs(g,v,_,M,d)}n=n.sibling}}function Ga(e,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var a=e,o=n,d=o.flags;switch(o.tag){case 22:Ga(a,o),d&2048&&$c(o.alternate,o);break;case 24:Ga(a,o),d&2048&&Kc(o.alternate,o);break;default:Ga(a,o)}n=n.sibling}}var qa=8192;function Is(e,n,a){if(e.subtreeFlags&qa)for(e=e.child;e!==null;)cg(e,n,a),e=e.sibling}function cg(e,n,a){switch(e.tag){case 26:Is(e,n,a),e.flags&qa&&e.memoizedState!==null&&t0(a,Ci,e.memoizedState,e.memoizedProps);break;case 5:Is(e,n,a);break;case 3:case 4:var o=Ci;Ci=Oo(e.stateNode.containerInfo),Is(e,n,a),Ci=o;break;case 22:e.memoizedState===null&&(o=e.alternate,o!==null&&o.memoizedState!==null?(o=qa,qa=16777216,Is(e,n,a),qa=o):Is(e,n,a));break;default:Is(e,n,a)}}function ug(e){var n=e.alternate;if(n!==null&&(e=n.child,e!==null)){n.child=null;do n=e.sibling,e.sibling=null,e=n;while(e!==null)}}function Va(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var a=0;a<n.length;a++){var o=n[a];ye=o,dg(o,e)}ug(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)hg(e),e=e.sibling}function hg(e){switch(e.tag){case 0:case 11:case 15:Va(e),e.flags&2048&&_n(9,e,e.return);break;case 3:Va(e);break;case 12:Va(e);break;case 22:var n=e.stateNode;e.memoizedState!==null&&n._visibility&2&&(e.return===null||e.return.tag!==13)?(n._visibility&=-3,vo(e)):Va(e);break;default:Va(e)}}function vo(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var a=0;a<n.length;a++){var o=n[a];ye=o,dg(o,e)}ug(e)}for(e=e.child;e!==null;){switch(n=e,n.tag){case 0:case 11:case 15:_n(8,n,n.return),vo(n);break;case 22:a=n.stateNode,a._visibility&2&&(a._visibility&=-3,vo(n));break;default:vo(n)}e=e.sibling}}function dg(e,n){for(;ye!==null;){var a=ye;switch(a.tag){case 0:case 11:case 15:_n(8,a,n);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var o=a.memoizedState.cachePool.pool;o!=null&&o.refCount++}break;case 24:Ma(a.memoizedState.cache)}if(o=a.child,o!==null)o.return=a,ye=o;else t:for(a=e;ye!==null;){o=ye;var d=o.sibling,g=o.return;if(ig(o),o===a){ye=null;break t}if(d!==null){d.return=g,ye=d;break t}ye=g}}}var pb={getCacheForType:function(e){var n=_e(le),a=n.data.get(e);return a===void 0&&(a=e(),n.data.set(e,a)),a},cacheSignal:function(){return _e(le).controller.signal}},mb=typeof WeakMap=="function"?WeakMap:Map,Bt=0,qt=null,Et=null,Mt=0,Ut=0,si=null,xn=!1,Gs=!1,Qc=!1,rn=0,ne=0,En=0,ns=0,Zc=0,ai=0,qs=0,Xa=null,Xe=null,Wc=!1,Ao=0,fg=0,So=1/0,wo=null,Tn=null,ge=0,Cn=null,Vs=null,on=0,Jc=0,tu=null,gg=null,Ya=0,eu=null;function ri(){return(Bt&2)!==0&&Mt!==0?Mt&-Mt:k.T!==null?ou():Dh()}function pg(){if(ai===0)if((Mt&536870912)===0||Rt){var e=Dr;Dr<<=1,(Dr&3932160)===0&&(Dr=262144),ai=e}else ai=536870912;return e=ii.current,e!==null&&(e.flags|=32),ai}function Ye(e,n,a){(e===qt&&(Ut===2||Ut===9)||e.cancelPendingCommit!==null)&&(Xs(e,0),Mn(e,Mt,ai,!1)),ga(e,a),((Bt&2)===0||e!==qt)&&(e===qt&&((Bt&2)===0&&(ns|=a),ne===4&&Mn(e,Mt,ai,!1)),zi(e))}function mg(e,n,a){if((Bt&6)!==0)throw Error(s(327));var o=!a&&(n&127)===0&&(n&e.expiredLanes)===0||fa(e,n),d=o?vb(e,n):nu(e,n,!0),g=o;do{if(d===0){Gs&&!o&&Mn(e,n,0,!1);break}else{if(a=e.current.alternate,g&&!yb(a)){d=nu(e,n,!1),g=!1;continue}if(d===2){if(g=n,e.errorRecoveryDisabledLanes&g)var v=0;else v=e.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){n=v;t:{var _=e;d=Xa;var M=_.current.memoizedState.isDehydrated;if(M&&(Xs(_,v).flags|=256),v=nu(_,v,!1),v!==2){if(Qc&&!M){_.errorRecoveryDisabledLanes|=g,ns|=g,d=4;break t}g=Xe,Xe=d,g!==null&&(Xe===null?Xe=g:Xe.push.apply(Xe,g))}d=v}if(g=!1,d!==2)continue}}if(d===1){Xs(e,0),Mn(e,n,0,!0);break}t:{switch(o=e,g=d,g){case 0:case 1:throw Error(s(345));case 4:if((n&4194048)!==n)break;case 6:Mn(o,n,ai,!xn);break t;case 2:Xe=null;break;case 3:case 5:break;default:throw Error(s(329))}if((n&62914560)===n&&(d=Ao+300-Le(),10<d)){if(Mn(o,n,ai,!xn),Nr(o,0,!0)!==0)break t;on=n,o.timeoutHandle=Yg(yg.bind(null,o,a,Xe,wo,Wc,n,ai,ns,qs,xn,g,"Throttled",-0,0),d);break t}yg(o,a,Xe,wo,Wc,n,ai,ns,qs,xn,g,null,-0,0)}}break}while(!0);zi(e)}function yg(e,n,a,o,d,g,v,_,M,F,V,Y,j,H){if(e.timeoutHandle=-1,Y=n.subtreeFlags,Y&8192||(Y&16785408)===16785408){Y={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Vi},cg(n,g,Y);var nt=(g&62914560)===g?Ao-Le():(g&4194048)===g?fg-Le():0;if(nt=e0(Y,nt),nt!==null){on=g,e.cancelPendingCommit=nt(Eg.bind(null,e,n,g,a,o,d,v,_,M,V,Y,null,j,H)),Mn(e,g,v,!F);return}}Eg(e,n,g,a,o,d,v,_,M)}function yb(e){for(var n=e;;){var a=n.tag;if((a===0||a===11||a===15)&&n.flags&16384&&(a=n.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var o=0;o<a.length;o++){var d=a[o],g=d.getSnapshot;d=d.value;try{if(!ti(g(),d))return!1}catch{return!1}}if(a=n.child,n.subtreeFlags&16384&&a!==null)a.return=n,n=a;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Mn(e,n,a,o){n&=~Zc,n&=~ns,e.suspendedLanes|=n,e.pingedLanes&=~n,o&&(e.warmLanes|=n),o=e.expirationTimes;for(var d=n;0<d;){var g=31-ke(d),v=1<<g;o[g]=-1,d&=~v}a!==0&&Th(e,a,n)}function _o(){return(Bt&6)===0?($a(0),!1):!0}function iu(){if(Et!==null){if(Ut===0)var e=Et.return;else e=Et,Ki=$n=null,bc(e),zs=null,Ra=0,e=Et;for(;e!==null;)$f(e.alternate,e),e=e.return;Et=null}}function Xs(e,n){var a=e.timeoutHandle;a!==-1&&(e.timeoutHandle=-1,Pb(a)),a=e.cancelPendingCommit,a!==null&&(e.cancelPendingCommit=null,a()),on=0,iu(),qt=e,Et=a=Yi(e.current,null),Mt=n,Ut=0,si=null,xn=!1,Gs=fa(e,n),Qc=!1,qs=ai=Zc=ns=En=ne=0,Xe=Xa=null,Wc=!1,(n&8)!==0&&(n|=n&32);var o=e.entangledLanes;if(o!==0)for(e=e.entanglements,o&=n;0<o;){var d=31-ke(o),g=1<<d;n|=e[d],o&=~g}return rn=n,Gr(),a}function bg(e,n){St=null,k.H=Ua,n===Bs||n===Zr?(n=Ld(),Ut=3):n===rc?(n=Ld(),Ut=4):Ut=n===kc?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,si=n,Et===null&&(ne=1,ho(e,fi(n,e.current)))}function vg(){var e=ii.current;return e===null?!0:(Mt&4194048)===Mt?yi===null:(Mt&62914560)===Mt||(Mt&536870912)!==0?e===yi:!1}function Ag(){var e=k.H;return k.H=Ua,e===null?Ua:e}function Sg(){var e=k.A;return k.A=pb,e}function xo(){ne=4,xn||(Mt&4194048)!==Mt&&ii.current!==null||(Gs=!0),(En&134217727)===0&&(ns&134217727)===0||qt===null||Mn(qt,Mt,ai,!1)}function nu(e,n,a){var o=Bt;Bt|=2;var d=Ag(),g=Sg();(qt!==e||Mt!==n)&&(wo=null,Xs(e,n)),n=!1;var v=ne;t:do try{if(Ut!==0&&Et!==null){var _=Et,M=si;switch(Ut){case 8:iu(),v=6;break t;case 3:case 2:case 9:case 6:ii.current===null&&(n=!0);var F=Ut;if(Ut=0,si=null,Ys(e,_,M,F),a&&Gs){v=0;break t}break;default:F=Ut,Ut=0,si=null,Ys(e,_,M,F)}}bb(),v=ne;break}catch(V){bg(e,V)}while(!0);return n&&e.shellSuspendCounter++,Ki=$n=null,Bt=o,k.H=d,k.A=g,Et===null&&(qt=null,Mt=0,Gr()),v}function bb(){for(;Et!==null;)wg(Et)}function vb(e,n){var a=Bt;Bt|=2;var o=Ag(),d=Sg();qt!==e||Mt!==n?(wo=null,So=Le()+500,Xs(e,n)):Gs=fa(e,n);t:do try{if(Ut!==0&&Et!==null){n=Et;var g=si;e:switch(Ut){case 1:Ut=0,si=null,Ys(e,n,g,1);break;case 2:case 9:if(Nd(g)){Ut=0,si=null,_g(n);break}n=function(){Ut!==2&&Ut!==9||qt!==e||(Ut=7),zi(e)},g.then(n,n);break t;case 3:Ut=7;break t;case 4:Ut=5;break t;case 7:Nd(g)?(Ut=0,si=null,_g(n)):(Ut=0,si=null,Ys(e,n,g,7));break;case 5:var v=null;switch(Et.tag){case 26:v=Et.memoizedState;case 5:case 27:var _=Et;if(v?lp(v):_.stateNode.complete){Ut=0,si=null;var M=_.sibling;if(M!==null)Et=M;else{var F=_.return;F!==null?(Et=F,Eo(F)):Et=null}break e}}Ut=0,si=null,Ys(e,n,g,5);break;case 6:Ut=0,si=null,Ys(e,n,g,6);break;case 8:iu(),ne=6;break t;default:throw Error(s(462))}}Ab();break}catch(V){bg(e,V)}while(!0);return Ki=$n=null,k.H=o,k.A=d,Bt=a,Et!==null?0:(qt=null,Mt=0,Gr(),ne)}function Ab(){for(;Et!==null&&!ml();)wg(Et)}function wg(e){var n=Xf(e.alternate,e,rn);e.memoizedProps=e.pendingProps,n===null?Eo(e):Et=n}function _g(e){var n=e,a=n.alternate;switch(n.tag){case 15:case 0:n=jf(a,n,n.pendingProps,n.type,void 0,Mt);break;case 11:n=jf(a,n,n.pendingProps,n.type.render,n.ref,Mt);break;case 5:bc(n);default:$f(a,n),n=Et=Ad(n,rn),n=Xf(a,n,rn)}e.memoizedProps=e.pendingProps,n===null?Eo(e):Et=n}function Ys(e,n,a,o){Ki=$n=null,bc(n),zs=null,Ra=0;var d=n.return;try{if(lb(e,d,n,a,Mt)){ne=1,ho(e,fi(a,e.current)),Et=null;return}}catch(g){if(d!==null)throw Et=d,g;ne=1,ho(e,fi(a,e.current)),Et=null;return}n.flags&32768?(Rt||o===1?e=!0:Gs||(Mt&536870912)!==0?e=!1:(xn=e=!0,(o===2||o===9||o===3||o===6)&&(o=ii.current,o!==null&&o.tag===13&&(o.flags|=16384))),xg(n,e)):Eo(n)}function Eo(e){var n=e;do{if((n.flags&32768)!==0){xg(n,xn);return}e=n.return;var a=hb(n.alternate,n,rn);if(a!==null){Et=a;return}if(n=n.sibling,n!==null){Et=n;return}Et=n=e}while(n!==null);ne===0&&(ne=5)}function xg(e,n){do{var a=db(e.alternate,e);if(a!==null){a.flags&=32767,Et=a;return}if(a=e.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!n&&(e=e.sibling,e!==null)){Et=e;return}Et=e=a}while(e!==null);ne=6,Et=null}function Eg(e,n,a,o,d,g,v,_,M){e.cancelPendingCommit=null;do To();while(ge!==0);if((Bt&6)!==0)throw Error(s(327));if(n!==null){if(n===e.current)throw Error(s(177));if(g=n.lanes|n.childLanes,g|=Vl,Jm(e,a,g,v,_,M),e===qt&&(Et=qt=null,Mt=0),Vs=n,Cn=e,on=a,Jc=g,tu=d,gg=o,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,xb(Ni,function(){return Rg(),null})):(e.callbackNode=null,e.callbackPriority=0),o=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||o){o=k.T,k.T=null,d=q.p,q.p=2,v=Bt,Bt|=4;try{fb(e,n,a)}finally{Bt=v,q.p=d,k.T=o}}ge=1,Tg(),Cg(),Mg()}}function Tg(){if(ge===1){ge=0;var e=Cn,n=Vs,a=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||a){a=k.T,k.T=null;var o=q.p;q.p=2;var d=Bt;Bt|=4;try{rg(n,e);var g=pu,v=hd(e.containerInfo),_=g.focusedElem,M=g.selectionRange;if(v!==_&&_&&_.ownerDocument&&ud(_.ownerDocument.documentElement,_)){if(M!==null&&jl(_)){var F=M.start,V=M.end;if(V===void 0&&(V=F),"selectionStart"in _)_.selectionStart=F,_.selectionEnd=Math.min(V,_.value.length);else{var Y=_.ownerDocument||document,j=Y&&Y.defaultView||window;if(j.getSelection){var H=j.getSelection(),nt=_.textContent.length,dt=Math.min(M.start,nt),It=M.end===void 0?dt:Math.min(M.end,nt);!H.extend&&dt>It&&(v=It,It=dt,dt=v);var z=cd(_,dt),N=cd(_,It);if(z&&N&&(H.rangeCount!==1||H.anchorNode!==z.node||H.anchorOffset!==z.offset||H.focusNode!==N.node||H.focusOffset!==N.offset)){var U=Y.createRange();U.setStart(z.node,z.offset),H.removeAllRanges(),dt>It?(H.addRange(U),H.extend(N.node,N.offset)):(U.setEnd(N.node,N.offset),H.addRange(U))}}}}for(Y=[],H=_;H=H.parentNode;)H.nodeType===1&&Y.push({element:H,left:H.scrollLeft,top:H.scrollTop});for(typeof _.focus=="function"&&_.focus(),_=0;_<Y.length;_++){var X=Y[_];X.element.scrollLeft=X.left,X.element.scrollTop=X.top}}Uo=!!gu,pu=gu=null}finally{Bt=d,q.p=o,k.T=a}}e.current=n,ge=2}}function Cg(){if(ge===2){ge=0;var e=Cn,n=Vs,a=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||a){a=k.T,k.T=null;var o=q.p;q.p=2;var d=Bt;Bt|=4;try{eg(e,n.alternate,n)}finally{Bt=d,q.p=o,k.T=a}}ge=3}}function Mg(){if(ge===4||ge===3){ge=0,yl();var e=Cn,n=Vs,a=on,o=gg;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?ge=5:(ge=0,Vs=Cn=null,Dg(e,e.pendingLanes));var d=e.pendingLanes;if(d===0&&(Tn=null),Sl(a),n=n.stateNode,ee&&typeof ee.onCommitFiberRoot=="function")try{ee.onCommitFiberRoot(Oi,n,void 0,(n.current.flags&128)===128)}catch{}if(o!==null){n=k.T,d=q.p,q.p=2,k.T=null;try{for(var g=e.onRecoverableError,v=0;v<o.length;v++){var _=o[v];g(_.value,{componentStack:_.stack})}}finally{k.T=n,q.p=d}}(on&3)!==0&&To(),zi(e),d=e.pendingLanes,(a&261930)!==0&&(d&42)!==0?e===eu?Ya++:(Ya=0,eu=e):Ya=0,$a(0)}}function Dg(e,n){(e.pooledCacheLanes&=n)===0&&(n=e.pooledCache,n!=null&&(e.pooledCache=null,Ma(n)))}function To(){return Tg(),Cg(),Mg(),Rg()}function Rg(){if(ge!==5)return!1;var e=Cn,n=Jc;Jc=0;var a=Sl(on),o=k.T,d=q.p;try{q.p=32>a?32:a,k.T=null,a=tu,tu=null;var g=Cn,v=on;if(ge=0,Vs=Cn=null,on=0,(Bt&6)!==0)throw Error(s(331));var _=Bt;if(Bt|=4,hg(g.current),lg(g,g.current,v,a),Bt=_,$a(0,!1),ee&&typeof ee.onPostCommitFiberRoot=="function")try{ee.onPostCommitFiberRoot(Oi,g)}catch{}return!0}finally{q.p=d,k.T=o,Dg(e,n)}}function Ng(e,n,a){n=fi(a,n),n=Lc(e.stateNode,n,2),e=An(e,n,2),e!==null&&(ga(e,2),zi(e))}function Ft(e,n,a){if(e.tag===3)Ng(e,e,a);else for(;n!==null;){if(n.tag===3){Ng(n,e,a);break}else if(n.tag===1){var o=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(Tn===null||!Tn.has(o))){e=fi(a,e),a=Of(2),o=An(n,a,2),o!==null&&(Lf(a,o,n,e),ga(o,2),zi(o));break}}n=n.return}}function su(e,n,a){var o=e.pingCache;if(o===null){o=e.pingCache=new mb;var d=new Set;o.set(n,d)}else d=o.get(n),d===void 0&&(d=new Set,o.set(n,d));d.has(a)||(Qc=!0,d.add(a),e=Sb.bind(null,e,n,a),n.then(e,e))}function Sb(e,n,a){var o=e.pingCache;o!==null&&o.delete(n),e.pingedLanes|=e.suspendedLanes&a,e.warmLanes&=~a,qt===e&&(Mt&a)===a&&(ne===4||ne===3&&(Mt&62914560)===Mt&&300>Le()-Ao?(Bt&2)===0&&Xs(e,0):Zc|=a,qs===Mt&&(qs=0)),zi(e)}function Og(e,n){n===0&&(n=Eh()),e=Vn(e,n),e!==null&&(ga(e,n),zi(e))}function wb(e){var n=e.memoizedState,a=0;n!==null&&(a=n.retryLane),Og(e,a)}function _b(e,n){var a=0;switch(e.tag){case 31:case 13:var o=e.stateNode,d=e.memoizedState;d!==null&&(a=d.retryLane);break;case 19:o=e.stateNode;break;case 22:o=e.stateNode._retryCache;break;default:throw Error(s(314))}o!==null&&o.delete(n),Og(e,a)}function xb(e,n){return gs(e,n)}var Co=null,$s=null,au=!1,Mo=!1,ru=!1,Dn=0;function zi(e){e!==$s&&e.next===null&&($s===null?Co=$s=e:$s=$s.next=e),Mo=!0,au||(au=!0,Tb())}function $a(e,n){if(!ru&&Mo){ru=!0;do for(var a=!1,o=Co;o!==null;){if(e!==0){var d=o.pendingLanes;if(d===0)var g=0;else{var v=o.suspendedLanes,_=o.pingedLanes;g=(1<<31-ke(42|e)+1)-1,g&=d&~(v&~_),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(a=!0,zg(o,g))}else g=Mt,g=Nr(o,o===qt?g:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),(g&3)===0||fa(o,g)||(a=!0,zg(o,g));o=o.next}while(a);ru=!1}}function Eb(){Lg()}function Lg(){Mo=au=!1;var e=0;Dn!==0&&zb()&&(e=Dn);for(var n=Le(),a=null,o=Co;o!==null;){var d=o.next,g=kg(o,n);g===0?(o.next=null,a===null?Co=d:a.next=d,d===null&&($s=a)):(a=o,(e!==0||(g&3)!==0)&&(Mo=!0)),o=d}ge!==0&&ge!==5||$a(e),Dn!==0&&(Dn=0)}function kg(e,n){for(var a=e.suspendedLanes,o=e.pingedLanes,d=e.expirationTimes,g=e.pendingLanes&-62914561;0<g;){var v=31-ke(g),_=1<<v,M=d[v];M===-1?((_&a)===0||(_&o)!==0)&&(d[v]=Wm(_,n)):M<=n&&(e.expiredLanes|=_),g&=~_}if(n=qt,a=Mt,a=Nr(e,e===n?a:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o=e.callbackNode,a===0||e===n&&(Ut===2||Ut===9)||e.cancelPendingCommit!==null)return o!==null&&o!==null&&Ri(o),e.callbackNode=null,e.callbackPriority=0;if((a&3)===0||fa(e,a)){if(n=a&-a,n===e.callbackPriority)return n;switch(o!==null&&Ri(o),Sl(a)){case 2:case 8:a=Ae;break;case 32:a=Ni;break;case 268435456:a=J;break;default:a=Ni}return o=Bg.bind(null,e),a=gs(a,o),e.callbackPriority=n,e.callbackNode=a,n}return o!==null&&o!==null&&Ri(o),e.callbackPriority=2,e.callbackNode=null,2}function Bg(e,n){if(ge!==0&&ge!==5)return e.callbackNode=null,e.callbackPriority=0,null;var a=e.callbackNode;if(To()&&e.callbackNode!==a)return null;var o=Mt;return o=Nr(e,e===qt?o:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o===0?null:(mg(e,o,n),kg(e,Le()),e.callbackNode!=null&&e.callbackNode===a?Bg.bind(null,e):null)}function zg(e,n){if(To())return null;mg(e,n,!0)}function Tb(){Ub(function(){(Bt&6)!==0?gs(Je,Eb):Lg()})}function ou(){if(Dn===0){var e=Ls;e===0&&(e=Mr,Mr<<=1,(Mr&261888)===0&&(Mr=256)),Dn=e}return Dn}function Pg(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Br(""+e)}function Ug(e,n){var a=n.ownerDocument.createElement("input");return a.name=n.name,a.value=n.value,e.id&&a.setAttribute("form",e.id),n.parentNode.insertBefore(a,n),e=new FormData(e),a.parentNode.removeChild(a),e}function Cb(e,n,a,o,d){if(n==="submit"&&a&&a.stateNode===d){var g=Pg((d[He]||null).action),v=o.submitter;v&&(n=(n=v[He]||null)?Pg(n.formAction):v.getAttribute("formAction"),n!==null&&(g=n,v=null));var _=new Fr("action","action",null,o,d);e.push({event:_,listeners:[{instance:null,listener:function(){if(o.defaultPrevented){if(Dn!==0){var M=v?Ug(d,v):new FormData(d);Cc(a,{pending:!0,data:M,method:d.method,action:g},null,M)}}else typeof g=="function"&&(_.preventDefault(),M=v?Ug(d,v):new FormData(d),Cc(a,{pending:!0,data:M,method:d.method,action:g},g,M))},currentTarget:d}]})}}for(var lu=0;lu<ql.length;lu++){var cu=ql[lu],Mb=cu.toLowerCase(),Db=cu[0].toUpperCase()+cu.slice(1);Ti(Mb,"on"+Db)}Ti(gd,"onAnimationEnd"),Ti(pd,"onAnimationIteration"),Ti(md,"onAnimationStart"),Ti("dblclick","onDoubleClick"),Ti("focusin","onFocus"),Ti("focusout","onBlur"),Ti(Vy,"onTransitionRun"),Ti(Xy,"onTransitionStart"),Ti(Yy,"onTransitionCancel"),Ti(yd,"onTransitionEnd"),vs("onMouseEnter",["mouseout","mouseover"]),vs("onMouseLeave",["mouseout","mouseover"]),vs("onPointerEnter",["pointerout","pointerover"]),vs("onPointerLeave",["pointerout","pointerover"]),Hn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Hn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Hn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Hn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Hn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Hn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ka="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Rb=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ka));function Fg(e,n){n=(n&4)!==0;for(var a=0;a<e.length;a++){var o=e[a],d=o.event;o=o.listeners;t:{var g=void 0;if(n)for(var v=o.length-1;0<=v;v--){var _=o[v],M=_.instance,F=_.currentTarget;if(_=_.listener,M!==g&&d.isPropagationStopped())break t;g=_,d.currentTarget=F;try{g(d)}catch(V){Ir(V)}d.currentTarget=null,g=M}else for(v=0;v<o.length;v++){if(_=o[v],M=_.instance,F=_.currentTarget,_=_.listener,M!==g&&d.isPropagationStopped())break t;g=_,d.currentTarget=F;try{g(d)}catch(V){Ir(V)}d.currentTarget=null,g=M}}}}function Tt(e,n){var a=n[wl];a===void 0&&(a=n[wl]=new Set);var o=e+"__bubble";a.has(o)||(jg(n,e,2,!1),a.add(o))}function uu(e,n,a){var o=0;n&&(o|=4),jg(a,e,o,n)}var Do="_reactListening"+Math.random().toString(36).slice(2);function hu(e){if(!e[Do]){e[Do]=!0,Oh.forEach(function(a){a!=="selectionchange"&&(Rb.has(a)||uu(a,!1,e),uu(a,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[Do]||(n[Do]=!0,uu("selectionchange",!1,n))}}function jg(e,n,a,o){switch(pp(n)){case 2:var d=s0;break;case 8:d=a0;break;default:d=Tu}a=d.bind(null,n,a,e),d=void 0,!Nl||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(d=!0),o?d!==void 0?e.addEventListener(n,a,{capture:!0,passive:d}):e.addEventListener(n,a,!0):d!==void 0?e.addEventListener(n,a,{passive:d}):e.addEventListener(n,a,!1)}function du(e,n,a,o,d){var g=o;if((n&1)===0&&(n&2)===0&&o!==null)t:for(;;){if(o===null)return;var v=o.tag;if(v===3||v===4){var _=o.stateNode.containerInfo;if(_===d)break;if(v===4)for(v=o.return;v!==null;){var M=v.tag;if((M===3||M===4)&&v.stateNode.containerInfo===d)return;v=v.return}for(;_!==null;){if(v=ms(_),v===null)return;if(M=v.tag,M===5||M===6||M===26||M===27){o=g=v;continue t}_=_.parentNode}}o=o.return}qh(function(){var F=g,V=Dl(a),Y=[];t:{var j=bd.get(e);if(j!==void 0){var H=Fr,nt=e;switch(e){case"keypress":if(Pr(a)===0)break t;case"keydown":case"keyup":H=_y;break;case"focusin":nt="focus",H=Bl;break;case"focusout":nt="blur",H=Bl;break;case"beforeblur":case"afterblur":H=Bl;break;case"click":if(a.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":H=Yh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":H=hy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":H=Ty;break;case gd:case pd:case md:H=gy;break;case yd:H=My;break;case"scroll":case"scrollend":H=cy;break;case"wheel":H=Ry;break;case"copy":case"cut":case"paste":H=my;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":H=Kh;break;case"toggle":case"beforetoggle":H=Oy}var dt=(n&4)!==0,It=!dt&&(e==="scroll"||e==="scrollend"),z=dt?j!==null?j+"Capture":null:j;dt=[];for(var N=F,U;N!==null;){var X=N;if(U=X.stateNode,X=X.tag,X!==5&&X!==26&&X!==27||U===null||z===null||(X=ya(N,z),X!=null&&dt.push(Qa(N,X,U))),It)break;N=N.return}0<dt.length&&(j=new H(j,nt,null,a,V),Y.push({event:j,listeners:dt}))}}if((n&7)===0){t:{if(j=e==="mouseover"||e==="pointerover",H=e==="mouseout"||e==="pointerout",j&&a!==Ml&&(nt=a.relatedTarget||a.fromElement)&&(ms(nt)||nt[ps]))break t;if((H||j)&&(j=V.window===V?V:(j=V.ownerDocument)?j.defaultView||j.parentWindow:window,H?(nt=a.relatedTarget||a.toElement,H=F,nt=nt?ms(nt):null,nt!==null&&(It=l(nt),dt=nt.tag,nt!==It||dt!==5&&dt!==27&&dt!==6)&&(nt=null)):(H=null,nt=F),H!==nt)){if(dt=Yh,X="onMouseLeave",z="onMouseEnter",N="mouse",(e==="pointerout"||e==="pointerover")&&(dt=Kh,X="onPointerLeave",z="onPointerEnter",N="pointer"),It=H==null?j:ma(H),U=nt==null?j:ma(nt),j=new dt(X,N+"leave",H,a,V),j.target=It,j.relatedTarget=U,X=null,ms(V)===F&&(dt=new dt(z,N+"enter",nt,a,V),dt.target=U,dt.relatedTarget=It,X=dt),It=X,H&&nt)e:{for(dt=Nb,z=H,N=nt,U=0,X=z;X;X=dt(X))U++;X=0;for(var lt=N;lt;lt=dt(lt))X++;for(;0<U-X;)z=dt(z),U--;for(;0<X-U;)N=dt(N),X--;for(;U--;){if(z===N||N!==null&&z===N.alternate){dt=z;break e}z=dt(z),N=dt(N)}dt=null}else dt=null;H!==null&&Hg(Y,j,H,dt,!1),nt!==null&&It!==null&&Hg(Y,It,nt,dt,!0)}}t:{if(j=F?ma(F):window,H=j.nodeName&&j.nodeName.toLowerCase(),H==="select"||H==="input"&&j.type==="file")var Lt=nd;else if(ed(j))if(sd)Lt=Iy;else{Lt=jy;var rt=Fy}else H=j.nodeName,!H||H.toLowerCase()!=="input"||j.type!=="checkbox"&&j.type!=="radio"?F&&Cl(F.elementType)&&(Lt=nd):Lt=Hy;if(Lt&&(Lt=Lt(e,F))){id(Y,Lt,a,V);break t}rt&&rt(e,j,F),e==="focusout"&&F&&j.type==="number"&&F.memoizedProps.value!=null&&Tl(j,"number",j.value)}switch(rt=F?ma(F):window,e){case"focusin":(ed(rt)||rt.contentEditable==="true")&&(Es=rt,Hl=F,Ea=null);break;case"focusout":Ea=Hl=Es=null;break;case"mousedown":Il=!0;break;case"contextmenu":case"mouseup":case"dragend":Il=!1,dd(Y,a,V);break;case"selectionchange":if(qy)break;case"keydown":case"keyup":dd(Y,a,V)}var _t;if(Pl)t:{switch(e){case"compositionstart":var Dt="onCompositionStart";break t;case"compositionend":Dt="onCompositionEnd";break t;case"compositionupdate":Dt="onCompositionUpdate";break t}Dt=void 0}else xs?Jh(e,a)&&(Dt="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(Dt="onCompositionStart");Dt&&(Qh&&a.locale!=="ko"&&(xs||Dt!=="onCompositionStart"?Dt==="onCompositionEnd"&&xs&&(_t=Vh()):(fn=V,Ol="value"in fn?fn.value:fn.textContent,xs=!0)),rt=Ro(F,Dt),0<rt.length&&(Dt=new $h(Dt,e,null,a,V),Y.push({event:Dt,listeners:rt}),_t?Dt.data=_t:(_t=td(a),_t!==null&&(Dt.data=_t)))),(_t=ky?By(e,a):zy(e,a))&&(Dt=Ro(F,"onBeforeInput"),0<Dt.length&&(rt=new $h("onBeforeInput","beforeinput",null,a,V),Y.push({event:rt,listeners:Dt}),rt.data=_t)),Cb(Y,e,F,a,V)}Fg(Y,n)})}function Qa(e,n,a){return{instance:e,listener:n,currentTarget:a}}function Ro(e,n){for(var a=n+"Capture",o=[];e!==null;){var d=e,g=d.stateNode;if(d=d.tag,d!==5&&d!==26&&d!==27||g===null||(d=ya(e,a),d!=null&&o.unshift(Qa(e,d,g)),d=ya(e,n),d!=null&&o.push(Qa(e,d,g))),e.tag===3)return o;e=e.return}return[]}function Nb(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Hg(e,n,a,o,d){for(var g=n._reactName,v=[];a!==null&&a!==o;){var _=a,M=_.alternate,F=_.stateNode;if(_=_.tag,M!==null&&M===o)break;_!==5&&_!==26&&_!==27||F===null||(M=F,d?(F=ya(a,g),F!=null&&v.unshift(Qa(a,F,M))):d||(F=ya(a,g),F!=null&&v.push(Qa(a,F,M)))),a=a.return}v.length!==0&&e.push({event:n,listeners:v})}var Ob=/\r\n?/g,Lb=/\u0000|\uFFFD/g;function Ig(e){return(typeof e=="string"?e:""+e).replace(Ob,`
`).replace(Lb,"")}function Gg(e,n){return n=Ig(n),Ig(e)===n}function Ht(e,n,a,o,d,g){switch(a){case"children":typeof o=="string"?n==="body"||n==="textarea"&&o===""||Ss(e,o):(typeof o=="number"||typeof o=="bigint")&&n!=="body"&&Ss(e,""+o);break;case"className":Lr(e,"class",o);break;case"tabIndex":Lr(e,"tabindex",o);break;case"dir":case"role":case"viewBox":case"width":case"height":Lr(e,a,o);break;case"style":Ih(e,o,g);break;case"data":if(n!=="object"){Lr(e,"data",o);break}case"src":case"href":if(o===""&&(n!=="a"||a!=="href")){e.removeAttribute(a);break}if(o==null||typeof o=="function"||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(a);break}o=Br(""+o),e.setAttribute(a,o);break;case"action":case"formAction":if(typeof o=="function"){e.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(a==="formAction"?(n!=="input"&&Ht(e,n,"name",d.name,d,null),Ht(e,n,"formEncType",d.formEncType,d,null),Ht(e,n,"formMethod",d.formMethod,d,null),Ht(e,n,"formTarget",d.formTarget,d,null)):(Ht(e,n,"encType",d.encType,d,null),Ht(e,n,"method",d.method,d,null),Ht(e,n,"target",d.target,d,null)));if(o==null||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(a);break}o=Br(""+o),e.setAttribute(a,o);break;case"onClick":o!=null&&(e.onclick=Vi);break;case"onScroll":o!=null&&Tt("scroll",e);break;case"onScrollEnd":o!=null&&Tt("scrollend",e);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(s(61));if(a=o.__html,a!=null){if(d.children!=null)throw Error(s(60));e.innerHTML=a}}break;case"multiple":e.multiple=o&&typeof o!="function"&&typeof o!="symbol";break;case"muted":e.muted=o&&typeof o!="function"&&typeof o!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(o==null||typeof o=="function"||typeof o=="boolean"||typeof o=="symbol"){e.removeAttribute("xlink:href");break}a=Br(""+o),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(a,""+o):e.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":o&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(a,""):e.removeAttribute(a);break;case"capture":case"download":o===!0?e.setAttribute(a,""):o!==!1&&o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(a,o):e.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":o!=null&&typeof o!="function"&&typeof o!="symbol"&&!isNaN(o)&&1<=o?e.setAttribute(a,o):e.removeAttribute(a);break;case"rowSpan":case"start":o==null||typeof o=="function"||typeof o=="symbol"||isNaN(o)?e.removeAttribute(a):e.setAttribute(a,o);break;case"popover":Tt("beforetoggle",e),Tt("toggle",e),Or(e,"popover",o);break;case"xlinkActuate":qi(e,"http://www.w3.org/1999/xlink","xlink:actuate",o);break;case"xlinkArcrole":qi(e,"http://www.w3.org/1999/xlink","xlink:arcrole",o);break;case"xlinkRole":qi(e,"http://www.w3.org/1999/xlink","xlink:role",o);break;case"xlinkShow":qi(e,"http://www.w3.org/1999/xlink","xlink:show",o);break;case"xlinkTitle":qi(e,"http://www.w3.org/1999/xlink","xlink:title",o);break;case"xlinkType":qi(e,"http://www.w3.org/1999/xlink","xlink:type",o);break;case"xmlBase":qi(e,"http://www.w3.org/XML/1998/namespace","xml:base",o);break;case"xmlLang":qi(e,"http://www.w3.org/XML/1998/namespace","xml:lang",o);break;case"xmlSpace":qi(e,"http://www.w3.org/XML/1998/namespace","xml:space",o);break;case"is":Or(e,"is",o);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=oy.get(a)||a,Or(e,a,o))}}function fu(e,n,a,o,d,g){switch(a){case"style":Ih(e,o,g);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(s(61));if(a=o.__html,a!=null){if(d.children!=null)throw Error(s(60));e.innerHTML=a}}break;case"children":typeof o=="string"?Ss(e,o):(typeof o=="number"||typeof o=="bigint")&&Ss(e,""+o);break;case"onScroll":o!=null&&Tt("scroll",e);break;case"onScrollEnd":o!=null&&Tt("scrollend",e);break;case"onClick":o!=null&&(e.onclick=Vi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Lh.hasOwnProperty(a))t:{if(a[0]==="o"&&a[1]==="n"&&(d=a.endsWith("Capture"),n=a.slice(2,d?a.length-7:void 0),g=e[He]||null,g=g!=null?g[a]:null,typeof g=="function"&&e.removeEventListener(n,g,d),typeof o=="function")){typeof g!="function"&&g!==null&&(a in e?e[a]=null:e.hasAttribute(a)&&e.removeAttribute(a)),e.addEventListener(n,o,d);break t}a in e?e[a]=o:o===!0?e.setAttribute(a,""):Or(e,a,o)}}}function Ee(e,n,a){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Tt("error",e),Tt("load",e);var o=!1,d=!1,g;for(g in a)if(a.hasOwnProperty(g)){var v=a[g];if(v!=null)switch(g){case"src":o=!0;break;case"srcSet":d=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:Ht(e,n,g,v,a,null)}}d&&Ht(e,n,"srcSet",a.srcSet,a,null),o&&Ht(e,n,"src",a.src,a,null);return;case"input":Tt("invalid",e);var _=g=v=d=null,M=null,F=null;for(o in a)if(a.hasOwnProperty(o)){var V=a[o];if(V!=null)switch(o){case"name":d=V;break;case"type":v=V;break;case"checked":M=V;break;case"defaultChecked":F=V;break;case"value":g=V;break;case"defaultValue":_=V;break;case"children":case"dangerouslySetInnerHTML":if(V!=null)throw Error(s(137,n));break;default:Ht(e,n,o,V,a,null)}}Uh(e,g,_,M,F,v,d,!1);return;case"select":Tt("invalid",e),o=v=g=null;for(d in a)if(a.hasOwnProperty(d)&&(_=a[d],_!=null))switch(d){case"value":g=_;break;case"defaultValue":v=_;break;case"multiple":o=_;default:Ht(e,n,d,_,a,null)}n=g,a=v,e.multiple=!!o,n!=null?As(e,!!o,n,!1):a!=null&&As(e,!!o,a,!0);return;case"textarea":Tt("invalid",e),g=d=o=null;for(v in a)if(a.hasOwnProperty(v)&&(_=a[v],_!=null))switch(v){case"value":o=_;break;case"defaultValue":d=_;break;case"children":g=_;break;case"dangerouslySetInnerHTML":if(_!=null)throw Error(s(91));break;default:Ht(e,n,v,_,a,null)}jh(e,o,d,g);return;case"option":for(M in a)if(a.hasOwnProperty(M)&&(o=a[M],o!=null))switch(M){case"selected":e.selected=o&&typeof o!="function"&&typeof o!="symbol";break;default:Ht(e,n,M,o,a,null)}return;case"dialog":Tt("beforetoggle",e),Tt("toggle",e),Tt("cancel",e),Tt("close",e);break;case"iframe":case"object":Tt("load",e);break;case"video":case"audio":for(o=0;o<Ka.length;o++)Tt(Ka[o],e);break;case"image":Tt("error",e),Tt("load",e);break;case"details":Tt("toggle",e);break;case"embed":case"source":case"link":Tt("error",e),Tt("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(F in a)if(a.hasOwnProperty(F)&&(o=a[F],o!=null))switch(F){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:Ht(e,n,F,o,a,null)}return;default:if(Cl(n)){for(V in a)a.hasOwnProperty(V)&&(o=a[V],o!==void 0&&fu(e,n,V,o,a,void 0));return}}for(_ in a)a.hasOwnProperty(_)&&(o=a[_],o!=null&&Ht(e,n,_,o,a,null))}function kb(e,n,a,o){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var d=null,g=null,v=null,_=null,M=null,F=null,V=null;for(H in a){var Y=a[H];if(a.hasOwnProperty(H)&&Y!=null)switch(H){case"checked":break;case"value":break;case"defaultValue":M=Y;default:o.hasOwnProperty(H)||Ht(e,n,H,null,o,Y)}}for(var j in o){var H=o[j];if(Y=a[j],o.hasOwnProperty(j)&&(H!=null||Y!=null))switch(j){case"type":g=H;break;case"name":d=H;break;case"checked":F=H;break;case"defaultChecked":V=H;break;case"value":v=H;break;case"defaultValue":_=H;break;case"children":case"dangerouslySetInnerHTML":if(H!=null)throw Error(s(137,n));break;default:H!==Y&&Ht(e,n,j,H,o,Y)}}El(e,v,_,M,F,V,g,d);return;case"select":H=v=_=j=null;for(g in a)if(M=a[g],a.hasOwnProperty(g)&&M!=null)switch(g){case"value":break;case"multiple":H=M;default:o.hasOwnProperty(g)||Ht(e,n,g,null,o,M)}for(d in o)if(g=o[d],M=a[d],o.hasOwnProperty(d)&&(g!=null||M!=null))switch(d){case"value":j=g;break;case"defaultValue":_=g;break;case"multiple":v=g;default:g!==M&&Ht(e,n,d,g,o,M)}n=_,a=v,o=H,j!=null?As(e,!!a,j,!1):!!o!=!!a&&(n!=null?As(e,!!a,n,!0):As(e,!!a,a?[]:"",!1));return;case"textarea":H=j=null;for(_ in a)if(d=a[_],a.hasOwnProperty(_)&&d!=null&&!o.hasOwnProperty(_))switch(_){case"value":break;case"children":break;default:Ht(e,n,_,null,o,d)}for(v in o)if(d=o[v],g=a[v],o.hasOwnProperty(v)&&(d!=null||g!=null))switch(v){case"value":j=d;break;case"defaultValue":H=d;break;case"children":break;case"dangerouslySetInnerHTML":if(d!=null)throw Error(s(91));break;default:d!==g&&Ht(e,n,v,d,o,g)}Fh(e,j,H);return;case"option":for(var nt in a)if(j=a[nt],a.hasOwnProperty(nt)&&j!=null&&!o.hasOwnProperty(nt))switch(nt){case"selected":e.selected=!1;break;default:Ht(e,n,nt,null,o,j)}for(M in o)if(j=o[M],H=a[M],o.hasOwnProperty(M)&&j!==H&&(j!=null||H!=null))switch(M){case"selected":e.selected=j&&typeof j!="function"&&typeof j!="symbol";break;default:Ht(e,n,M,j,o,H)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var dt in a)j=a[dt],a.hasOwnProperty(dt)&&j!=null&&!o.hasOwnProperty(dt)&&Ht(e,n,dt,null,o,j);for(F in o)if(j=o[F],H=a[F],o.hasOwnProperty(F)&&j!==H&&(j!=null||H!=null))switch(F){case"children":case"dangerouslySetInnerHTML":if(j!=null)throw Error(s(137,n));break;default:Ht(e,n,F,j,o,H)}return;default:if(Cl(n)){for(var It in a)j=a[It],a.hasOwnProperty(It)&&j!==void 0&&!o.hasOwnProperty(It)&&fu(e,n,It,void 0,o,j);for(V in o)j=o[V],H=a[V],!o.hasOwnProperty(V)||j===H||j===void 0&&H===void 0||fu(e,n,V,j,o,H);return}}for(var z in a)j=a[z],a.hasOwnProperty(z)&&j!=null&&!o.hasOwnProperty(z)&&Ht(e,n,z,null,o,j);for(Y in o)j=o[Y],H=a[Y],!o.hasOwnProperty(Y)||j===H||j==null&&H==null||Ht(e,n,Y,j,o,H)}function qg(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Bb(){if(typeof performance.getEntriesByType=="function"){for(var e=0,n=0,a=performance.getEntriesByType("resource"),o=0;o<a.length;o++){var d=a[o],g=d.transferSize,v=d.initiatorType,_=d.duration;if(g&&_&&qg(v)){for(v=0,_=d.responseEnd,o+=1;o<a.length;o++){var M=a[o],F=M.startTime;if(F>_)break;var V=M.transferSize,Y=M.initiatorType;V&&qg(Y)&&(M=M.responseEnd,v+=V*(M<_?1:(_-F)/(M-F)))}if(--o,n+=8*(g+v)/(d.duration/1e3),e++,10<e)break}}if(0<e)return n/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var gu=null,pu=null;function No(e){return e.nodeType===9?e:e.ownerDocument}function Vg(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Xg(e,n){if(e===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&n==="foreignObject"?0:e}function mu(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var yu=null;function zb(){var e=window.event;return e&&e.type==="popstate"?e===yu?!1:(yu=e,!0):(yu=null,!1)}var Yg=typeof setTimeout=="function"?setTimeout:void 0,Pb=typeof clearTimeout=="function"?clearTimeout:void 0,$g=typeof Promise=="function"?Promise:void 0,Ub=typeof queueMicrotask=="function"?queueMicrotask:typeof $g<"u"?function(e){return $g.resolve(null).then(e).catch(Fb)}:Yg;function Fb(e){setTimeout(function(){throw e})}function Rn(e){return e==="head"}function Kg(e,n){var a=n,o=0;do{var d=a.nextSibling;if(e.removeChild(a),d&&d.nodeType===8)if(a=d.data,a==="/$"||a==="/&"){if(o===0){e.removeChild(d),Ws(n);return}o--}else if(a==="$"||a==="$?"||a==="$~"||a==="$!"||a==="&")o++;else if(a==="html")Za(e.ownerDocument.documentElement);else if(a==="head"){a=e.ownerDocument.head,Za(a);for(var g=a.firstChild;g;){var v=g.nextSibling,_=g.nodeName;g[pa]||_==="SCRIPT"||_==="STYLE"||_==="LINK"&&g.rel.toLowerCase()==="stylesheet"||a.removeChild(g),g=v}}else a==="body"&&Za(e.ownerDocument.body);a=d}while(a);Ws(n)}function Qg(e,n){var a=e;e=0;do{var o=a.nextSibling;if(a.nodeType===1?n?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",a.getAttribute("style")===""&&a.removeAttribute("style")):a.nodeType===3&&(n?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),o&&o.nodeType===8)if(a=o.data,a==="/$"){if(e===0)break;e--}else a!=="$"&&a!=="$?"&&a!=="$~"&&a!=="$!"||e++;a=o}while(a)}function bu(e){var n=e.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var a=n;switch(n=n.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":bu(a),_l(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}e.removeChild(a)}}function jb(e,n,a,o){for(;e.nodeType===1;){var d=a;if(e.nodeName.toLowerCase()!==n.toLowerCase()){if(!o&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(o){if(!e[pa])switch(n){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(g=e.getAttribute("rel"),g==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(g!==d.rel||e.getAttribute("href")!==(d.href==null||d.href===""?null:d.href)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin)||e.getAttribute("title")!==(d.title==null?null:d.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(g=e.getAttribute("src"),(g!==(d.src==null?null:d.src)||e.getAttribute("type")!==(d.type==null?null:d.type)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin))&&g&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(n==="input"&&e.type==="hidden"){var g=d.name==null?null:""+d.name;if(d.type==="hidden"&&e.getAttribute("name")===g)return e}else return e;if(e=bi(e.nextSibling),e===null)break}return null}function Hb(e,n,a){if(n==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!a||(e=bi(e.nextSibling),e===null))return null;return e}function Zg(e,n){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=bi(e.nextSibling),e===null))return null;return e}function vu(e){return e.data==="$?"||e.data==="$~"}function Au(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Ib(e,n){var a=e.ownerDocument;if(e.data==="$~")e._reactRetry=n;else if(e.data!=="$?"||a.readyState!=="loading")n();else{var o=function(){n(),a.removeEventListener("DOMContentLoaded",o)};a.addEventListener("DOMContentLoaded",o),e._reactRetry=o}}function bi(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"||n==="F!"||n==="F")break;if(n==="/$"||n==="/&")return null}}return e}var Su=null;function Wg(e){e=e.nextSibling;for(var n=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"||a==="/&"){if(n===0)return bi(e.nextSibling);n--}else a!=="$"&&a!=="$!"&&a!=="$?"&&a!=="$~"&&a!=="&"||n++}e=e.nextSibling}return null}function Jg(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"){if(n===0)return e;n--}else a!=="/$"&&a!=="/&"||n++}e=e.previousSibling}return null}function tp(e,n,a){switch(n=No(a),e){case"html":if(e=n.documentElement,!e)throw Error(s(452));return e;case"head":if(e=n.head,!e)throw Error(s(453));return e;case"body":if(e=n.body,!e)throw Error(s(454));return e;default:throw Error(s(451))}}function Za(e){for(var n=e.attributes;n.length;)e.removeAttributeNode(n[0]);_l(e)}var vi=new Map,ep=new Set;function Oo(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var ln=q.d;q.d={f:Gb,r:qb,D:Vb,C:Xb,L:Yb,m:$b,X:Qb,S:Kb,M:Zb};function Gb(){var e=ln.f(),n=_o();return e||n}function qb(e){var n=ys(e);n!==null&&n.tag===5&&n.type==="form"?bf(n):ln.r(e)}var Ks=typeof document>"u"?null:document;function ip(e,n,a){var o=Ks;if(o&&typeof n=="string"&&n){var d=hi(n);d='link[rel="'+e+'"][href="'+d+'"]',typeof a=="string"&&(d+='[crossorigin="'+a+'"]'),ep.has(d)||(ep.add(d),e={rel:e,crossOrigin:a,href:n},o.querySelector(d)===null&&(n=o.createElement("link"),Ee(n,"link",e),me(n),o.head.appendChild(n)))}}function Vb(e){ln.D(e),ip("dns-prefetch",e,null)}function Xb(e,n){ln.C(e,n),ip("preconnect",e,n)}function Yb(e,n,a){ln.L(e,n,a);var o=Ks;if(o&&e&&n){var d='link[rel="preload"][as="'+hi(n)+'"]';n==="image"&&a&&a.imageSrcSet?(d+='[imagesrcset="'+hi(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(d+='[imagesizes="'+hi(a.imageSizes)+'"]')):d+='[href="'+hi(e)+'"]';var g=d;switch(n){case"style":g=Qs(e);break;case"script":g=Zs(e)}vi.has(g)||(e=y({rel:"preload",href:n==="image"&&a&&a.imageSrcSet?void 0:e,as:n},a),vi.set(g,e),o.querySelector(d)!==null||n==="style"&&o.querySelector(Wa(g))||n==="script"&&o.querySelector(Ja(g))||(n=o.createElement("link"),Ee(n,"link",e),me(n),o.head.appendChild(n)))}}function $b(e,n){ln.m(e,n);var a=Ks;if(a&&e){var o=n&&typeof n.as=="string"?n.as:"script",d='link[rel="modulepreload"][as="'+hi(o)+'"][href="'+hi(e)+'"]',g=d;switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=Zs(e)}if(!vi.has(g)&&(e=y({rel:"modulepreload",href:e},n),vi.set(g,e),a.querySelector(d)===null)){switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(Ja(g)))return}o=a.createElement("link"),Ee(o,"link",e),me(o),a.head.appendChild(o)}}}function Kb(e,n,a){ln.S(e,n,a);var o=Ks;if(o&&e){var d=bs(o).hoistableStyles,g=Qs(e);n=n||"default";var v=d.get(g);if(!v){var _={loading:0,preload:null};if(v=o.querySelector(Wa(g)))_.loading=5;else{e=y({rel:"stylesheet",href:e,"data-precedence":n},a),(a=vi.get(g))&&wu(e,a);var M=v=o.createElement("link");me(M),Ee(M,"link",e),M._p=new Promise(function(F,V){M.onload=F,M.onerror=V}),M.addEventListener("load",function(){_.loading|=1}),M.addEventListener("error",function(){_.loading|=2}),_.loading|=4,Lo(v,n,o)}v={type:"stylesheet",instance:v,count:1,state:_},d.set(g,v)}}}function Qb(e,n){ln.X(e,n);var a=Ks;if(a&&e){var o=bs(a).hoistableScripts,d=Zs(e),g=o.get(d);g||(g=a.querySelector(Ja(d)),g||(e=y({src:e,async:!0},n),(n=vi.get(d))&&_u(e,n),g=a.createElement("script"),me(g),Ee(g,"link",e),a.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},o.set(d,g))}}function Zb(e,n){ln.M(e,n);var a=Ks;if(a&&e){var o=bs(a).hoistableScripts,d=Zs(e),g=o.get(d);g||(g=a.querySelector(Ja(d)),g||(e=y({src:e,async:!0,type:"module"},n),(n=vi.get(d))&&_u(e,n),g=a.createElement("script"),me(g),Ee(g,"link",e),a.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},o.set(d,g))}}function np(e,n,a,o){var d=(d=ft.current)?Oo(d):null;if(!d)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(n=Qs(a.href),a=bs(d).hoistableStyles,o=a.get(n),o||(o={type:"style",instance:null,count:0,state:null},a.set(n,o)),o):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){e=Qs(a.href);var g=bs(d).hoistableStyles,v=g.get(e);if(v||(d=d.ownerDocument||d,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(e,v),(g=d.querySelector(Wa(e)))&&!g._p&&(v.instance=g,v.state.loading=5),vi.has(e)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},vi.set(e,a),g||Wb(d,e,a,v.state))),n&&o===null)throw Error(s(528,""));return v}if(n&&o!==null)throw Error(s(529,""));return null;case"script":return n=a.async,a=a.src,typeof a=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=Zs(a),a=bs(d).hoistableScripts,o=a.get(n),o||(o={type:"script",instance:null,count:0,state:null},a.set(n,o)),o):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function Qs(e){return'href="'+hi(e)+'"'}function Wa(e){return'link[rel="stylesheet"]['+e+"]"}function sp(e){return y({},e,{"data-precedence":e.precedence,precedence:null})}function Wb(e,n,a,o){e.querySelector('link[rel="preload"][as="style"]['+n+"]")?o.loading=1:(n=e.createElement("link"),o.preload=n,n.addEventListener("load",function(){return o.loading|=1}),n.addEventListener("error",function(){return o.loading|=2}),Ee(n,"link",a),me(n),e.head.appendChild(n))}function Zs(e){return'[src="'+hi(e)+'"]'}function Ja(e){return"script[async]"+e}function ap(e,n,a){if(n.count++,n.instance===null)switch(n.type){case"style":var o=e.querySelector('style[data-href~="'+hi(a.href)+'"]');if(o)return n.instance=o,me(o),o;var d=y({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return o=(e.ownerDocument||e).createElement("style"),me(o),Ee(o,"style",d),Lo(o,a.precedence,e),n.instance=o;case"stylesheet":d=Qs(a.href);var g=e.querySelector(Wa(d));if(g)return n.state.loading|=4,n.instance=g,me(g),g;o=sp(a),(d=vi.get(d))&&wu(o,d),g=(e.ownerDocument||e).createElement("link"),me(g);var v=g;return v._p=new Promise(function(_,M){v.onload=_,v.onerror=M}),Ee(g,"link",o),n.state.loading|=4,Lo(g,a.precedence,e),n.instance=g;case"script":return g=Zs(a.src),(d=e.querySelector(Ja(g)))?(n.instance=d,me(d),d):(o=a,(d=vi.get(g))&&(o=y({},a),_u(o,d)),e=e.ownerDocument||e,d=e.createElement("script"),me(d),Ee(d,"link",o),e.head.appendChild(d),n.instance=d);case"void":return null;default:throw Error(s(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(o=n.instance,n.state.loading|=4,Lo(o,a.precedence,e));return n.instance}function Lo(e,n,a){for(var o=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),d=o.length?o[o.length-1]:null,g=d,v=0;v<o.length;v++){var _=o[v];if(_.dataset.precedence===n)g=_;else if(g!==d)break}g?g.parentNode.insertBefore(e,g.nextSibling):(n=a.nodeType===9?a.head:a,n.insertBefore(e,n.firstChild))}function wu(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.title==null&&(e.title=n.title)}function _u(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.integrity==null&&(e.integrity=n.integrity)}var ko=null;function rp(e,n,a){if(ko===null){var o=new Map,d=ko=new Map;d.set(a,o)}else d=ko,o=d.get(a),o||(o=new Map,d.set(a,o));if(o.has(e))return o;for(o.set(e,null),a=a.getElementsByTagName(e),d=0;d<a.length;d++){var g=a[d];if(!(g[pa]||g[Se]||e==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var v=g.getAttribute(n)||"";v=e+v;var _=o.get(v);_?_.push(g):o.set(v,[g])}}return o}function op(e,n,a){e=e.ownerDocument||e,e.head.insertBefore(a,n==="title"?e.querySelector("head > title"):null)}function Jb(e,n,a){if(a===1||n.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;switch(n.rel){case"stylesheet":return e=n.disabled,typeof n.precedence=="string"&&e==null;default:return!0}case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function lp(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function t0(e,n,a,o){if(a.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var d=Qs(o.href),g=n.querySelector(Wa(d));if(g){n=g._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(e.count++,e=Bo.bind(e),n.then(e,e)),a.state.loading|=4,a.instance=g,me(g);return}g=n.ownerDocument||n,o=sp(o),(d=vi.get(d))&&wu(o,d),g=g.createElement("link"),me(g);var v=g;v._p=new Promise(function(_,M){v.onload=_,v.onerror=M}),Ee(g,"link",o),a.instance=g}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(a,n),(n=a.state.preload)&&(a.state.loading&3)===0&&(e.count++,a=Bo.bind(e),n.addEventListener("load",a),n.addEventListener("error",a))}}var xu=0;function e0(e,n){return e.stylesheets&&e.count===0&&Po(e,e.stylesheets),0<e.count||0<e.imgCount?function(a){var o=setTimeout(function(){if(e.stylesheets&&Po(e,e.stylesheets),e.unsuspend){var g=e.unsuspend;e.unsuspend=null,g()}},6e4+n);0<e.imgBytes&&xu===0&&(xu=62500*Bb());var d=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Po(e,e.stylesheets),e.unsuspend)){var g=e.unsuspend;e.unsuspend=null,g()}},(e.imgBytes>xu?50:800)+n);return e.unsuspend=a,function(){e.unsuspend=null,clearTimeout(o),clearTimeout(d)}}:null}function Bo(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Po(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var zo=null;function Po(e,n){e.stylesheets=null,e.unsuspend!==null&&(e.count++,zo=new Map,n.forEach(i0,e),zo=null,Bo.call(e))}function i0(e,n){if(!(n.state.loading&4)){var a=zo.get(e);if(a)var o=a.get(null);else{a=new Map,zo.set(e,a);for(var d=e.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<d.length;g++){var v=d[g];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(a.set(v.dataset.precedence,v),o=v)}o&&a.set(null,o)}d=n.instance,v=d.getAttribute("data-precedence"),g=a.get(v)||o,g===o&&a.set(null,d),a.set(v,d),this.count++,o=Bo.bind(this),d.addEventListener("load",o),d.addEventListener("error",o),g?g.parentNode.insertBefore(d,g.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(d,e.firstChild)),n.state.loading|=4}}var tr={$$typeof:T,Provider:null,Consumer:null,_currentValue:Z,_currentValue2:Z,_threadCount:0};function n0(e,n,a,o,d,g,v,_,M){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=vl(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vl(0),this.hiddenUpdates=vl(null),this.identifierPrefix=o,this.onUncaughtError=d,this.onCaughtError=g,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=M,this.incompleteTransitions=new Map}function cp(e,n,a,o,d,g,v,_,M,F,V,Y){return e=new n0(e,n,a,v,M,F,V,Y,_),n=1,g===!0&&(n|=24),g=ei(3,null,null,n),e.current=g,g.stateNode=e,n=nc(),n.refCount++,e.pooledCache=n,n.refCount++,g.memoizedState={element:o,isDehydrated:a,cache:n},oc(g),e}function up(e){return e?(e=Ms,e):Ms}function hp(e,n,a,o,d,g){d=up(d),o.context===null?o.context=d:o.pendingContext=d,o=vn(n),o.payload={element:a},g=g===void 0?null:g,g!==null&&(o.callback=g),a=An(e,o,n),a!==null&&(Ye(a,e,n),Oa(a,e,n))}function dp(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<n?a:n}}function Eu(e,n){dp(e,n),(e=e.alternate)&&dp(e,n)}function fp(e){if(e.tag===13||e.tag===31){var n=Vn(e,67108864);n!==null&&Ye(n,e,67108864),Eu(e,67108864)}}function gp(e){if(e.tag===13||e.tag===31){var n=ri();n=Al(n);var a=Vn(e,n);a!==null&&Ye(a,e,n),Eu(e,n)}}var Uo=!0;function s0(e,n,a,o){var d=k.T;k.T=null;var g=q.p;try{q.p=2,Tu(e,n,a,o)}finally{q.p=g,k.T=d}}function a0(e,n,a,o){var d=k.T;k.T=null;var g=q.p;try{q.p=8,Tu(e,n,a,o)}finally{q.p=g,k.T=d}}function Tu(e,n,a,o){if(Uo){var d=Cu(o);if(d===null)du(e,n,o,Fo,a),mp(e,o);else if(o0(d,e,n,a,o))o.stopPropagation();else if(mp(e,o),n&4&&-1<r0.indexOf(e)){for(;d!==null;){var g=ys(d);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var v=jn(g.pendingLanes);if(v!==0){var _=g;for(_.pendingLanes|=2,_.entangledLanes|=2;v;){var M=1<<31-ke(v);_.entanglements[1]|=M,v&=~M}zi(g),(Bt&6)===0&&(So=Le()+500,$a(0))}}break;case 31:case 13:_=Vn(g,2),_!==null&&Ye(_,g,2),_o(),Eu(g,2)}if(g=Cu(o),g===null&&du(e,n,o,Fo,a),g===d)break;d=g}d!==null&&o.stopPropagation()}else du(e,n,o,null,a)}}function Cu(e){return e=Dl(e),Mu(e)}var Fo=null;function Mu(e){if(Fo=null,e=ms(e),e!==null){var n=l(e);if(n===null)e=null;else{var a=n.tag;if(a===13){if(e=c(n),e!==null)return e;e=null}else if(a===31){if(e=u(n),e!==null)return e;e=null}else if(a===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null)}}return Fo=e,null}function pp(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(bl()){case Je:return 2;case Ae:return 8;case Ni:case $:return 32;case J:return 268435456;default:return 32}default:return 32}}var Du=!1,Nn=null,On=null,Ln=null,er=new Map,ir=new Map,kn=[],r0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function mp(e,n){switch(e){case"focusin":case"focusout":Nn=null;break;case"dragenter":case"dragleave":On=null;break;case"mouseover":case"mouseout":Ln=null;break;case"pointerover":case"pointerout":er.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":ir.delete(n.pointerId)}}function nr(e,n,a,o,d,g){return e===null||e.nativeEvent!==g?(e={blockedOn:n,domEventName:a,eventSystemFlags:o,nativeEvent:g,targetContainers:[d]},n!==null&&(n=ys(n),n!==null&&fp(n)),e):(e.eventSystemFlags|=o,n=e.targetContainers,d!==null&&n.indexOf(d)===-1&&n.push(d),e)}function o0(e,n,a,o,d){switch(n){case"focusin":return Nn=nr(Nn,e,n,a,o,d),!0;case"dragenter":return On=nr(On,e,n,a,o,d),!0;case"mouseover":return Ln=nr(Ln,e,n,a,o,d),!0;case"pointerover":var g=d.pointerId;return er.set(g,nr(er.get(g)||null,e,n,a,o,d)),!0;case"gotpointercapture":return g=d.pointerId,ir.set(g,nr(ir.get(g)||null,e,n,a,o,d)),!0}return!1}function yp(e){var n=ms(e.target);if(n!==null){var a=l(n);if(a!==null){if(n=a.tag,n===13){if(n=c(a),n!==null){e.blockedOn=n,Rh(e.priority,function(){gp(a)});return}}else if(n===31){if(n=u(a),n!==null){e.blockedOn=n,Rh(e.priority,function(){gp(a)});return}}else if(n===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function jo(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var a=Cu(e.nativeEvent);if(a===null){a=e.nativeEvent;var o=new a.constructor(a.type,a);Ml=o,a.target.dispatchEvent(o),Ml=null}else return n=ys(a),n!==null&&fp(n),e.blockedOn=a,!1;n.shift()}return!0}function bp(e,n,a){jo(e)&&a.delete(n)}function l0(){Du=!1,Nn!==null&&jo(Nn)&&(Nn=null),On!==null&&jo(On)&&(On=null),Ln!==null&&jo(Ln)&&(Ln=null),er.forEach(bp),ir.forEach(bp)}function Ho(e,n){e.blockedOn===n&&(e.blockedOn=null,Du||(Du=!0,m.unstable_scheduleCallback(m.unstable_NormalPriority,l0)))}var Io=null;function vp(e){Io!==e&&(Io=e,m.unstable_scheduleCallback(m.unstable_NormalPriority,function(){Io===e&&(Io=null);for(var n=0;n<e.length;n+=3){var a=e[n],o=e[n+1],d=e[n+2];if(typeof o!="function"){if(Mu(o||a)===null)continue;break}var g=ys(a);g!==null&&(e.splice(n,3),n-=3,Cc(g,{pending:!0,data:d,method:a.method,action:o},o,d))}}))}function Ws(e){function n(M){return Ho(M,e)}Nn!==null&&Ho(Nn,e),On!==null&&Ho(On,e),Ln!==null&&Ho(Ln,e),er.forEach(n),ir.forEach(n);for(var a=0;a<kn.length;a++){var o=kn[a];o.blockedOn===e&&(o.blockedOn=null)}for(;0<kn.length&&(a=kn[0],a.blockedOn===null);)yp(a),a.blockedOn===null&&kn.shift();if(a=(e.ownerDocument||e).$$reactFormReplay,a!=null)for(o=0;o<a.length;o+=3){var d=a[o],g=a[o+1],v=d[He]||null;if(typeof g=="function")v||vp(a);else if(v){var _=null;if(g&&g.hasAttribute("formAction")){if(d=g,v=g[He]||null)_=v.formAction;else if(Mu(d)!==null)continue}else _=v.action;typeof _=="function"?a[o+1]=_:(a.splice(o,3),o-=3),vp(a)}}}function Ap(){function e(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(v){return d=v})},focusReset:"manual",scroll:"manual"})}function n(){d!==null&&(d(),d=null),o||setTimeout(a,20)}function a(){if(!o&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var o=!1,d=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",n),navigation.addEventListener("navigateerror",n),setTimeout(a,100),function(){o=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",n),navigation.removeEventListener("navigateerror",n),d!==null&&(d(),d=null)}}}function Ru(e){this._internalRoot=e}Go.prototype.render=Ru.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(s(409));var a=n.current,o=ri();hp(a,o,e,n,null,null)},Go.prototype.unmount=Ru.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;hp(e.current,2,null,e,null,null),_o(),n[ps]=null}};function Go(e){this._internalRoot=e}Go.prototype.unstable_scheduleHydration=function(e){if(e){var n=Dh();e={blockedOn:null,target:e,priority:n};for(var a=0;a<kn.length&&n!==0&&n<kn[a].priority;a++);kn.splice(a,0,e),a===0&&yp(e)}};var Sp=t.version;if(Sp!=="19.2.0")throw Error(s(527,Sp,"19.2.0"));q.findDOMNode=function(e){var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(s(188)):(e=Object.keys(e).join(","),Error(s(268,e)));return e=f(n),e=e!==null?p(e):null,e=e===null?null:e.stateNode,e};var c0={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:k,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qo.isDisabled&&qo.supportsFiber)try{Oi=qo.inject(c0),ee=qo}catch{}}return ar.createRoot=function(e,n){if(!r(e))throw Error(s(299));var a=!1,o="",d=Mf,g=Df,v=Rf;return n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onUncaughtError!==void 0&&(d=n.onUncaughtError),n.onCaughtError!==void 0&&(g=n.onCaughtError),n.onRecoverableError!==void 0&&(v=n.onRecoverableError)),n=cp(e,1,!1,null,null,a,o,null,d,g,v,Ap),e[ps]=n.current,hu(e),new Ru(n)},ar.hydrateRoot=function(e,n,a){if(!r(e))throw Error(s(299));var o=!1,d="",g=Mf,v=Df,_=Rf,M=null;return a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(d=a.identifierPrefix),a.onUncaughtError!==void 0&&(g=a.onUncaughtError),a.onCaughtError!==void 0&&(v=a.onCaughtError),a.onRecoverableError!==void 0&&(_=a.onRecoverableError),a.formState!==void 0&&(M=a.formState)),n=cp(e,1,!0,n,a??null,o,d,M,g,v,_,Ap),n.context=up(null),a=n.current,o=ri(),o=Al(o),d=vn(o),d.callback=null,An(a,d,o),a=o,n.current.lanes=a,ga(n,a),zi(n),e[ps]=n.current,hu(e),new Go(n)},ar.version="19.2.0",ar}var Lp;function v0(){if(Lp)return ku.exports;Lp=1;function m(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(m)}catch(t){console.error(t)}}return m(),ku.exports=b0(),ku.exports}var A0=v0();const S0=["Keep text  2.5 mm x-height and hairlines  0.5 mm for DTF prints.","Avoid semi-transparent layers; use solid colors for best adhesion."];function Ze(m,t=2){const i=10**t;return Math.round(m*i)/i}function kp(m,t){return m/t}function Bp(m,t,i){const s=kp(m,i),r=kp(t,i);return{w_in:Ze(s),h_in:Ze(r),w_cm:Ze(s*2.54),h_cm:Ze(r*2.54)}}function zp(m,t){return{w_in:Ze(m),h_in:Ze(t),w_cm:Ze(m*2.54),h_cm:Ze(t*2.54)}}function w0(m,t){return{at300dpi:Bp(m,t,300),at150dpi:Bp(m,t,150)}}function _0(m,t){return{at300dpi:zp(m,t),at150dpi:zp(m,t)}}function x0({dpi:m,width:t,height:i}){if(m!==null)return m>=300?"Optimal":m>=150?"Good":"Poor";const s=Math.min(t,i);return s>=4500?"Optimal":s>=2250?"Good":"Poor"}function dm(){return[...S0]}function fm(m,t){return t===0?m:fm(t,m%t)}function gm(m,t){if(!m||!t)return"N/A";const i=1e3,s=Math.round(m*i),r=Math.round(t*i),l=fm(s,r),c=Math.round(s/l),u=Math.round(r/l),h=Ze(m/t,2);return`${c}:${u} (${h}:1)`}const E0=new Uint8Array([137,80,78,71,13,10,26,10]),T0=new Set([4,6]);function Vo(m,t){return(m[t]<<24|m[t+1]<<16|m[t+2]<<8|m[t+3])>>>0}function Pp(m,t,i){return new TextDecoder("ascii").decode(m.subarray(t,t+i))}function C0(m){if(m.length<8||!E0.every((p,y)=>m[y]===p))throw new Error("Invalid PNG signature");let t=8,i=0,s=0,r=0,l=0,c=!1,u=!1,h=null,f;for(;t<m.length;){const p=Vo(m,t),y=Pp(m,t+4,4),b=t+8,A=b+p;if(y==="IHDR")i=Vo(m,b),s=Vo(m,b+4),r=m[b+8],l=m[b+9],c=T0.has(l);else if(y==="pHYs"){const w=Vo(m,b);m[b+8]===1&&w>0&&(h=Math.round(w/1/39.37007874))}else if(y==="iCCP"){const w=m.indexOf(0,b);w>b&&(f=Pp(m,b,w-b))}else y==="tRNS"&&(u=!0);if(t=A+4,y==="IEND")break}return{width:i,height:s,bitDepth:r,colorType:l,hasAlpha:c||u,hasTransparencyChunk:u,dpi:h,iccProfile:f}}async function M0(m){const t=await m.arrayBuffer(),i=new Uint8Array(t),s=C0(i);if(!s.width||!s.height)throw new Error("Unable to read PNG dimensions");const r=s.dpi??null,l=x0({dpi:r,width:s.width,height:s.height}),c=dm();return r===null&&c.push("No embedded DPI value found (pHYs chunk missing)."),s.hasAlpha?c.push("Alpha channel detected in artwork."):c.push("No alpha channel detected."),s.iccProfile?c.push(`Embedded ICC profile: ${s.iccProfile}.`):c.push("No embedded ICC profile detected."),{fileType:"png",fileSizeMB:Ze(m.size/(1024*1024),2),pixels:{w:s.width,h:s.height},dpi:r,hasICC:!!s.iccProfile,iccProfile:s.iccProfile,bitDepth:s.bitDepth,hasAlpha:s.hasAlpha,alphaStats:void 0,imageCategory:"Raster",recommendedSizes:w0(s.width,s.height),aspectRatio:gm(s.width,s.height),rating:l,notes:c}}const Pe=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),$u=[.001,0,0,.001,0,0],Uu=1.35,oi={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},zn={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},pr="pdfjs_internal_editor_",At={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Nt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},D0={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Ku={TRIANGLES:1,LATTICE:2},Te={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},el={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},fe={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},ea={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},ll={ERRORS:0,WARNINGS:1,INFOS:5},mr={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},rr={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},R0={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let cl=ll.WARNINGS;function N0(m){Number.isInteger(m)&&(cl=m)}function O0(){return cl}function ul(m){cl>=ll.INFOS&&console.info(`Info: ${m}`)}function bt(m){cl>=ll.WARNINGS&&console.warn(`Warning: ${m}`)}function Vt(m){throw new Error(m)}function Ot(m,t){m||Vt(t)}function L0(m){switch(m?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function pm(m,t=null,i=null){if(!m)return null;if(i&&typeof m=="string"&&(i.addDefaultProtocol&&m.startsWith("www.")&&m.match(/\./g)?.length>=2&&(m=`http://${m}`),i.tryConvertEncoding))try{m=U0(m)}catch{}const s=t?URL.parse(m,t):URL.parse(m);return L0(s)?s:null}function mm(m,t,i=!1){const s=URL.parse(m);return s?(s.hash=t,s.href):i&&pm(m,"http://example.com")?m.split("#",1)[0]+`${t?`#${t}`:""}`:""}function wt(m,t,i,s=!1){return Object.defineProperty(m,t,{value:i,enumerable:!s,configurable:!0,writable:!1}),i}const hs=(function(){function t(i,s){this.message=i,this.name=s}return t.prototype=new Error,t.constructor=t,t})();class Up extends hs{constructor(t,i){super(t,"PasswordException"),this.code=i}}class Fu extends hs{constructor(t,i){super(t,"UnknownErrorException"),this.details=i}}class Qu extends hs{constructor(t){super(t,"InvalidPDFException")}}class sl extends hs{constructor(t,i,s){super(t,"ResponseException"),this.status=i,this.missing=s}}class k0 extends hs{constructor(t){super(t,"FormatError")}}class Un extends hs{constructor(t){super(t,"AbortException")}}function ym(m){(typeof m!="object"||m?.length===void 0)&&Vt("Invalid argument for bytesToString");const t=m.length,i=8192;if(t<i)return String.fromCharCode.apply(null,m);const s=[];for(let r=0;r<t;r+=i){const l=Math.min(r+i,t),c=m.subarray(r,l);s.push(String.fromCharCode.apply(null,c))}return s.join("")}function Ar(m){typeof m!="string"&&Vt("Invalid argument for stringToBytes");const t=m.length,i=new Uint8Array(t);for(let s=0;s<t;++s)i[s]=m.charCodeAt(s)&255;return i}function B0(m){return String.fromCharCode(m>>24&255,m>>16&255,m>>8&255,m&255)}function z0(){const m=new Uint8Array(4);return m[0]=1,new Uint32Array(m.buffer,0,1)[0]===1}function P0(){try{return new Function(""),!0}catch{return!1}}class De{static get isLittleEndian(){return wt(this,"isLittleEndian",z0())}static get isEvalSupported(){return wt(this,"isEvalSupported",P0())}static get isOffscreenCanvasSupported(){return wt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return wt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return wt(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return wt(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:t,userAgent:i}=navigator;return wt(this,"platform",{isAndroid:i.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:i.includes("Firefox")})}static get isCSSRoundSupported(){return wt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const ju=Array.from(Array(256).keys(),m=>m.toString(16).padStart(2,"0"));class st{static makeHexColor(t,i,s){return`#${ju[t]}${ju[i]}${ju[s]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,i){let s;t[0]?(t[0]<0&&(s=i[0],i[0]=i[2],i[2]=s),i[0]*=t[0],i[2]*=t[0],t[3]<0&&(s=i[1],i[1]=i[3],i[3]=s),i[1]*=t[3],i[3]*=t[3]):(s=i[0],i[0]=i[1],i[1]=s,s=i[2],i[2]=i[3],i[3]=s,t[1]<0&&(s=i[1],i[1]=i[3],i[3]=s),i[1]*=t[1],i[3]*=t[1],t[2]<0&&(s=i[0],i[0]=i[2],i[2]=s),i[0]*=t[2],i[2]*=t[2]),i[0]+=t[4],i[1]+=t[5],i[2]+=t[4],i[3]+=t[5]}static transform(t,i){return[t[0]*i[0]+t[2]*i[1],t[1]*i[0]+t[3]*i[1],t[0]*i[2]+t[2]*i[3],t[1]*i[2]+t[3]*i[3],t[0]*i[4]+t[2]*i[5]+t[4],t[1]*i[4]+t[3]*i[5]+t[5]]}static multiplyByDOMMatrix(t,i){return[t[0]*i.a+t[2]*i.b,t[1]*i.a+t[3]*i.b,t[0]*i.c+t[2]*i.d,t[1]*i.c+t[3]*i.d,t[0]*i.e+t[2]*i.f+t[4],t[1]*i.e+t[3]*i.f+t[5]]}static applyTransform(t,i,s=0){const r=t[s],l=t[s+1];t[s]=r*i[0]+l*i[2]+i[4],t[s+1]=r*i[1]+l*i[3]+i[5]}static applyTransformToBezier(t,i,s=0){const r=i[0],l=i[1],c=i[2],u=i[3],h=i[4],f=i[5];for(let p=0;p<6;p+=2){const y=t[s+p],b=t[s+p+1];t[s+p]=y*r+b*c+h,t[s+p+1]=y*l+b*u+f}}static applyInverseTransform(t,i){const s=t[0],r=t[1],l=i[0]*i[3]-i[1]*i[2];t[0]=(s*i[3]-r*i[2]+i[2]*i[5]-i[4]*i[3])/l,t[1]=(-s*i[1]+r*i[0]+i[4]*i[1]-i[5]*i[0])/l}static axialAlignedBoundingBox(t,i,s){const r=i[0],l=i[1],c=i[2],u=i[3],h=i[4],f=i[5],p=t[0],y=t[1],b=t[2],A=t[3];let w=r*p+h,S=w,E=r*b+h,x=E,C=u*y+f,T=C,B=u*A+f,O=B;if(l!==0||c!==0){const L=l*p,P=l*b,G=c*y,Q=c*A;w+=G,x+=G,E+=Q,S+=Q,C+=L,O+=L,B+=P,T+=P}s[0]=Math.min(s[0],w,E,S,x),s[1]=Math.min(s[1],C,B,T,O),s[2]=Math.max(s[2],w,E,S,x),s[3]=Math.max(s[3],C,B,T,O)}static inverseTransform(t){const i=t[0]*t[3]-t[1]*t[2];return[t[3]/i,-t[1]/i,-t[2]/i,t[0]/i,(t[2]*t[5]-t[4]*t[3])/i,(t[4]*t[1]-t[5]*t[0])/i]}static singularValueDecompose2dScale(t,i){const s=t[0],r=t[1],l=t[2],c=t[3],u=s**2+r**2,h=s*l+r*c,f=l**2+c**2,p=(u+f)/2,y=Math.sqrt(p**2-(u*f-h**2));i[0]=Math.sqrt(p+y||1),i[1]=Math.sqrt(p-y||1)}static normalizeRect(t){const i=t.slice(0);return t[0]>t[2]&&(i[0]=t[2],i[2]=t[0]),t[1]>t[3]&&(i[1]=t[3],i[3]=t[1]),i}static intersect(t,i){const s=Math.max(Math.min(t[0],t[2]),Math.min(i[0],i[2])),r=Math.min(Math.max(t[0],t[2]),Math.max(i[0],i[2]));if(s>r)return null;const l=Math.max(Math.min(t[1],t[3]),Math.min(i[1],i[3])),c=Math.min(Math.max(t[1],t[3]),Math.max(i[1],i[3]));return l>c?null:[s,l,r,c]}static pointBoundingBox(t,i,s){s[0]=Math.min(s[0],t),s[1]=Math.min(s[1],i),s[2]=Math.max(s[2],t),s[3]=Math.max(s[3],i)}static rectBoundingBox(t,i,s,r,l){l[0]=Math.min(l[0],t,s),l[1]=Math.min(l[1],i,r),l[2]=Math.max(l[2],t,s),l[3]=Math.max(l[3],i,r)}static#t(t,i,s,r,l,c,u,h,f,p){if(f<=0||f>=1)return;const y=1-f,b=f*f,A=b*f,w=y*(y*(y*t+3*f*i)+3*b*s)+A*r,S=y*(y*(y*l+3*f*c)+3*b*u)+A*h;p[0]=Math.min(p[0],w),p[1]=Math.min(p[1],S),p[2]=Math.max(p[2],w),p[3]=Math.max(p[3],S)}static#e(t,i,s,r,l,c,u,h,f,p,y,b){if(Math.abs(f)<1e-12){Math.abs(p)>=1e-12&&this.#t(t,i,s,r,l,c,u,h,-y/p,b);return}const A=p**2-4*y*f;if(A<0)return;const w=Math.sqrt(A),S=2*f;this.#t(t,i,s,r,l,c,u,h,(-p+w)/S,b),this.#t(t,i,s,r,l,c,u,h,(-p-w)/S,b)}static bezierBoundingBox(t,i,s,r,l,c,u,h,f){f[0]=Math.min(f[0],t,u),f[1]=Math.min(f[1],i,h),f[2]=Math.max(f[2],t,u),f[3]=Math.max(f[3],i,h),this.#e(t,s,l,u,i,r,c,h,3*(-t+3*(s-l)+u),6*(t-2*s+l),3*(s-t),f),this.#e(t,s,l,u,i,r,c,h,3*(-i+3*(r-c)+h),6*(i-2*r+c),3*(r-i),f)}}function U0(m){return decodeURIComponent(escape(m))}let Hu=null,Fp=null;function F0(m){return Hu||(Hu=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Fp=new Map([["","t"]])),m.replaceAll(Hu,(t,i,s)=>i?i.normalize("NFKC"):Fp.get(s))}function bm(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const m=new Uint8Array(32);return crypto.getRandomValues(m),ym(m)}const sa="pdfjs_internal_id_";function j0(m,t,i){if(!Array.isArray(i)||i.length<2)return!1;const[s,r,...l]=i;if(!m(s)&&!Number.isInteger(s)||!t(r))return!1;const c=l.length;let u=!0;switch(r.name){case"XYZ":if(c<2||c>3)return!1;break;case"Fit":case"FitB":return c===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(c>1)return!1;break;case"FitR":if(c!==4)return!1;u=!1;break;default:return!1}for(const h of l)if(!(typeof h=="number"||u&&h===null))return!1;return!0}function Ue(m,t,i){return Math.min(Math.max(m,t),i)}function vm(m){return Uint8Array.prototype.toBase64?m.toBase64():btoa(ym(m))}function H0(m){return Uint8Array.fromBase64?Uint8Array.fromBase64(m):Ar(atob(m))}typeof Promise.try!="function"&&(Promise.try=function(m,...t){return new Promise(i=>{i(m(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(m){return m.reduce((t,i)=>t+i,0)});class yr{static textContent(t){const i=[],s={items:i,styles:Object.create(null)};function r(l){if(!l)return;let c=null;const u=l.name;if(u==="#text")c=l.value;else if(yr.shouldBuildText(u))l?.attributes?.textContent?c=l.attributes.textContent:l.value&&(c=l.value);else return;if(c!==null&&i.push({str:c}),!!l.children)for(const h of l.children)r(h)}return r(t),s}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class Am{static setupStorage(t,i,s,r,l){const c=r.getValue(i,{value:null});switch(s.name){case"textarea":if(c.value!==null&&(t.textContent=c.value),l==="print")break;t.addEventListener("input",u=>{r.setValue(i,{value:u.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(c.value===s.attributes.xfaOn?t.setAttribute("checked",!0):c.value===s.attributes.xfaOff&&t.removeAttribute("checked"),l==="print")break;t.addEventListener("change",u=>{r.setValue(i,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(c.value!==null&&t.setAttribute("value",c.value),l==="print")break;t.addEventListener("input",u=>{r.setValue(i,{value:u.target.value})})}break;case"select":if(c.value!==null){t.setAttribute("value",c.value);for(const u of s.children)u.attributes.value===c.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const h=u.target.options,f=h.selectedIndex===-1?"":h[h.selectedIndex].value;r.setValue(i,{value:f})});break}}static setAttributes({html:t,element:i,storage:s=null,intent:r,linkService:l}){const{attributes:c}=i,u=t instanceof HTMLAnchorElement;c.type==="radio"&&(c.name=`${c.name}-${r}`);for(const[h,f]of Object.entries(c))if(f!=null)switch(h){case"class":f.length&&t.setAttribute(h,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!u||h!=="href"&&h!=="newWindow")&&t.setAttribute(h,f)}u&&l.addLinkAttributes(t,c.href,c.newWindow),s&&c.dataId&&this.setupStorage(t,c.dataId,i,s)}static render(t){const i=t.annotationStorage,s=t.linkService,r=t.xfaHtml,l=t.intent||"display",c=document.createElement(r.name);r.attributes&&this.setAttributes({html:c,element:r,intent:l,linkService:s});const u=l!=="richText",h=t.div;if(h.append(c),t.viewport){const y=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=y}u&&h.setAttribute("class","xfaLayer xfaFont");const f=[];if(r.children.length===0){if(r.value){const y=document.createTextNode(r.value);c.append(y),u&&yr.shouldBuildText(r.name)&&f.push(y)}return{textDivs:f}}const p=[[r,-1,c]];for(;p.length>0;){const[y,b,A]=p.at(-1);if(b+1===y.children.length){p.pop();continue}const w=y.children[++p.at(-1)[1]];if(w===null)continue;const{name:S}=w;if(S==="#text"){const x=document.createTextNode(w.value);f.push(x),A.append(x);continue}const E=w?.attributes?.xmlns?document.createElementNS(w.attributes.xmlns,S):document.createElement(S);if(A.append(E),w.attributes&&this.setAttributes({html:E,element:w,storage:i,intent:l,linkService:s}),w.children?.length>0)p.push([w,-1,E]);else if(w.value){const x=document.createTextNode(w.value);u&&yr.shouldBuildText(S)&&f.push(x),E.append(x)}}for(const y of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))y.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const i=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=i,t.div.hidden=!1}}const cn="http://www.w3.org/2000/svg";class ha{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Sr(m,t="text"){if(hr(m,document.baseURI)){const i=await fetch(m);if(!i.ok)throw new Error(i.statusText);switch(t){case"arraybuffer":return i.arrayBuffer();case"blob":return i.blob();case"json":return i.json()}return i.text()}return new Promise((i,s)=>{const r=new XMLHttpRequest;r.open("GET",m,!0),r.responseType=t,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(t){case"arraybuffer":case"blob":case"json":i(r.response);return}i(r.responseText);return}s(new Error(r.statusText))}},r.send(null)})}class wr{constructor({viewBox:t,userUnit:i,scale:s,rotation:r,offsetX:l=0,offsetY:c=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=i,this.scale=s,this.rotation=r,this.offsetX=l,this.offsetY=c,s*=i;const h=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let p,y,b,A;switch(r%=360,r<0&&(r+=360),r){case 180:p=-1,y=0,b=0,A=1;break;case 90:p=0,y=1,b=1,A=0;break;case 270:p=0,y=-1,b=-1,A=0;break;case 0:p=1,y=0,b=0,A=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(b=-b,A=-A);let w,S,E,x;p===0?(w=Math.abs(f-t[1])*s+l,S=Math.abs(h-t[0])*s+c,E=(t[3]-t[1])*s,x=(t[2]-t[0])*s):(w=Math.abs(h-t[0])*s+l,S=Math.abs(f-t[1])*s+c,E=(t[2]-t[0])*s,x=(t[3]-t[1])*s),this.transform=[p*s,y*s,b*s,A*s,w-p*s*h-b*s*f,S-y*s*h-A*s*f],this.width=E,this.height=x}get rawDims(){const t=this.viewBox;return wt(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:i=this.rotation,offsetX:s=this.offsetX,offsetY:r=this.offsetY,dontFlip:l=!1}={}){return new wr({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:i,offsetX:s,offsetY:r,dontFlip:l})}convertToViewportPoint(t,i){const s=[t,i];return st.applyTransform(s,this.transform),s}convertToViewportRectangle(t){const i=[t[0],t[1]];st.applyTransform(i,this.transform);const s=[t[2],t[3]];return st.applyTransform(s,this.transform),[i[0],i[1],s[0],s[1]]}convertToPdfPoint(t,i){const s=[t,i];return st.applyInverseTransform(s,this.transform),s}}class ch extends hs{constructor(t,i=0){super(t,"RenderingCancelledException"),this.extraDelay=i}}function hl(m){const t=m.length;let i=0;for(;i<t&&m[i].trim()==="";)i++;return m.substring(i,i+5).toLowerCase()==="data:"}function uh(m){return typeof m=="string"&&/\.pdf$/i.test(m)}function I0(m){return[m]=m.split(/[#?]/,1),m.substring(m.lastIndexOf("/")+1)}function G0(m,t="document.pdf"){if(typeof m!="string")return t;if(hl(m))return bt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const s=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(m);if(!s)return t;const r=u=>{try{let h=decodeURIComponent(u);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:u):h}catch{return u}},l=/\.pdf$/i,c=s.pathname.split("/").at(-1);if(l.test(c))return r(c);if(s.searchParams.size>0){const u=Array.from(s.searchParams.values()).reverse();for(const f of u)if(l.test(f))return r(f);const h=Array.from(s.searchParams.keys()).reverse();for(const f of h)if(l.test(f))return r(f)}if(s.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(h)return r(h[0])}return t}class jp{started=Object.create(null);times=[];time(t){t in this.started&&bt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||bt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let i=0;for(const{name:s}of this.times)i=Math.max(s.length,i);for(const{name:s,start:r,end:l}of this.times)t.push(`${s.padEnd(i)} ${l-r}ms
`);return t.join("")}}function hr(m,t){const i=t?URL.parse(m,t):URL.parse(m);return i?.protocol==="http:"||i?.protocol==="https:"}function _i(m){m.preventDefault()}function se(m){m.preventDefault(),m.stopPropagation()}function q0(m){console.log("Deprecated API usage: "+m)}class Zu{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const i=this.#t.exec(t);if(!i)return null;const s=parseInt(i[1],10);let r=parseInt(i[2],10);r=r>=1&&r<=12?r-1:0;let l=parseInt(i[3],10);l=l>=1&&l<=31?l:1;let c=parseInt(i[4],10);c=c>=0&&c<=23?c:0;let u=parseInt(i[5],10);u=u>=0&&u<=59?u:0;let h=parseInt(i[6],10);h=h>=0&&h<=59?h:0;const f=i[7]||"Z";let p=parseInt(i[8],10);p=p>=0&&p<=23?p:0;let y=parseInt(i[9],10)||0;return y=y>=0&&y<=59?y:0,f==="-"?(c+=p,u+=y):f==="+"&&(c-=p,u-=y),new Date(Date.UTC(s,r,l,c,u,h))}}function V0(m,{scale:t=1,rotation:i=0}){const{width:s,height:r}=m.attributes.style,l=[0,0,parseInt(s),parseInt(r)];return new wr({viewBox:l,userUnit:1,scale:t,rotation:i})}function _r(m){if(m.startsWith("#")){const t=parseInt(m.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return m.startsWith("rgb(")?m.slice(4,-1).split(",").map(t=>parseInt(t)):m.startsWith("rgba(")?m.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(bt(`Not a valid color format: "${m}"`),[0,0,0])}function X0(m){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const i of m.keys()){t.style.color=i;const s=window.getComputedStyle(t).color;m.set(i,_r(s))}t.remove()}function Jt(m){const{a:t,b:i,c:s,d:r,e:l,f:c}=m.getTransform();return[t,i,s,r,l,c]}function Fi(m){const{a:t,b:i,c:s,d:r,e:l,f:c}=m.getTransform().invertSelf();return[t,i,s,r,l,c]}function cs(m,t,i=!1,s=!0){if(t instanceof wr){const{pageWidth:r,pageHeight:l}=t.rawDims,{style:c}=m,u=De.isCSSRoundSupported,h=`var(--total-scale-factor) * ${r}px`,f=`var(--total-scale-factor) * ${l}px`,p=u?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,y=u?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!i||t.rotation%180===0?(c.width=p,c.height=y):(c.width=y,c.height=p)}s&&m.setAttribute("data-main-rotation",t.rotation)}class Gi{constructor(){const{pixelRatio:t}=Gi;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,i,s,r,l=-1){let c=1/0,u=1/0,h=1/0;s=Gi.capPixels(s,l),s>0&&(c=Math.sqrt(s/(t*i))),r!==-1&&(u=r/t,h=r/i);const f=Math.min(c,u,h);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,i){if(i>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+i/100));return t>0?Math.min(t,s):s}return t}}const Wu=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class Y0{static get isDarkMode(){return wt(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class $0{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:i}=t;i.width=i.height="0",i.display="none",i.color="var(--comment-fg-color)",document.body.append(t);const{color:s}=window.getComputedStyle(t);return t.remove(),wt(this,"commentForegroundColor",_r(s))}}function K0(m,t,i,s){s=Math.min(Math.max(s??1,0),1);const r=255*(1-s);return m=Math.round(m*s+r),t=Math.round(t*s+r),i=Math.round(i*s+r),[m,t,i]}function Hp(m,t){const i=m[0]/255,s=m[1]/255,r=m[2]/255,l=Math.max(i,s,r),c=Math.min(i,s,r),u=(l+c)/2;if(l===c)t[0]=t[1]=0;else{const h=l-c;switch(t[1]=u<.5?h/(l+c):h/(2-l-c),l){case i:t[0]=((s-r)/h+(s<r?6:0))*60;break;case s:t[0]=((r-i)/h+2)*60;break;case r:t[0]=((i-s)/h+4)*60;break}}t[2]=u}function Ju(m,t){const i=m[0],s=m[1],r=m[2],l=(1-Math.abs(2*r-1))*s,c=l*(1-Math.abs(i/60%2-1)),u=r-l/2;switch(Math.floor(i/60)){case 0:t[0]=l+u,t[1]=c+u,t[2]=u;break;case 1:t[0]=c+u,t[1]=l+u,t[2]=u;break;case 2:t[0]=u,t[1]=l+u,t[2]=c+u;break;case 3:t[0]=u,t[1]=c+u,t[2]=l+u;break;case 4:t[0]=c+u,t[1]=u,t[2]=l+u;break;case 5:case 6:t[0]=l+u,t[1]=u,t[2]=c+u;break}}function Ip(m){return m<=.03928?m/12.92:((m+.055)/1.055)**2.4}function Gp(m,t,i){Ju(m,i),i.map(Ip);const s=.2126*i[0]+.7152*i[1]+.0722*i[2];Ju(t,i),i.map(Ip);const r=.2126*i[0]+.7152*i[1]+.0722*i[2];return s>r?(s+.05)/(r+.05):(r+.05)/(s+.05)}const qp=new Map;function Q0(m,t){const i=m[0]+m[1]*256+m[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let s=qp.get(i);if(s)return s;const r=new Float32Array(9),l=r.subarray(0,3),c=r.subarray(3,6);Hp(m,c);const u=r.subarray(6,9);Hp(t,u);const h=u[2]<.5,f=h?12:4.5;if(c[2]=h?Math.sqrt(c[2]):1-Math.sqrt(1-c[2]),Gp(c,u,l)<f){let p,y;h?(p=c[2],y=1):(p=0,y=c[2]);const b=.005;for(;y-p>b;){const A=c[2]=(p+y)/2;h===Gp(c,u,l)<f?p=A:y=A}c[2]=h?y:p}return Ju(c,l),s=st.makeHexColor(Math.round(l[0]*255),Math.round(l[1]*255),Math.round(l[2]*255)),qp.set(i,s),s}function Sm({html:m,dir:t,className:i},s){const r=document.createDocumentFragment();if(typeof m=="string"){const l=document.createElement("p");l.dir=t||"auto";const c=m.split(/(?:\r\n?|\n)/);for(let u=0,h=c.length;u<h;++u){const f=c[u];l.append(document.createTextNode(f)),u<h-1&&l.append(document.createElement("br"))}r.append(l)}else Am.render({xfaHtml:m,div:r,intent:"richText"});r.firstChild.classList.add("richText",i),s.append(r)}function wm(m){const t=new Path2D;if(!m)return t;for(let i=0,s=m.length;i<s;)switch(m[i++]){case rr.moveTo:t.moveTo(m[i++],m[i++]);break;case rr.lineTo:t.lineTo(m[i++],m[i++]);break;case rr.curveTo:t.bezierCurveTo(m[i++],m[i++],m[i++],m[i++],m[i++],m[i++]);break;case rr.quadraticCurveTo:t.quadraticCurveTo(m[i++],m[i++],m[i++],m[i++]);break;case rr.closePath:t.closePath();break;default:bt(`Unrecognized drawing path operator: ${m[i-1]}`);break}return t}class gr{#t=null;#e=null;#n;#i=null;#r=null;#a=null;#s=null;#o=null;static#c=null;constructor(t){this.#n=t,gr.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const i=this.#n._uiManager._signal;i instanceof AbortSignal&&!i.aborted&&(t.addEventListener("contextmenu",_i,{signal:i}),t.addEventListener("pointerdown",gr.#l,{signal:i}));const s=this.#i=document.createElement("div");s.className="buttons",t.append(s);const r=this.#n.toolbarPosition;if(r){const{style:l}=t,c=this.#n._uiManager.direction==="ltr"?1-r[0]:r[0];l.insetInlineEnd=`${100*c}%`,l.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#l(t){t.stopPropagation()}#d(t){this.#n._focusEventsAllowed=!1,se(t)}#h(t){this.#n._focusEventsAllowed=!0,se(t)}#f(t){const i=this.#n._uiManager._signal;return!(i instanceof AbortSignal)||i.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:i}),t.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:i}),t.addEventListener("contextmenu",_i,{signal:i}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#r?.shown(),this.#a?.shown()}addDeleteButton(){const{editorType:t,_uiManager:i}=this.#n,s=document.createElement("button");s.classList.add("basic","deleteButton"),s.tabIndex=0,s.setAttribute("data-l10n-id",gr.#c[t]),this.#f(s)&&s.addEventListener("click",r=>{i.delete()},{signal:i._signal}),this.#i.append(s)}get#m(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const i=await t.render();this.#f(i),this.#i.append(i,this.#m),this.#r=t}addComment(t,i=null){if(this.#a)return;const s=t.renderForToolbar();if(!s)return;this.#f(s);const r=this.#s=this.#m;i?(this.#i.insertBefore(s,i),this.#i.insertBefore(r,i)):this.#i.append(s,r),this.#a=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const i=t.renderButton();this.#f(i),this.#i.append(i,this.#m)}async addEditSignatureButton(t){const i=this.#o=await t.renderEditButton(this.#n);this.#f(i),this.#i.append(i,this.#m)}removeButton(t){switch(t){case"comment":this.#a?.removeToolbarCommentButton(),this.#a=null,this.#s?.remove(),this.#s=null;break}}async addButton(t,i){switch(t){case"colorPicker":i&&this.addColorPicker(i);break;case"altText":i&&await this.addAltText(i);break;case"editSignature":i&&await this.addEditSignatureButton(i);break;case"delete":this.addDeleteButton();break;case"comment":i&&this.addComment(i);break}}async addButtonBefore(t,i,s){if(!i&&t==="comment")return;const r=this.#i.querySelector(s);r&&t==="comment"&&this.addComment(i,r)}updateEditSignatureButton(t){this.#o&&(this.#o.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class Z0{#t=null;#e=null;#n;constructor(t){this.#n=t}#i(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const i=this.#n._signal;i instanceof AbortSignal&&!i.aborted&&t.addEventListener("contextmenu",_i,{signal:i});const s=this.#t=document.createElement("div");return s.className="buttons",t.append(s),this.#n.hasCommentManager()&&this.#a("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#n.commentSelection("floating_button")}),this.#a("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#n.highlightSelection("floating_button")}),t}#r(t,i){let s=0,r=0;for(const l of t){const c=l.y+l.height;if(c<s)continue;const u=l.x+(i?l.width:0);if(c>s){r=u,s=c;continue}i?u>r&&(r=u):u<r&&(r=u)}return[i?1-r:r,s]}show(t,i,s){const[r,l]=this.#r(i,s),{style:c}=this.#e||=this.#i();t.append(this.#e),c.insetInlineEnd=`${100*r}%`,c.top=`calc(${100*l}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#a(t,i,s,r){const l=document.createElement("button");l.classList.add("basic",t),l.tabIndex=0,l.setAttribute("data-l10n-id",i);const c=document.createElement("span");l.append(c),c.className="visuallyHidden",c.setAttribute("data-l10n-id",s);const u=this.#n._signal;u instanceof AbortSignal&&!u.aborted&&(l.addEventListener("contextmenu",_i,{signal:u}),l.addEventListener("click",r,{signal:u})),this.#t.append(l)}}function _m(m,t,i){for(const s of i)t.addEventListener(s,m[s].bind(m))}class Pt{static#t=NaN;static#e=null;static#n=NaN;static#i=null;static initializeAndAddPointerId(t){(Pt.#e||=new Set).add(t)}static setPointer(t,i){Pt.#t||=i,Pt.#i??=t}static setTimeStamp(t){Pt.#n=t}static isSamePointerId(t){return Pt.#t===t}static isSamePointerIdOrRemove(t){return Pt.#t===t?!0:(Pt.#e?.delete(t),!1)}static isSamePointerType(t){return Pt.#i===t}static isInitializedAndDifferentPointerType(t){return Pt.#i!==null&&!Pt.isSamePointerType(t)}static isSameTimeStamp(t){return Pt.#n===t}static isUsingMultiplePointers(){return Pt.#e?.size>=1}static clearPointerType(){Pt.#i=null}static clearPointerIds(){Pt.#t=NaN,Pt.#e=null}static clearTimeStamp(){Pt.#n=NaN}}class W0{#t=0;get id(){return`${pr}${this.#t++}`}}class hh{#t=bm();#e=0;#n=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=t;const l=r.decode().then(()=>(s.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return wt(this,"_isSVGFittingCanvas",l)}async#i(t,i){this.#n||=new Map;let s=this.#n.get(t);if(s===null)return null;if(s?.bitmap)return s.refCounter+=1,s;try{s||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let r;if(typeof i=="string"?(s.url=i,r=await Sr(i,"blob")):i instanceof File?r=s.file=i:i instanceof Blob&&(r=i),r.type==="image/svg+xml"){const l=hh._isSVGFittingCanvas,c=new FileReader,u=new Image,h=new Promise((f,p)=>{u.onload=()=>{s.bitmap=u,s.isSvg=!0,f()},c.onload=async()=>{const y=s.svgUrl=c.result;u.src=await l?`${y}#svgView(preserveAspectRatio(none))`:y},u.onerror=c.onerror=p});c.readAsDataURL(r),await h}else s.bitmap=await createImageBitmap(r);s.refCounter=1}catch(r){bt(r),s=null}return this.#n.set(t,s),s&&this.#n.set(s.id,s),s}async getFromFile(t){const{lastModified:i,name:s,size:r,type:l}=t;return this.#i(`${i}_${s}_${r}_${l}`,t)}async getFromUrl(t){return this.#i(t,t)}async getFromBlob(t,i){const s=await i;return this.#i(t,s)}async getFromId(t){this.#n||=new Map;const i=this.#n.get(t);if(!i)return null;if(i.bitmap)return i.refCounter+=1,i;if(i.file)return this.getFromFile(i.file);if(i.blobPromise){const{blobPromise:s}=i;return delete i.blobPromise,this.getFromBlob(i.id,s)}return this.getFromUrl(i.url)}getFromCanvas(t,i){this.#n||=new Map;let s=this.#n.get(t);if(s?.bitmap)return s.refCounter+=1,s;const r=new OffscreenCanvas(i.width,i.height);return r.getContext("2d").drawImage(i,0,0),s={bitmap:r.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#n.set(t,s),this.#n.set(s.id,s),s}getSvgUrl(t){const i=this.#n.get(t);return i?.isSvg?i.svgUrl:null}deleteId(t){this.#n||=new Map;const i=this.#n.get(t);if(!i||(i.refCounter-=1,i.refCounter!==0))return;const{bitmap:s}=i;if(!i.url&&!i.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),i.blobPromise=r.convertToBlob()}s.close?.(),i.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class J0{#t=[];#e=!1;#n;#i=-1;constructor(t=128){this.#n=t}add({cmd:t,undo:i,post:s,mustExec:r,type:l=NaN,overwriteIfSameType:c=!1,keepUndo:u=!1}){if(r&&t(),this.#e)return;const h={cmd:t,undo:i,post:s,type:l};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(h);return}if(c&&this.#t[this.#i].type===l){u&&(h.undo=this.#t[this.#i].undo),this.#t[this.#i]=h;return}const f=this.#i+1;f===this.#n?this.#t.splice(0,1):(this.#i=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(h)}undo(){if(this.#i===-1)return;this.#e=!0;const{undo:t,post:i}=this.#t[this.#i];t(),i?.(),this.#e=!1,this.#i-=1}redo(){if(this.#i<this.#t.length-1){this.#i+=1,this.#e=!0;const{cmd:t,post:i}=this.#t[this.#i];t(),i?.(),this.#e=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}cleanType(t){if(this.#i!==-1){for(let i=this.#i;i>=0;i--)if(this.#t[i].type!==t){this.#t.splice(i+1,this.#i-i),this.#i=i;return}this.#t.length=0,this.#i=-1}}destroy(){this.#t=null}}class xr{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:i}=De.platform;for(const[s,r,l={}]of t)for(const c of s){const u=c.startsWith("mac+");i&&u?(this.callbacks.set(c.slice(4),{callback:r,options:l}),this.allKeys.add(c.split("+").at(-1))):!i&&!u&&(this.callbacks.set(c,{callback:r,options:l}),this.allKeys.add(c.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const i=this.buffer.join("+");return this.buffer.length=0,i}exec(t,i){if(!this.allKeys.has(i.key))return;const s=this.callbacks.get(this.#t(i));if(!s)return;const{callback:r,options:{bubbles:l=!1,args:c=[],checker:u=null}}=s;u&&!u(t,i)||(r.bind(t,...c,i)(),l||se(i))}}class dh{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return X0(t),wt(this,"_colors",t)}convert(t){const i=_r(t);if(!window.matchMedia("(forced-colors: active)").matches)return i;for(const[s,r]of this._colors)if(r.every((l,c)=>l===i[c]))return dh._colorsMapping.get(s);return i}getHexCode(t){const i=this._colors.get(t);return i?st.makeHexColor(...i):t}}class Fn{#t=new AbortController;#e=null;#n=null;#i=new Map;#r=new Map;#a=null;#s=null;#o=null;#c=new J0;#l=null;#d=null;#h=null;#f=0;#m=new Set;#p=null;#u=null;#g=new Set;_editorUndoBar=null;#y=!1;#v=!1;#b=!1;#E=null;#_=null;#S=null;#C=null;#A=!1;#x=null;#R=new W0;#M=!1;#D=!1;#P=!1;#O=null;#k=null;#U=null;#B=null;#q=null;#T=At.NONE;#w=new Set;#L=null;#F=null;#H=null;#Y=null;#X=null;#$={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#I=[0,0];#z=null;#V=null;#W=null;#J=null;#j=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=Fn.prototype,i=c=>c.#V.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&c.hasSomethingToControl(),s=(c,{target:u})=>{if(u instanceof HTMLInputElement){const{type:h}=u;return h!=="text"&&h!=="number"}return!0},r=this.TRANSLATE_SMALL,l=this.TRANSLATE_BIG;return wt(this,"_keyboardManager",new xr([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],t.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:s}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#V.contains(u)&&!c.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#V.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-l,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[l,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-l],checker:i}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,l],checker:i}]]))}constructor(t,i,s,r,l,c,u,h,f,p,y,b,A,w,S,E){const x=this._signal=this.#t.signal;this.#V=t,this.#W=i,this.#J=s,this.#a=r,this.#l=l,this.#F=c,this.#X=h,this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:x}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:x}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:x}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:x}),u._on("setpreference",this.onSetPreference.bind(this),{signal:x}),u._on("switchannotationeditorparams",C=>this.updateParams(C.type,C.value),{signal:x}),window.addEventListener("pointerdown",()=>{this.#D=!0},{capture:!0,signal:x}),window.addEventListener("pointerup",()=>{this.#D=!1},{capture:!0,signal:x}),this.#rt(),this.#dt(),this.#et(),this.#s=h.annotationStorage,this.#E=h.filterFactory,this.#H=f,this.#C=p||null,this.#y=y,this.#v=b,this.#b=A,this.#q=w||null,this.viewParameters={realScale:ha.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=S||null,this._supportsPinchToZoom=E!==!1,l?.setSidebarUiManager(this)}destroy(){this.#j?.resolve(),this.#j=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#r.values())t.destroy();this.#r.clear(),this.#i.clear(),this.#g.clear(),this.#B?.clear(),this.#e=null,this.#w.clear(),this.#c.destroy(),this.#a?.destroy(),this.#l?.destroy(),this.#F?.destroy(),this.#x?.hide(),this.#x=null,this.#U?.destroy(),this.#U=null,this.#n=null,this.#_&&(clearTimeout(this.#_),this.#_=null),this.#z&&(clearTimeout(this.#z),this.#z=null),this._editorUndoBar?.destroy(),this.#X=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#q}get useNewAltTextFlow(){return this.#v}get useNewAltTextWhenAddingImage(){return this.#b}get hcmFilter(){return wt(this,"hcmFilter",this.#H?this.#E.addHCMFilter(this.#H.foreground,this.#H.background):"none")}get direction(){return wt(this,"direction",getComputedStyle(this.#V).direction)}get _highlightColors(){return wt(this,"_highlightColors",this.#C?new Map(this.#C.split(",").map(t=>(t=t.split("=").map(i=>i.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return wt(this,"highlightColors",null);const i=new Map,s=!!this.#H;for(const[r,l]of t){const c=r.endsWith("_HCM");if(s&&c){i.set(r.replace("_HCM",""),l);continue}!s&&!c&&i.set(r,l)}return wt(this,"highlightColors",i)}get highlightColorNames(){return wt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const i=this.highlightColorNames.get(t);return this._highlightColors.get(i)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=t}setMainHighlightColorPicker(t){this.#U=t}editAltText(t,i=!1){this.#a?.editAltText(this,t,i)}hasCommentManager(){return!!this.#l}editComment(t,i,s,r){this.#l?.showDialog(this,t,i,s,r)}selectComment(t,i){this.#r.get(t)?.getEditorByUID(i)?.toggleComment(!0,!0)}updateComment(t){this.#l?.updateComment(t.getData())}updatePopupColor(t){this.#l?.updatePopupColor(t)}removeComment(t){this.#l?.removeComments([t.uid])}toggleComment(t,i,s=void 0){this.#l?.toggleCommentPopup(t,i,s)}makeCommentColor(t,i){return t&&this.#l?.makeCommentColor(t,i)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(t){if(this.#r.has(t-1))return;const{resolve:i,promise:s}=Promise.withResolvers(),r=l=>{l.pageNumber===t&&(this._eventBus._off("editorsrendered",r),i())};this._eventBus.on("editorsrendered",r),await s}getSignature(t){this.#F?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#F}switchToMode(t,i){this._eventBus.on("annotationeditormodechanged",i,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,i){this._eventBus.dispatch("setpreference",{source:this,name:t,value:i})}onSetPreference({name:t,value:i}){switch(t){case"enableNewAltTextWhenAddingImage":this.#b=i;break}}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#V.focus()}findParent(t,i){for(const s of this.#r.values()){const{x:r,y:l,width:c,height:u}=s.div.getBoundingClientRect();if(t>=r&&t<=r+c&&i>=l&&i<=l+u)return s}return null}disableUserSelect(t=!1){this.#W.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#g.add(t)}removeShouldRescale(t){this.#g.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*ha.PDF_TO_CSS_UNITS;for(const i of this.#g)i.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#Z({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:i}=this;if(i.hasTextLayer(t))return i;for(const s of this.#r.values())if(s.hasTextLayer(t))return s;return null}highlightSelection(t="",i=!1){const s=document.getSelection();if(!s||s.isCollapsed)return;const{anchorNode:r,anchorOffset:l,focusNode:c,focusOffset:u}=s,h=s.toString(),p=this.#Z(s).closest(".textLayer"),y=this.getSelectionBoxes(p);if(!y)return;s.empty();const b=this.#tt(p),A=this.#T===At.NONE,w=()=>{const S=b?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:y,anchorNode:r,anchorOffset:l,focusNode:c,focusOffset:u,text:h});A&&this.showAllEditors("highlight",!0,!0),i&&S?.editComment()};if(A){this.switchToMode(At.HIGHLIGHT,w);return}w()}commentSelection(t=""){this.highlightSelection(t,!0)}#st(){const t=document.getSelection();if(!t||t.isCollapsed)return;const s=this.#Z(t).closest(".textLayer"),r=this.getSelectionBoxes(s);r&&(this.#x||=new Z0(this),this.#x.show(s,r,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#s)return null;const i=`${pr}${t}`,s=this.#s.getRawValue(i);return s&&this.#s.remove(i),s}addToAnnotationStorage(t){!t.isEmpty()&&this.#s&&!this.#s.has(t.id)&&this.#s.setValue(t.id,t)}a11yAlert(t,i=null){const s=this.#J;s&&(s.setAttribute("data-l10n-id",t),i?s.setAttribute("data-l10n-args",JSON.stringify(i)):s.removeAttribute("data-l10n-args"))}#at(){const t=document.getSelection();if(!t||t.isCollapsed){this.#L&&(this.#x?.hide(),this.#L=null,this.#N({hasSelectedText:!1}));return}const{anchorNode:i}=t;if(i===this.#L)return;const r=this.#Z(t).closest(".textLayer");if(!r){this.#L&&(this.#x?.hide(),this.#L=null,this.#N({hasSelectedText:!1}));return}if(this.#x?.hide(),this.#L=i,this.#N({hasSelectedText:!0}),!(this.#T!==At.HIGHLIGHT&&this.#T!==At.NONE)&&(this.#T===At.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#A=this.isShiftKeyDown,!this.isShiftKeyDown)){const l=this.#T===At.HIGHLIGHT?this.#tt(r):null;if(l?.toggleDrawing(),this.#D){const c=new AbortController,u=this.combinedSignal(c),h=f=>{f.type==="pointerup"&&f.button!==0||(c.abort(),l?.toggleDrawing(!0),f.type==="pointerup"&&this.#K("main_toolbar"))};window.addEventListener("pointerup",h,{signal:u}),window.addEventListener("blur",h,{signal:u})}else l?.toggleDrawing(!0),this.#K("main_toolbar")}}#K(t=""){this.#T===At.HIGHLIGHT?this.highlightSelection(t):this.#y&&this.#st()}#rt(){document.addEventListener("selectionchange",this.#at.bind(this),{signal:this._signal})}#ot(){if(this.#S)return;this.#S=new AbortController;const t=this.combinedSignal(this.#S);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#lt(){this.#S?.abort(),this.#S=null}blur(){if(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#K("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const i of this.#w)if(i.div.contains(t)){this.#k=[i,t],i._focusEventsAllowed=!1;break}}focus(){if(!this.#k)return;const[t,i]=this.#k;this.#k=null,i.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),i.focus()}#et(){if(this.#O)return;this.#O=new AbortController;const t=this.combinedSignal(this.#O);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ct(){this.#O?.abort(),this.#O=null}#ut(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#ht(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.setEditingState(!0)}removeEditListeners(){this.#ct(),this.setEditingState(!1)}dragOver(t){for(const{type:i}of t.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(i)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const i of t.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(i.type)){s.paste(i,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const i=[];for(const s of this.#w){const r=s.serialize(!0);r&&i.push(r)}i.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(i))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:i}=t;for(const l of i.items)for(const c of this.#u)if(c.isHandlingMimeForPasting(l.type)){c.paste(l,this.currentLayer);return}let s=i.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(l){bt(`paste: "${l.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const r=this.currentLayer;try{const l=[];for(const h of s){const f=await r.deserialize(h);if(!f)return;l.push(f)}const c=()=>{for(const h of l)this.#it(h);this.#nt(l)},u=()=>{for(const h of l)h.remove()};this.addCommands({cmd:c,undo:u,mustExec:!0})}catch(l){bt(`paste: "${l.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#T!==At.NONE&&!this.isEditorHandlingKeyboard&&Fn._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#K("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#N(t){Object.entries(t).some(([s,r])=>this.#$[s]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#$,t)}),this.#T===At.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#G([[Nt.HIGHLIGHT_FREE,!0]]))}#G(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ot(),this.#ut(),this.#N({isEditing:this.#T!==At.NONE,isEmpty:this.#Q(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#lt(),this.#ht(),this.#N({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#u){this.#u=t;for(const i of this.#u)this.#G(i.defaultPropertiesToUpdate)}}getId(){return this.#R.id}get currentLayer(){return this.#r.get(this.#f)}getLayer(t){return this.#r.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#r.set(t.pageIndex,t),this.#M?t.enable():t.disable()}removeLayer(t){this.#r.delete(t.pageIndex)}async updateMode(t,i=null,s=!1,r=!1,l=!1){if(this.#T!==t&&!(this.#j&&(await this.#j.promise,!this.#j))){if(this.#j=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#T===At.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#T=t,t===At.NONE){this.setEditingState(!1),this.#gt();for(const c of this.#i.values())c.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#j.resolve();return}for(const c of this.#i.values())c.addStandaloneCommentButton();t===At.SIGNATURE&&await this.#F?.loadSignatures(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const c of this.#r.values())c.updateMode(t);if(t===At.POPUP){this.#n||=await this.#X.getAnnotationsByType(new Set(this.#u.map(h=>h._editorType)));const c=new Set,u=[];for(const h of this.#i.values()){const{annotationElementId:f,hasComment:p,deleted:y}=h;f&&c.add(f),p&&!y&&u.push(h.getData())}for(const h of this.#n){const{id:f,popupRef:p,contentsObj:y}=h;p&&y?.str&&!c.has(f)&&!this.#m.has(f)&&u.push(h)}this.#l?.showSidebar(u)}if(!i){s&&this.addNewEditorFromKeyboard(),this.#j.resolve();return}for(const c of this.#i.values())c.uid===i?(this.setSelected(c),l?c.editComment():r?c.enterInEditMode():c.focus()):c.unselect();this.#j.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#T&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,i){if(this.#u){switch(t){case Nt.CREATE:this.currentLayer.addNewEditor(i);return;case Nt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#Y||=new Map).set(t,i),this.showAllEditors("highlight",i);break}if(this.hasSelection)for(const s of this.#w)s.updateParams(t,i);else for(const s of this.#u)s.updateDefaultParams(t,i)}}showAllEditors(t,i,s=!1){for(const l of this.#i.values())l.editorType===t&&l.show(i);(this.#Y?.get(Nt.HIGHLIGHT_SHOW_ALL)??!0)!==i&&this.#G([[Nt.HIGHLIGHT_SHOW_ALL,i]])}enableWaiting(t=!1){if(this.#P!==t){this.#P=t;for(const i of this.#r.values())t?i.disableClick():i.enableClick(),i.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#M){this.#M=!0;const t=[];for(const i of this.#r.values())t.push(i.enable());await Promise.all(t);for(const i of this.#i.values())i.enable()}}#gt(){if(this.unselectAll(),this.#M){this.#M=!1;for(const t of this.#r.values())t.disable();for(const t of this.#i.values())t.disable()}}*getEditors(t){for(const i of this.#i.values())i.pageIndex===t&&(yield i)}getEditor(t){return this.#i.get(t)}addEditor(t){this.#i.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#_&&clearTimeout(this.#_),this.#_=setTimeout(()=>{this.focusMainContainer(),this.#_=null},0)),this.#i.delete(t.id),t.annotationElementId&&this.#B?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#m.has(t.annotationElementId))&&this.#s?.remove(t.id)}addDeletedAnnotationElement(t){this.#m.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#m.has(t)}removeDeletedAnnotationElement(t){this.#m.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#it(t){const i=this.#r.get(t.pageIndex);i?i.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#G(t.propertiesToUpdate))}get#pt(){let t=null;for(t of this.#w);return t}updateUI(t){this.#pt===t&&this.#G(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#G(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#w.has(t)){this.#w.delete(t),t.unselect(),this.#N({hasSelectedEditor:this.hasSelection});return}this.#w.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#N({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.uid}),this.#h?.commitOrRemove();for(const i of this.#w)i!==t&&i.unselect();this.#w.clear(),this.#w.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#N({hasSelectedEditor:!0})}isSelected(t){return this.#w.has(t)}get firstSelectedEditor(){return this.#w.values().next().value}unselect(t){t.unselect(),this.#w.delete(t),this.#N({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#w.size!==0}get isEnterHandled(){return this.#w.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#N({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#Q()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#N({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#Q()})}addCommands(t){this.#c.add(t),this.#N({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#Q()})}cleanUndoStack(t){this.#c.cleanType(t)}#Q(){if(this.#i.size===0)return!0;if(this.#i.size===1)for(const t of this.#i.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const i=t?[t]:[...this.#w],s=()=>{this._editorUndoBar?.show(r,i.length===1?i[0].editorType:i.length);for(const l of i)l.remove()},r=()=>{for(const l of i)this.#it(l)};this.addCommands({cmd:s,undo:r,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#nt(t){for(const i of this.#w)i.unselect();this.#w.clear();for(const i of t)i.isEmpty()||(this.#w.add(i),i.select());this.#N({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#w)t.commit();this.#nt(this.#i.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#T!==At.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const t of this.#w)t.unselect();this.#w.clear(),this.#N({hasSelectedEditor:!1})}}translateSelectedEditors(t,i,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;this.#I[0]+=t,this.#I[1]+=i;const[r,l]=this.#I,c=[...this.#w],u=1e3;this.#z&&clearTimeout(this.#z),this.#z=setTimeout(()=>{this.#z=null,this.#I[0]=this.#I[1]=0,this.addCommands({cmd:()=>{for(const h of c)this.#i.has(h.id)&&(h.translateInPage(r,l),h.translationDone())},undo:()=>{for(const h of c)this.#i.has(h.id)&&(h.translateInPage(-r,-l),h.translationDone())},mustExec:!1})},u);for(const h of c)h.translateInPage(t,i),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#p=new Map;for(const t of this.#w)this.#p.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#p)return!1;this.disableUserSelect(!1);const t=this.#p;this.#p=null;let i=!1;for(const[{x:r,y:l,pageIndex:c},u]of t)u.newX=r,u.newY=l,u.newPageIndex=c,i||=r!==u.savedX||l!==u.savedY||c!==u.savedPageIndex;if(!i)return!1;const s=(r,l,c,u)=>{if(this.#i.has(r.id)){const h=this.#r.get(u);h?r._setParentAndPosition(h,l,c):(r.pageIndex=u,r.x=l,r.y=c)}};return this.addCommands({cmd:()=>{for(const[r,{newX:l,newY:c,newPageIndex:u}]of t)s(r,l,c,u)},undo:()=>{for(const[r,{savedX:l,savedY:c,savedPageIndex:u}]of t)s(r,l,c,u)},mustExec:!0}),!0}dragSelectedEditors(t,i){if(this.#p)for(const s of this.#p.keys())s.drag(t,i)}rebuild(t){if(t.parent===null){const i=this.getLayer(t.pageIndex);i?(i.changeParent(t),i.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#w.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#T}isEditingMode(){return this.#T!==At.NONE}get imageManager(){return wt(this,"imageManager",new hh)}getSelectionBoxes(t){if(!t)return null;const i=document.getSelection();for(let f=0,p=i.rangeCount;f<p;f++)if(!t.contains(i.getRangeAt(f).commonAncestorContainer))return null;const{x:s,y:r,width:l,height:c}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(f,p,y,b)=>({x:(p-r)/c,y:1-(f+y-s)/l,width:b/c,height:y/l});break;case"180":u=(f,p,y,b)=>({x:1-(f+y-s)/l,y:1-(p+b-r)/c,width:y/l,height:b/c});break;case"270":u=(f,p,y,b)=>({x:1-(p+b-r)/c,y:(f-s)/l,width:b/c,height:y/l});break;default:u=(f,p,y,b)=>({x:(f-s)/l,y:(p-r)/c,width:y/l,height:b/c});break}const h=[];for(let f=0,p=i.rangeCount;f<p;f++){const y=i.getRangeAt(f);if(!y.collapsed)for(const{x:b,y:A,width:w,height:S}of y.getClientRects())w===0||S===0||h.push(u(b,A,w,S))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:t,id:i}){(this.#o||=new Map).set(t,i)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const i=this.#o?.get(t.data.id);if(!i)return;const s=this.#s.getRawValue(i);s&&(this.#T===At.NONE&&!s.hasBeenModified||s.renderAnnotationElement(t))}setMissingCanvas(t,i,s){const r=this.#B?.get(t);r&&(r.setCanvas(i,s),this.#B.delete(t))}addMissingCanvas(t,i){(this.#B||=new Map).set(t,i)}}class Ii{#t=null;#e=!1;#n=null;#i=null;#r=null;#a=null;#s=!1;#o=null;#c=null;#l=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(t){this.#c=t,this.#h=t._uiManager.useNewAltTextFlow,Ii.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){Ii._l10n??=t}async render(){const t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";const i=this.#i=document.createElement("span");t.append(i),this.#h?(t.classList.add("new"),t.setAttribute("data-l10n-id",Ii.#f.missing),i.setAttribute("data-l10n-id",Ii.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=this.#c._uiManager._signal;t.addEventListener("contextmenu",_i,{signal:s}),t.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:s});const r=l=>{l.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#m}})};return t.addEventListener("click",r,{capture:!0,signal:s}),t.addEventListener("keydown",l=>{l.target===t&&l.key==="Enter"&&(this.#s=!0,r(l))},{signal:s}),await this.#p(),t}get#m(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#s}),this.#s=!1)}isEmpty(){return this.#h?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#h?this.#t!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(t){this.#t===null&&(this.#l=t,this.#d=await Ii._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#p())}toggleAltTextBadge(t=!1){if(!this.#h||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const i=this.#o=document.createElement("div");i.className="noAltTextBadge",this.#c.div.append(i)}this.#o.classList.toggle("hidden",!t)}serialize(t){let i=this.#t;return!t&&this.#l===i&&(i=this.#d),{altText:i,decorative:this.#e,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:i,guessedText:s,textWithDisclaimer:r,cancel:l=!1}){s&&(this.#l=s,this.#d=r),!(this.#t===t&&this.#e===i)&&(l||(this.#t=t,this.#e=i),this.#p())}toggle(t=!1){this.#n&&(!t&&this.#a&&(clearTimeout(this.#a),this.#a=null),this.#n.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#m}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#r=null,this.#o?.remove(),this.#o=null}async#p(){const t=this.#n;if(!t)return;if(this.#h){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",Ii.#f[this.#m]),this.#i?.setAttribute("data-l10n-id",Ii.#f[`${this.#m}-label`]),!this.#t){this.#r?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#r?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let i=this.#r;if(!i){this.#r=i=document.createElement("span"),i.className="tooltip",i.setAttribute("role","tooltip"),i.id=`alt-text-tooltip-${this.#c.id}`;const r=100,l=this.#c._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(this.#a),this.#a=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#a=setTimeout(()=>{this.#a=null,this.#r.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},r)},{signal:l}),t.addEventListener("mouseleave",()=>{this.#a&&(clearTimeout(this.#a),this.#a=null),this.#r?.classList.remove("show")},{signal:l})}this.#e?i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(i.removeAttribute("data-l10n-id"),i.textContent=this.#t),i.parentNode||t.append(i),this.#c.getElementForAltText()?.setAttribute("aria-describedby",i.id)}}class Xo{#t=null;#e=null;#n=!1;#i=null;#r=null;#a=null;#s=null;#o=null;#c=!1;#l=null;constructor(t){this.#i=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const i=this.#i.commentButtonPosition;if(i){const{style:s}=t;s.insetInlineEnd=`calc(${100*(this.#i._uiManager.direction==="ltr"?1-i[0]:i[0])}% - var(--comment-button-dim))`,s.top=`calc(${100*i[1]}% - var(--comment-button-dim))`;const r=this.#i.commentButtonColor;r&&(s.backgroundColor=r)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#i.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#i._uiManager.updatePopupColor(this.#i)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#i.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#t)return null;const{x:t,y:i,height:s}=this.#t.getBoundingClientRect(),{x:r,y:l,width:c,height:u}=this.#i.parent.boundingClientRect;return[(t-r)/c,(i+s-l)/u]}set commentPopupPositionInLayer(t){this.#l=t}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:i}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=i)}#d(t,i){if(!this.#i._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",i?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#i._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const s=this.#i._uiManager._signal;if(!(s instanceof AbortSignal)||s.aborted)return t;t.addEventListener("contextmenu",_i,{signal:s}),i&&(t.addEventListener("focusin",l=>{this.#i._focusEventsAllowed=!1,se(l)},{capture:!0,signal:s}),t.addEventListener("focusout",l=>{this.#i._focusEventsAllowed=!0,se(l)},{capture:!0,signal:s})),t.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:s});const r=l=>{l.preventDefault(),t===this.#e?this.edit():this.#i.toggleComment(!0)};return t.addEventListener("click",r,{capture:!0,signal:s}),t.addEventListener("keydown",l=>{l.target===t&&l.key==="Enter"&&(this.#n=!0,r(l))},{signal:s}),t.addEventListener("pointerenter",()=>{this.#i.toggleComment(!1,!0)},{signal:s}),t.addEventListener("pointerleave",()=>{this.#i.toggleComment(!1,!1)},{signal:s}),t}edit(t){const i=this.commentPopupPositionInLayer;let s,r;if(i)[s,r]=i;else{[s,r]=this.#i.commentButtonPosition;const{width:p,height:y,x:b,y:A}=this.#i;s=b+s*p,r=A+r*y}const l=this.#i.parent.boundingClientRect,{x:c,y:u,width:h,height:f}=l;this.#i._uiManager.editComment(this.#i,c+s*h,u+r*f,{...t,parentDimensions:l})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#n}),this.#n=!1)}isDeleted(){return this.#c||this.#s===""}isEmpty(){return this.#s===null}hasBeenEdited(){return this.isDeleted()||this.#s!==this.#r}serialize(){return this.data}get data(){return{text:this.#s,richText:this.#a,date:this.#o,deleted:this.isDeleted()}}set data(t){if(t!==this.#s&&(this.#a=null),t===null){this.#s="",this.#c=!0;return}this.#s=t,this.#o=new Date,this.#c=!1}setInitialText(t,i=null){this.#r=t,this.data=t,this.#o=null,this.#a=i}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#s="",this.#a=null,this.#o=null,this.#i=null,this.#n=!1,this.#c=!1}}class dl{#t;#e=!1;#n=null;#i;#r;#a;#s;#o=null;#c;#l=null;#d;#h=null;constructor({container:t,isPinchingDisabled:i=null,isPinchingStopped:s=null,onPinchStart:r=null,onPinching:l=null,onPinchEnd:c=null,signal:u}){this.#t=t,this.#n=s,this.#i=i,this.#r=r,this.#a=l,this.#s=c,this.#d=new AbortController,this.#c=AbortSignal.any([u,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Gi.pixelRatio}#f(t){if(this.#i?.())return;if(t.touches.length===1){if(this.#o)return;const r=this.#o=new AbortController,l=AbortSignal.any([this.#c,r.signal]),c=this.#t,u={capture:!0,signal:l,passive:!1},h=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};c.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(se(f),h(f))},u),c.addEventListener("pointerup",h,u),c.addEventListener("pointercancel",h,u);return}if(!this.#h){this.#h=new AbortController;const r=AbortSignal.any([this.#c,this.#h.signal]),l=this.#t,c={signal:r,capture:!1,passive:!1};l.addEventListener("touchmove",this.#m.bind(this),c);const u=this.#p.bind(this);l.addEventListener("touchend",u,c),l.addEventListener("touchcancel",u,c),c.capture=!0,l.addEventListener("pointerdown",se,c),l.addEventListener("pointermove",se,c),l.addEventListener("pointercancel",se,c),l.addEventListener("pointerup",se,c),this.#r?.()}if(se(t),t.touches.length!==2||this.#n?.()){this.#l=null;return}let[i,s]=t.touches;i.identifier>s.identifier&&([i,s]=[s,i]),this.#l={touch0X:i.screenX,touch0Y:i.screenY,touch1X:s.screenX,touch1Y:s.screenY}}#m(t){if(!this.#l||t.touches.length!==2)return;se(t);let[i,s]=t.touches;i.identifier>s.identifier&&([i,s]=[s,i]);const{screenX:r,screenY:l}=i,{screenX:c,screenY:u}=s,h=this.#l,{touch0X:f,touch0Y:p,touch1X:y,touch1Y:b}=h,A=y-f,w=b-p,S=c-r,E=u-l,x=Math.hypot(S,E)||1,C=Math.hypot(A,w)||1;if(!this.#e&&Math.abs(C-x)<=dl.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=r,h.touch0Y=l,h.touch1X=c,h.touch1Y=u,!this.#e){this.#e=!0;return}const T=[(r+c)/2,(l+u)/2];this.#a?.(T,C,x)}#p(t){t.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#s?.()),this.#l&&(se(t),this.#l=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class ct{#t=null;#e=null;#n=null;#i=null;#r=null;#a=!1;#s=null;#o="";#c=null;#l=null;#d=null;#h=null;#f=null;#m="";#p=!1;#u=null;#g=!1;#y=!1;#v=!1;#b=null;#E=0;#_=0;#S=null;#C=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#A=!1;#x=ct._zIndex++;static _borderLineWidth=-1;static _colorManager=new dh;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=ct.prototype._resizeWithKeyboard,i=Fn.TRANSLATE_SMALL,s=Fn.TRANSLATE_BIG;return wt(this,"_resizerKeyboardManager",new xr([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-i,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[i,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-i]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,i]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,s]}],[["Escape","mac+Escape"],ct.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null,this.canAddComment=!0;const{rotation:i,rawDims:{pageWidth:s,pageHeight:r,pageX:l,pageY:c}}=this.parent.viewport;this.rotation=i,this.pageRotation=(360+i-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,r],this.pageTranslation=[l,c];const[u,h]=this.parentDimensions;this.x=t.x/u,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return wt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const i=new tv({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});i.annotationElementId=t.annotationElementId,i.deleted=!0,i._uiManager.addToAnnotationStorage(i)}static initialize(t,i){if(ct._l10n??=t,ct._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),ct._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);ct._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,i){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,i){Vt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#A}set _isDraggable(t){this.#A=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,i]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*i/(t*2),this.y+=this.width*t/(i*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*i/(t*2),this.y-=this.width*t/(i*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#x}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#z(),this.#h?.remove(),this.#h=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#p?this.#p=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,i,s,r){const[l,c]=this.parentDimensions;[s,r]=this.screenToPageTranslation(s,r),this.x=(t+s)/l,this.y=(i+r)/c,this.fixAndSetPosition()}_moveAfterPaste(t,i){const[s,r]=this.parentDimensions;this.setAt(t*s,i*r,this.width*s,this.height*r),this._onTranslated()}#R([t,i],s,r){[s,r]=this.screenToPageTranslation(s,r),this.x+=s/t,this.y+=r/i,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,i){this.#R(this.parentDimensions,t,i)}translateInPage(t,i){this.#u||=[this.x,this.y,this.width,this.height],this.#R(this.pageDimensions,t,i),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,i){this.#u||=[this.x,this.y,this.width,this.height];const{div:s,parentDimensions:[r,l]}=this;if(this.x+=t/r,this.y+=i/l,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:y,y:b}=this.div.getBoundingClientRect();this.parent.findNewParent(this,y,b)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:c,y:u}=this;const[h,f]=this.getBaseTranslation();c+=h,u+=f;const{style:p}=s;p.left=`${(100*c).toFixed(2)}%`,p.top=`${(100*u).toFixed(2)}%`,this._onTranslating(c,u),s.scrollIntoView({block:"nearest"})}_onTranslating(t,i){}_onTranslated(t,i){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[t,i]=this.parentDimensions,{_borderLineWidth:s}=ct,r=s/t,l=s/i;switch(this.rotation){case 90:return[-r,l];case 180:return[r,l];case 270:return[r,-l];default:return[-r,-l]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:i},pageDimensions:[s,r]}=this;let{x:l,y:c,width:u,height:h}=this;if(u*=s,h*=r,l*=s,c*=r,this._mustFixPosition)switch(t){case 0:l=Ue(l,0,s-u),c=Ue(c,0,r-h);break;case 90:l=Ue(l,0,s-h),c=Ue(c,u,r);break;case 180:l=Ue(l,u,s),c=Ue(c,h,r);break;case 270:l=Ue(l,h,s),c=Ue(c,0,r-u);break}this.x=l/=s,this.y=c/=r;const[f,p]=this.getBaseTranslation();l+=f,c+=p,i.left=`${(100*l).toFixed(2)}%`,i.top=`${(100*c).toFixed(2)}%`,this.moveInDOM()}static#M(t,i,s){switch(s){case 90:return[i,-t];case 180:return[-t,-i];case 270:return[-i,t];default:return[t,i]}}screenToPageTranslation(t,i){return ct.#M(t,i,this.parentRotation)}pageTranslationToScreen(t,i){return ct.#M(t,i,360-this.parentRotation)}#D(t){switch(t){case 90:{const[i,s]=this.pageDimensions;return[0,-i/s,s/i,0]}case 180:return[-1,0,0,-1];case 270:{const[i,s]=this.pageDimensions;return[0,i/s,-s/i,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[i,s]}=this;return[i*t,s*t]}setDims(){const{div:{style:t},width:i,height:s}=this;t.width=`${(100*i).toFixed(2)}%`,t.height=`${(100*s).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#P(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],i=this._uiManager._signal;for(const s of t){const r=document.createElement("div");this.#c.append(r),r.classList.add("resizer",s),r.setAttribute("data-resizer-name",s),r.addEventListener("pointerdown",this.#O.bind(this,s),{signal:i}),r.addEventListener("contextmenu",_i,{signal:i}),r.tabIndex=-1}this.div.prepend(this.#c)}#O(t,i){i.preventDefault();const{isMac:s}=De.platform;if(i.button!==0||i.ctrlKey&&s)return;this.#n?.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,this.#l=[i.screenX,i.screenY];const l=new AbortController,c=this._uiManager.combinedSignal(l);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#B.bind(this,t),{passive:!0,capture:!0,signal:c}),window.addEventListener("touchmove",se,{passive:!1,signal:c}),window.addEventListener("contextmenu",_i,{signal:c}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(i.target).cursor;const f=()=>{l.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=u,this.div.style.cursor=h,this.#U()};window.addEventListener("pointerup",f,{signal:c}),window.addEventListener("blur",f,{signal:c})}#k(t,i,s,r){this.width=s,this.height=r,this.x=t,this.y=i,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#U(){if(!this.#d)return;const{savedX:t,savedY:i,savedWidth:s,savedHeight:r}=this.#d;this.#d=null;const l=this.x,c=this.y,u=this.width,h=this.height;l===t&&c===i&&u===s&&h===r||this.addCommands({cmd:this.#k.bind(this,l,c,u,h),undo:this.#k.bind(this,t,i,s,r),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#B(t,i){const[s,r]=this.parentDimensions,l=this.x,c=this.y,u=this.width,h=this.height,f=ct.MIN_SIZE/s,p=ct.MIN_SIZE/r,y=this.#D(this.rotation),b=(k,q)=>[y[0]*k+y[2]*q,y[1]*k+y[3]*q],A=this.#D(360-this.rotation),w=(k,q)=>[A[0]*k+A[2]*q,A[1]*k+A[3]*q];let S,E,x=!1,C=!1;switch(t){case"topLeft":x=!0,S=(k,q)=>[0,0],E=(k,q)=>[k,q];break;case"topMiddle":S=(k,q)=>[k/2,0],E=(k,q)=>[k/2,q];break;case"topRight":x=!0,S=(k,q)=>[k,0],E=(k,q)=>[0,q];break;case"middleRight":C=!0,S=(k,q)=>[k,q/2],E=(k,q)=>[0,q/2];break;case"bottomRight":x=!0,S=(k,q)=>[k,q],E=(k,q)=>[0,0];break;case"bottomMiddle":S=(k,q)=>[k/2,q],E=(k,q)=>[k/2,0];break;case"bottomLeft":x=!0,S=(k,q)=>[0,q],E=(k,q)=>[k,0];break;case"middleLeft":C=!0,S=(k,q)=>[0,q/2],E=(k,q)=>[k,q/2];break}const T=S(u,h),B=E(u,h);let O=b(...B);const L=ct._round(l+O[0]),P=ct._round(c+O[1]);let G=1,Q=1,tt,W;if(i.fromKeyboard)({deltaX:tt,deltaY:W}=i);else{const{screenX:k,screenY:q}=i,[Z,gt]=this.#l;[tt,W]=this.screenToPageTranslation(k-Z,q-gt),this.#l[0]=k,this.#l[1]=q}if([tt,W]=w(tt/s,W/r),x){const k=Math.hypot(u,h);G=Q=Math.max(Math.min(Math.hypot(B[0]-T[0]-tt,B[1]-T[1]-W)/k,1/u,1/h),f/u,p/h)}else C?G=Ue(Math.abs(B[0]-T[0]-tt),f,1)/u:Q=Ue(Math.abs(B[1]-T[1]-W),p,1)/h;const ut=ct._round(u*G),mt=ct._round(h*Q);O=b(...E(ut,mt));const ht=L-O[0],vt=P-O[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=ut,this.height=mt,this.x=ht,this.y=vt,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#y)return this._editToolbar;this._editToolbar=new gr(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[i,s]of t)await this._editToolbar.addButton(i,s);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#n?.destroy()}addContainer(t){const i=this._editToolbar?.div;i?i.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#n||(Ii.initialize(ct._l10n),this.#n=new Ii(this),this.#t&&(this.#n.data=this.#t,this.#t=null)),this.#n}get altTextData(){return this.#n?.data}set altTextData(t){this.#n&&(this.#n.data=t)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(t){await this.#n?.setGuessedText(t)}serializeAltText(t){return this.#n?.serialize(t)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}focusCommentButton(){this.#i?.focusButton()}addCommentButton(){return this.canAddComment?this.#i||=new Xo(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#r){this._uiManager.isEditingMode()&&this.#r.classList.remove("hidden");return}this.hasComment&&(this.#r=this.#i.renderForStandalone(),this.div.append(this.#r))}}removeStandaloneCommentButton(){this.#i.removeStandaloneCommentButton(),this.#r=null}hideStandaloneCommentButton(){this.#r?.classList.add("hidden")}get comment(){const{data:{richText:t,text:i,date:s,deleted:r}}=this.#i;return{text:i,richText:t,date:s,deleted:r,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#i||=new Xo(this),this.#i.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:i,richText:s}){if(!i||(this.#i||=new Xo(this),this.#i.setInitialText(t,s),!this.annotationElementId))return;const r=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);r&&this.updateFromAnnotationLayer(r)}get hasEditedComment(){return this.#i?.hasBeenEdited()}get hasDeletedComment(){return this.#i?.isDeleted()}get hasComment(){return!!this.#i&&!this.#i.isEmpty()&&!this.#i.isDeleted()}async editComment(t){this.#i||=new Xo(this),this.#i.edit(t)}toggleComment(t,i=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,i)}setSelectedCommentButton(t){this.#i.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,r]=t.rect,[l]=this.pageDimensions,[c]=this.pageTranslation,u=c+l+1,h=r-100,f=u+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,h,f,r]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:i}}){this.#i.data=i?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#a?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#H();const[i,s]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*s/i).toFixed(2)}%`,t.style.maxHeight=`${(100*i/s).toFixed(2)}%`);const[r,l]=this.getInitialTranslation();return this.translate(r,l),_m(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#C||=new dl({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#q.bind(this),onPinching:this.#T.bind(this),onPinchEnd:this.#w.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#q(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#T(t,i,s){let l=.7*(s/i)+1-.7;if(l===1)return;const c=this.#D(this.rotation),u=(L,P)=>[c[0]*L+c[2]*P,c[1]*L+c[3]*P],[h,f]=this.parentDimensions,p=this.x,y=this.y,b=this.width,A=this.height,w=ct.MIN_SIZE/h,S=ct.MIN_SIZE/f;l=Math.max(Math.min(l,1/b,1/A),w/b,S/A);const E=ct._round(b*l),x=ct._round(A*l);if(E===b&&x===A)return;this.#u||=[p,y,b,A];const C=u(b/2,A/2),T=ct._round(p+C[0]),B=ct._round(y+C[1]),O=u(E/2,x/2);this.x=T-O[0],this.y=B-O[1],this.width=E,this.height=x,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#w(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#U()}pointerdown(t){const{isMac:i}=De.platform;if(t.button!==0||t.ctrlKey&&i){t.preventDefault();return}if(this.#p=!0,this._isDraggable){this.#F(t);return}this.#L(t)}#L(t){const{isMac:i}=De.platform;t.ctrlKey&&!i||t.shiftKey||t.metaKey&&i?this.parent.toggleSelected(this):this.parent.setSelected(this)}#F(t){const{isSelected:i}=this;this._uiManager.setUpDragSession();let s=!1;const r=new AbortController,l=this._uiManager.combinedSignal(r),c={capture:!0,passive:!1,signal:l},u=f=>{r.abort(),this.#s=null,this.#p=!1,this._uiManager.endDragSession()||this.#L(f),s&&this._onStopDragging()};i&&(this.#E=t.clientX,this.#_=t.clientY,this.#s=t.pointerId,this.#o=t.pointerType,window.addEventListener("pointermove",f=>{s||(s=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:p,clientY:y,pointerId:b}=f;if(b!==this.#s){se(f);return}const[A,w]=this.screenToPageTranslation(p-this.#E,y-this.#_);this.#E=p,this.#_=y,this._uiManager.dragSelectedEditors(A,w)},c),window.addEventListener("touchmove",se,c),window.addEventListener("pointerdown",f=>{f.pointerType===this.#o&&(this.#C||f.isPrimary)&&u(f),se(f)},c));const h=f=>{if(!this.#s||this.#s===f.pointerId){u(f);return}se(f)};window.addEventListener("pointerup",h,{signal:l}),window.addEventListener("blur",h,{signal:l})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#b&&clearTimeout(this.#b),this.#b=setTimeout(()=>{this.#b=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,i,s){t.changeParent(this),this.x=i,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(t,i,s=this.rotation){const r=this.parentScale,[l,c]=this.pageDimensions,[u,h]=this.pageTranslation,f=t/r,p=i/r,y=this.x*l,b=this.y*c,A=this.width*l,w=this.height*c;switch(s){case 0:return[y+f+u,c-b-p-w+h,y+f+A+u,c-b-p+h];case 90:return[y+p+u,c-b+f+h,y+p+w+u,c-b+f+A+h];case 180:return[y-f-A+u,c-b+p+h,y-f+u,c-b+p+w+h];case 270:return[y-p-w+u,c-b-f-A+h,y-p+u,c-b-f+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,i){const[s,r,l,c]=t,u=l-s,h=c-r;switch(this.rotation){case 0:return[s,i-c,u,h];case 90:return[s,i-r,h,u];case 180:return[l,i-r,u,h];case 270:return[l,i-c,h,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&ct._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#i?.onUpdatedColor()}getData(){const{comment:{text:t,color:i,date:s,opacity:r,deleted:l,richText:c},uid:u,pageIndex:h,creationDate:f,modificationDate:p}=this;return{id:u,pageIndex:h,rect:this.getPDFRect(),richText:c,contentsObj:{str:t},creationDate:f,modificationDate:s||p,popupRef:!l,color:i,opacity:r}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#y=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#y=!1,!0):!1}isInEditMode(){return this.#y}shouldGetKeyboardEvents(){return this.#v}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:i,bottom:s,right:r}=this.getClientDimensions(),{innerHeight:l,innerWidth:c}=window;return i<c&&r>0&&t<l&&s>0}#H(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#H()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,i=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,i,s){const r=new this.prototype.constructor({parent:i,id:i.getNextId(),uiManager:s,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});r.rotation=t.rotation,r.#t=t.accessibilityData,r._isCopy=t.isCopy||!1;const[l,c]=r.pageDimensions,[u,h,f,p]=r.getRectInCurrentCoords(t.rect,c);return r.x=u/l,r.y=h/c,r.width=f/l,r.height=p/c,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#b&&(clearTimeout(this.#b),this.#b=null),this.#z(),this.removeEditToolbar(),this.#S){for(const t of this.#S.values())clearTimeout(t);this.#S=null}this.parent=null,this.#C?.destroy(),this.#C=null,this.#h?.remove(),this.#h=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#P(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,i]}=this,[s,r,l,c]=this.getPDFRect();return[ct._round(s+(l-s)*t),ct._round(r+(c-r)*(1-i))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#i.commentPopupPositionInLayer}set commentPopupPosition(t){this.#i.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#i.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#i.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#i?.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const i=this.#c.children;if(!this.#e){this.#e=Array.from(i);const c=this.#Y.bind(this),u=this.#X.bind(this),h=this._uiManager._signal;for(const f of this.#e){const p=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",c,{signal:h}),f.addEventListener("blur",u,{signal:h}),f.addEventListener("focus",this.#$.bind(this,p),{signal:h}),f.setAttribute("data-l10n-id",ct._l10nResizer[p])}}const s=this.#e[0];let r=0;for(const c of i){if(c===s)break;r++}const l=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(l!==r){if(l<r)for(let u=0;u<r-l;u++)this.#c.append(this.#c.firstChild);else if(l>r)for(let u=0;u<l-r;u++)this.#c.firstChild.before(this.#c.lastChild);let c=0;for(const u of i){const f=this.#e[c++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",ct._l10nResizer[f])}}this.#I(0),this.#v=!0,this.#c.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#Y(t){ct._resizerKeyboardManager.exec(this,t)}#X(t){this.#v&&t.relatedTarget?.parentNode!==this.#c&&this.#z()}#$(t){this.#m=this.#v?t:""}#I(t){if(this.#e)for(const i of this.#e)i.tabIndex=t}_resizeWithKeyboard(t,i){this.#v&&this.#B(this.#m,{deltaX:t,deltaY:i,fromKeyboard:!0})}#z(){this.#v=!1,this.#I(-1),this.#U()}_stopResizingWithKeyboard(){this.#z(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(t,i){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#g}set isEditing(t){this.#g=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,i=!1){if(i){this.#S||=new Map;const{action:s}=t;let r=this.#S.get(s);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(t),this.#S.delete(s),this.#S.size===0&&(this.#S=null)},ct._telemetryTimeout),this.#S.set(s,r);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#a=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#a=!0}updateFakeAnnotationElement(t){if(!this.#h&&!this.deleted){this.#h=t.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let i=t.container.querySelector(".annotationContent");if(!i)i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),t.container.prepend(i);else if(i.nodeName==="CANVAS"){const s=i;i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),s.before(i)}return i}resetAnnotationElement(t){const{firstChild:i}=t.container;i?.nodeName==="DIV"&&i.classList.contains("annotationContent")&&i.remove()}}class tv extends ct{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Vp=3285377520,Ai=4294901760,ji=65535;class xm{constructor(t){this.h1=t?t&4294967295:Vp,this.h2=t?t&4294967295:Vp}update(t){let i,s;if(typeof t=="string"){i=new Uint8Array(t.length*2),s=0;for(let S=0,E=t.length;S<E;S++){const x=t.charCodeAt(S);x<=255?i[s++]=x:(i[s++]=x>>>8,i[s++]=x&255)}}else if(ArrayBuffer.isView(t))i=t.slice(),s=i.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=s>>2,l=s-r*4,c=new Uint32Array(i.buffer,0,r);let u=0,h=0,f=this.h1,p=this.h2;const y=3432918353,b=461845907,A=y&ji,w=b&ji;for(let S=0;S<r;S++)S&1?(u=c[S],u=u*y&Ai|u*A&ji,u=u<<15|u>>>17,u=u*b&Ai|u*w&ji,f^=u,f=f<<13|f>>>19,f=f*5+3864292196):(h=c[S],h=h*y&Ai|h*A&ji,h=h<<15|h>>>17,h=h*b&Ai|h*w&ji,p^=h,p=p<<13|p>>>19,p=p*5+3864292196);switch(u=0,l){case 3:u^=i[r*4+2]<<16;case 2:u^=i[r*4+1]<<8;case 1:u^=i[r*4],u=u*y&Ai|u*A&ji,u=u<<15|u>>>17,u=u*b&Ai|u*w&ji,r&1?f^=u:p^=u}this.h1=f,this.h2=p}hexdigest(){let t=this.h1,i=this.h2;return t^=i>>>1,t=t*3981806797&Ai|t*36045&ji,i=i*4283543511&Ai|((i<<16|t>>>16)*2950163797&Ai)>>>16,t^=i>>>1,t=t*444984403&Ai|t*60499&ji,i=i*3301882366&Ai|((i<<16|t>>>16)*3120437893&Ai)>>>16,t^=i>>>1,(t>>>0).toString(16).padStart(8,"0")+(i>>>0).toString(16).padStart(8,"0")}}const th=Object.freeze({map:null,hash:"",transfer:void 0});class fh{#t=!1;#e=null;#n=null;#i=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,i){const s=this.#i.get(t);return s===void 0?i:Object.assign(i,s)}getRawValue(t){return this.#i.get(t)}remove(t){const i=this.#i.get(t);if(i!==void 0&&(i instanceof ct&&this.#n.delete(i.annotationElementId),this.#i.delete(t),this.#i.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const s of this.#i.values())if(s instanceof ct)return;this.onAnnotationEditor(null)}}setValue(t,i){const s=this.#i.get(t);let r=!1;if(s!==void 0)for(const[l,c]of Object.entries(i))s[l]!==c&&(r=!0,s[l]=c);else r=!0,this.#i.set(t,i);r&&this.#r(),i instanceof ct&&((this.#n||=new Map).set(i.annotationElementId,i),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(i.constructor._type))}has(t){return this.#i.has(t)}get size(){return this.#i.size}#r(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Em(this)}get serializable(){if(this.#i.size===0)return th;const t=new Map,i=new xm,s=[],r=Object.create(null);let l=!1;for(const[c,u]of this.#i){const h=u instanceof ct?u.serialize(!1,r):u;h&&(t.set(c,h),i.update(`${c}:${JSON.stringify(h)}`),l||=!!h.bitmap)}if(l)for(const c of t.values())c.bitmap&&s.push(c.bitmap);return t.size>0?{map:t,hash:i.hexdigest(),transfer:s}:th}get editorStats(){let t=null;const i=new Map;let s=0,r=0;for(const l of this.#i.values()){if(!(l instanceof ct)){l.popup&&(l.popup.deleted?r+=1:s+=1);continue}l.isCommentDeleted?r+=1:l.hasEditedComment&&(s+=1);const c=l.telemetryFinalData;if(!c)continue;const{type:u}=c;i.has(u)||i.set(u,Object.getPrototypeOf(l).constructor),t||=Object.create(null);const h=t[u]||=new Map;for(const[f,p]of Object.entries(c)){if(f==="type")continue;let y=h.get(f);y||(y=new Map,h.set(f,y));const b=y.get(p)??0;y.set(p,b+1)}}if((r>0||s>0)&&(t||=Object.create(null),t.comments={deleted:r,edited:s}),!t)return null;for(const[l,c]of i)t[l]=c.computeTelemetryFinalData(t[l]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,i){const s=this.#n?.get(t);return s?(s.updateFromAnnotationLayer(i),!0):!1}getEditor(t){return this.#n?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#n)for(const i of this.#n.values())i.serialize()&&t.push(i.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#i.entries()}}class Em extends fh{#t;constructor(t){super();const{map:i,hash:s,transfer:r}=t.serializable,l=structuredClone(i,r?{transfer:r}:null);this.#t={map:l,hash:s,transfer:r}}get print(){Vt("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return wt(this,"modifiedIds",{ids:new Set,hash:""})}}class ev{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:i=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const i=this.styleElement.sheet;i.insertRule(t,i.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:i,_inspectFont:s}){if(!(!t||this.#t.has(t.loadedName))){if(Ot(!i,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:l,style:c}=t,u=new FontFace(r,l,c);this.addNativeFontFace(u);try{await u.load(),this.#t.add(r),s?.(t)}catch{bt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}Vt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const s=t.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(r){throw bt(`Failed to load font '${s.family}': '${r}'.`),t.disableFontFace=!0,r}}return}const i=t.createFontFaceRule();if(i){if(this.insertRule(i),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const r=this._queueLoadingCallback(s);this._prepareFontLoadEvent(t,r)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return wt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return wt(this,"isSyncFontLoadingSupported",Pe||De.platform.isFirefox)}_queueLoadingCallback(t){function i(){for(Ot(!r.done,"completeRequest() cannot be called twice."),r.done=!0;s.length>0&&s[0].done;){const l=s.shift();setTimeout(l.callback,0)}}const{loadingRequests:s}=this,r={done:!1,complete:i,callback:t};return s.push(r),r}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return wt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,i){function s(B,O){return B.charCodeAt(O)<<24|B.charCodeAt(O+1)<<16|B.charCodeAt(O+2)<<8|B.charCodeAt(O+3)&255}function r(B,O,L,P){const G=B.substring(0,O),Q=B.substring(O+L);return G+P+Q}let l,c;const u=this._document.createElement("canvas");u.width=1,u.height=1;const h=u.getContext("2d");let f=0;function p(B,O){if(++f>30){bt("Load test font never loaded."),O();return}if(h.font="30px "+B,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){O();return}setTimeout(p.bind(null,B,O))}const y=`lt${Date.now()}${this.loadTestFontId++}`;let b=this._loadTestFont;b=r(b,976,y.length,y);const w=16,S=1482184792;let E=s(b,w);for(l=0,c=y.length-3;l<c;l+=4)E=E-S+s(y,l)|0;l<y.length&&(E=E-S+s(y+"XXX",l)|0),b=r(b,w,4,B0(E));const x=`url(data:font/opentype;base64,${btoa(b)});`,C=`@font-face {font-family:"${y}";src:${x}}`;this.insertRule(C);const T=this._document.createElement("div");T.style.visibility="hidden",T.style.width=T.style.height="10px",T.style.position="absolute",T.style.top=T.style.left="0px";for(const B of[t.loadedName,y]){const O=this._document.createElement("span");O.textContent="Hi",O.style.fontFamily=B,T.append(O)}this._document.body.append(T),p(y,()=>{T.remove(),i.complete()})}}class iv{#t;constructor(t,i=null,s,r){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=i,s&&Object.assign(this,s),r&&(this.charProcOperatorList=r)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${vm(this.data)});`;let i;if(!this.cssFontInfo)i=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),i=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${t}}`}return this._inspectFont?.(this,t),i}getPathGenerator(t,i){if(this.compiledGlyphs[i]!==void 0)return this.compiledGlyphs[i];const s=this.loadedName+"_path_"+i;let r;try{r=t.get(s)}catch(c){bt(`getPathGenerator - ignoring character: "${c}".`)}const l=wm(r);return this.fontExtraProperties||t.delete(s),this.compiledGlyphs[i]=l}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}class oa{#t;#e;#n;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const i=new TextEncoder,s={};let r=0;for(const f of oa.strings){const p=i.encode(t[f]);s[f]=p,r+=4+p.length}const l=new ArrayBuffer(r),c=new Uint8Array(l),u=new DataView(l);let h=0;for(const f of oa.strings){const p=s[f],y=p.length;u.setUint32(h,y),c.set(p,h+4),h+=4+y}return Ot(h===l.byteLength,"CssFontInfo.write: Buffer overflow"),l}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#n=new TextDecoder}#i(t){Ot(t<oa.strings.length,"Invalid string index");let i=0;for(let r=0;r<t;r++)i+=this.#e.getUint32(i)+4;const s=this.#e.getUint32(i);return this.#n.decode(new Uint8Array(this.#t,i+4,s))}get fontFamily(){return this.#i(0)}get fontWeight(){return this.#i(1)}get italicAngle(){return this.#i(2)}}class la{#t;#e;#n;static strings=["css","loadedName","baseFontName","src"];static write(t){const i=new TextEncoder,s={};let r=0;for(const b of la.strings){const A=i.encode(t[b]);s[b]=A,r+=4+A.length}r+=4;let l,c,u=1+r;t.style&&(l=i.encode(t.style.style),c=i.encode(t.style.weight),u+=4+l.length+4+c.length);const h=new ArrayBuffer(u),f=new Uint8Array(h),p=new DataView(h);let y=0;p.setUint8(y++,t.guessFallback?1:0),p.setUint32(y,0),y+=4,r=0;for(const b of la.strings){const A=s[b],w=A.length;r+=4+w,p.setUint32(y,w),f.set(A,y+4),y+=4+w}return p.setUint32(y-r-4,r),t.style&&(p.setUint32(y,l.length),f.set(l,y+4),y+=4+l.length,p.setUint32(y,c.length),f.set(c,y+4),y+=4+c.length),Ot(y<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(y)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#n=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#i(t){Ot(t<la.strings.length,"Invalid string index");let i=5;for(let r=0;r<t;r++)i+=this.#e.getUint32(i)+4;const s=this.#e.getUint32(i);return this.#n.decode(new Uint8Array(this.#t,i+4,s))}get css(){return this.#i(0)}get loadedName(){return this.#i(1)}get baseFontName(){return this.#i(2)}get src(){return this.#i(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const i=this.#e.getUint32(t),s=this.#n.decode(new Uint8Array(this.#t,t+4,i));t+=4+i;const r=this.#e.getUint32(t),l=this.#n.decode(new Uint8Array(this.#t,t+4,r));return{style:s,weight:l}}}class Gt{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#n=this.#e+1+8;static#i=this.#n+1+48;static#r=this.#i+1+6;#a;#s;#o;constructor({data:t,extra:i}){this.#a=t,this.#s=new TextDecoder,this.#o=new DataView(this.#a),i&&Object.assign(this,i)}#c(t){Ot(t<Gt.bools.length,"Invalid boolean index");const i=Math.floor(t/4),s=t*2%8,r=this.#o.getUint8(i)>>s&3;return r===0?void 0:r===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(t){return Ot(t<Gt.numbers.length,"Invalid number index"),this.#o.getFloat64(Gt.#t+t*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let t=Gt.#e;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let r=0;r<4;r++)s.push(this.#o.getInt16(t,!0)),t+=2;return s}get fontMatrix(){let t=Gt.#n;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let r=0;r<6;r++)s.push(this.#o.getFloat64(t,!0)),t+=8;return s}get defaultVMetrics(){let t=Gt.#i;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let r=0;r<3;r++)s.push(this.#o.getInt16(t,!0)),t+=2;return s}#d(t){Ot(t<Gt.strings.length,"Invalid string index");let i=Gt.#r+4;for(let l=0;l<t;l++)i+=this.#o.getUint32(i)+4;const s=this.#o.getUint32(i),r=new Uint8Array(s);return r.set(new Uint8Array(this.#a,i+4,s)),this.#s.decode(r)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=Gt.#r;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);t+=4+s;const r=this.#o.getUint32(t);t+=4+r;const l=this.#o.getUint32(t);if(l!==0)return new Uint8Array(this.#a,t+4,l)}clearData(){let t=Gt.#r;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);t+=4+s;const r=this.#o.getUint32(t);t+=4+r;const l=this.#o.getUint32(t);new Uint8Array(this.#a,t+4,l).fill(0),this.#o.setUint32(t,0)}get cssFontInfo(){let t=Gt.#r;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);t+=4+s;const r=this.#o.getUint32(t);if(r===0)return null;const l=new Uint8Array(r);return l.set(new Uint8Array(this.#a,t+4,r)),new oa(l.buffer)}get systemFontInfo(){let t=Gt.#r;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);if(s===0)return null;const r=new Uint8Array(s);return r.set(new Uint8Array(this.#a,t+4,s)),new la(r.buffer)}static write(t){const i=t.systemFontInfo?la.write(t.systemFontInfo):null,s=t.cssFontInfo?oa.write(t.cssFontInfo):null,r=new TextEncoder,l={};let c=0;for(const S of Gt.strings)l[S]=r.encode(t[S]),c+=4+l[S].length;const u=Gt.#r+4+c+4+(i?i.byteLength:0)+4+(s?s.byteLength:0)+4+(t.data?t.data.length:0),h=new ArrayBuffer(u),f=new Uint8Array(h),p=new DataView(h);let y=0;const b=Gt.bools.length;let A=0,w=0;for(let S=0;S<b;S++){const E=t[Gt.bools[S]];A|=(E===void 0?0:E?2:1)<<w,w+=2,(w===8||S===b-1)&&(p.setUint8(y++,A),A=0,w=0)}Ot(y===Gt.#t,"FontInfo.write: Boolean properties offset mismatch");for(const S of Gt.numbers)p.setFloat64(y,t[S]),y+=8;if(Ot(y===Gt.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){p.setUint8(y++,4);for(const S of t.bbox)p.setInt16(y,S,!0),y+=2}else p.setUint8(y++,0),y+=8;if(Ot(y===Gt.#n,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){p.setUint8(y++,6);for(const S of t.fontMatrix)p.setFloat64(y,S,!0),y+=8}else p.setUint8(y++,0),y+=48;if(Ot(y===Gt.#i,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){p.setUint8(y++,1);for(const S of t.defaultVMetrics)p.setInt16(y,S,!0),y+=2}else p.setUint8(y++,0),y+=6;Ot(y===Gt.#r,"FontInfo.write: DefaultVMetrics properties offset mismatch"),p.setUint32(Gt.#r,0),y+=4;for(const S of Gt.strings){const E=l[S],x=E.length;p.setUint32(y,x),f.set(E,y+4),y+=4+x}if(p.setUint32(Gt.#r,y-Gt.#r-4),!i)p.setUint32(y,0),y+=4;else{const S=i.byteLength;p.setUint32(y,S),Ot(y+4+S<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(i),y+4),y+=4+S}if(!s)p.setUint32(y,0),y+=4;else{const S=s.byteLength;p.setUint32(y,S),Ot(y+4+S<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(s),y+4),y+=4+S}return t.data===void 0?(p.setUint32(y,0),y+=4):(p.setUint32(y,t.data.length),f.set(t.data,y+4),y+=4+t.data.length),Ot(y<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(y)}}class be{static#t=0;static#e=1;static#n=2;static#i=3;static#r=4;static#a=8;static#s=12;static#o=16;constructor(t){this.buffer=t,this.view=new DataView(t),this.data=new Uint8Array(t)}static write(t){let i,s=null,r=[],l=[],c=[],u=[],h=null,f=null;switch(t[0]){case"RadialAxial":i=t[1]==="axial"?1:2,s=t[2],c=t[3],i===1?r.push(...t[4],...t[5]):r.push(t[4][0],t[4][1],t[6],t[5][0],t[5][1],t[7]);break;case"Mesh":i=3,h=t[1],r=t[2],l=t[3],u=t[4]||[],s=t[6],f=t[7];break;default:throw new Error(`Unsupported pattern type: ${t[0]}`)}const p=Math.floor(r.length/2),y=Math.floor(l.length/3),b=c.length,A=u.length;let w=0;for(const O of u)w+=1,w=Math.ceil(w/4)*4,w+=4+O.coords.length*4,w+=4+O.colors.length*4,O.verticesPerRow!==void 0&&(w+=4);const S=20+p*8+y*3+b*8+(s?16:0)+(f?3:0)+w,E=new ArrayBuffer(S),x=new DataView(E),C=new Uint8Array(E);x.setUint8(be.#t,i),x.setUint8(be.#e,s?1:0),x.setUint8(be.#n,f?1:0),x.setUint8(be.#i,h),x.setUint32(be.#r,p,!0),x.setUint32(be.#a,y,!0),x.setUint32(be.#s,b,!0),x.setUint32(be.#o,A,!0);let T=20;new Float32Array(E,T,p*2).set(r),T+=p*8,C.set(l,T),T+=y*3;for(const[O,L]of c)x.setFloat32(T,O,!0),T+=4,x.setUint32(T,parseInt(L.slice(1),16),!0),T+=4;if(s)for(const O of s)x.setFloat32(T,O,!0),T+=4;f&&(C.set(f,T),T+=3);for(let O=0;O<u.length;O++){const L=u[O];x.setUint8(T,L.type),T+=1,T=Math.ceil(T/4)*4,x.setUint32(T,L.coords.length,!0),T+=4,new Int32Array(E,T,L.coords.length).set(L.coords),T+=L.coords.length*4,x.setUint32(T,L.colors.length,!0),T+=4,new Int32Array(E,T,L.colors.length).set(L.colors),T+=L.colors.length*4,L.verticesPerRow!==void 0&&(x.setUint32(T,L.verticesPerRow,!0),T+=4)}return E}getIR(){const t=this.view,i=this.data[be.#t],s=!!this.data[be.#e],r=!!this.data[be.#n],l=t.getUint32(be.#r,!0),c=t.getUint32(be.#a,!0),u=t.getUint32(be.#s,!0),h=t.getUint32(be.#o,!0);let f=20;const p=new Float32Array(this.buffer,f,l*2);f+=l*8;const y=new Uint8Array(this.buffer,f,c*3);f+=c*3;const b=[];for(let E=0;E<u;++E){const x=t.getFloat32(f,!0);f+=4;const C=t.getUint32(f,!0);f+=4,b.push([x,`#${C.toString(16).padStart(6,"0")}`])}let A=null;if(s){A=[];for(let E=0;E<4;++E)A.push(t.getFloat32(f,!0)),f+=4}let w=null;r&&(w=new Uint8Array(this.buffer,f,3),f+=3);const S=[];for(let E=0;E<h;++E){const x=t.getUint8(f);f+=1,f=Math.ceil(f/4)*4;const C=t.getUint32(f,!0);f+=4;const T=new Int32Array(this.buffer,f,C);f+=C*4;const B=t.getUint32(f,!0);f+=4;const O=new Int32Array(this.buffer,f,B);f+=B*4;const L={type:x,coords:T,colors:O};x===Ku.LATTICE&&(L.verticesPerRow=t.getUint32(f,!0),f+=4),S.push(L)}if(i===1)return["RadialAxial","axial",A,b,Array.from(p.slice(0,2)),Array.from(p.slice(2,4)),null,null];if(i===2)return["RadialAxial","radial",A,b,[p[0],p[1]],[p[3],p[4]],p[2],p[5]];if(i===3){const E=this.data[be.#i];let x=null;if(p.length>0){let C=p[0],T=p[0],B=p[1],O=p[1];for(let L=0;L<p.length;L+=2){const P=p[L],G=p[L+1];C=C>P?P:C,B=B>G?G:B,T=T<P?P:T,O=O<G?G:O}x=[C,B,T,O]}return["Mesh",E,p,y,S,x,A,w]}throw new Error(`Unsupported pattern kind: ${i}`)}}function nv(m){if(m instanceof URL)return m.href;if(typeof m=="string"){if(Pe)return m;const t=URL.parse(m,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function sv(m){if(Pe&&typeof Buffer<"u"&&m instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(m instanceof Uint8Array&&m.byteLength===m.buffer.byteLength)return m;if(typeof m=="string")return Ar(m);if(m instanceof ArrayBuffer||ArrayBuffer.isView(m)||typeof m=="object"&&!isNaN(m?.length))return new Uint8Array(m);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Yo(m){if(typeof m!="string")return null;if(m.endsWith("/"))return m;throw new Error(`Invalid factory url: "${m}" must include trailing slash.`)}const eh=m=>typeof m=="object"&&Number.isInteger(m?.num)&&m.num>=0&&Number.isInteger(m?.gen)&&m.gen>=0,av=m=>typeof m=="object"&&typeof m?.name=="string",rv=j0.bind(null,eh,av);class ov{#t=new Map;#e=Promise.resolve();postMessage(t,i){const s={data:structuredClone(t,i?{transfer:i}:null)};this.#e.then(()=>{for(const[r]of this.#t)r.call(this,s)})}addEventListener(t,i,s=null){let r=null;if(s?.signal instanceof AbortSignal){const{signal:l}=s;if(l.aborted){bt("LoopbackPort - cannot use an `aborted` signal.");return}const c=()=>this.removeEventListener(t,i);r=()=>l.removeEventListener("abort",c),l.addEventListener("abort",c)}this.#t.set(i,r)}removeEventListener(t,i){this.#t.get(i)?.(),this.#t.delete(i)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const $o={DATA:1,ERROR:2},de={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Xp(){}function Ke(m){if(m instanceof Un||m instanceof Qu||m instanceof Up||m instanceof sl||m instanceof Fu)return m;switch(m instanceof Error||typeof m=="object"&&m!==null||Vt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),m.name){case"AbortException":return new Un(m.message);case"InvalidPDFException":return new Qu(m.message);case"PasswordException":return new Up(m.message,m.code);case"ResponseException":return new sl(m.message,m.status,m.missing);case"UnknownErrorException":return new Fu(m.message,m.details)}return new Fu(m.message,m.toString())}class dr{#t=new AbortController;constructor(t,i,s){this.sourceName=t,this.targetName=i,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#i(t);return}if(t.callback){const s=t.callbackId,r=this.callbackCapabilities[s];if(!r)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],t.callback===$o.DATA)r.resolve(t.data);else if(t.callback===$o.ERROR)r.reject(Ke(t.reason));else throw new Error("Unexpected callback case");return}const i=this.actionHandler[t.action];if(!i)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const s=this.sourceName,r=t.sourceName,l=this.comObj;Promise.try(i,t.data).then(function(c){l.postMessage({sourceName:s,targetName:r,callback:$o.DATA,callbackId:t.callbackId,data:c})},function(c){l.postMessage({sourceName:s,targetName:r,callback:$o.ERROR,callbackId:t.callbackId,reason:Ke(c)})});return}if(t.streamId){this.#n(t);return}i(t.data)}on(t,i){const s=this.actionHandler;if(s[t])throw new Error(`There is already an actionName called "${t}"`);s[t]=i}send(t,i,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:i},s)}sendWithPromise(t,i,s){const r=this.callbackId++,l=Promise.withResolvers();this.callbackCapabilities[r]=l;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:r,data:i},s)}catch(c){l.reject(c)}return l.promise}sendWithStream(t,i,s,r){const l=this.streamId++,c=this.sourceName,u=this.targetName,h=this.comObj;return new ReadableStream({start:f=>{const p=Promise.withResolvers();return this.streamControllers[l]={controller:f,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:c,targetName:u,action:t,streamId:l,data:i,desiredSize:f.desiredSize},r),p.promise},pull:f=>{const p=Promise.withResolvers();return this.streamControllers[l].pullCall=p,h.postMessage({sourceName:c,targetName:u,stream:de.PULL,streamId:l,desiredSize:f.desiredSize}),p.promise},cancel:f=>{Ot(f instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[l].cancelCall=p,this.streamControllers[l].isClosed=!0,h.postMessage({sourceName:c,targetName:u,stream:de.CANCEL,streamId:l,reason:Ke(f)}),p.promise}},s)}#n(t){const i=t.streamId,s=this.sourceName,r=t.sourceName,l=this.comObj,c=this,u=this.actionHandler[t.action],h={enqueue(f,p=1,y){if(this.isCancelled)return;const b=this.desiredSize;this.desiredSize-=p,b>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),l.postMessage({sourceName:s,targetName:r,stream:de.ENQUEUE,streamId:i,chunk:f},y)},close(){this.isCancelled||(this.isCancelled=!0,l.postMessage({sourceName:s,targetName:r,stream:de.CLOSE,streamId:i}),delete c.streamSinks[i])},error(f){Ot(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,l.postMessage({sourceName:s,targetName:r,stream:de.ERROR,streamId:i,reason:Ke(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[i]=h,Promise.try(u,t.data,h).then(function(){l.postMessage({sourceName:s,targetName:r,stream:de.START_COMPLETE,streamId:i,success:!0})},function(f){l.postMessage({sourceName:s,targetName:r,stream:de.START_COMPLETE,streamId:i,reason:Ke(f)})})}#i(t){const i=t.streamId,s=this.sourceName,r=t.sourceName,l=this.comObj,c=this.streamControllers[i],u=this.streamSinks[i];switch(t.stream){case de.START_COMPLETE:t.success?c.startCall.resolve():c.startCall.reject(Ke(t.reason));break;case de.PULL_COMPLETE:t.success?c.pullCall.resolve():c.pullCall.reject(Ke(t.reason));break;case de.PULL:if(!u){l.postMessage({sourceName:s,targetName:r,stream:de.PULL_COMPLETE,streamId:i,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||Xp).then(function(){l.postMessage({sourceName:s,targetName:r,stream:de.PULL_COMPLETE,streamId:i,success:!0})},function(f){l.postMessage({sourceName:s,targetName:r,stream:de.PULL_COMPLETE,streamId:i,reason:Ke(f)})});break;case de.ENQUEUE:if(Ot(c,"enqueue should have stream controller"),c.isClosed)break;c.controller.enqueue(t.chunk);break;case de.CLOSE:if(Ot(c,"close should have stream controller"),c.isClosed)break;c.isClosed=!0,c.controller.close(),this.#r(c,i);break;case de.ERROR:Ot(c,"error should have stream controller"),c.controller.error(Ke(t.reason)),this.#r(c,i);break;case de.CANCEL_COMPLETE:t.success?c.cancelCall.resolve():c.cancelCall.reject(Ke(t.reason)),this.#r(c,i);break;case de.CANCEL:if(!u)break;const h=Ke(t.reason);Promise.try(u.onCancel||Xp,h).then(function(){l.postMessage({sourceName:s,targetName:r,stream:de.CANCEL_COMPLETE,streamId:i,success:!0})},function(f){l.postMessage({sourceName:s,targetName:r,stream:de.CANCEL_COMPLETE,streamId:i,reason:Ke(f)})}),u.sinkCapability.reject(h),u.isCancelled=!0,delete this.streamSinks[i];break;default:throw new Error("Unexpected stream case")}}async#r(t,i){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[i]}destroy(){this.#t?.abort(),this.#t=null}}class Tm{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,i){if(t<=0||i<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(t,i);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,i,s){if(!t.canvas)throw new Error("Canvas is not specified");if(i<=0||s<=0)throw new Error("Invalid canvas size");t.canvas.width=i,t.canvas.height=s}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,i){Vt("Abstract method `_createCanvas` called.")}}class lv extends Tm{constructor({ownerDocument:t=globalThis.document,enableHWA:i=!1}){super({enableHWA:i}),this._document=t}_createCanvas(t,i){const s=this._document.createElement("canvas");return s.width=t,s.height=i,s}}class Cm{constructor({baseUrl:t=null,isCompressed:i=!0}){this.baseUrl=t,this.isCompressed=i}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const i=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(i).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${i}`)})}async _fetch(t){Vt("Abstract method `_fetch` called.")}}class Yp extends Cm{async _fetch(t){const i=await Sr(t,this.isCompressed?"arraybuffer":"text");return i instanceof ArrayBuffer?new Uint8Array(i):Ar(i)}}class Mm{addFilter(t){return"none"}addHCMFilter(t,i){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,i,s,r,l){return"none"}destroy(t=!1){}}class cv extends Mm{#t;#e;#n;#i;#r;#a;#s=0;constructor({docId:t,ownerDocument:i=globalThis.document}){super(),this.#i=t,this.#r=i}get#o(){return this.#e||=new Map}get#c(){return this.#a||=new Map}get#l(){if(!this.#n){const t=this.#r.createElement("div"),{style:i}=t;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const s=this.#r.createElementNS(cn,"svg");s.setAttribute("width",0),s.setAttribute("height",0),this.#n=this.#r.createElementNS(cn,"defs"),t.append(s),s.append(this.#n),this.#r.body.append(t)}return this.#n}#d(t){if(t.length===1){const h=t[0],f=new Array(256);for(let y=0;y<256;y++)f[y]=h[y]/255;const p=f.join(",");return[p,p,p]}const[i,s,r]=t,l=new Array(256),c=new Array(256),u=new Array(256);for(let h=0;h<256;h++)l[h]=i[h]/255,c[h]=s[h]/255,u[h]=r[h]/255;return[l.join(","),c.join(","),u.join(",")]}#h(t){if(this.#t===void 0){this.#t="";const i=this.#r.URL;i!==this.#r.baseURI&&(hl(i)?bt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=mm(i,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let i=this.#o.get(t);if(i)return i;const[s,r,l]=this.#d(t),c=t.length===1?s:`${s}${r}${l}`;if(i=this.#o.get(c),i)return this.#o.set(t,i),i;const u=`g_${this.#i}_transfer_map_${this.#s++}`,h=this.#h(u);this.#o.set(t,h),this.#o.set(c,h);const f=this.#p(u);return this.#g(s,r,l,f),h}addHCMFilter(t,i){const s=`${t}-${i}`,r="base";let l=this.#c.get(r);if(l?.key===s||(l?(l.filter?.remove(),l.key=s,l.url="none",l.filter=null):(l={key:s,url:"none",filter:null},this.#c.set(r,l)),!t||!i))return l.url;const c=this.#v(t);t=st.makeHexColor(...c);const u=this.#v(i);if(i=st.makeHexColor(...u),this.#l.style.color="",t==="#000000"&&i==="#ffffff"||t===i)return l.url;const h=new Array(256);for(let A=0;A<=255;A++){const w=A/255;h[A]=w<=.03928?w/12.92:((w+.055)/1.055)**2.4}const f=h.join(","),p=`g_${this.#i}_hcm_filter`,y=l.filter=this.#p(p);this.#g(f,f,f,y),this.#m(y);const b=(A,w)=>{const S=c[A]/255,E=u[A]/255,x=new Array(w+1);for(let C=0;C<=w;C++)x[C]=S+C/w*(E-S);return x.join(",")};return this.#g(b(0,5),b(1,5),b(2,5),y),l.url=this.#h(p),l.url}addAlphaFilter(t){let i=this.#o.get(t);if(i)return i;const[s]=this.#d([t]),r=`alpha_${s}`;if(i=this.#o.get(r),i)return this.#o.set(t,i),i;const l=`g_${this.#i}_alpha_map_${this.#s++}`,c=this.#h(l);this.#o.set(t,c),this.#o.set(r,c);const u=this.#p(l);return this.#y(s,u),c}addLuminosityFilter(t){let i=this.#o.get(t||"luminosity");if(i)return i;let s,r;if(t?([s]=this.#d([t]),r=`luminosity_${s}`):r="luminosity",i=this.#o.get(r),i)return this.#o.set(t,i),i;const l=`g_${this.#i}_luminosity_map_${this.#s++}`,c=this.#h(l);this.#o.set(t,c),this.#o.set(r,c);const u=this.#p(l);return this.#f(u),t&&this.#y(s,u),c}addHighlightHCMFilter(t,i,s,r,l){const c=`${i}-${s}-${r}-${l}`;let u=this.#c.get(t);if(u?.key===c||(u?(u.filter?.remove(),u.key=c,u.url="none",u.filter=null):(u={key:c,url:"none",filter:null},this.#c.set(t,u)),!i||!s))return u.url;const[h,f]=[i,s].map(this.#v.bind(this));let p=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),y=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[b,A]=[r,l].map(this.#v.bind(this));y<p&&([p,y,b,A]=[y,p,A,b]),this.#l.style.color="";const w=(x,C,T)=>{const B=new Array(256),O=(y-p)/T,L=x/255,P=(C-x)/(255*T);let G=0;for(let Q=0;Q<=T;Q++){const tt=Math.round(p+Q*O),W=L+Q*P;for(let ut=G;ut<=tt;ut++)B[ut]=W;G=tt+1}for(let Q=G;Q<256;Q++)B[Q]=B[G-1];return B.join(",")},S=`g_${this.#i}_hcm_${t}_filter`,E=u.filter=this.#p(S);return this.#m(E),this.#g(w(b[0],A[0],5),w(b[1],A[1],5),w(b[2],A[2],5),E),u.url=this.#h(S),u.url}destroy(t=!1){t&&this.#a?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#e?.clear(),this.#e=null,this.#a?.clear(),this.#a=null,this.#s=0)}#f(t){const i=this.#r.createElementNS(cn,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(i)}#m(t){const i=this.#r.createElementNS(cn,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(i)}#p(t){const i=this.#r.createElementNS(cn,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",t),this.#l.append(i),i}#u(t,i,s){const r=this.#r.createElementNS(cn,i);r.setAttribute("type","discrete"),r.setAttribute("tableValues",s),t.append(r)}#g(t,i,s,r){const l=this.#r.createElementNS(cn,"feComponentTransfer");r.append(l),this.#u(l,"feFuncR",t),this.#u(l,"feFuncG",i),this.#u(l,"feFuncB",s)}#y(t,i){const s=this.#r.createElementNS(cn,"feComponentTransfer");i.append(s),this.#u(s,"feFuncA",t)}#v(t){return this.#l.style.color=t,_r(getComputedStyle(this.#l).getPropertyValue("color"))}}class Dm{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetch(i).catch(s=>{throw new Error(`Unable to load font data at: ${i}`)})}async _fetch(t){Vt("Abstract method `_fetch` called.")}}class $p extends Dm{async _fetch(t){const i=await Sr(t,"arraybuffer");return new Uint8Array(i)}}class Rm{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetch(i).catch(s=>{throw new Error(`Unable to load wasm data at: ${i}`)})}async _fetch(t){Vt("Abstract method `_fetch` called.")}}class Kp extends Rm{async _fetch(t){const i=await Sr(t,"arraybuffer");return new Uint8Array(i)}}Pe&&bt("Please use the `legacy` build in Node.js environments.");async function gh(m){const i=await process.getBuiltinModule("fs").promises.readFile(m);return new Uint8Array(i)}class uv extends Mm{}class hv extends Tm{_createCanvas(t,i){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,i)}}class dv extends Cm{async _fetch(t){return gh(t)}}class fv extends Dm{async _fetch(t){return gh(t)}}class gv extends Rm{async _fetch(t){return gh(t)}}const Js="__forcedDependency",{floor:Qp,ceil:Zp}=Math;function Ko(m,t,i,s,r,l){m[t*4+0]=Math.min(m[t*4+0],i),m[t*4+1]=Math.min(m[t*4+1],s),m[t*4+2]=Math.max(m[t*4+2],r),m[t*4+3]=Math.max(m[t*4+3],l)}const ih=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class pv{#t;#e;constructor(t,i){this.#t=t,this.#e=i}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===ih}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const Qo=(m,t)=>{if(!m)return;let i=m.get(t);return i||(i={dependencies:new Set,isRenderingOperation:!1},m.set(t,i)),i};class mv{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[Js]:[]};#n=new Map;#i=[];#r=[];#a=[[1,0,0,1,0,0]];#s=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#d=new Map;#h=new Map;#f;#m;#p;#u;#g;constructor(t,i,s=!1){this.#f=t.width,this.#m=t.height,this.#y(i),s&&(this.#g=new Map)}growOperationsCount(t){t>=this.#u.length&&this.#y(t,this.#u)}#y(t,i){const s=new ArrayBuffer(t*4);this.#p=new Uint8ClampedArray(s),this.#u=new Uint32Array(s),i&&i.length>0?(this.#u.set(i),this.#u.fill(ih,i.length)):this.#u.fill(ih)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[Js]:{__proto__:this.#e[Js]}},this.#s={__proto__:this.#s},this.#i.push(t),this}restore(t){const i=Object.getPrototypeOf(this.#t);if(i===null)return this;this.#t=i,this.#e=Object.getPrototypeOf(this.#e),this.#s=Object.getPrototypeOf(this.#s);const s=this.#i.pop();return s!==void 0&&(Qo(this.#g,t)?.dependencies.add(s),this.#u[t]=this.#u[s]),this}recordOpenMarker(t){return this.#i.push(t),this}getOpenMarker(){return this.#i.length===0?null:this.#i.at(-1)}recordCloseMarker(t){const i=this.#i.pop();return i!==void 0&&(Qo(this.#g,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}beginMarkedContent(t){return this.#r.push(t),this}endMarkedContent(t){const i=this.#r.pop();return i!==void 0&&(Qo(this.#g,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}pushBaseTransform(t){return this.#a.push(st.multiplyByDOMMatrix(this.#a.at(-1),t.getTransform())),this}popBaseTransform(){return this.#a.length>1&&this.#a.pop(),this}recordSimpleData(t,i){return this.#t[t]=i,this}recordIncrementalData(t,i){return this.#e[t].push(i),this}resetIncrementalData(t,i){return this.#e[t].length=0,this}recordNamedData(t,i){return this.#n.set(t,i),this}recordSimpleDataFromNamed(t,i,s){this.#t[t]=this.#n.get(i)??s}recordFutureForcedDependency(t,i){return this.recordIncrementalData(Js,i),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const i of t)i in this.#t&&this.recordFutureForcedDependency(i,this.#t[i]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#l)this.recordFutureForcedDependency(Js,t);return this}resetBBox(t){return this.#c!==t&&(this.#c=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(t,i,s,r,l,c){const u=st.multiplyByDOMMatrix(this.#a.at(-1),i.getTransform()),h=[1/0,1/0,-1/0,-1/0];st.axialAlignedBoundingBox([s,l,r,c],u,h);const f=st.intersect(this.#s,h);return f?(this.#s[0]=f[0],this.#s[1]=f[1],this.#s[2]=f[2],this.#s[3]=f[3]):(this.#s[0]=this.#s[1]=1/0,this.#s[2]=this.#s[3]=-1/0),this}recordBBox(t,i,s,r,l,c){const u=this.#s;if(u[0]===1/0)return this;const h=st.multiplyByDOMMatrix(this.#a.at(-1),i.getTransform());if(u[0]===-1/0)return st.axialAlignedBoundingBox([s,l,r,c],h,this.#o),this;const f=[1/0,1/0,-1/0,-1/0];return st.axialAlignedBoundingBox([s,l,r,c],h,f),this.#o[0]=Math.min(this.#o[0],Math.max(f[0],u[0])),this.#o[1]=Math.min(this.#o[1],Math.max(f[1],u[1])),this.#o[2]=Math.max(this.#o[2],Math.min(f[2],u[2])),this.#o[3]=Math.max(this.#o[3],Math.min(f[3],u[3])),this}recordCharacterBBox(t,i,s,r=1,l=0,c=0,u){const h=s.bbox;let f,p;if(h&&(f=h[2]!==h[0]&&h[3]!==h[1]&&this.#h.get(s),f!==!1&&(p=[0,0,0,0],st.axialAlignedBoundingBox(h,s.fontMatrix,p),(r!==1||l!==0||c!==0)&&st.scaleMinMax([r,0,0,-r,l,c],p),f)))return this.recordBBox(t,i,p[0],p[2],p[1],p[3]);if(!u)return this.recordFullPageBBox(t);const y=u();return h&&p&&f===void 0&&(f=p[0]<=l-y.actualBoundingBoxLeft&&p[2]>=l+y.actualBoundingBoxRight&&p[1]<=c-y.actualBoundingBoxAscent&&p[3]>=c+y.actualBoundingBoxDescent,this.#h.set(s,f),f)?this.recordBBox(t,i,p[0],p[2],p[1],p[3]):this.recordBBox(t,i,l-y.actualBoundingBoxLeft,l+y.actualBoundingBoxRight,c-y.actualBoundingBoxAscent,c+y.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#s[0]),this.#o[1]=Math.max(0,this.#s[1]),this.#o[2]=Math.min(this.#f,this.#s[2]),this.#o[3]=Math.min(this.#m,this.#s[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,i){const s=this.#l,r=this.#t,l=this.#e;for(const c of i)c in this.#t?s.add(r[c]):c in l&&l[c].forEach(s.add,s);return this}recordNamedDependency(t,i){return this.#n.has(i)&&this.#l.add(this.#n.get(i)),this}recordOperation(t,i=!1){if(this.recordDependencies(t,[Js]),this.#g){const s=Qo(this.#g,t),{dependencies:r}=s;this.#l.forEach(r.add,r),this.#i.forEach(r.add,r),this.#r.forEach(r.add,r),r.delete(t),s.isRenderingOperation=!0}if(this.#c===t){const s=Qp(this.#o[0]*256/this.#f),r=Qp(this.#o[1]*256/this.#m),l=Zp(this.#o[2]*256/this.#f),c=Zp(this.#o[3]*256/this.#m);Ko(this.#p,t,s,r,l,c);for(const u of this.#l)u!==t&&Ko(this.#p,u,s,r,l,c);for(const u of this.#i)u!==t&&Ko(this.#p,u,s,r,l,c);for(const u of this.#r)u!==t&&Ko(this.#p,u,s,r,l,c);i||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(t,i=!1){const s=Array.from(this.#l);this.recordOperation(t,i),this.recordIncrementalData("sameLineText",t);for(const r of s)this.recordIncrementalData("sameLineText",r);return this}bboxToClipBoxDropOperation(t,i=!1){return this.#c===t&&(this.#c=-1,this.#s[0]=Math.max(this.#s[0],this.#o[0]),this.#s[1]=Math.max(this.#s[1],this.#o[1]),this.#s[2]=Math.min(this.#s[2],this.#o[2]),this.#s[3]=Math.min(this.#s[3],this.#o[3]),i||this.#l.clear()),this}_takePendingDependencies(){const t=this.#l;return this.#l=new Set,t}_extractOperation(t){const i=this.#d.get(t);return this.#d.delete(t),i}_pushPendingDependencies(t){for(const i of t)this.#l.add(i)}take(){return this.#h.clear(),new pv(this.#u,this.#p)}takeDebugMetadata(){return this.#g}}class al{#t;#e;#n;#i=0;#r=0;constructor(t,i,s){if(t instanceof al&&t.#n===!!s)return t;this.#t=t,this.#e=i,this.#n=!!s}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#r++,this.#t.save(this.#e),this}restore(t){return this.#r>0&&(this.#t.restore(this.#e),this.#r--),this}recordOpenMarker(t){return this.#i++,this}getOpenMarker(){return this.#i>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#i--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,i){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,i){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,i){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,i){return this}recordSimpleDataFromNamed(t,i,s){return this.#t.recordSimpleDataFromNamed(t,i,this.#e),this}recordFutureForcedDependency(t,i){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#n||this.#t.resetBBox(this.#e),this}recordClipBox(t,i,s,r,l,c){return this.#n||this.#t.recordClipBox(this.#e,i,s,r,l,c),this}recordBBox(t,i,s,r,l,c){return this.#n||this.#t.recordBBox(this.#e,i,s,r,l,c),this}recordCharacterBBox(t,i,s,r,l,c,u){return this.#n||this.#t.recordCharacterBBox(this.#e,i,s,r,l,c,u),this}recordFullPageBBox(t){return this.#n||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,i){return this.#t.recordDependencies(this.#e,i),this}recordNamedDependency(t,i){return this.#t.recordNamedDependency(this.#e,i),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#n||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const Si={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Me={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function nh(m,t){if(!t)return;const i=t[2]-t[0],s=t[3]-t[1],r=new Path2D;r.rect(t[0],t[1],i,s),m.clip(r)}class ph{isModifyingCurrentTransform(){return!1}getPattern(){Vt("Abstract method `getPattern` called.")}}class yv extends ph{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let i;this._type==="axial"?i=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(i=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)i.addColorStop(s[0],s[1]);return i}getPattern(t,i,s,r){let l;if(r===Me.STROKE||r===Me.FILL){const c=i.current.getClippedPathBoundingBox(r,Jt(t))||[0,0,0,0],u=Math.ceil(c[2]-c[0])||1,h=Math.ceil(c[3]-c[1])||1,f=i.cachedCanvases.getCanvas("pattern",u,h),p=f.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-c[0],-c[1]),s=st.transform(s,[1,0,0,1,c[0],c[1]]),p.transform(...i.baseTransform),this.matrix&&p.transform(...this.matrix),nh(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),l=t.createPattern(f.canvas,"no-repeat");const y=new DOMMatrix(s);l.setTransform(y)}else nh(t,this._bbox),l=this._createGradient(t);return l}}function Iu(m,t,i,s,r,l,c,u){const h=t.coords,f=t.colors,p=m.data,y=m.width*4;let b;h[i+1]>h[s+1]&&(b=i,i=s,s=b,b=l,l=c,c=b),h[s+1]>h[r+1]&&(b=s,s=r,r=b,b=c,c=u,u=b),h[i+1]>h[s+1]&&(b=i,i=s,s=b,b=l,l=c,c=b);const A=(h[i]+t.offsetX)*t.scaleX,w=(h[i+1]+t.offsetY)*t.scaleY,S=(h[s]+t.offsetX)*t.scaleX,E=(h[s+1]+t.offsetY)*t.scaleY,x=(h[r]+t.offsetX)*t.scaleX,C=(h[r+1]+t.offsetY)*t.scaleY;if(w>=C)return;const T=f[l],B=f[l+1],O=f[l+2],L=f[c],P=f[c+1],G=f[c+2],Q=f[u],tt=f[u+1],W=f[u+2],ut=Math.round(w),mt=Math.round(C);let ht,vt,k,q,Z,gt,xt,R;for(let I=ut;I<=mt;I++){if(I<E){const at=I<w?0:(w-I)/(w-E);ht=A-(A-S)*at,vt=T-(T-L)*at,k=B-(B-P)*at,q=O-(O-G)*at}else{let at;I>C?at=1:E===C?at=0:at=(E-I)/(E-C),ht=S-(S-x)*at,vt=L-(L-Q)*at,k=P-(P-tt)*at,q=G-(G-W)*at}let K;I<w?K=0:I>C?K=1:K=(w-I)/(w-C),Z=A-(A-x)*K,gt=T-(T-Q)*K,xt=B-(B-tt)*K,R=O-(O-W)*K;const et=Math.round(Math.min(ht,Z)),ot=Math.round(Math.max(ht,Z));let ft=y*I+et*4;for(let at=et;at<=ot;at++)K=(ht-at)/(ht-Z),K<0?K=0:K>1&&(K=1),p[ft++]=vt-(vt-gt)*K|0,p[ft++]=k-(k-xt)*K|0,p[ft++]=q-(q-R)*K|0,p[ft++]=255}}function bv(m,t,i){const s=t.coords,r=t.colors;let l,c;switch(t.type){case Ku.LATTICE:const u=t.verticesPerRow,h=Math.floor(s.length/u)-1,f=u-1;for(l=0;l<h;l++){let p=l*u;for(let y=0;y<f;y++,p++)Iu(m,i,s[p],s[p+1],s[p+u],r[p],r[p+1],r[p+u]),Iu(m,i,s[p+u+1],s[p+1],s[p+u],r[p+u+1],r[p+1],r[p+u])}break;case Ku.TRIANGLES:for(l=0,c=s.length;l<c;l+=3)Iu(m,i,s[l],s[l+1],s[l+2],r[l],r[l+1],r[l+2]);break;default:throw new Error("illegal figure")}}class vv extends ph{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,i,s){const u=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-u,p=Math.ceil(this._bounds[3])-h,y=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),b=Math.min(Math.ceil(Math.abs(p*t[1]*1.1)),3e3),A=f/y,w=p/b,S={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-h,scaleX:1/A,scaleY:1/w},E=y+4,x=b+4,C=s.getCanvas("mesh",E,x),T=C.context,B=T.createImageData(y,b);if(i){const L=B.data;for(let P=0,G=L.length;P<G;P+=4)L[P]=i[0],L[P+1]=i[1],L[P+2]=i[2],L[P+3]=255}for(const L of this._figures)bv(B,L,S);return T.putImageData(B,2,2),{canvas:C.canvas,offsetX:u-2*A,offsetY:h-2*w,scaleX:A,scaleY:w}}isModifyingCurrentTransform(){return!0}getPattern(t,i,s,r){nh(t,this._bbox);const l=new Float32Array(2);if(r===Me.SHADING)st.singularValueDecompose2dScale(Jt(t),l);else if(this.matrix){st.singularValueDecompose2dScale(this.matrix,l);const[u,h]=l;st.singularValueDecompose2dScale(i.baseTransform,l),l[0]*=u,l[1]*=h}else st.singularValueDecompose2dScale(i.baseTransform,l);const c=this._createMeshCanvas(l,r===Me.SHADING?null:this._background,i.cachedCanvases);return r!==Me.SHADING&&(t.setTransform(...i.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(c.offsetX,c.offsetY),t.scale(c.scaleX,c.scaleY),t.createPattern(c.canvas,"no-repeat")}}class Av extends ph{getPattern(){return"hotpink"}}function Sv(m){switch(m[0]){case"RadialAxial":return new yv(m);case"Mesh":return new vv(m);case"Dummy":return new Av}throw new Error(`Unknown IR type: ${m[0]}`)}const Wp={COLORED:1,UNCOLORED:2};class mh{static MAX_PATTERN_SIZE=3e3;constructor(t,i,s,r){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=i,this.canvasGraphicsFactory=s,this.baseTransform=r}createPatternCanvas(t,i){const{bbox:s,operatorList:r,paintType:l,tilingType:c,color:u,canvasGraphicsFactory:h}=this;let{xstep:f,ystep:p}=this;f=Math.abs(f),p=Math.abs(p),ul("TilingType: "+c);const y=s[0],b=s[1],A=s[2],w=s[3],S=A-y,E=w-b,x=new Float32Array(2);st.singularValueDecompose2dScale(this.matrix,x);const[C,T]=x;st.singularValueDecompose2dScale(this.baseTransform,x);const B=C*x[0],O=T*x[1];let L=S,P=E,G=!1,Q=!1;const tt=Math.ceil(f*B),W=Math.ceil(p*O),ut=Math.ceil(S*B),mt=Math.ceil(E*O);tt>=ut?L=f:G=!0,W>=mt?P=p:Q=!0;const ht=this.getSizeAndScale(L,this.ctx.canvas.width,B),vt=this.getSizeAndScale(P,this.ctx.canvas.height,O),k=t.cachedCanvases.getCanvas("pattern",ht.size,vt.size),q=k.context,Z=h.createCanvasGraphics(q,i);if(Z.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(Z,l,u),q.translate(-ht.scale*y,-vt.scale*b),Z.transform(0,ht.scale,0,0,vt.scale,0,0),q.save(),Z.dependencyTracker?.save(),this.clipBbox(Z,y,b,A,w),Z.baseTransform=Jt(Z.ctx),Z.executeOperatorList(r),Z.endDrawing(),Z.dependencyTracker?.restore(),q.restore(),G||Q){const gt=k.canvas;G&&(L=f),Q&&(P=p);const xt=this.getSizeAndScale(L,this.ctx.canvas.width,B),R=this.getSizeAndScale(P,this.ctx.canvas.height,O),I=xt.size,K=R.size,et=t.cachedCanvases.getCanvas("pattern-workaround",I,K),ot=et.context,ft=G?Math.floor(S/f):0,at=Q?Math.floor(E/p):0;for(let $t=0;$t<=ft;$t++)for(let Ct=0;Ct<=at;Ct++)ot.drawImage(gt,I*$t,K*Ct,I,K,0,0,I,K);return{canvas:et.canvas,scaleX:xt.scale,scaleY:R.scale,offsetX:y,offsetY:b}}return{canvas:k.canvas,scaleX:ht.scale,scaleY:vt.scale,offsetX:y,offsetY:b}}getSizeAndScale(t,i,s){const r=Math.max(mh.MAX_PATTERN_SIZE,i);let l=Math.ceil(t*s);return l>=r?l=r:s=l/t,{scale:s,size:l}}clipBbox(t,i,s,r,l){const c=r-i,u=l-s;t.ctx.rect(i,s,c,u),st.axialAlignedBoundingBox([i,s,r,l],Jt(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,i,s){const r=t.ctx,l=t.current;switch(i){case Wp.COLORED:const{fillStyle:c,strokeStyle:u}=this.ctx;r.fillStyle=l.fillColor=c,r.strokeStyle=l.strokeColor=u;break;case Wp.UNCOLORED:r.fillStyle=r.strokeStyle=s,l.fillColor=l.strokeColor=s;break;default:throw new k0(`Unsupported paint type: ${i}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,i,s,r,l){let c=s;r!==Me.SHADING&&(c=st.transform(c,i.baseTransform),this.matrix&&(c=st.transform(c,this.matrix)));const u=this.createPatternCanvas(i,l);let h=new DOMMatrix(c);h=h.translate(u.offsetX,u.offsetY),h=h.scale(1/u.scaleX,1/u.scaleY);const f=t.createPattern(u.canvas,"repeat");return f.setTransform(h),f}}function wv({src:m,srcPos:t=0,dest:i,width:s,height:r,nonBlackColor:l=4294967295,inverseDecode:c=!1}){const u=De.isLittleEndian?4278190080:255,[h,f]=c?[l,u]:[u,l],p=s>>3,y=s&7,b=m.length;i=new Uint32Array(i.buffer);let A=0;for(let w=0;w<r;w++){for(const E=t+p;t<E;t++){const x=t<b?m[t]:255;i[A++]=x&128?f:h,i[A++]=x&64?f:h,i[A++]=x&32?f:h,i[A++]=x&16?f:h,i[A++]=x&8?f:h,i[A++]=x&4?f:h,i[A++]=x&2?f:h,i[A++]=x&1?f:h}if(y===0)continue;const S=t<b?m[t++]:255;for(let E=0;E<y;E++)i[A++]=S&1<<7-E?f:h}return{srcPos:t,destPos:A}}const Jp=16,tm=100,_v=15,em=10,Qe=16,Gu=new DOMMatrix,li=new Float32Array(2),aa=new Float32Array([1/0,1/0,-1/0,-1/0]);function xv(m,t){if(m._removeMirroring)throw new Error("Context is already forwarding operations.");m.__originalSave=m.save,m.__originalRestore=m.restore,m.__originalRotate=m.rotate,m.__originalScale=m.scale,m.__originalTranslate=m.translate,m.__originalTransform=m.transform,m.__originalSetTransform=m.setTransform,m.__originalResetTransform=m.resetTransform,m.__originalClip=m.clip,m.__originalMoveTo=m.moveTo,m.__originalLineTo=m.lineTo,m.__originalBezierCurveTo=m.bezierCurveTo,m.__originalRect=m.rect,m.__originalClosePath=m.closePath,m.__originalBeginPath=m.beginPath,m._removeMirroring=()=>{m.save=m.__originalSave,m.restore=m.__originalRestore,m.rotate=m.__originalRotate,m.scale=m.__originalScale,m.translate=m.__originalTranslate,m.transform=m.__originalTransform,m.setTransform=m.__originalSetTransform,m.resetTransform=m.__originalResetTransform,m.clip=m.__originalClip,m.moveTo=m.__originalMoveTo,m.lineTo=m.__originalLineTo,m.bezierCurveTo=m.__originalBezierCurveTo,m.rect=m.__originalRect,m.closePath=m.__originalClosePath,m.beginPath=m.__originalBeginPath,delete m._removeMirroring},m.save=function(){t.save(),this.__originalSave()},m.restore=function(){t.restore(),this.__originalRestore()},m.translate=function(i,s){t.translate(i,s),this.__originalTranslate(i,s)},m.scale=function(i,s){t.scale(i,s),this.__originalScale(i,s)},m.transform=function(i,s,r,l,c,u){t.transform(i,s,r,l,c,u),this.__originalTransform(i,s,r,l,c,u)},m.setTransform=function(i,s,r,l,c,u){t.setTransform(i,s,r,l,c,u),this.__originalSetTransform(i,s,r,l,c,u)},m.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},m.rotate=function(i){t.rotate(i),this.__originalRotate(i)},m.clip=function(i){t.clip(i),this.__originalClip(i)},m.moveTo=function(i,s){t.moveTo(i,s),this.__originalMoveTo(i,s)},m.lineTo=function(i,s){t.lineTo(i,s),this.__originalLineTo(i,s)},m.bezierCurveTo=function(i,s,r,l,c,u){t.bezierCurveTo(i,s,r,l,c,u),this.__originalBezierCurveTo(i,s,r,l,c,u)},m.rect=function(i,s,r,l){t.rect(i,s,r,l),this.__originalRect(i,s,r,l)},m.closePath=function(){t.closePath(),this.__originalClosePath()},m.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class Ev{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,i,s){let r;return this.cache[t]!==void 0?(r=this.cache[t],this.canvasFactory.reset(r,i,s)):(r=this.canvasFactory.create(i,s),this.cache[t]=r),r}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const i=this.cache[t];this.canvasFactory.destroy(i),delete this.cache[t]}}}function Zo(m,t,i,s,r,l,c,u,h,f){const[p,y,b,A,w,S]=Jt(m);if(y===0&&b===0){const C=c*p+w,T=Math.round(C),B=u*A+S,O=Math.round(B),L=(c+h)*p+w,P=Math.abs(Math.round(L)-T)||1,G=(u+f)*A+S,Q=Math.abs(Math.round(G)-O)||1;return m.setTransform(Math.sign(p),0,0,Math.sign(A),T,O),m.drawImage(t,i,s,r,l,0,0,P,Q),m.setTransform(p,y,b,A,w,S),[P,Q]}if(p===0&&A===0){const C=u*b+w,T=Math.round(C),B=c*y+S,O=Math.round(B),L=(u+f)*b+w,P=Math.abs(Math.round(L)-T)||1,G=(c+h)*y+S,Q=Math.abs(Math.round(G)-O)||1;return m.setTransform(0,Math.sign(y),Math.sign(b),0,T,O),m.drawImage(t,i,s,r,l,0,0,Q,P),m.setTransform(p,y,b,A,w,S),[Q,P]}m.drawImage(t,i,s,r,l,c,u,h,f);const E=Math.hypot(p,y),x=Math.hypot(b,A);return[E*h,x*f]}class im{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=$u;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=Te.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,i,s){s?.(this),this.clipBox=new Float32Array([0,0,t,i]),this.minMax=aa.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=Me.FILL,i=null){const s=this.minMax.slice();if(t===Me.STROKE){i||Vt("Stroke bounding box must include transform."),st.singularValueDecompose2dScale(i,li);const r=li[0]*this.lineWidth/2,l=li[1]*this.lineWidth/2;s[0]-=r,s[1]-=l,s[2]+=r,s[3]+=l}return s}updateClipFromPath(){const t=st.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(aa,0)}getClippedPathBoundingBox(t=Me.FILL,i=null){return st.intersect(this.clipBox,this.getPathBoundingBox(t,i))}}function nm(m,t){if(t instanceof ImageData){m.putImageData(t,0,0);return}const i=t.height,s=t.width,r=i%Qe,l=(i-r)/Qe,c=r===0?l:l+1,u=m.createImageData(s,Qe);let h=0,f;const p=t.data,y=u.data;let b,A,w,S;if(t.kind===el.GRAYSCALE_1BPP){const E=p.byteLength,x=new Uint32Array(y.buffer,0,y.byteLength>>2),C=x.length,T=s+7>>3,B=4294967295,O=De.isLittleEndian?4278190080:255;for(b=0;b<c;b++){for(w=b<l?Qe:r,f=0,A=0;A<w;A++){const L=E-h;let P=0;const G=L>T?s:L*8-7,Q=G&-8;let tt=0,W=0;for(;P<Q;P+=8)W=p[h++],x[f++]=W&128?B:O,x[f++]=W&64?B:O,x[f++]=W&32?B:O,x[f++]=W&16?B:O,x[f++]=W&8?B:O,x[f++]=W&4?B:O,x[f++]=W&2?B:O,x[f++]=W&1?B:O;for(;P<G;P++)tt===0&&(W=p[h++],tt=128),x[f++]=W&tt?B:O,tt>>=1}for(;f<C;)x[f++]=0;m.putImageData(u,0,b*Qe)}}else if(t.kind===el.RGBA_32BPP){for(A=0,S=s*Qe*4,b=0;b<l;b++)y.set(p.subarray(h,h+S)),h+=S,m.putImageData(u,0,A),A+=Qe;b<c&&(S=s*r*4,y.set(p.subarray(h,h+S)),m.putImageData(u,0,A))}else if(t.kind===el.RGB_24BPP)for(w=Qe,S=s*w,b=0;b<c;b++){for(b>=l&&(w=r,S=s*w),f=0,A=S;A--;)y[f++]=p[h++],y[f++]=p[h++],y[f++]=p[h++],y[f++]=255;m.putImageData(u,0,b*Qe)}else throw new Error(`bad image kind: ${t.kind}`)}function sm(m,t){if(t.bitmap){m.drawImage(t.bitmap,0,0);return}const i=t.height,s=t.width,r=i%Qe,l=(i-r)/Qe,c=r===0?l:l+1,u=m.createImageData(s,Qe);let h=0;const f=t.data,p=u.data;for(let y=0;y<c;y++){const b=y<l?Qe:r;({srcPos:h}=wv({src:f,srcPos:h,dest:p,width:s,height:b,nonBlackColor:0})),m.putImageData(u,0,y*Qe)}}function or(m,t){const i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of i)m[s]!==void 0&&(t[s]=m[s]);m.setLineDash!==void 0&&(t.setLineDash(m.getLineDash()),t.lineDashOffset=m.lineDashOffset)}function Wo(m){m.strokeStyle=m.fillStyle="#000000",m.fillRule="nonzero",m.globalAlpha=1,m.lineWidth=1,m.lineCap="butt",m.lineJoin="miter",m.miterLimit=10,m.globalCompositeOperation="source-over",m.font="10px sans-serif",m.setLineDash!==void 0&&(m.setLineDash([]),m.lineDashOffset=0);const{filter:t}=m;t!=="none"&&t!==""&&(m.filter="none")}function am(m,t){if(t)return!0;st.singularValueDecompose2dScale(m,li);const i=Math.fround(Gi.pixelRatio*ha.PDF_TO_CSS_UNITS);return li[0]<=i&&li[1]<=i}const Tv=["butt","round","square"],Cv=["miter","round","bevel"],Mv={},rm={};class ca{constructor(t,i,s,r,l,{optionalContentConfig:c,markedContentStack:u=null},h,f,p){this.ctx=t,this.current=new im(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=i,this.objs=s,this.canvasFactory=r,this.filterFactory=l,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=c,this.cachedCanvases=new Ev(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=p??null}getObject(t,i,s=null){return typeof i=="string"?(this.dependencyTracker?.recordNamedDependency(t,i),i.startsWith("g_")?this.commonObjs.get(i):this.objs.get(i)):s}beginDrawing({transform:t,viewport:i,transparency:s=!1,background:r=null}){const l=this.ctx.canvas.width,c=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,l,c),this.ctx.fillStyle=u,s){const h=this.cachedCanvases.getCanvas("transparent",l,c);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...Jt(this.compositeCtx))}this.ctx.save(),Wo(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...i.transform),this.viewportScale=i.scale,this.baseTransform=Jt(this.ctx)}executeOperatorList(t,i,s,r,l){const c=t.argsArray,u=t.fnArray;let h=i||0;const f=c.length;if(f===h)return h;const p=f-h>em&&typeof s=="function",y=p?Date.now()+_v:0;let b=0;const A=this.commonObjs,w=this.objs;let S,E;for(;;){if(r!==void 0&&h===r.nextBreakPoint)return r.breakIt(h,s),h;if(!l||l(h))if(S=u[h],E=c[h]??null,S!==mr.dependency)E===null?this[S](h):this[S](h,...E);else for(const x of E){this.dependencyTracker?.recordNamedData(x,h);const C=x.startsWith("g_")?A:w;if(!C.has(x))return C.get(x,s),h}if(h++,h===f)return h;if(p&&++b>em){if(Date.now()>y)return s(),h;b=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const i of t.values())typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&(i.width=i.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const i=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=i}}}_scaleImage(t,i){const s=t.width??t.displayWidth,r=t.height??t.displayHeight;let l=Math.max(Math.hypot(i[0],i[1]),1),c=Math.max(Math.hypot(i[2],i[3]),1),u=s,h=r,f="prescale1",p,y;for(;l>2&&u>1||c>2&&h>1;){let b=u,A=h;l>2&&u>1&&(b=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),l/=u/b),c>2&&h>1&&(A=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,c/=h/A),p=this.cachedCanvases.getCanvas(f,b,A),y=p.context,y.clearRect(0,0,b,A),y.drawImage(t,0,0,u,h,0,0,b,A),t=p.canvas,u=b,h=A,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:h}}_createMaskCanvas(t,i){const s=this.ctx,{width:r,height:l}=i,c=this.current.fillColor,u=this.current.patternFill,h=Jt(s);let f,p,y,b;if((i.bitmap||i.data)&&i.count>1){const tt=i.bitmap||i.data.buffer;p=JSON.stringify(u?h:[h.slice(0,4),c]),f=this._cachedBitmapsMap.get(tt),f||(f=new Map,this._cachedBitmapsMap.set(tt,f));const W=f.get(p);if(W&&!u){const ut=Math.round(Math.min(h[0],h[2])+h[4]),mt=Math.round(Math.min(h[1],h[3])+h[5]);return this.dependencyTracker?.recordDependencies(t,Si.transformAndFill),{canvas:W,offsetX:ut,offsetY:mt}}y=W}y||(b=this.cachedCanvases.getCanvas("maskCanvas",r,l),sm(b.context,i));let A=st.transform(h,[1/r,0,0,-1/l,0,0]);A=st.transform(A,[1,0,0,1,0,-l]);const w=aa.slice();st.axialAlignedBoundingBox([0,0,r,l],A,w);const[S,E,x,C]=w,T=Math.round(x-S)||1,B=Math.round(C-E)||1,O=this.cachedCanvases.getCanvas("fillCanvas",T,B),L=O.context,P=S,G=E;L.translate(-P,-G),L.transform(...A),y||(y=this._scaleImage(b.canvas,Fi(L)),y=y.img,f&&u&&f.set(p,y)),L.imageSmoothingEnabled=am(Jt(L),i.interpolate),Zo(L,y,0,0,y.width,y.height,0,0,r,l),L.globalCompositeOperation="source-in";const Q=st.transform(Fi(L),[1,0,0,1,-P,-G]);return L.fillStyle=u?c.getPattern(s,this,Q,Me.FILL,t):c,L.fillRect(0,0,r,l),f&&!u&&(this.cachedCanvases.delete("fillCanvas"),f.set(p,O.canvas)),this.dependencyTracker?.recordDependencies(t,Si.transformAndFill),{canvas:O.canvas,offsetX:Math.round(P),offsetY:Math.round(G)}}setLineWidth(t,i){this.dependencyTracker?.recordSimpleData("lineWidth",t),i!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=i,this.ctx.lineWidth=i}setLineCap(t,i){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=Tv[i]}setLineJoin(t,i){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=Cv[i]}setMiterLimit(t,i){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=i}setDash(t,i,s){this.dependencyTracker?.recordSimpleData("dash",t);const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(i),r.lineDashOffset=s)}setRenderingIntent(t,i){}setFlatness(t,i){}setGState(t,i){for(const[s,r]of i)switch(s){case"LW":this.setLineWidth(t,r);break;case"LC":this.setLineCap(t,r);break;case"LJ":this.setLineJoin(t,r);break;case"ML":this.setMiterLimit(t,r);break;case"D":this.setDash(t,r[0],r[1]);break;case"RI":this.setRenderingIntent(t,r);break;case"FL":this.setFlatness(t,r);break;case"Font":this.setFont(t,r[0],r[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=r;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=r;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=r;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(r);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const i=this.ctx.canvas.width,s=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,l=this.cachedCanvases.getCanvas(r,i,s);this.suspendedCtx=this.ctx;const c=this.ctx=l.context;c.setTransform(this.suspendedCtx.getTransform()),or(this.suspendedCtx,c),xv(c,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),or(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const i=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,i,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,i,s,r){const l=r[0],c=r[1],u=r[2]-l,h=r[3]-c;u===0||h===0||(this.genericComposeSMask(i.context,s,u,h,i.subtype,i.backdrop,i.transferMap,l,c,i.offsetX,i.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(s.canvas,0,0),t.restore())}genericComposeSMask(t,i,s,r,l,c,u,h,f,p,y){let b=t.canvas,A=h-p,w=f-y;if(c)if(A<0||w<0||A+s>b.width||w+r>b.height){const E=this.cachedCanvases.getCanvas("maskExtension",s,r),x=E.context;x.drawImage(b,-A,-w),x.globalCompositeOperation="destination-atop",x.fillStyle=c,x.fillRect(0,0,s,r),x.globalCompositeOperation="source-over",b=E.canvas,A=w=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const E=new Path2D;E.rect(A,w,s,r),t.clip(E),t.globalCompositeOperation="destination-atop",t.fillStyle=c,t.fillRect(A,w,s,r),t.restore()}i.save(),i.globalAlpha=1,i.setTransform(1,0,0,1,0,0),l==="Alpha"&&u?i.filter=this.filterFactory.addAlphaFilter(u):l==="Luminosity"&&(i.filter=this.filterFactory.addLuminosityFilter(u));const S=new Path2D;S.rect(h,f,s,r),i.clip(S),i.globalCompositeOperation="destination-in",i.drawImage(b,A,w,s,r,h,f,s,r),i.restore()}save(t){this.inSMaskMode&&or(this.ctx,this.suspendedCtx),this.ctx.save();const i=this.current;this.stateStack.push(i),this.current=i.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&or(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,i,s,r,l,c,u){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(i,s,r,l,c,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,i,s,r){let[l]=s;if(!r){l||=s[0]=new Path2D,this[i](t,l);return}if(this.dependencyTracker!==null){const c=i===mr.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,r[0]-c,r[2]+c,r[1]-c,r[3]+c).recordDependencies(t,["transform"])}l instanceof Path2D||(l=s[0]=wm(l)),st.axialAlignedBoundingBox(r,Jt(this.ctx),this.current.minMax),this[i](t,l),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,i,s=!0){const r=this.ctx,l=this.current.strokeColor;if(r.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof l=="object"&&l?.getPattern){const c=l.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.strokeStyle=l.getPattern(r,this,Fi(r),Me.STROKE,t),c){const u=new Path2D;u.addPath(i,r.getTransform().invertSelf().multiplySelf(c)),i=u}this.rescaleAndStroke(i,!1),r.restore()}else this.rescaleAndStroke(i,!0);this.dependencyTracker?.recordDependencies(t,Si.stroke),s&&this.consumePath(t,i,this.current.getClippedPathBoundingBox(Me.STROKE,Jt(this.ctx))),r.globalAlpha=this.current.fillAlpha}closeStroke(t,i){this.stroke(t,i)}fill(t,i,s=!0){const r=this.ctx,l=this.current.fillColor,c=this.current.patternFill;let u=!1;if(c){const f=l.isModifyingCurrentTransform()?r.getTransform():null;if(this.dependencyTracker?.save(t),r.save(),r.fillStyle=l.getPattern(r,this,Fi(r),Me.FILL,t),f){const p=new Path2D;p.addPath(i,r.getTransform().invertSelf().multiplySelf(f)),i=p}u=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(r.fill(i,"evenodd"),this.pendingEOFill=!1):r.fill(i)),this.dependencyTracker?.recordDependencies(t,Si.fill),u&&(r.restore(),this.dependencyTracker?.restore(t)),s&&this.consumePath(t,i,h)}eoFill(t,i){this.pendingEOFill=!0,this.fill(t,i)}fillStroke(t,i){this.fill(t,i,!1),this.stroke(t,i,!1),this.consumePath(t,i)}eoFillStroke(t,i){this.pendingEOFill=!0,this.fillStroke(t,i)}closeFillStroke(t,i){this.fillStroke(t,i)}closeEOFillStroke(t,i){this.pendingEOFill=!0,this.fillStroke(t,i)}endPath(t,i){this.consumePath(t,i)}rawFillPath(t,i){this.ctx.fill(i),this.dependencyTracker?.recordDependencies(t,Si.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=Mv}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=rm}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const i=this.pendingTextPaths,s=this.ctx;if(this.dependencyTracker){const{dependencyTracker:r}=this;i!==void 0&&r.recordFutureForcedDependency("textClip",r.getOpenMarker()).recordFutureForcedDependency("textClip",t),r.recordCloseMarker(t)}if(i!==void 0){const r=new Path2D,l=s.getTransform().invertSelf();for(const{transform:c,x:u,y:h,fontSize:f,path:p}of i)p&&r.addPath(p,new DOMMatrix(c).preMultiplySelf(l).translate(u,h).scale(f,-f));s.clip(r)}delete this.pendingTextPaths}setCharSpacing(t,i){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=i}setWordSpacing(t,i){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=i}setHScale(t,i){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=i/100}setLeading(t,i){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-i}setFont(t,i,s){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",i,t);const r=this.commonObjs.get(i),l=this.current;if(!r)throw new Error(`Can't find font for ${i}`);if(l.fontMatrix=r.fontMatrix||$u,(l.fontMatrix[0]===0||l.fontMatrix[3]===0)&&bt("Invalid font matrix for font "+i),s<0?(s=-s,l.fontDirection=-1):l.fontDirection=1,this.current.font=r,this.current.fontSize=s,r.isType3Font)return;const c=r.loadedName||"sans-serif",u=r.systemFontInfo?.css||`"${c}", ${r.fallbackName}`;let h="normal";r.black?h="900":r.bold&&(h="bold");const f=r.italic?"italic":"normal";let p=s;s<Jp?p=Jp:s>tm&&(p=tm),this.current.fontSizeScale=s/p,this.ctx.font=`${f} ${h} ${p}px ${u}`}setTextRenderingMode(t,i){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=i}setTextRise(t,i){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=i}moveText(t,i,s){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=i,this.current.y=this.current.lineY+=s}setLeadingMoveText(t,i,s){this.setLeading(t,-s),this.moveText(t,i,s)}setTextMatrix(t,i){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",t);const{current:s}=this;s.textMatrix=i,s.textMatrixScale=Math.hypot(i[0],i[1]),s.x=s.lineX=0,s.y=s.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#n(t,i,s){const r=new Path2D;return r.addPath(t,new DOMMatrix(s).invertSelf().multiplySelf(i)),r}paintChar(t,i,s,r,l,c){const u=this.ctx,h=this.current,f=h.font,p=h.textRenderingMode,y=h.fontSize/h.fontSizeScale,b=p&Te.FILL_STROKE_MASK,A=!!(p&Te.ADD_TO_PATH_FLAG),w=h.patternFill&&!f.missingFile,S=h.patternStroke&&!f.missingFile;let E;if((f.disableFontFace||A||w||S)&&!f.missingFile&&(E=f.getPathGenerator(this.commonObjs,i)),E&&(f.disableFontFace||w||S)){u.save(),u.translate(s,r),u.scale(y,-y),this.dependencyTracker?.recordCharacterBBox(t,u,f);let x;if(b===Te.FILL||b===Te.FILL_STROKE)if(l){x=u.getTransform(),u.setTransform(...l);const C=this.#n(E,x,l);u.fill(C)}else u.fill(E);if(b===Te.STROKE||b===Te.FILL_STROKE)if(c){x||=u.getTransform(),u.setTransform(...c);const{a:C,b:T,c:B,d:O}=x,L=st.inverseTransform(c),P=st.transform([C,T,B,O,0,0],L);st.singularValueDecompose2dScale(P,li),u.lineWidth*=Math.max(li[0],li[1])/y,u.stroke(this.#n(E,x,c))}else u.lineWidth/=y,u.stroke(E);u.restore()}else(b===Te.FILL||b===Te.FILL_STROKE)&&(u.fillText(i,s,r),this.dependencyTracker?.recordCharacterBBox(t,u,f,y,s,r,()=>u.measureText(i))),(b===Te.STROKE||b===Te.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,u,f,y,s,r,()=>u.measureText(i)).recordDependencies(t,Si.stroke),u.strokeText(i,s,r));A&&((this.pendingTextPaths||=[]).push({transform:Jt(u),x:s,y:r,fontSize:y,path:E}),this.dependencyTracker?.recordCharacterBBox(t,u,f,y,s,r))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const i=t.getImageData(0,0,10,10).data;let s=!1;for(let r=3;r<i.length;r+=4)if(i[r]>0&&i[r]<255){s=!0;break}return wt(this,"isFontSubpixelAAEnabled",s)}showText(t,i){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,Si.showText).resetBBox(t),this.current.textRenderingMode&Te.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const s=this.current,r=s.font;if(r.isType3Font){this.showType3Text(t,i),this.dependencyTracker?.recordShowTextOperation(t);return}const l=s.fontSize;if(l===0){this.dependencyTracker?.recordOperation(t);return}const c=this.ctx,u=s.fontSizeScale,h=s.charSpacing,f=s.wordSpacing,p=s.fontDirection,y=s.textHScale*p,b=i.length,A=r.vertical,w=A?1:-1,S=r.defaultVMetrics,E=l*s.fontMatrix[0],x=s.textRenderingMode===Te.FILL&&!r.disableFontFace&&!s.patternFill;c.save(),s.textMatrix&&c.transform(...s.textMatrix),c.translate(s.x,s.y+s.textRise),p>0?c.scale(y,-1):c.scale(y,1);let C,T;if(s.patternFill){c.save();const G=s.fillColor.getPattern(c,this,Fi(c),Me.FILL,t);C=Jt(c),c.restore(),c.fillStyle=G}if(s.patternStroke){c.save();const G=s.strokeColor.getPattern(c,this,Fi(c),Me.STROKE,t);T=Jt(c),c.restore(),c.strokeStyle=G}let B=s.lineWidth;const O=s.textMatrixScale;if(O===0||B===0){const G=s.textRenderingMode&Te.FILL_STROKE_MASK;(G===Te.STROKE||G===Te.FILL_STROKE)&&(B=this.getSinglePixelWidth())}else B/=O;if(u!==1&&(c.scale(u,u),B/=u),c.lineWidth=B,r.isInvalidPDFjsFont){const G=[];let Q=0;for(const W of i)G.push(W.unicode),Q+=W.width;const tt=G.join("");if(c.fillText(tt,0,0),this.dependencyTracker!==null){const W=c.measureText(tt);this.dependencyTracker.recordBBox(t,this.ctx,-W.actualBoundingBoxLeft,W.actualBoundingBoxRight,-W.actualBoundingBoxAscent,W.actualBoundingBoxDescent).recordShowTextOperation(t)}s.x+=Q*E*y,c.restore(),this.compose();return}let L=0,P;for(P=0;P<b;++P){const G=i[P];if(typeof G=="number"){L+=w*G*l/1e3;continue}let Q=!1;const tt=(G.isSpace?f:0)+h,W=G.fontChar,ut=G.accent;let mt,ht,vt=G.width;if(A){const Z=G.vmetric||S,gt=-(G.vmetric?Z[1]:vt*.5)*E,xt=Z[2]*E;vt=Z?-Z[0]:vt,mt=gt/u,ht=(L+xt)/u}else mt=L/u,ht=0;let k;if(r.remeasure&&vt>0){k=c.measureText(W);const Z=k.width*1e3/l*u;if(vt<Z&&this.isFontSubpixelAAEnabled){const gt=vt/Z;Q=!0,c.save(),c.scale(gt,1),mt/=gt}else vt!==Z&&(mt+=(vt-Z)/2e3*l/u)}if(this.contentVisible&&(G.isInFont||r.missingFile)){if(x&&!ut)c.fillText(W,mt,ht),this.dependencyTracker?.recordCharacterBBox(t,c,k?{bbox:null}:r,l/u,mt,ht,()=>k??c.measureText(W));else if(this.paintChar(t,W,mt,ht,C,T),ut){const Z=mt+l*ut.offset.x/u,gt=ht-l*ut.offset.y/u;this.paintChar(t,ut.fontChar,Z,gt,C,T)}}const q=A?vt*E-tt*p:vt*E+tt*p;L+=q,Q&&c.restore()}A?s.y-=L:s.x+=L*y,c.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,i){const s=this.ctx,r=this.current,l=r.font,c=r.fontSize,u=r.fontDirection,h=l.vertical?1:-1,f=r.charSpacing,p=r.wordSpacing,y=r.textHScale*u,b=r.fontMatrix||$u,A=i.length,w=r.textRenderingMode===Te.INVISIBLE;let S,E,x,C;if(w||c===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),r.textMatrix&&s.transform(...r.textMatrix),s.translate(r.x,r.y+r.textRise),s.scale(y,u);const T=this.dependencyTracker;for(this.dependencyTracker=T?new al(T,t):null,S=0;S<A;++S){if(E=i[S],typeof E=="number"){C=h*E*c/1e3,this.ctx.translate(C,0),r.x+=C*y;continue}const B=(E.isSpace?p:0)+f,O=l.charProcOperatorList[E.operatorListId];O?this.contentVisible&&(this.save(),s.scale(c,c),s.transform(...b),this.executeOperatorList(O),this.restore()):bt(`Type3 character "${E.operatorListId}" is not available.`);const L=[E.width,0];st.applyTransform(L,b),x=L[0]*c+B,s.translate(x,0),r.x+=x*y}s.restore(),T&&(this.dependencyTracker=T)}setCharWidth(t,i,s){}setCharWidthAndBounds(t,i,s,r,l,c,u){const h=new Path2D;h.rect(r,l,c-r,u-l),this.ctx.clip(h),this.dependencyTracker?.recordBBox(t,this.ctx,r,c,l,u).recordClipBox(t,this.ctx,r,c,l,u),this.endPath(t)}getColorN_Pattern(t,i){let s;if(i[0]==="TilingPattern"){const r=this.baseTransform||Jt(this.ctx),l={createCanvasGraphics:(c,u)=>new ca(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new al(this.dependencyTracker,u,!0):null)};s=new mh(i,this.ctx,l,r)}else s=this._getPattern(t,i[1],i[2]);return s}setStrokeColorN(t,...i){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,i),this.current.patternStroke=!0}setFillColorN(t,...i){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,i),this.current.patternFill=!0}setStrokeRGBColor(t,i){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=i,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,i){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=i,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,i,s=null){let r;return this.cachedPatterns.has(i)?r=this.cachedPatterns.get(i):(r=Sv(this.getObject(t,i)),this.cachedPatterns.set(i,r)),s&&(r.matrix=s),r}shadingFill(t,i){if(!this.contentVisible)return;const s=this.ctx;this.save(t);const r=this._getPattern(t,i);s.fillStyle=r.getPattern(s,this,Fi(s),Me.SHADING,t);const l=Fi(s);if(l){const{width:c,height:u}=s.canvas,h=aa.slice();st.axialAlignedBoundingBox([0,0,c,u],l,h);const[f,p,y,b]=h;this.ctx.fillRect(f,p,y-f,b-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,Si.transform).recordDependencies(t,Si.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){Vt("Should not call beginInlineImage")}beginImageData(){Vt("Should not call beginImageData")}paintFormXObjectBegin(t,i,s){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),i&&this.transform(t,...i),this.baseTransform=Jt(this.ctx),s)){st.axialAlignedBoundingBox(s,this.baseTransform,this.current.minMax);const[r,l,c,u]=s,h=new Path2D;h.rect(r,l,c-r,u-l),this.ctx.clip(h),this.dependencyTracker?.recordClipBox(t,this.ctx,r,c,l,u),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,i){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;i.isolated||ul("TODO: Support non-isolated groups."),i.knockout&&bt("Knockout groups not supported.");const r=Jt(s);if(i.matrix&&s.transform(...i.matrix),!i.bbox)throw new Error("Bounding box is required.");let l=aa.slice();st.axialAlignedBoundingBox(i.bbox,Jt(s),l);const c=[0,0,s.canvas.width,s.canvas.height];l=st.intersect(l,c)||[0,0,0,0];const u=Math.floor(l[0]),h=Math.floor(l[1]),f=Math.max(Math.ceil(l[2])-u,1),p=Math.max(Math.ceil(l[3])-h,1);this.current.startNewPathAndClipBox([0,0,f,p]);let y="groupAt"+this.groupLevel;i.smask&&(y+="_smask_"+this.smaskCounter++%2);const b=this.cachedCanvases.getCanvas(y,f,p),A=b.context;A.translate(-u,-h),A.transform(...r);let w=new Path2D;const[S,E,x,C]=i.bbox;if(w.rect(S,E,x-S,C-E),i.matrix){const T=new Path2D;T.addPath(w,new DOMMatrix(i.matrix)),w=T}A.clip(w),i.smask&&this.smaskStack.push({canvas:b.canvas,context:A,offsetX:u,offsetY:h,subtype:i.smask.subtype,backdrop:i.smask.backdrop,transferMap:i.smask.transferMap||null,startTransformInverse:null}),(!i.smask||this.dependencyTracker)&&(s.setTransform(1,0,0,1,0,0),s.translate(u,h),s.save()),or(s,A),this.ctx=A,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(s),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(t,i){if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),i.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const l=Jt(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...l);const c=aa.slice();st.axialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],l,c),this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(c)}}beginAnnotation(t,i,s,r,l,c){if(this.#t(),Wo(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),s){const u=s[2]-s[0],h=s[3]-s[1];if(c&&this.annotationCanvasMap){r=r.slice(),r[4]-=s[0],r[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=u,s[3]=h,st.singularValueDecompose2dScale(Jt(this.ctx),li);const{viewportScale:f}=this,p=Math.ceil(u*this.outputScaleX*f),y=Math.ceil(h*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(p,y);const{canvas:b,context:A}=this.annotationCanvas;this.annotationCanvasMap.set(i,b),this.annotationCanvas.savedCtx=this.ctx,this.ctx=A,this.ctx.save(),this.ctx.setTransform(li[0],0,0,-li[1],0,h*li[1]),Wo(this.ctx)}else{Wo(this.ctx),this.endPath(t);const f=new Path2D;f.rect(s[0],s[1],u,h),this.ctx.clip(f)}}this.current=new im(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...r),this.transform(t,...l)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,i){if(!this.contentVisible)return;const s=i.count;i=this.getObject(t,i.data,i),i.count=s;const r=this.ctx,l=this._createMaskCanvas(t,i),c=l.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(c,l.offsetX,l.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,l.offsetX,l.offsetX+c.width,l.offsetY,l.offsetY+c.height).recordOperation(t),r.restore(),this.compose()}paintImageMaskXObjectRepeat(t,i,s,r=0,l=0,c,u){if(!this.contentVisible)return;i=this.getObject(t,i.data,i);const h=this.ctx;h.save();const f=Jt(h);h.transform(s,r,l,c,0,0);const p=this._createMaskCanvas(t,i);h.setTransform(1,0,0,1,p.offsetX-f[4],p.offsetY-f[5]),this.dependencyTracker?.resetBBox(t);for(let y=0,b=u.length;y<b;y+=2){const A=st.transform(f,[s,r,l,c,u[y],u[y+1]]);h.drawImage(p.canvas,A[4],A[5]),this.dependencyTracker?.recordBBox(t,this.ctx,A[4],A[4]+p.canvas.width,A[5],A[5]+p.canvas.height)}h.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,i){if(!this.contentVisible)return;const s=this.ctx,r=this.current.fillColor,l=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,Si.transformAndFill);for(const c of i){const{data:u,width:h,height:f,transform:p}=c,y=this.cachedCanvases.getCanvas("maskCanvas",h,f),b=y.context;b.save();const A=this.getObject(t,u,c);sm(b,A),b.globalCompositeOperation="source-in",b.fillStyle=l?r.getPattern(b,this,Fi(s),Me.FILL,t):r,b.fillRect(0,0,h,f),b.restore(),s.save(),s.transform(...p),s.scale(1,-1),Zo(s,y.canvas,0,0,h,f,0,-1,1,1),this.dependencyTracker?.recordBBox(t,s,0,h,0,f),s.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,i){if(!this.contentVisible)return;const s=this.getObject(t,i);if(!s){bt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,s)}paintImageXObjectRepeat(t,i,s,r,l){if(!this.contentVisible)return;const c=this.getObject(t,i);if(!c){bt("Dependent image isn't ready yet");return}const u=c.width,h=c.height,f=[];for(let p=0,y=l.length;p<y;p+=2)f.push({transform:[s,0,0,r,l[p],l[p+1]],x:0,y:0,w:u,h});this.paintInlineImageXObjectGroup(t,c,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:i,width:s,height:r}=t,l=this.cachedCanvases.getCanvas("inlineImage",s,r),c=l.context;return c.filter=this.current.transferMaps,c.drawImage(i,0,0),c.filter="none",l.canvas}paintInlineImageXObject(t,i){if(!this.contentVisible)return;const s=i.width,r=i.height,l=this.ctx;this.save(t);const{filter:c}=l;c!=="none"&&c!==""&&(l.filter="none"),l.scale(1/s,-1/r);let u;if(i.bitmap)u=this.applyTransferMapsToBitmap(i);else if(typeof HTMLElement=="function"&&i instanceof HTMLElement||!i.data)u=i;else{const p=this.cachedCanvases.getCanvas("inlineImage",s,r).context;nm(p,i),u=this.applyTransferMapsToCanvas(p)}const h=this._scaleImage(u,Fi(l));l.imageSmoothingEnabled=am(Jt(l),i.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,l,0,s,-r,0).recordDependencies(t,Si.imageXObject).recordOperation(t),Zo(l,h.img,0,0,h.paintWidth,h.paintHeight,0,-r,s,r),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,i,s){if(!this.contentVisible)return;const r=this.ctx;let l;if(i.bitmap)l=i.bitmap;else{const c=i.width,u=i.height,f=this.cachedCanvases.getCanvas("inlineImage",c,u).context;nm(f,i),l=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(t);for(const c of s)r.save(),r.transform(...c.transform),r.scale(1,-1),Zo(r,l,c.x,c.y,c.w,c.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,r,0,1,-1,0),r.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,Si.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,i){}markPointProps(t,i,s){}beginMarkedContent(t,i){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,i,s){this.dependencyTracker?.beginMarkedContent(t),i==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,i,s){const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const l=this.ctx;this.pendingClip?(r||(this.pendingClip===rm?l.clip(i,"evenodd"):l.clip(i)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Jt(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const i=Math.abs(t[0]*t[3]-t[2]*t[1]),s=Math.hypot(t[0],t[2]),r=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(s,r)/i}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:i,b:s,c:r,d:l}=this.ctx.getTransform();let c,u;if(s===0&&r===0){const h=Math.abs(i),f=Math.abs(l);if(h===f)if(t===0)c=u=1/h;else{const p=h*t;c=u=p<1?1/p:1}else if(t===0)c=1/h,u=1/f;else{const p=h*t,y=f*t;c=p<1?1/p:1,u=y<1?1/y:1}}else{const h=Math.abs(i*l-s*r),f=Math.hypot(i,s),p=Math.hypot(r,l);if(t===0)c=p/h,u=f/h;else{const y=t*h;c=p>y?p/y:1,u=f>y?f/y:1}}this._cachedScaleForStroking[0]=c,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t,i){const{ctx:s,current:{lineWidth:r}}=this,[l,c]=this.getScaleForStroking();if(l===c){s.lineWidth=(r||1)*l,s.stroke(t);return}const u=s.getLineDash();i&&s.save(),s.scale(l,c),Gu.a=1/l,Gu.d=1/c;const h=new Path2D;if(h.addPath(t,Gu),u.length>0){const f=Math.max(l,c);s.setLineDash(u.map(p=>p/f)),s.lineDashOffset/=f}s.lineWidth=r||1,s.stroke(h),i&&s.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const m in mr)ca.prototype[m]!==void 0&&(ca.prototype[mr[m]]=ca.prototype[m]);class ls{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class Dv{#t;#e;constructor({parsedData:t,rawData:i}){this.#t=t,this.#e=i}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const ia=Symbol("INTERNAL");class Rv{#t=!1;#e=!1;#n=!1;#i=!0;constructor(t,{name:i,intent:s,usage:r,rbGroups:l}){this.#t=!!(t&oi.DISPLAY),this.#e=!!(t&oi.PRINT),this.name=i,this.intent=s,this.usage=r,this.rbGroups=l}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;const{print:t,view:i}=this.usage;return this.#t?i?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,i,s=!1){t!==ia&&Vt("Internal method `_setVisible` called."),this.#n=s,this.#i=i}}class Nv{#t=null;#e=new Map;#n=null;#i=null;constructor(t,i=oi.DISPLAY){if(this.renderingIntent=i,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#i=t.order;for(const s of t.groups)this.#e.set(s.id,new Rv(i,s));if(t.baseState==="OFF")for(const s of this.#e.values())s._setVisible(ia,!1);for(const s of t.on)this.#e.get(s)._setVisible(ia,!0);for(const s of t.off)this.#e.get(s)._setVisible(ia,!1);this.#n=this.getHash()}}#r(t){const i=t.length;if(i<2)return!0;const s=t[0];for(let r=1;r<i;r++){const l=t[r];let c;if(Array.isArray(l))c=this.#r(l);else if(this.#e.has(l))c=this.#e.get(l).visible;else return bt(`Optional content group not found: ${l}`),!0;switch(s){case"And":if(!c)return!1;break;case"Or":if(c)return!0;break;case"Not":return!c;default:return!0}}return s==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return ul("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(bt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#r(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const i of t.ids){if(!this.#e.has(i))return bt(`Optional content group not found: ${i}`),!0;if(this.#e.get(i).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const i of t.ids){if(!this.#e.has(i))return bt(`Optional content group not found: ${i}`),!0;if(!this.#e.get(i).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const i of t.ids){if(!this.#e.has(i))return bt(`Optional content group not found: ${i}`),!0;if(!this.#e.get(i).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const i of t.ids){if(!this.#e.has(i))return bt(`Optional content group not found: ${i}`),!0;if(this.#e.get(i).visible)return!1}return!0}return bt(`Unknown optional content policy ${t.policy}.`),!0}return bt(`Unknown group type ${t.type}.`),!0}setVisibility(t,i=!0,s=!0){const r=this.#e.get(t);if(!r){bt(`Optional content group not found: ${t}`);return}if(s&&i&&r.rbGroups.length)for(const l of r.rbGroups)for(const c of l)c!==t&&this.#e.get(c)?._setVisible(ia,!1,!0);r._setVisible(ia,!!i,!0),this.#t=null}setOCGState({state:t,preserveRB:i}){let s;for(const r of t){switch(r){case"ON":case"OFF":case"Toggle":s=r;continue}const l=this.#e.get(r);if(l)switch(s){case"ON":this.setVisibility(r,!0,i);break;case"OFF":this.setVisibility(r,!1,i);break;case"Toggle":this.setVisibility(r,!l.visible,i);break}}this.#t=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new xm;for(const[i,s]of this.#e)t.update(`${i}:${s.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class Ov{constructor(t,{disableRange:i=!1,disableStream:s=!1}){Ot(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:l,progressiveDone:c,contentDispositionFilename:u}=t;if(this._queuedChunks=[],this._progressiveDone=c,this._contentDispositionFilename=u,l?.length>0){const h=l instanceof Uint8Array&&l.byteLength===l.buffer.byteLength?l.buffer:new Uint8Array(l).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!s,this._isRangeSupported=!i,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,f)=>{this._onReceiveData({begin:h,chunk:f})}),t.addProgressListener((h,f)=>{this._onProgress({loaded:h,total:f})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:i}){const s=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const r=this._rangeReaders.some(function(l){return l._begin!==t?!1:(l._enqueue(s),!0)});Ot(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const i=this._rangeReaders.indexOf(t);i>=0&&this._rangeReaders.splice(i,1)}getFullReader(){Ot(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new Lv(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=new kv(this,t,i);return this._pdfDataRangeTransport.requestDataRange(t,i),this._rangeReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeReaders.slice(0))i.cancel(t);this._pdfDataRangeTransport.abort()}}class Lv{constructor(t,i,s=!1,r=null){this._stream=t,this._done=s||!1,this._filename=uh(r)?r:null,this._queuedChunks=i||[],this._loaded=0;for(const l of this._queuedChunks)this._loaded+=l.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class kv{constructor(t,i,s){this._stream=t,this._begin=i,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Bv(m){let t=!0,i=s("filename\\*","i").exec(m);if(i){i=i[1];let p=u(i);return p=unescape(p),p=h(p),p=f(p),l(p)}if(i=c(m),i){const p=f(i);return l(p)}if(i=s("filename","i").exec(m),i){i=i[1];let p=u(i);return p=f(p),l(p)}function s(p,y){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',y)}function r(p,y){if(p){if(!/^[\x00-\xFF]+$/.test(y))return y;try{const b=new TextDecoder(p,{fatal:!0}),A=Ar(y);y=b.decode(A),t=!1}catch{}}return y}function l(p){return t&&/[\x80-\xff]/.test(p)&&(p=r("utf-8",p),t&&(p=r("iso-8859-1",p))),p}function c(p){const y=[];let b;const A=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(b=A.exec(p))!==null;){let[,S,E,x]=b;if(S=parseInt(S,10),S in y){if(S===0)break;continue}y[S]=[E,x]}const w=[];for(let S=0;S<y.length&&S in y;++S){let[E,x]=y[S];x=u(x),E&&(x=unescape(x),S===0&&(x=h(x))),w.push(x)}return w.join("")}function u(p){if(p.startsWith('"')){const y=p.slice(1).split('\\"');for(let b=0;b<y.length;++b){const A=y[b].indexOf('"');A!==-1&&(y[b]=y[b].slice(0,A),y.length=b+1),y[b]=y[b].replaceAll(/\\(.)/g,"$1")}p=y.join('"')}return p}function h(p){const y=p.indexOf("'");if(y===-1)return p;const b=p.slice(0,y),w=p.slice(y+1).replace(/^[^']*'/,"");return r(b,w)}function f(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(y,b,A,w){if(A==="q"||A==="Q")return w=w.replaceAll("_"," "),w=w.replaceAll(/=([0-9a-fA-F]{2})/g,function(S,E){return String.fromCharCode(parseInt(E,16))}),r(b,w);try{w=atob(w)}catch{}return r(b,w)})}return""}function Nm(m,t){const i=new Headers;if(!m||!t||typeof t!="object")return i;for(const s in t){const r=t[s];r!==void 0&&i.append(s,r)}return i}function fl(m){return URL.parse(m)?.origin??null}function Om({responseHeaders:m,isHttp:t,rangeChunkSize:i,disableRange:s}){const r={allowRangeRequests:!1,suggestedLength:void 0},l=parseInt(m.get("Content-Length"),10);return!Number.isInteger(l)||(r.suggestedLength=l,l<=2*i)||s||!t||m.get("Accept-Ranges")!=="bytes"||(m.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function Lm(m){const t=m.get("Content-Disposition");if(t){let i=Bv(t);if(i.includes("%"))try{i=decodeURIComponent(i)}catch{}if(uh(i))return i}return null}function Er(m,t){return new sl(`Unexpected server response (${m}) while retrieving PDF "${t}".`,m,m===404||m===0&&t.startsWith("file:"))}function km(m){return m===200||m===206}function Bm(m,t,i){return{method:"GET",headers:m,signal:i.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function zm(m){return m instanceof Uint8Array?m.buffer:m instanceof ArrayBuffer?m:(bt(`getArrayBuffer - unexpected data format: ${m}`),new Uint8Array(m).buffer)}class zv{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=Nm(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Ot(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Pv(this),this._fullRequestReader}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=new Uv(this,t,i);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class Pv{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const i=t.source;this._withCredentials=i.withCredentials||!1,this._contentLength=i.length,this._headersCapability=Promise.withResolvers(),this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange;const s=new Headers(t.headers),r=i.url;fetch(r,Bm(s,this._withCredentials,this._abortController)).then(l=>{if(t._responseOrigin=fl(l.url),!km(l.status))throw Er(l.status,r);this._reader=l.body.getReader(),this._headersCapability.resolve();const c=l.headers,{allowRangeRequests:u,suggestedLength:h}=Om({responseHeaders:c,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=h||this._contentLength,this._filename=Lm(c),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Un("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:zm(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class Uv{constructor(t,i,s){this._stream=t,this._reader=null,this._loaded=0;const r=t.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const l=new Headers(t.headers);l.append("Range",`bytes=${i}-${s-1}`);const c=r.url;fetch(c,Bm(l,this._withCredentials,this._abortController)).then(u=>{const h=fl(u.url);if(h!==t._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${t._responseOrigin}".`);if(!km(u.status))throw Er(u.status,c);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:zm(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const qu=200,Vu=206;function Fv(m){const t=m.response;return typeof t!="string"?t:Ar(t).buffer}class jv{_responseOrigin=null;constructor({url:t,httpHeaders:i,withCredentials:s}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=Nm(this.isHttp,i),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const i=new XMLHttpRequest,s=this.currXhrId++,r=this.pendingRequests[s]={xhr:i};i.open("GET",this.url),i.withCredentials=this.withCredentials;for(const[l,c]of this.headers)i.setRequestHeader(l,c);return this.isHttp&&"begin"in t&&"end"in t?(i.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),r.expectedStatus=Vu):r.expectedStatus=qu,i.responseType="arraybuffer",Ot(t.onError,"Expected `onError` callback to be provided."),i.onerror=()=>{t.onError(i.status)},i.onreadystatechange=this.onStateChange.bind(this,s),i.onprogress=this.onProgress.bind(this,s),r.onHeadersReceived=t.onHeadersReceived,r.onDone=t.onDone,r.onError=t.onError,r.onProgress=t.onProgress,i.send(null),s}onProgress(t,i){const s=this.pendingRequests[t];s&&s.onProgress?.(i)}onStateChange(t,i){const s=this.pendingRequests[t];if(!s)return;const r=s.xhr;if(r.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),r.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],r.status===0&&this.isHttp){s.onError(r.status);return}const l=r.status||qu;if(!(l===qu&&s.expectedStatus===Vu)&&l!==s.expectedStatus){s.onError(r.status);return}const u=Fv(r);if(l===Vu){const h=r.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);f?s.onDone({begin:parseInt(f[1],10),chunk:u}):(bt('Missing or invalid "Content-Range" header.'),s.onError(0))}else u?s.onDone({begin:0,chunk:u}):s.onError(r.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const i=this.pendingRequests[t].xhr;delete this.pendingRequests[t],i.abort()}}class Hv{constructor(t){this._source=t,this._manager=new jv(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const i=this._rangeRequestReaders.indexOf(t);i>=0&&this._rangeRequestReaders.splice(i,1)}getFullReader(){return Ot(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Iv(this._manager,this._source),this._fullRequestReader}getRangeReader(t,i){const s=new Gv(this._manager,t,i);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class Iv{constructor(t,i){this._manager=t,this._url=i.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=i.disableRange||!1,this._contentLength=i.length,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,i=this._manager.getRequestXhr(t);this._manager._responseOrigin=fl(i.responseURL);const s=i.getAllResponseHeaders(),r=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(u=>{const[h,...f]=u.split(": ");return[h,f.join(": ")]}):[]),{allowRangeRequests:l,suggestedLength:c}=Om({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});l&&(this._isRangeSupported=!0),this._contentLength=c||this._contentLength,this._filename=Lm(r),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=Er(t,this._url),this._headersCapability.reject(this._storedError);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class Gv{constructor(t,i,s){this._manager=t,this._url=t.url,this._requestId=t.request({begin:i,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=fl(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const i=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:i,done:!1}):this._queuedChunk=i,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=Er(t,this._url);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const qv=/^[a-z][a-z0-9\-+.]+:/i;function Vv(m){if(qv.test(m))return new URL(m);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(m))}class Xv{constructor(t){this.source=t,this.url=Vv(t.url),Ot(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Ot(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new Yv(this),this._fullRequestReader}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=new $v(this,t,i);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class Yv{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const i=t.source;this._contentLength=i.length,this._loaded=0,this._filename=null,this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=Er(0,this._url.href)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",i=>{this._error(i)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Un("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class $v{constructor(t,i,s){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=t.source;this._isStreamingSupported=!r.disableStream;const l=process.getBuiltinModule("fs");this._setReadableStream(l.createReadStream(this._url,{start:i,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",i=>{this._error(i)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const lr=Symbol("INITIAL_DATA");class Pm{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:lr}}get(t,i=null){if(i){const r=this.#e(t);return r.promise.then(()=>i(r.data)),null}const s=this.#t[t];if(!s||s.data===lr)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return s.data}has(t){const i=this.#t[t];return!!i&&i.data!==lr}delete(t){const i=this.#t[t];return!i||i.data===lr?!1:(delete this.#t[t],!0)}resolve(t,i=null){const s=this.#e(t);s.data=i,s.resolve()}clear(){for(const t in this.#t){const{data:i}=this.#t[t];i?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:i}=this.#t[t];i!==lr&&(yield[t,i])}}}const Kv=1e5,om=30;class ze{#t=Promise.withResolvers();#e=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#r=null;#a=null;#s=0;#o=0;#c=null;#l=null;#d=0;#h=0;#f=Object.create(null);#m=[];#p=null;#u=[];#g=new WeakMap;#y=null;static#v=new Map;static#b=new Map;static#E=new WeakMap;static#_=null;static#S=new Set;constructor({textContentSource:t,container:i,viewport:s}){if(t instanceof ReadableStream)this.#p=t;else if(typeof t=="object")this.#p=new ReadableStream({start(h){h.enqueue(t),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#l=i,this.#h=s.scale*Gi.pixelRatio,this.#d=s.rotation,this.#a={div:null,properties:null,ctx:null};const{pageWidth:r,pageHeight:l,pageX:c,pageY:u}=s.rawDims;this.#y=[1,0,0,-1,-c,u+l],this.#o=r,this.#s=l,ze.#D(),cs(i,s),this.#t.promise.finally(()=>{ze.#S.delete(this),this.#a=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:i}=De.platform;return wt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&i?"Calibri, ":""}sans-serif`],["monospace",`${t&&i?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:i,done:s})=>{if(s){this.#t.resolve();return}this.#r??=i.lang,Object.assign(this.#f,i.styles),this.#C(i.items),t()},this.#t.reject)};return this.#c=this.#p.getReader(),ze.#S.add(this),t(),this.#t.promise}update({viewport:t,onBefore:i=null}){const s=t.scale*Gi.pixelRatio,r=t.rotation;if(r!==this.#d&&(i?.(),this.#d=r,cs(this.#l,{rotation:r})),s!==this.#h){i?.(),this.#h=s;const l={div:null,properties:null,ctx:ze.#R(this.#r)};for(const c of this.#u)l.properties=this.#g.get(c),l.div=c,this.#x(l)}}cancel(){const t=new Un("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#m}#C(t){if(this.#n)return;this.#a.ctx??=ze.#R(this.#r);const i=this.#u,s=this.#m;for(const r of t){if(i.length>Kv){bt("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const l=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),r.id&&this.#e.setAttribute("id",`${r.id}`),l.append(this.#e)}else r.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}s.push(r.str),this.#A(r)}}#A(t){const i=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#u.push(i);const r=st.transform(this.#y,t.transform);let l=Math.atan2(r[1],r[0]);const c=this.#f[t.fontName];c.vertical&&(l+=Math.PI/2);let u=this.#i&&c.fontSubstitution||c.fontFamily;u=ze.fontFamilyMap.get(u)||u;const h=Math.hypot(r[2],r[3]),f=h*ze.#P(u,c,this.#r);let p,y;l===0?(p=r[4],y=r[5]-f):(p=r[4]+f*Math.sin(l),y=r[5]-f*Math.cos(l));const b="calc(var(--total-scale-factor) *",A=i.style;this.#e===this.#l?(A.left=`${(100*p/this.#o).toFixed(2)}%`,A.top=`${(100*y/this.#s).toFixed(2)}%`):(A.left=`${b}${p.toFixed(2)}px)`,A.top=`${b}${y.toFixed(2)}px)`),A.fontSize=`${b}${(ze.#_*h).toFixed(2)}px)`,A.fontFamily=u,s.fontSize=h,i.setAttribute("role","presentation"),i.textContent=t.str,i.dir=t.dir,this.#i&&(i.dataset.fontName=c.fontSubstitutionLoadedName||t.fontName),l!==0&&(s.angle=l*(180/Math.PI));let w=!1;if(t.str.length>1)w=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const S=Math.abs(t.transform[0]),E=Math.abs(t.transform[3]);S!==E&&Math.max(S,E)/Math.min(S,E)>1.5&&(w=!0)}if(w&&(s.canvasWidth=c.vertical?t.height:t.width),this.#g.set(i,s),this.#a.div=i,this.#a.properties=s,this.#x(this.#a),s.hasText&&this.#e.append(i),s.hasEOL){const S=document.createElement("br");S.setAttribute("role","presentation"),this.#e.append(S)}}#x(t){const{div:i,properties:s,ctx:r}=t,{style:l}=i;let c="";if(ze.#_>1&&(c=`scale(${1/ze.#_})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:u}=l,{canvasWidth:h,fontSize:f}=s;ze.#M(r,f*this.#h,u);const{width:p}=r.measureText(i.textContent);p>0&&(c=`scaleX(${h*this.#h/p}) ${c}`)}s.angle!==0&&(c=`rotate(${s.angle}deg) ${c}`),c.length>0&&(l.transform=c)}static cleanup(){if(!(this.#S.size>0)){this.#v.clear();for(const{canvas:t}of this.#b.values())t.remove();this.#b.clear()}}static#R(t=null){let i=this.#b.get(t||="");if(!i){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=t,document.body.append(s),i=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#b.set(t,i),this.#E.set(i,{size:0,family:""})}return i}static#M(t,i,s){const r=this.#E.get(t);i===r.size&&s===r.family||(t.font=`${i}px ${s}`,r.size=i,r.family=s)}static#D(){if(this.#_!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#_=t.getBoundingClientRect().height,t.remove()}static#P(t,i,s){const r=this.#v.get(t);if(r)return r;const l=this.#R(s);l.canvas.width=l.canvas.height=om,this.#M(l,om,t);const c=l.measureText(""),u=c.fontBoundingBoxAscent,h=Math.abs(c.fontBoundingBoxDescent);l.canvas.width=l.canvas.height=0;let f=.8;return u?f=u/(u+h):(De.platform.isFirefox&&bt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),i.ascent?f=i.ascent:i.descent&&(f=1+i.descent)),this.#v.set(t,f),f}}const Qv=100;function yh(m={}){typeof m=="string"||m instanceof URL?m={url:m}:(m instanceof ArrayBuffer||ArrayBuffer.isView(m))&&(m={data:m});const t=new bh,{docId:i}=t,s=m.url?nv(m.url):null,r=m.data?sv(m.data):null,l=m.httpHeaders||null,c=m.withCredentials===!0,u=m.password??null,h=m.range instanceof Um?m.range:null,f=Number.isInteger(m.rangeChunkSize)&&m.rangeChunkSize>0?m.rangeChunkSize:2**16;let p=m.worker instanceof br?m.worker:null;const y=m.verbosity,b=typeof m.docBaseUrl=="string"&&!hl(m.docBaseUrl)?m.docBaseUrl:null,A=Yo(m.cMapUrl),w=m.cMapPacked!==!1,S=m.CMapReaderFactory||(Pe?dv:Yp),E=Yo(m.iccUrl),x=Yo(m.standardFontDataUrl),C=m.StandardFontDataFactory||(Pe?fv:$p),T=Yo(m.wasmUrl),B=m.WasmFactory||(Pe?gv:Kp),O=m.stopAtErrors!==!0,L=Number.isInteger(m.maxImageSize)&&m.maxImageSize>-1?m.maxImageSize:-1,P=m.isEvalSupported!==!1,G=typeof m.isOffscreenCanvasSupported=="boolean"?m.isOffscreenCanvasSupported:!Pe,Q=typeof m.isImageDecoderSupported=="boolean"?m.isImageDecoderSupported:!Pe&&(De.platform.isFirefox||!globalThis.chrome),tt=Number.isInteger(m.canvasMaxAreaInBytes)?m.canvasMaxAreaInBytes:-1,W=typeof m.disableFontFace=="boolean"?m.disableFontFace:Pe,ut=m.fontExtraProperties===!0,mt=m.enableXfa===!0,ht=m.ownerDocument||globalThis.document,vt=m.disableRange===!0,k=m.disableStream===!0,q=m.disableAutoFetch===!0,Z=m.pdfBug===!0,gt=m.CanvasFactory||(Pe?hv:lv),xt=m.FilterFactory||(Pe?uv:cv),R=m.enableHWA===!0,I=m.useWasm!==!1,K=h?h.length:m.length??NaN,et=typeof m.useSystemFonts=="boolean"?m.useSystemFonts:!Pe&&!W,ot=typeof m.useWorkerFetch=="boolean"?m.useWorkerFetch:!!(S===Yp&&C===$p&&B===Kp&&A&&x&&T&&hr(A,document.baseURI)&&hr(x,document.baseURI)&&hr(T,document.baseURI)),ft=null;N0(y);const at={canvasFactory:new gt({ownerDocument:ht,enableHWA:R}),filterFactory:new xt({docId:i,ownerDocument:ht}),cMapReaderFactory:ot?null:new S({baseUrl:A,isCompressed:w}),standardFontDataFactory:ot?null:new C({baseUrl:x}),wasmFactory:ot?null:new B({baseUrl:T})};p||(p=br.create({verbosity:y,port:ls.workerPort}),t._worker=p);const $t={docId:i,apiVersion:"5.4.394",data:r,password:u,disableAutoFetch:q,rangeChunkSize:f,length:K,docBaseUrl:b,enableXfa:mt,evaluatorOptions:{maxImageSize:L,disableFontFace:W,ignoreErrors:O,isEvalSupported:P,isOffscreenCanvasSupported:G,isImageDecoderSupported:Q,canvasMaxAreaInBytes:tt,fontExtraProperties:ut,useSystemFonts:et,useWasm:I,useWorkerFetch:ot,cMapUrl:A,iccUrl:E,standardFontDataUrl:x,wasmUrl:T}},Ct={ownerDocument:ht,pdfBug:Z,styleElement:ft,loadingParams:{disableAutoFetch:q,enableXfa:mt}};return p.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const ci=p.messageHandler.sendWithPromise("GetDocRequest",$t,r?[r.buffer]:null);let Oe;if(h)Oe=new Ov(h,{disableRange:vt,disableStream:k});else if(!r){if(!s)throw new Error("getDocument - no `url` parameter provided.");const We=hr(s)?zv:Pe?Xv:Hv;Oe=new We({url:s,length:K,httpHeaders:l,withCredentials:c,rangeChunkSize:f,disableRange:vt,disableStream:k})}return ci.then(We=>{if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const xi=new dr(i,We,p.port),Ei=new Jv(xi,t,Oe,Ct,at,R);t._transport=Ei,xi.send("Ready",null)})}).catch(t._capability.reject),t}class bh{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${bh.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class Um{#t=Promise.withResolvers();#e=[];#n=[];#i=[];#r=[];constructor(t,i,s=!1,r=null){this.length=t,this.initialData=i,this.progressiveDone=s,this.contentDispositionFilename=r}addRangeListener(t){this.#r.push(t)}addProgressListener(t){this.#i.push(t)}addProgressiveReadListener(t){this.#n.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,i){for(const s of this.#r)s(t,i)}onDataProgress(t,i){this.#t.promise.then(()=>{for(const s of this.#i)s(t,i)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const i of this.#n)i(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,i){Vt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class Zv{constructor(t,i){this._pdfInfo=t,this._transport=i}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return wt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,i){return this._transport.getAnnotationsByType(t,i)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:i}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(i)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class Wv{#t=!1;constructor(t,i,s,r=!1){this._pageIndex=t,this._pageInfo=i,this._transport=s,this._stats=r?new jp:null,this._pdfBug=r,this.commonObjs=s.commonObjs,this.objs=new Pm,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:i=this.rotate,offsetX:s=0,offsetY:r=0,dontFlip:l=!1}={}){return new wr({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:i,offsetX:s,offsetY:r,dontFlip:l})}getAnnotations({intent:t="display"}={}){const{renderingIntent:i}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,i)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return wt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:i=t.canvas,viewport:s,intent:r="display",annotationMode:l=zn.ENABLE,transform:c=null,background:u=null,optionalContentConfigPromise:h=null,annotationCanvasMap:f=null,pageColors:p=null,printAnnotationStorage:y=null,isEditing:b=!1,recordOperations:A=!1,operationsFilter:w=null}){this._stats?.time("Overall");const S=this._transport.getRenderingIntent(r,l,y,b),{renderingIntent:E,cacheKey:x}=S;this.#t=!1,h||=this._transport.getOptionalContentConfig(E);let C=this._intentStates.get(x);C||(C=Object.create(null),this._intentStates.set(x,C)),C.streamReaderCancelTimeout&&(clearTimeout(C.streamReaderCancelTimeout),C.streamReaderCancelTimeout=null);const T=!!(E&oi.PRINT);C.displayReadyCapability||(C.displayReadyCapability=Promise.withResolvers(),C.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(S));const B=!!(this._pdfBug&&globalThis.StepperManager?.enabled),O=!this.recordedBBoxes&&(A||B),L=Q=>{if(C.renderTasks.delete(P),O){const tt=P.gfx?.dependencyTracker.take();tt&&(P.stepper&&P.stepper.setOperatorBBoxes(tt,P.gfx.dependencyTracker.takeDebugMetadata()),A&&(this.recordedBBoxes=tt))}T&&(this.#t=!0),this.#e(),Q?(P.capability.reject(Q),this._abortOperatorList({intentState:C,reason:Q instanceof Error?Q:new Error(Q)})):P.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},P=new ra({callback:L,params:{canvas:i,canvasContext:t,dependencyTracker:O?new mv(i,C.operatorList.length,B):null,viewport:s,transform:c,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:C.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!T,pdfBug:this._pdfBug,pageColors:p,enableHWA:this._transport.enableHWA,operationsFilter:w});(C.renderTasks||=new Set).add(P);const G=P.task;return Promise.all([C.displayReadyCapability.promise,h]).then(([Q,tt])=>{if(this.destroyed){L();return}if(this._stats?.time("Rendering"),!(tt.renderingIntent&E))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");P.initializeGraphics({transparency:Q,optionalContentConfig:tt}),P.operatorListChanged()}).catch(L),G}getOperatorList({intent:t="display",annotationMode:i=zn.ENABLE,printAnnotationStorage:s=null,isEditing:r=!1}={}){function l(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(h))}const c=this._transport.getRenderingIntent(t,i,s,r,!0);let u=this._intentStates.get(c.cacheKey);u||(u=Object.create(null),this._intentStates.set(c.cacheKey,u));let h;return u.opListReadCapability||(h=Object.create(null),h.operatorListChanged=l,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(h),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(c)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:i=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:i===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>yr.textContent(s));const i=this.streamTextContent(t);return new Promise(function(s,r){function l(){c.read().then(function({value:h,done:f}){if(f){s(u);return}u.lang??=h.lang,Object.assign(u.styles,h.styles),u.items.push(...h.items),l()},r)}const c=i.getReader(),u={items:[],styles:Object.create(null),lang:null};l()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const i of this._intentStates.values())if(this._abortOperatorList({intentState:i,reason:new Error("Page was destroyed."),force:!0}),!i.opListReadCapability)for(const s of i.renderTasks)t.push(s.completed),s.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const i=this.#e();return t&&i&&(this._stats&&=new jp),i}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:i}of this._intentStates.values())if(t.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,i){const s=this._intentStates.get(i);s&&(this._stats?.timeEnd("Page Request"),s.displayReadyCapability?.resolve(t))}_renderPageChunk(t,i){for(let s=0,r=t.length;s<r;s++)i.operatorList.fnArray.push(t.fnArray[s]),i.operatorList.argsArray.push(t.argsArray[s]);i.operatorList.lastChunk=t.lastChunk,i.operatorList.separateAnnots=t.separateAnnots;for(const s of i.renderTasks)s.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:i,annotationStorageSerializable:s,modifiedIds:r}){const{map:l,transfer:c}=s,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:i,annotationStorage:l,modifiedIds:r},c).getReader(),f=this._intentStates.get(i);f.streamReader=h;const p=()=>{h.read().then(({value:y,done:b})=>{if(b){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(y,f),p())},y=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const b of f.renderTasks)b.operatorListChanged();this.#e()}if(f.displayReadyCapability)f.displayReadyCapability.reject(y);else if(f.opListReadCapability)f.opListReadCapability.reject(y);else throw y}})};p()}_abortOperatorList({intentState:t,reason:i,force:s=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!s){if(t.renderTasks.size>0)return;if(i instanceof ch){let r=Qv;i.extraDelay>0&&i.extraDelay<1e3&&(r+=i.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:i,force:!0})},r);return}}if(t.streamReader.cancel(new Un(i.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[r,l]of this._intentStates)if(l===t){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}var Pn,Di,hn,as,ol,rs,os,Fe,il,Fm,jm,fr,ua,nl;const Zt=class Zt{constructor({name:t=null,port:i=null,verbosity:s=O0()}={}){Pi(this,Fe);Pi(this,Pn,Promise.withResolvers());Pi(this,Di,null);Pi(this,hn,null);Pi(this,as,null);if(this.name=t,this.destroyed=!1,this.verbosity=s,i){if(Qt(Zt,os).has(i))throw new Error("Cannot use more than one PDFWorker per port.");Qt(Zt,os).set(i,this),Ui(this,Fe,Fm).call(this,i)}else Ui(this,Fe,jm).call(this)}get promise(){return Qt(this,Pn).promise}get port(){return Qt(this,hn)}get messageHandler(){return Qt(this,Di)}destroy(){this.destroyed=!0,Qt(this,as)?.terminate(),$e(this,as,null),Qt(Zt,os).delete(Qt(this,hn)),$e(this,hn,null),Qt(this,Di)?.destroy(),$e(this,Di,null)}static create(t){const i=Qt(this,os).get(t?.port);if(i){if(i._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return i}return new Zt(t)}static get workerSrc(){if(ls.workerSrc)return ls.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return wt(this,"_setupFakeWorkerGlobal",(async()=>Qt(this,ua,nl)?Qt(this,ua,nl):(await import(this.workerSrc)).WorkerMessageHandler)())}};Pn=new WeakMap,Di=new WeakMap,hn=new WeakMap,as=new WeakMap,ol=new WeakMap,rs=new WeakMap,os=new WeakMap,Fe=new WeakSet,il=function(){Qt(this,Pn).resolve(),Qt(this,Di).send("configure",{verbosity:this.verbosity})},Fm=function(t){$e(this,hn,t),$e(this,Di,new dr("main","worker",t)),Qt(this,Di).on("ready",()=>{}),Ui(this,Fe,il).call(this)},jm=function(){if(Qt(Zt,rs)||Qt(Zt,ua,nl)){Ui(this,Fe,fr).call(this);return}let{workerSrc:t}=Zt;try{Zt._isSameOrigin(window.location,t)||(t=Zt._createCDNWrapper(new URL(t,window.location).href));const i=new Worker(t,{type:"module"}),s=new dr("main","worker",i),r=()=>{l.abort(),s.destroy(),i.terminate(),this.destroyed?Qt(this,Pn).reject(new Error("Worker was destroyed")):Ui(this,Fe,fr).call(this)},l=new AbortController;i.addEventListener("error",()=>{Qt(this,as)||r()},{signal:l.signal}),s.on("test",u=>{if(l.abort(),this.destroyed||!u){r();return}$e(this,Di,s),$e(this,hn,i),$e(this,as,i),Ui(this,Fe,il).call(this)}),s.on("ready",u=>{if(l.abort(),this.destroyed){r();return}try{c()}catch{Ui(this,Fe,fr).call(this)}});const c=()=>{const u=new Uint8Array;s.send("test",u,[u.buffer])};c();return}catch{ul("The worker has been disabled.")}Ui(this,Fe,fr).call(this)},fr=function(){Qt(Zt,rs)||(bt("Setting up fake worker."),$e(Zt,rs,!0)),Zt._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Qt(this,Pn).reject(new Error("Worker was destroyed"));return}const i=new ov;$e(this,hn,i);const s=`fake${_p(Zt,ol)._++}`,r=new dr(s+"_worker",s,i);t.setup(r,i),$e(this,Di,new dr(s,s+"_worker",i)),Ui(this,Fe,il).call(this)}).catch(t=>{Qt(this,Pn).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},ua=new WeakSet,nl=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Pi(Zt,ua),Pi(Zt,ol,0),Pi(Zt,rs,!1),Pi(Zt,os,new WeakMap),Pe&&($e(Zt,rs,!0),ls.workerSrc||="./pdf.worker.mjs"),Zt._isSameOrigin=(t,i)=>{const s=URL.parse(t);if(!s?.origin||s.origin==="null")return!1;const r=new URL(i,s);return s.origin===r.origin},Zt._createCDNWrapper=t=>{const i=`await import("${t}");`;return URL.createObjectURL(new Blob([i],{type:"text/javascript"}))},Zt.fromPort=t=>{if(q0("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Zt.create(t)};let br=Zt;class Jv{#t=new Map;#e=new Map;#n=new Map;#i=new Map;#r=null;constructor(t,i,s,r,l,c){this.messageHandler=t,this.loadingTask=i,this.commonObjs=new Pm,this.fontLoader=new ev({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=l.canvasFactory,this.filterFactory=l.filterFactory,this.cMapReaderFactory=l.cMapReaderFactory,this.standardFontDataFactory=l.standardFontDataFactory,this.wasmFactory=l.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=c,this.setupMessageHandler()}#a(t,i=null){const s=this.#t.get(t);if(s)return s;const r=this.messageHandler.sendWithPromise(t,i);return this.#t.set(t,r),r}get annotationStorage(){return wt(this,"annotationStorage",new fh)}getRenderingIntent(t,i=zn.ENABLE,s=null,r=!1,l=!1){let c=oi.DISPLAY,u=th;switch(t){case"any":c=oi.ANY;break;case"display":break;case"print":c=oi.PRINT;break;default:bt(`getRenderingIntent - invalid intent: ${t}`)}const h=c&oi.PRINT&&s instanceof Em?s:this.annotationStorage;switch(i){case zn.DISABLE:c+=oi.ANNOTATIONS_DISABLE;break;case zn.ENABLE:break;case zn.ENABLE_FORMS:c+=oi.ANNOTATIONS_FORMS;break;case zn.ENABLE_STORAGE:c+=oi.ANNOTATIONS_STORAGE,u=h.serializable;break;default:bt(`getRenderingIntent - invalid annotationMode: ${i}`)}r&&(c+=oi.IS_EDITING),l&&(c+=oi.OPLIST);const{ids:f,hash:p}=h.modifiedIds,y=[c,u.hash,p];return{renderingIntent:c,cacheKey:y.join("_"),annotationStorageSerializable:u,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const s of this.#e.values())t.push(s._destroy());this.#e.clear(),this.#n.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const i=this.messageHandler.sendWithPromise("Terminate",null);return t.push(i),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),ze.cleanup(),this._networkStream?.cancelAllRequests(new Un("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:i}=this;t.on("GetReader",(s,r)=>{Ot(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=l=>{this._lastProgress={loaded:l.loaded,total:l.total}},r.onPull=()=>{this._fullReader.read().then(function({value:l,done:c}){if(c){r.close();return}Ot(l instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{r.error(l)})},r.onCancel=l=>{this._fullReader.cancel(l),r.ready.catch(c=>{if(!this.destroyed)throw c})}}),t.on("ReaderHeadersReady",async s=>{await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:l,contentLength:c}=this._fullReader;return(!r||!l)&&(this._lastProgress&&i.onProgress?.(this._lastProgress),this._fullReader.onProgress=u=>{i.onProgress?.({loaded:u.loaded,total:u.total})}),{isStreamingSupported:r,isRangeSupported:l,contentLength:c}}),t.on("GetRangeReader",(s,r)=>{Ot(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const l=this._networkStream.getRangeReader(s.begin,s.end);if(!l){r.close();return}r.onPull=()=>{l.read().then(function({value:c,done:u}){if(u){r.close();return}Ot(c instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(c),1,[c])}).catch(c=>{r.error(c)})},r.onCancel=c=>{l.cancel(c),r.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,i._capability.resolve(new Zv(s,this))}),t.on("DocException",s=>{i._capability.reject(Ke(s))}),t.on("PasswordRequest",s=>{this.#r=Promise.withResolvers();try{if(!i.onPassword)throw Ke(s);const r=l=>{l instanceof Error?this.#r.reject(l):this.#r.resolve({password:l})};i.onPassword(r,s.code)}catch(r){this.#r.reject(r)}return this.#r.promise}),t.on("DataLoaded",s=>{i.onProgress?.({loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),t.on("StartRenderPage",s=>{if(this.destroyed)return;this.#e.get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),t.on("commonobj",([s,r,l])=>{if(this.destroyed||this.commonObjs.has(s))return null;switch(r){case"Font":if("error"in l){const y=l.error;bt(`Error during font loading: ${y}`),this.commonObjs.resolve(s,y);break}const c=new Gt(l),u=this._params.pdfBug&&globalThis.FontInspector?.enabled?(y,b)=>globalThis.FontInspector.fontAdded(y,b):null,h=new iv(c,u,l.extra,l.charProcOperatorList);this.fontLoader.bind(h).catch(()=>t.sendWithPromise("FontFallback",{id:s})).finally(()=>{!h.fontExtraProperties&&h.data&&h.clearData(),this.commonObjs.resolve(s,h)});break;case"CopyLocalImage":const{imageRef:f}=l;Ot(f,"The imageRef must be defined.");for(const y of this.#e.values())for(const[,b]of y.objs)if(b?.ref===f)return b.dataLen?(this.commonObjs.resolve(s,structuredClone(b)),b.dataLen):null;break;case"FontPath":case"Image":this.commonObjs.resolve(s,l);break;case"Pattern":const p=new be(l);this.commonObjs.resolve(s,p.getIR());break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),t.on("obj",([s,r,l,c])=>{if(this.destroyed)return;const u=this.#e.get(r);if(!u.objs.has(s)){if(u._intentStates.size===0){c?.bitmap?.close();return}switch(l){case"Image":case"Pattern":u.objs.resolve(s,c);break;default:throw new Error(`Got unknown object type ${l}`)}}}),t.on("DocProgress",s=>{this.destroyed||i.onProgress?.({loaded:s.loaded,total:s.total})}),t.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const r=this[s.type];if(!r)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return r.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&bt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:i}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},i).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const i=t-1,s=this.#n.get(i);if(s)return s;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:i}).then(l=>{if(this.destroyed)throw new Error("Transport destroyed");l.refStr&&this.#i.set(l.refStr,t);const c=new Wv(i,l,this,this._params.pdfBug);return this.#e.set(i,c),c});return this.#n.set(i,r),r}getPageIndex(t){return eh(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,i){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:i})}getFieldObjects(){return this.#a("GetFieldObjects")}hasJSActions(){return this.#a("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,i){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:i})}getDocJSActions(){return this.#a("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#a("GetOptionalContentConfig").then(i=>new Nv(i,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",i=this.#t.get(t);if(i)return i;const s=this.messageHandler.sendWithPromise(t,null).then(r=>({info:r[0],metadata:r[1]?new Dv(r[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const i of this.#e.values())if(!i.cleanup())throw new Error(`startCleanup: Page ${i.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),ze.cleanup()}}cachedPageNumber(t){if(!eh(t))return null;const i=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#i.get(i)??null}}class tA{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:i}=this.#t;return t.form||t.canvas&&i?.size>0}}class ra{#t=null;static#e=new WeakSet;constructor({callback:t,params:i,objs:s,commonObjs:r,annotationCanvasMap:l,operatorList:c,pageIndex:u,canvasFactory:h,filterFactory:f,useRequestAnimationFrame:p=!1,pdfBug:y=!1,pageColors:b=null,enableHWA:A=!1,operationsFilter:w=null}){this.callback=t,this.params=i,this.objs=s,this.commonObjs=r,this.annotationCanvasMap=l,this.operatorListIdx=null,this.operatorList=c,this._pageIndex=u,this.canvasFactory=h,this.filterFactory=f,this._pdfBug=y,this.pageColors=b,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new tA(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=i.canvas,this._canvasContext=i.canvas?null:i.canvasContext,this._enableHWA=A,this._dependencyTracker=i.dependencyTracker,this._operationsFilter=w}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:i}){if(this.cancelled)return;if(this._canvas){if(ra.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");ra.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:s,transform:r,background:l,dependencyTracker:c}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new ca(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:i},this.annotationCanvasMap,this.pageColors,c),this.gfx.beginDrawing({transform:r,viewport:s,transparency:t,background:l}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,i=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),ra.#e.delete(this._canvas),t||=new ch(`Rendering cancelled, page ${this._pageIndex+1}`,i),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),ra.#e.delete(this._canvas),this.callback())))}}const eA="5.4.394",iA="2cc809ade";class wi{#t=null;#e=null;#n;#i=null;#r=!1;#a=!1;#s=null;#o;#c=null;#l=null;static#d=null;static get _keyboardManager(){return wt(this,"_keyboardManager",new xr([[["Escape","mac+Escape"],wi.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],wi.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],wi.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],wi.prototype._moveToPrevious],[["Home","mac+Home"],wi.prototype._moveToBeginning],[["End","mac+End"],wi.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:i=null}){t?(this.#a=!1,this.#s=t):this.#a=!0,this.#l=t?._uiManager||i,this.#o=this.#l._eventBus,this.#n=t?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",wi.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#s&&(t.ariaControls=`${this.#s.id}_colorpicker_dropdown`);const i=this.#l._signal;t.addEventListener("click",this.#p.bind(this),{signal:i}),t.addEventListener("keydown",this.#m.bind(this),{signal:i});const s=this.#e=document.createElement("span");return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=this.#n,t.append(s),t}renderMainDropdown(){const t=this.#i=this.#h();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#h(){const t=document.createElement("div"),i=this.#l._signal;t.addEventListener("contextmenu",_i,{signal:i}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#s&&(t.id=`${this.#s.id}_colorpicker_dropdown`);for(const[s,r]of this.#l.highlightColors){const l=document.createElement("button");l.tabIndex="0",l.role="option",l.setAttribute("data-color",r),l.title=s,l.setAttribute("data-l10n-id",wi.#d[s]);const c=document.createElement("span");l.append(c),c.className="swatch",c.style.backgroundColor=r,l.ariaSelected=r===this.#n,l.addEventListener("click",this.#f.bind(this,r),{signal:i}),t.append(l)}return t.addEventListener("keydown",this.#m.bind(this),{signal:i}),t}#f(t,i){i.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:Nt.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#p(t);return}const i=t.target.getAttribute("data-color");i&&this.#f(i,t)}_moveToNext(t){if(!this.#g){this.#p(t);return}if(t.target===this.#t){this.#i.firstChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#i?.firstChild||t.target===this.#t){this.#g&&this._hideDropdownFromKeyboard();return}this.#g||this.#p(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#g){this.#p(t);return}this.#i.firstChild?.focus()}_moveToEnd(t){if(!this.#g){this.#p(t);return}this.#i.lastChild?.focus()}#m(t){wi._keyboardManager.exec(this,t)}#p(t){if(this.#g){this.hideDropdown();return}if(this.#r=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#i){this.#i.classList.remove("hidden");return}const i=this.#i=this.#h();this.#t.append(i)}#u(t){this.#i?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#g(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#a){if(!this.#g){this.#s?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#r})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#i)return;const i=this.#l.highlightColors.values();for(const s of this.#i.children)s.ariaSelected=i.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#i?.remove(),this.#i=null}}class vr{#t=null;#e=null;#n=null;static#i=null;constructor(t){this.#e=t,this.#n=t._uiManager,vr.#i||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:i,color:s}=this.#e,r=this.#t=document.createElement("input");return r.type="color",r.value=s||"#000000",r.className="basicColorPicker",r.tabIndex=0,r.setAttribute("data-l10n-id",vr.#i[t]),r.addEventListener("input",()=>{this.#n.updateParams(i,r.value)},{signal:this.#n._signal}),r}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function lm(m){return Math.floor(Math.max(0,Math.min(1,m))*255).toString(16).padStart(2,"0")}function cr(m){return Math.max(0,Math.min(255,255*m))}class cm{static CMYK_G([t,i,s,r]){return["G",1-Math.min(1,.3*t+.59*s+.11*i+r)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=cr(t),[t,t,t]}static G_HTML([t]){const i=lm(t);return`#${i}${i}${i}`}static RGB_G([t,i,s]){return["G",.3*t+.59*i+.11*s]}static RGB_rgb(t){return t.map(cr)}static RGB_HTML(t){return`#${t.map(lm).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,i,s,r]){return["RGB",1-Math.min(1,t+r),1-Math.min(1,s+r),1-Math.min(1,i+r)]}static CMYK_rgb([t,i,s,r]){return[cr(1-Math.min(1,t+r)),cr(1-Math.min(1,s+r)),cr(1-Math.min(1,i+r))]}static CMYK_HTML(t){const i=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(i)}static RGB_CMYK([t,i,s]){const r=1-t,l=1-i,c=1-s,u=Math.min(r,l,c);return["CMYK",r,l,c,u]}}class nA{create(t,i,s=!1){if(t<=0||i<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),s||(r.setAttribute("width",`${t}px`),r.setAttribute("height",`${i}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${t} ${i}`),r}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Vt("Abstract method `_createSVG` called.")}}class rl extends nA{_createSVG(t){return document.createElementNS(cn,t)}}const sA=9,us=new WeakSet,aA=new Date().getTimezoneOffset()*60*1e3;class Xu{static create(t){switch(t.data.annotationType){case fe.LINK:return new vh(t);case fe.TEXT:return new oA(t);case fe.WIDGET:switch(t.data.fieldType){case"Tx":return new lA(t);case"Btn":return t.data.radioButton?new Hm(t):t.data.checkBox?new uA(t):new hA(t);case"Ch":return new dA(t);case"Sig":return new cA(t)}return new ds(t);case fe.POPUP:return new sh(t);case fe.FREETEXT:return new Im(t);case fe.LINE:return new gA(t);case fe.SQUARE:return new pA(t);case fe.CIRCLE:return new mA(t);case fe.POLYLINE:return new Gm(t);case fe.CARET:return new bA(t);case fe.INK:return new Ah(t);case fe.POLYGON:return new yA(t);case fe.HIGHLIGHT:return new qm(t);case fe.UNDERLINE:return new vA(t);case fe.SQUIGGLY:return new AA(t);case fe.STRIKEOUT:return new SA(t);case fe.STAMP:return new Vm(t);case fe.FILEATTACHMENT:return new wA(t);default:return new te(t)}}}class te{#t=null;#e=!1;#n=null;constructor(t,{isRenderable:i=!1,ignoreBorder:s=!1,createQuadrilaterals:r=!1}={}){this.isRenderable=i,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,this.hasOwnCommentButton=!1,i&&(this.contentElement=this.container=this._createContainer(s)),r&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:i}){return!!(t?.str||i?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return te._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,i=this.annotationStorage?.getEditor(t.id);return i?i.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:i,inkLists:s,rect:r}=this.data;let l=-1/0,c=-1/0;if(i?.length>=8){for(let u=0;u<i.length;u+=8)i[u+1]>c?(c=i[u+1],l=i[u+2]):i[u+1]===c&&(l=Math.max(l,i[u+2]));return[l,c]}if(s?.length>=1){for(const u of s)for(let h=0,f=u.length;h<f;h+=2)u[h+1]>c?(c=u[h+1],l=u[h]):u[h+1]===c&&(l=Math.max(l,u[h]));if(l!==1/0)return[l,c]}return r?[r[2],r[3]]:null}_normalizePoint(t){const{page:{view:i},viewport:{rawDims:{pageWidth:s,pageHeight:r,pageX:l,pageY:c}}}=this.parent;return t[1]=i[3]-t[1]+i[1],t[0]=100*(t[0]-l)/s,t[1]=100*(t[1]-c)/r,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${pr}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:i}=this,s={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(i.id,{popup:s})||this.annotationStorage.setValue(`${pr}${i.id}`,{id:i.id,annotationType:i.annotationType,pageIndex:this.parent.page._pageIndex,popup:s,popupRef:i.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#n?.popup||this.popup)?.remove(),this.#n=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:i,popup:s}=t;i&&this.#i(i);let r=this.#n?.popup||this.popup;!r&&s?.text&&(this._createPopup(s),r=this.#n.popup),r&&(r.updateEdited(t),s?.deleted&&(r.remove(),this.#n=null,this.popup=null))}resetEdited(){this.#t&&(this.#i(this.#t.rect),this.#n?.popup.resetEdited(),this.#t=null)}#i(t){const{container:{style:i},data:{rect:s,rotation:r},parent:{viewport:{rawDims:{pageWidth:l,pageHeight:c,pageX:u,pageY:h}}}}=this;s?.splice(0,4,...t),i.left=`${100*(t[0]-u)/l}%`,i.top=`${100*(c-t[3]+h)/c}%`,r===0?(i.width=`${100*(t[2]-t[0])/l}%`,i.height=`${100*(t[3]-t[1])/c}%`):this.setRotation(r)}_createContainer(t){const{data:i,parent:{page:s,viewport:r}}=this,l=document.createElement("section");l.setAttribute("data-annotation-id",i.id),!(this instanceof ds)&&!(this instanceof vh)&&(l.tabIndex=0);const{style:c}=l;if(c.zIndex=this.parent.zIndex,this.parent.zIndex+=2,i.alternativeText&&(l.title=i.alternativeText),i.noRotate&&l.classList.add("norotate"),!i.rect||this instanceof sh){const{rotation:S}=i;return!i.hasOwnCanvas&&S!==0&&this.setRotation(S,l),l}const{width:u,height:h}=this;if(!t&&i.borderStyle.width>0){c.borderWidth=`${i.borderStyle.width}px`;const S=i.borderStyle.horizontalCornerRadius,E=i.borderStyle.verticalCornerRadius;if(S>0||E>0){const C=`calc(${S}px * var(--total-scale-factor)) / calc(${E}px * var(--total-scale-factor))`;c.borderRadius=C}else if(this instanceof Hm){const C=`calc(${u}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;c.borderRadius=C}switch(i.borderStyle.style){case ea.SOLID:c.borderStyle="solid";break;case ea.DASHED:c.borderStyle="dashed";break;case ea.BEVELED:bt("Unimplemented border style: beveled");break;case ea.INSET:bt("Unimplemented border style: inset");break;case ea.UNDERLINE:c.borderBottomStyle="solid";break}const x=i.borderColor||null;x?(this.#e=!0,c.borderColor=st.makeHexColor(x[0]|0,x[1]|0,x[2]|0)):c.borderWidth=0}const f=st.normalizeRect([i.rect[0],s.view[3]-i.rect[1]+s.view[1],i.rect[2],s.view[3]-i.rect[3]+s.view[1]]),{pageWidth:p,pageHeight:y,pageX:b,pageY:A}=r.rawDims;c.left=`${100*(f[0]-b)/p}%`,c.top=`${100*(f[1]-A)/y}%`;const{rotation:w}=i;return i.hasOwnCanvas||w===0?(c.width=`${100*u/p}%`,c.height=`${100*h/y}%`):this.setRotation(w,l),l}setRotation(t,i=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:r}=this.parent.viewport.rawDims;let{width:l,height:c}=this;t%180!==0&&([l,c]=[c,l]),i.style.width=`${100*l/s}%`,i.style.height=`${100*c/r}%`,i.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(i,s,r)=>{const l=r.detail[i],c=l[0],u=l.slice(1);r.target.style[s]=cm[`${c}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[s]:cm[`${c}_rgb`](u)})};return wt(this,"_commonActions",{display:i=>{const{display:s}=i.detail,r=s%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:s===1||s===2})},print:i=>{this.annotationStorage.setValue(this.data.id,{noPrint:!i.detail.print})},hidden:i=>{const{hidden:s}=i.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:i=>{setTimeout(()=>i.target.focus({preventScroll:!1}),0)},userName:i=>{i.target.title=i.detail.userName},readonly:i=>{i.target.disabled=i.detail.readonly},required:i=>{this._setRequired(i.target,i.detail.required)},bgColor:i=>{t("bgColor","backgroundColor",i)},fillColor:i=>{t("fillColor","backgroundColor",i)},fgColor:i=>{t("fgColor","color",i)},textColor:i=>{t("textColor","color",i)},borderColor:i=>{t("borderColor","borderColor",i)},strokeColor:i=>{t("strokeColor","borderColor",i)},rotation:i=>{const s=i.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(t,i){const s=this._commonActions;for(const r of Object.keys(i.detail))(t[r]||s[r])?.(i)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const i=this.annotationStorage.getRawValue(this.data.id);if(!i)return;const s=this._commonActions;for(const[r,l]of Object.entries(i)){const c=s[r];if(c){const u={detail:{[r]:l},target:t};c(u),delete i[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[i,s,r,l]=this.data.rect.map(S=>Math.fround(S));if(t.length===8){const[S,E,x,C]=t.subarray(2,6);if(r===S&&l===E&&i===x&&s===C)return}const{style:c}=this.container;let u;if(this.#e){const{borderColor:S,borderWidth:E}=c;c.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${S}" stroke-width="${E}">`],this.container.classList.add("hasBorder")}const h=r-i,f=l-s,{svgFactory:p}=this,y=p.createElement("svg");y.classList.add("quadrilateralsContainer"),y.setAttribute("width",0),y.setAttribute("height",0),y.role="none";const b=p.createElement("defs");y.append(b);const A=p.createElement("clipPath"),w=`clippath_${this.data.id}`;A.setAttribute("id",w),A.setAttribute("clipPathUnits","objectBoundingBox"),b.append(A);for(let S=2,E=t.length;S<E;S+=8){const x=t[S],C=t[S+1],T=t[S+2],B=t[S+3],O=p.createElement("rect"),L=(T-i)/h,P=(l-C)/f,G=(x-T)/h,Q=(C-B)/f;O.setAttribute("x",L),O.setAttribute("y",P),O.setAttribute("width",G),O.setAttribute("height",Q),A.append(O),u?.push(`<rect vector-effect="non-scaling-stroke" x="${L}" y="${P}" width="${G}" height="${Q}"/>`)}this.#e&&(u.push("</g></svg>')"),c.backgroundImage=u.join("")),this.container.append(y),this.container.style.clipPath=`url(#${w})`}_createPopup(t=null){const{data:i}=this;let s,r;t?(s={str:t.text},r=t.date):(s=i.contentsObj,r=i.modificationDate),this.#n=new sh({data:{color:i.color,titleObj:i.titleObj,modificationDate:r,contentsObj:s,richText:i.richText,parentRect:i.rect,borderStyle:0,id:`popup_${i.id}`,rotation:i.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#n||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#n}render(){Vt("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,i=null){const s=[];if(this._fieldObjects){const r=this._fieldObjects[t];if(r)for(const{page:l,id:c,exportValues:u}of r){if(l===-1||c===i)continue;const h=typeof u=="string"?u:null,f=document.querySelector(`[data-element-id="${c}"]`);if(f&&!us.has(f)){bt(`_getElementsByName - element not allowed: ${c}`);continue}s.push({id:c,exportValue:h,domElement:f})}return s}for(const r of document.getElementsByName(t)){const{exportValue:l}=r,c=r.getAttribute("data-element-id");c!==i&&us.has(r)&&s.push({id:c,exportValue:l,domElement:r})}return s}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const i of t)i.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:i}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:i,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class rA extends te{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&this._createPopup(t.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class vh extends te{constructor(t,i=null){super(t,{isRenderable:!0,ignoreBorder:!!i?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:i}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let r=!1;return t.url?(i.addLinkAttributes(s,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(s,t.action,t.overlaidText),r=!0):t.attachment?(this.#e(s,t.attachment,t.overlaidText,t.attachmentDest),r=!0):t.setOCGState?(this.#n(s,t.setOCGState,t.overlaidText),r=!0):t.dest?(this._bindLink(s,t.dest,t.overlaidText),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),r=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(s,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&(this.contentElement=s,this.container.append(s)),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,i,s=""){t.href=this.linkService.getDestinationHash(i),t.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&this.#t(),s&&(t.title=s)}_bindNamedAction(t,i,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(i),!1),s&&(t.title=s),this.#t()}#e(t,i,s="",r=null){t.href=this.linkService.getAnchorUrl(""),i.description?t.title=i.description:s&&(t.title=s),t.onclick=()=>(this.downloadManager?.openOrDownloadData(i.content,i.filename,r),!1),this.#t()}#n(t,i,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(i),!1),s&&(t.title=s),this.#t()}_bindJSAction(t,i){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(i.actions)){const l=s.get(r);l&&(t[l]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:r}}),!1))}i.overlaidText&&(t.title=i.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,i){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){bt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{s?.();const{fields:r,refs:l,include:c}=i,u=[];if(r.length!==0||l.length!==0){const p=new Set(l);for(const y of r){const b=this._fieldObjects[y]||[];for(const{id:A}of b)p.add(A)}for(const y of Object.values(this._fieldObjects))for(const b of y)p.has(b.id)===c&&u.push(b)}else for(const p of Object.values(this._fieldObjects))u.push(...p);const h=this.annotationStorage,f=[];for(const p of u){const{id:y}=p;switch(f.push(y),p.type){case"text":{const A=p.defaultValue||"";h.setValue(y,{value:A});break}case"checkbox":case"radiobutton":{const A=p.defaultValue===p.exportValues;h.setValue(y,{value:A});break}case"combobox":case"listbox":{const A=p.defaultValue||"";h.setValue(y,{value:A});break}default:continue}const b=document.querySelector(`[data-element-id="${y}"]`);if(b){if(!us.has(b)){bt(`_bindResetFormAction - element not allowed: ${y}`);continue}}else continue;b.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class oA extends te{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(t),this.container}}class ds extends te{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return De.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,i,s,r,l){s.includes("mouse")?t.addEventListener(s,c=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:l(c),shift:c.shiftKey,modifier:this._getKeyModifier(c)}})}):t.addEventListener(s,c=>{if(s==="blur"){if(!i.focused||!c.relatedTarget)return;i.focused=!1}else if(s==="focus"){if(i.focused)return;i.focused=!0}l&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:l(c)}})})}_setEventListeners(t,i,s,r){for(const[l,c]of s)(c==="Action"||this.data.actions?.[c])&&((c==="Focus"||c==="Blur")&&(i||={focused:!1}),this._setEventListener(t,i,l,c,r),c==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,i,"blur","Blur",null):c==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,i,"focus","Focus",null))}_setBackgroundColor(t){const i=this.data.backgroundColor||null;t.style.backgroundColor=i===null?"transparent":st.makeHexColor(i[0],i[1],i[2])}_setTextStyle(t){const i=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||sA,l=t.style;let c;const u=2,h=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u),p=Math.round(f/(Uu*r))||1,y=f/p;c=Math.min(r,h(y/Uu))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u);c=Math.min(r,h(f/Uu))}l.fontSize=`calc(${c}px * var(--total-scale-factor))`,l.color=st.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(l.textAlign=i[this.data.textAlignment])}_setRequired(t,i){i?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",i)}}class lA extends ds{constructor(t){const i=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:i})}setPropertyOnSiblings(t,i,s,r){const l=this.annotationStorage;for(const c of this._getElementsByName(t.name,t.id))c.domElement&&(c.domElement[i]=s),l.setValue(c.id,{[r]:s})}render(){const t=this.annotationStorage,i=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const r=t.getValue(i,{value:this.data.fieldValue});let l=r.value||"";const c=t.getValue(i,{charLimit:this.data.maxLen}).charLimit;c&&l.length>c&&(l=l.slice(0,c));let u=r.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:l,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??l,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",u??l),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),us.add(s),this.contentElement=s,s.setAttribute("data-element-id",i),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const{datetimeFormat:f,datetimeType:p,timeStep:y}=this.data,b=!!p&&this.enableScripting;f&&(s.title=f),this._setRequired(s,this.data.required),c&&(s.maxLength=c),s.addEventListener("input",w=>{t.setValue(i,{value:w.target.value}),this.setPropertyOnSiblings(s,"value",w.target.value,"value"),h.formattedValue=null}),s.addEventListener("resetform",w=>{const S=this.data.defaultFieldValue??"";s.value=h.userValue=S,h.formattedValue=null});let A=w=>{const{formattedValue:S}=h;S!=null&&(w.target.value=S),w.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",S=>{if(h.focused)return;const{target:E}=S;if(b&&(E.type=p,y&&(E.step=y)),h.userValue){const x=h.userValue;if(b)if(p==="time"){const C=new Date(x),T=[C.getHours(),C.getMinutes(),C.getSeconds()];E.value=T.map(B=>B.toString().padStart(2,"0")).join(":")}else E.value=new Date(x-aA).toISOString().split(p==="date"?"T":".",1)[0];else E.value=x}h.lastCommittedValue=E.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),s.addEventListener("updatefromsandbox",S=>{this.showElementAndHideCanvas(S.target);const E={value(x){h.userValue=x.detail.value??"",b||t.setValue(i,{value:h.userValue.toString()}),x.target.value=h.userValue},formattedValue(x){const{formattedValue:C}=x.detail;h.formattedValue=C,C!=null&&x.target!==document.activeElement&&(x.target.value=C);const T={formattedValue:C};b&&(T.value=C),t.setValue(i,T)},selRange(x){x.target.setSelectionRange(...x.detail.selRange)},charLimit:x=>{const{charLimit:C}=x.detail,{target:T}=x;if(C===0){T.removeAttribute("maxLength");return}T.setAttribute("maxLength",C);let B=h.userValue;!B||B.length<=C||(B=B.slice(0,C),T.value=h.userValue=B,t.setValue(i,{value:B}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:B,willCommit:!0,commitKey:1,selStart:T.selectionStart,selEnd:T.selectionEnd}}))}};this._dispatchEventFromSandbox(E,S)}),s.addEventListener("keydown",S=>{h.commitKey=1;let E=-1;if(S.key==="Escape"?E=0:S.key==="Enter"&&!this.data.multiLine?E=2:S.key==="Tab"&&(h.commitKey=3),E===-1)return;const{value:x}=S.target;h.lastCommittedValue!==x&&(h.lastCommittedValue=x,h.userValue=x,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:x,willCommit:!0,commitKey:E,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}))});const w=A;A=null,s.addEventListener("blur",S=>{if(!h.focused||!S.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{target:E}=S;let{value:x}=E;if(b){if(x&&p==="time"){const C=x.split(":").map(T=>parseInt(T,10));x=new Date(2e3,0,1,C[0],C[1],C[2]||0).valueOf(),E.step=""}else x.includes("T")||(x=`${x}T00:00`),x=new Date(x).valueOf();E.type="text"}h.userValue=x,h.lastCommittedValue!==x&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:x,willCommit:!0,commitKey:h.commitKey,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}),w(S)}),this.data.actions?.Keystroke&&s.addEventListener("beforeinput",S=>{h.lastCommittedValue=null;const{data:E,target:x}=S,{value:C,selectionStart:T,selectionEnd:B}=x;let O=T,L=B;switch(S.inputType){case"deleteWordBackward":{const P=C.substring(0,T).match(/\w*[^\w]*$/);P&&(O-=P[0].length);break}case"deleteWordForward":{const P=C.substring(T).match(/^[^\w]*\w*/);P&&(L+=P[0].length);break}case"deleteContentBackward":T===B&&(O-=1);break;case"deleteContentForward":T===B&&(L+=1);break}S.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:C,change:E||"",willCommit:!1,selStart:O,selEnd:L}})}),this._setEventListeners(s,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],S=>S.target.value)}if(A&&s.addEventListener("blur",A),this.data.comb){const S=(this.data.rect[2]-this.data.rect[0])/c;s.classList.add("comb"),s.style.letterSpacing=`calc(${S}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class cA extends ds{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class uA extends ds{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,i=this.data,s=i.id;let r=t.getValue(s,{value:i.exportValue===i.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",t.setValue(s,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const l=document.createElement("input");return us.add(l),l.setAttribute("data-element-id",s),l.disabled=i.readOnly,this._setRequired(l,this.data.required),l.type="checkbox",l.name=i.fieldName,r&&l.setAttribute("checked",!0),l.setAttribute("exportValue",i.exportValue),l.tabIndex=0,l.addEventListener("change",c=>{const{name:u,checked:h}=c.target;for(const f of this._getElementsByName(u,s)){const p=h&&f.exportValue===i.exportValue;f.domElement&&(f.domElement.checked=p),t.setValue(f.id,{value:p})}t.setValue(s,{value:h})}),l.addEventListener("resetform",c=>{const u=i.defaultFieldValue||"Off";c.target.checked=u===i.exportValue}),this.enableScripting&&this.hasJSActions&&(l.addEventListener("updatefromsandbox",c=>{const u={value(h){h.target.checked=h.detail.value!=="Off",t.setValue(s,{value:h.target.checked})}};this._dispatchEventFromSandbox(u,c)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)),this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class Hm extends ds{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,i=this.data,s=i.id;let r=t.getValue(s,{value:i.fieldValue===i.buttonValue}).value;if(typeof r=="string"&&(r=r!==i.buttonValue,t.setValue(s,{value:r})),r)for(const c of this._getElementsByName(i.fieldName,s))t.setValue(c.id,{value:!1});const l=document.createElement("input");if(us.add(l),l.setAttribute("data-element-id",s),l.disabled=i.readOnly,this._setRequired(l,this.data.required),l.type="radio",l.name=i.fieldName,r&&l.setAttribute("checked",!0),l.tabIndex=0,l.addEventListener("change",c=>{const{name:u,checked:h}=c.target;for(const f of this._getElementsByName(u,s))t.setValue(f.id,{value:!1});t.setValue(s,{value:h})}),l.addEventListener("resetform",c=>{const u=i.defaultFieldValue;c.target.checked=u!=null&&u===i.buttonValue}),this.enableScripting&&this.hasJSActions){const c=i.buttonValue;l.addEventListener("updatefromsandbox",u=>{const h={value:f=>{const p=c===f.detail.value;for(const y of this._getElementsByName(f.target.name)){const b=p&&y.id===s;y.domElement&&(y.domElement.checked=b),t.setValue(y.id,{value:b})}}};this._dispatchEventFromSandbox(h,u)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class hA extends vh{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const i=t.lastChild;return this.enableScripting&&this.hasJSActions&&i&&(this._setDefaultPropertiesFromJS(i),i.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),t}}class dA extends ds{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,i=this.data.id,s=t.getValue(i,{value:this.data.fieldValue}),r=document.createElement("select");us.add(r),r.setAttribute("data-element-id",i),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=0;let l=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",p=>{const y=this.data.defaultFieldValue;for(const b of r.options)b.selected=b.value===y});for(const p of this.data.options){const y=document.createElement("option");y.textContent=p.displayValue,y.value=p.exportValue,s.value.includes(p.exportValue)&&(y.setAttribute("selected",!0),l=!1),r.append(y)}let c=null;if(l){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),r.prepend(p),c=()=>{p.remove(),r.removeEventListener("input",c),c=null},r.addEventListener("input",c)}const u=p=>{const y=p?"value":"textContent",{options:b,multiple:A}=r;return A?Array.prototype.filter.call(b,w=>w.selected).map(w=>w[y]):b.selectedIndex===-1?null:b[b.selectedIndex][y]};let h=u(!1);const f=p=>{const y=p.target.options;return Array.prototype.map.call(y,b=>({displayValue:b.textContent,exportValue:b.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",p=>{const y={value(b){c?.();const A=b.detail.value,w=new Set(Array.isArray(A)?A:[A]);for(const S of r.options)S.selected=w.has(S.value);t.setValue(i,{value:u(!0)}),h=u(!1)},multipleSelection(b){r.multiple=!0},remove(b){const A=r.options,w=b.detail.remove;A[w].selected=!1,r.remove(w),A.length>0&&Array.prototype.findIndex.call(A,E=>E.selected)===-1&&(A[0].selected=!0),t.setValue(i,{value:u(!0),items:f(b)}),h=u(!1)},clear(b){for(;r.length!==0;)r.remove(0);t.setValue(i,{value:null,items:[]}),h=u(!1)},insert(b){const{index:A,displayValue:w,exportValue:S}=b.detail.insert,E=r.children[A],x=document.createElement("option");x.textContent=w,x.value=S,E?E.before(x):r.append(x),t.setValue(i,{value:u(!0),items:f(b)}),h=u(!1)},items(b){const{items:A}=b.detail;for(;r.length!==0;)r.remove(0);for(const w of A){const{displayValue:S,exportValue:E}=w,x=document.createElement("option");x.textContent=S,x.value=E,r.append(x)}r.options.length>0&&(r.options[0].selected=!0),t.setValue(i,{value:u(!0),items:f(b)}),h=u(!1)},indices(b){const A=new Set(b.detail.indices);for(const w of b.target.options)w.selected=A.has(w.index);t.setValue(i,{value:u(!0)}),h=u(!1)},editable(b){b.target.disabled=!b.detail.editable}};this._dispatchEventFromSandbox(y,p)}),r.addEventListener("input",p=>{const y=u(!0),b=u(!1);t.setValue(i,{value:y}),p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:h,change:b,changeEx:y,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):r.addEventListener("input",function(p){t.setValue(i,{value:u(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class sh extends te{constructor(t){const{data:i,elements:s,parent:r}=t,l=!!r._commentManager;if(super(t,{isRenderable:!l&&te._hasPopupData(i)}),this.elements=s,l&&te._hasPopupData(i)){const c=this.popup=this.#t();for(const u of s)u.popup=c}else this.popup=null}#t(){return new fA({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const i=this.popup=this.#t(),s=[];for(const r of this.elements)r.popup=i,r.container.ariaHasPopup="dialog",s.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(r=>`${sa}${r}`).join(",")),this.container}}class fA{#t=null;#e=this.#q.bind(this);#n=this.#F.bind(this);#i=this.#L.bind(this);#r=this.#w.bind(this);#a=null;#s=null;#o=null;#c=null;#l=null;#d=null;#h=null;#f=!1;#m=null;#p=null;#u=null;#g=null;#y=null;#v=null;#b=null;#E=null;#_=null;#S=null;#C=!1;#A=null;#x=null;constructor({container:t,color:i,elements:s,titleObj:r,modificationDate:l,contentsObj:c,richText:u,parent:h,rect:f,parentRect:p,open:y,commentManager:b=null}){this.#s=t,this.#_=r,this.#o=c,this.#E=u,this.#d=h,this.#a=i,this.#b=f,this.#h=p,this.#l=s,this.#t=b,this.#A=s[0],this.#c=Zu.toDateObject(l),this.trigger=s.flatMap(A=>A.getElementsToTriggerPopup()),b||(this.#R(),this.#s.hidden=!0,y&&this.#w())}#R(){if(this.#p)return;this.#p=new AbortController;const{signal:t}=this.#p;for(const i of this.trigger)i.addEventListener("click",this.#r,{signal:t}),i.addEventListener("pointerenter",this.#i,{signal:t}),i.addEventListener("pointerleave",this.#n,{signal:t}),i.classList.add("popupTriggerArea");for(const i of this.#l)i.container?.addEventListener("keydown",this.#e,{signal:t})}#M(){const t=this.#l.find(i=>i.hasCommentButton);t&&(this.#y=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#g){this.#g.parentNode||this.#A.container.after(this.#g);return}if(this.#y||this.#M(),!this.#y)return;const{signal:t}=this.#p=new AbortController,i=this.#A.hasOwnCommentButton,s=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!i)},r=()=>{this.#t.toggleCommentPopup(this,!1,!0,!i)},l=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(i){this.#g=this.#A.container;for(const c of this.trigger)c.ariaHasPopup="dialog",c.ariaControls="commentPopup",c.addEventListener("keydown",this.#e,{signal:t}),c.addEventListener("click",s,{signal:t}),c.addEventListener("pointerenter",r,{signal:t}),c.addEventListener("pointerleave",l,{signal:t}),c.classList.add("popupTriggerArea")}else{const c=this.#g=document.createElement("button");c.className="annotationCommentButton";const u=this.#A.container;c.style.zIndex=u.style.zIndex+1,c.tabIndex=0,c.ariaHasPopup="dialog",c.ariaControls="commentPopup",c.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#P(),this.#D(),c.addEventListener("keydown",this.#e,{signal:t}),c.addEventListener("click",s,{signal:t}),c.addEventListener("pointerenter",r,{signal:t}),c.addEventListener("pointerleave",l,{signal:t}),u.after(c)}}#D(){if(this.#A.extraPopupElement&&!this.#A.editor)return;this.#g||this.renderCommentButton();const[t,i]=this.#y,{style:s}=this.#g;s.left=`calc(${t}%)`,s.top=`calc(${i}% - var(--comment-button-dim))`}#P(){this.#A.extraPopupElement||(this.#g||this.renderCommentButton(),this.#g.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:i}=this.#A.commentData;return t?this.#d._commentManager.makeCommentColor(t,i):null}focusCommentButton(){setTimeout(()=>{this.#g?.focus()},0)}getData(){const{richText:t,color:i,opacity:s,creationDate:r,modificationDate:l}=this.#A.commentData;return{contentsObj:{str:this.comment},richText:t,color:i,opacity:s,creationDate:r,modificationDate:l}}get elementBeforePopup(){return this.#g}get comment(){return this.#x||=this.#A.commentText,this.#x}set comment(t){t!==this.comment&&(this.#A.commentText=this.#x=t)}focus(){this.#A.container?.focus()}get parentBoundingClientRect(){return this.#A.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:i}){this.#g&&(this.#g.classList.toggle("selected",t),this.#g.ariaExpanded=i)}setSelectedCommentButton(t){this.#g.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#v)return this.#v;const{x:t,y:i,height:s}=this.#g.getBoundingClientRect(),{x:r,y:l,width:c,height:u}=this.#A.layer.getBoundingClientRect();return[(t-r)/c,(i+s-l)/u]}set commentPopupPosition(t){this.#v=t}hasDefaultPopupPosition(){return this.#v===null}get commentButtonPosition(){return this.#y}get commentButtonWidth(){return this.#g.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[i,s]=this.#v||this.commentButtonPosition.map(f=>f/100),r=this.parentBoundingClientRect,{x:l,y:c,width:u,height:h}=r;this.#t.showDialog(null,this,l+i*u,c+s*h,{...t,parentDimensions:r})}render(){if(this.#m)return;const t=this.#m=document.createElement("div");if(t.className="popup",this.#a){const s=t.style.outlineColor=st.makeHexColor(...this.#a);t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const i=document.createElement("span");if(i.className="header",this.#_?.str){const s=document.createElement("span");s.className="title",i.append(s),{dir:s.dir,str:s.textContent}=this.#_}if(t.append(i),this.#c){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),s.dateTime=this.#c.toISOString(),i.append(s)}Sm({html:this.#O||this.#o.str,dir:this.#o?.dir,className:"popupContent"},t),this.#s.append(t)}get#O(){const t=this.#E,i=this.#o;return t?.str&&(!i?.str||i.str===t.str)&&this.#E.html||null}get#k(){return this.#O?.attributes?.style?.fontSize||0}get#U(){return this.#O?.attributes?.style?.color||null}#B(t){const i=[],s={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:i}]}},r={style:{color:this.#U,fontSize:this.#k?`calc(${this.#k}px * var(--total-scale-factor))`:""}};for(const l of t.split(`
`))i.push({name:"span",value:l,attributes:r});return s}#q(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#w()}updateEdited({rect:t,popup:i,deleted:s}){if(this.#t){s?(this.remove(),this.#x=null):i&&(i.deleted?this.remove():(this.#P(),this.#x=i.text)),t&&(this.#y=null,this.#M(),this.#D());return}if(s||i?.deleted){this.remove();return}this.#R(),this.#S||={contentsObj:this.#o,richText:this.#E},t&&(this.#u=null),i&&i.text&&(this.#E=this.#B(i.text),this.#c=Zu.toDateObject(i.date),this.#o=null),this.#m?.remove(),this.#m=null}resetEdited(){this.#S&&({contentsObj:this.#o,richText:this.#E}=this.#S,this.#S=null,this.#m?.remove(),this.#m=null,this.#u=null)}remove(){if(this.#p?.abort(),this.#p=null,this.#m?.remove(),this.#m=null,this.#C=!1,this.#f=!1,this.#g?.remove(),this.#g=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#T(){if(this.#u!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:i,pageHeight:s,pageX:r,pageY:l}}}=this.#d;let c=!!this.#h,u=c?this.#h:this.#b;for(const w of this.#l)if(!u||st.intersect(w.data.rect,u)!==null){u=w.data.rect,c=!0;break}const h=st.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),p=c?u[2]-u[0]+5:0,y=h[0]+p,b=h[1];this.#u=[100*(y-r)/i,100*(b-l)/s];const{style:A}=this.#s;A.left=`${this.#u[0]}%`,A.top=`${this.#u[1]}%`}#w(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#L(),this.#s.addEventListener("click",this.#r),this.#s.addEventListener("keydown",this.#e)):(this.#F(),this.#s.removeEventListener("click",this.#r),this.#s.removeEventListener("keydown",this.#e))}#L(){this.#m||this.render(),this.isVisible?this.#f&&this.#s.classList.add("focused"):(this.#T(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#F(){this.#s.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#C=this.isVisible,this.#C&&(this.#s.hidden=!0)}maybeShow(){this.#t||(this.#R(),this.#C&&(this.#m||this.#L(),this.#C=!1,this.#s.hidden=!1))}get isVisible(){return this.#t?!1:this.#s.hidden===!1}}class Im extends te{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=At.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=this.contentElement=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const i of this.textContent){const s=document.createElement("span");s.textContent=i,t.append(s)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class gA extends te{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),l=this.#t=this.svgFactory.createElement("svg:line");return l.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),l.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),l.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),l.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),l.setAttribute("stroke-width",t.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class pA extends te{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),l=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:rect");return c.setAttribute("x",l/2),c.setAttribute("y",l/2),c.setAttribute("width",i-l),c.setAttribute("height",s-l),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),r.append(c),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class mA extends te{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),l=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:ellipse");return c.setAttribute("cx",i/2),c.setAttribute("cy",s/2),c.setAttribute("rx",i/2-l/2),c.setAttribute("ry",s/2-l/2),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),r.append(c),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Gm extends te{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:i,borderStyle:s,popupRef:r},width:l,height:c}=this;if(!i)return this.container;const u=this.svgFactory.create(l,c,!0);let h=[];for(let p=0,y=i.length;p<y;p+=2){const b=i[p]-t[0],A=t[3]-i[p+1];h.push(`${b},${A}`)}h=h.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",h),f.setAttribute("stroke-width",s.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),u.append(f),this.container.append(u),!r&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class yA extends Gm{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class bA extends te{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class Ah extends te{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?At.HIGHLIGHT:At.INK}#n(t,i){switch(t){case 90:return{transform:`rotate(90) translate(${-i[0]},${i[1]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};case 180:return{transform:`rotate(180) translate(${-i[2]},${i[1]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]};case 270:return{transform:`rotate(270) translate(${-i[2]},${i[3]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};default:return{transform:`translate(${-i[0]},${i[3]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:i,inkLists:s,borderStyle:r,popupRef:l}}=this,{transform:c,width:u,height:h}=this.#n(i,t),f=this.svgFactory.create(u,h,!0),p=this.#t=this.svgFactory.createElement("svg:g");f.append(p),p.setAttribute("stroke-width",r.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",c);for(let y=0,b=s.length;y<b;y++){const A=this.svgFactory.createElement(this.svgElementName);this.#e.push(A),A.setAttribute("points",s[y].join(",")),p.append(A)}return!l&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:i,points:s,rect:r}=t,l=this.#t;if(i>=0&&l.setAttribute("stroke-width",i||1),s)for(let c=0,u=this.#e.length;c<u;c++)this.#e[c].setAttribute("points",s[c].join(","));if(r){const{transform:c,width:u,height:h}=this.#n(this.data.rotation,r);l.parentElement.setAttribute("viewBox",`0 0 ${u} ${h}`),l.setAttribute("transform",c)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class qm extends te{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=At.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class vA extends te{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class AA extends te{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class SA extends te{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),t){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class Vm extends te{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=At.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class wA extends te{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:i}=this.data;this.filename=i.filename,this.content=i.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:i}=this;let s;i.hasAppearance||i.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),s.addEventListener("dblclick",this.#e.bind(this)),this.#t=s;const{isMac:r}=De.platform;return t.addEventListener("keydown",l=>{l.key==="Enter"&&(r?l.metaKey:l.ctrlKey)&&this.#e()}),!i.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Sh{#t=null;#e=null;#n=null;#i=new Map;#r=null;#a=null;#s=[];#o=!1;constructor({div:t,accessibilityManager:i,annotationCanvasMap:s,annotationEditorUIManager:r,page:l,viewport:c,structTreeLayer:u,commentManager:h,linkService:f,annotationStorage:p}){this.div=t,this.#t=i,this.#e=s,this.#r=u||null,this.#a=f||null,this.#n=p||new fh,this.page=l,this.viewport=c,this.zIndex=0,this._annotationEditorUIManager=r,this._commentManager=h||null}hasEditableAnnotations(){return this.#i.size>0}async render(t){const{annotations:i}=t,s=this.div;cs(s,this.viewport);const r=new Map,l=[],c={data:null,layer:s,linkService:this.#a,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new rl,annotationStorage:this.#n,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const u of i){if(u.noHTML)continue;const h=u.annotationType===fe.POPUP;if(h){const y=r.get(u.id);if(!y)continue;if(!this._commentManager){l.push(u);continue}c.elements=y}else if(u.rect[2]===u.rect[0]||u.rect[3]===u.rect[1])continue;c.data=u;const f=Xu.create(c);if(!f.isRenderable)continue;if(!h&&(this.#s.push(f),u.popupRef)){const y=r.get(u.popupRef);y?y.push(f):r.set(u.popupRef,[f])}const p=f.render();u.hidden&&(p.style.visibility="hidden"),f._isEditable&&(this.#i.set(f.data.id,f),this._annotationEditorUIManager?.renderAnnotationElement(f))}await this.#c();for(const u of l){const h=c.elements=r.get(u.id);c.data=u;const f=Xu.create(c);if(!f.isRenderable)continue;const p=f.render();f.contentElement.id=`${sa}${u.id}`,u.hidden&&(p.style.visibility="hidden"),h.at(-1).container.after(p)}this.#l()}async#c(){if(this.#s.length===0)return;this.div.replaceChildren();const t=[];if(!this.#o){this.#o=!0;for(const{contentElement:s,data:{id:r}}of this.#s){const l=s.id=`${sa}${r}`;t.push(this.#r?.getAriaAttributes(l).then(c=>{if(c)for(const[u,h]of c)s.setAttribute(u,h)}))}}this.#s.sort(({data:{rect:[s,r,l,c]}},{data:{rect:[u,h,f,p]}})=>{if(s===l&&r===c)return 1;if(u===f&&h===p)return-1;const y=c,b=r,A=(r+c)/2,w=p,S=h,E=(h+p)/2;if(A>=w&&E<=b)return-1;if(E>=y&&A<=S)return 1;const x=(s+l)/2,C=(u+f)/2;return x-C});const i=document.createDocumentFragment();for(const s of this.#s)i.append(s.container),this._commentManager?(s.extraPopupElement?.popup||s.popup)?.renderCommentButton():s.extraPopupElement&&i.append(s.extraPopupElement.render());if(this.div.append(i),await Promise.all(t),this.#t)for(const s of this.#s)this.#t.addPointerInTextLayer(s.contentElement,!1)}async addLinkAnnotations(t){const i={data:null,layer:this.div,linkService:this.#a,svgFactory:new rl,parent:this};for(const s of t){s.borderStyle||=Sh._defaultBorderStyle,i.data=s;const r=Xu.create(i);r.isRenderable&&(r.render(),r.contentElement.id=`${sa}${s.id}`,this.#s.push(r))}await this.#c()}update({viewport:t}){const i=this.div;this.viewport=t,cs(i,{rotation:t.rotation}),this.#l(),i.hidden=!1}#l(){if(!this.#e)return;const t=this.div;for(const[i,s]of this.#e){const r=t.querySelector(`[data-annotation-id="${i}"]`);if(!r)continue;s.className="annotationContent";const{firstChild:l}=r;l?l.nodeName==="CANVAS"?l.replaceWith(s):l.classList.contains("annotationContent")?l.after(s):l.before(s):r.append(s);const c=this.#i.get(i);c&&(c._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(i,r.id,s),c._hasNoCanvas=!1):c.canvas=s)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#i.values())}getEditableAnnotation(t){return this.#i.get(t)}addFakeAnnotation(t){const{div:i}=this,{id:s,rotation:r}=t,l=new rA({data:{id:s,rect:t.getPDFRect(),rotation:r},editor:t,layer:i,parent:this,enableComment:!!this._commentManager,linkService:this.#a,annotationStorage:this.#n});return l.render(),l.contentElement.id=`${sa}${s}`,l.createOrUpdatePopup(),this.#s.push(l),l}removeAnnotation(t){const i=this.#s.findIndex(r=>r.data.id===t);if(i<0)return;const[s]=this.#s.splice(i,1);this.#t?.removePointerInTextLayer(s.contentElement)}updateFakeAnnotations(t){if(t.length!==0){for(const i of t)i.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}static get _defaultBorderStyle(){return wt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:ea.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const Jo=/\r\n?|\n/g;class ve extends ct{#t="";#e=`${this.id}-editor`;#n=null;#i;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=ve.prototype,i=l=>l.isEmpty(),s=Fn.TRANSLATE_SMALL,r=Fn.TRANSLATE_BIG;return wt(this,"_keyboardManager",new xr([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:i}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:i}]]))}static _type="freetext";static _editorType=At.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||ve._defaultColor||ct._defaultLineColor,this.#i=t.fontSize||ve._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(t,i){ct.initialize(t,i);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,i){switch(t){case Nt.FREETEXT_SIZE:ve._defaultFontSize=i;break;case Nt.FREETEXT_COLOR:ve._defaultColor=i;break}}updateParams(t,i){switch(t){case Nt.FREETEXT_SIZE:this.#r(i);break;case Nt.FREETEXT_COLOR:this.#a(i);break}}static get defaultPropertiesToUpdate(){return[[Nt.FREETEXT_SIZE,ve._defaultFontSize],[Nt.FREETEXT_COLOR,ve._defaultColor||ct._defaultLineColor]]}get propertiesToUpdate(){return[[Nt.FREETEXT_SIZE,this.#i],[Nt.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new vr(this),[["colorPicker",this._colorPicker]]}get colorType(){return Nt.FREETEXT_COLOR}#r(t){const i=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-this.#i)*this.parentScale),this.#i=r,this.#o()},s=this.#i;this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#a(t){const i=r=>{this.color=r,this.onUpdatedColor()},s=this.color;this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,i){this._uiManager.translateSelectedEditors(t,i,!0)}getInitialTranslation(){const t=this.parentScale;return[-ve._internalPadding*t,-(ve._internalPadding+this.#i)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#n=new AbortController;const t=this._uiManager.combinedSignal(this.#n);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#n?.abort(),this.#n=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#s(){const t=[];this.editorDiv.normalize();let i=null;for(const s of this.editorDiv.childNodes)i?.nodeType===Node.TEXT_NODE&&s.nodeName==="BR"||(t.push(ve.#c(s)),i=s);return t.join(`
`)}#o(){const[t,i]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:r,div:l}=this,c=l.style.display,u=l.classList.contains("hidden");l.classList.remove("hidden"),l.style.display="hidden",r.div.append(this.div),s=l.getBoundingClientRect(),l.remove(),l.style.display=c,l.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/i):(this.width=s.height/t,this.height=s.width/i),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,i=this.#t=this.#s().trimEnd();if(t===i)return;const s=r=>{if(this.#t=r,!r){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{s(i)},undo:()=>{s(t)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){ve._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,i;(this._isCopy||this.annotationElementId)&&(t=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,s.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,l]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[u,h]=this.getInitialTranslation();[u,h]=this.pageTranslationToScreen(u,h);const[f,p]=this.pageDimensions,[y,b]=this.pageTranslation;let A,w;switch(this.rotation){case 0:A=t+(c[0]-y)/f,w=i+this.height-(c[1]-b)/p;break;case 90:A=t+(c[0]-y)/f,w=i-(c[1]-b)/p,[u,h]=[h,-u];break;case 180:A=t-this.width+(c[0]-y)/f,w=i-(c[1]-b)/p,[u,h]=[-u,-h];break;case 270:A=t+(c[0]-y-this.height*p)/f,w=i+(c[1]-b-this.width*f)/p,[u,h]=[-h,u];break}this.setAt(A*r,w*l,u,h)}else this._moveAfterPaste(t,i);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Jo,"")}editorDivPaste(t){const i=t.clipboardData||window.clipboardData,{types:s}=i;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const r=ve.#h(i.getData("text")||"").replaceAll(Jo,`
`);if(!r)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const c=l.getRangeAt(0);if(!r.includes(`
`)){c.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:u,startOffset:h}=c,f=[],p=[];if(u.nodeType===Node.TEXT_NODE){const A=u.parentElement;if(p.push(u.nodeValue.slice(h).replaceAll(Jo,"")),A!==this.editorDiv){let w=f;for(const S of this.editorDiv.childNodes){if(S===A){w=p;continue}w.push(ve.#c(S))}}f.push(u.nodeValue.slice(0,h).replaceAll(Jo,""))}else if(u===this.editorDiv){let A=f,w=0;for(const S of this.editorDiv.childNodes)w++===h&&(A=p),A.push(ve.#c(S))}this.#t=`${f.join(`
`)}${r}${p.join(`
`)}`,this.#l();const y=new Range;let b=Math.sumPrecise(f.map(A=>A.length));for(const{firstChild:A}of this.editorDiv.childNodes)if(A.nodeType===Node.TEXT_NODE){const w=A.nodeValue.length;if(b<=w){y.setStart(A,b),y.setEnd(A,b);break}b-=w}l.removeAllRanges(),l.addRange(y)}#l(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const i=document.createElement("div");i.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(i)}}#d(){return this.#t.replaceAll(""," ")}static#h(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=ve._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,i,s){let r=null;if(t instanceof Im){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:h,rotation:f,id:p,popupRef:y,richText:b,contentsObj:A,creationDate:w,modificationDate:S},textContent:E,textPosition:x,parent:{page:{pageNumber:C}}}=t;if(!E||E.length===0)return null;r=t={annotationType:At.FREETEXT,color:Array.from(u),fontSize:c,value:E.join(`
`),position:x,pageIndex:C-1,rect:h.slice(0),rotation:f,annotationElementId:p,id:p,deleted:!1,popupRef:y,comment:A?.str||null,richText:b,creationDate:w,modificationDate:S}}const l=await super.deserialize(t,i,s);return l.#i=t.fontSize,l.color=st.makeHexColor(...t.color),l.#t=ve.#h(t.value),l._initialData=r,t.comment&&l.setCommentData(t),l}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=ct._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),s=Object.assign(super.serialize(t),{color:i,fontSize:this.#i,value:this.#d()});return this.addComment(s),t?(s.isCopy=!0,s):this.annotationElementId&&!this.#f(s)?null:(s.id=this.annotationElementId,s)}#f(t){const{value:i,fontSize:s,color:r,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==i||t.fontSize!==s||t.color.some((c,u)=>c!==r[u])||t.pageIndex!==l}renderAnnotationElement(t){const i=super.renderAnnotationElement(t);if(!i)return null;const{style:s}=i;s.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,s.color=this.color,i.replaceChildren();for(const r of this.#t.split(`
`)){const l=document.createElement("div");l.append(r?document.createTextNode(r):document.createElement("br")),i.append(l)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),i}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class it{static PRECISION=1e-4;toSVGPath(){Vt("Abstract method `toSVGPath` must be implemented.")}get box(){Vt("Abstract getter `box` must be implemented.")}serialize(t,i){Vt("Abstract method `serialize` must be implemented.")}static _rescale(t,i,s,r,l,c){c||=new Float32Array(t.length);for(let u=0,h=t.length;u<h;u+=2)c[u]=i+t[u]*r,c[u+1]=s+t[u+1]*l;return c}static _rescaleAndSwap(t,i,s,r,l,c){c||=new Float32Array(t.length);for(let u=0,h=t.length;u<h;u+=2)c[u]=i+t[u+1]*r,c[u+1]=s+t[u]*l;return c}static _translate(t,i,s,r){r||=new Float32Array(t.length);for(let l=0,c=t.length;l<c;l+=2)r[l]=i+t[l],r[l+1]=s+t[l+1];return r}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,i,s,r,l){switch(l){case 90:return[1-i/s,t/r];case 180:return[1-t/s,1-i/r];case 270:return[i/s,1-t/r];default:return[t/s,i/r]}}static _normalizePagePoint(t,i,s){switch(s){case 90:return[1-i,t];case 180:return[1-t,1-i];case 270:return[i,1-t];default:return[t,i]}}static createBezierPoints(t,i,s,r,l,c){return[(t+5*s)/6,(i+5*r)/6,(5*s+l)/6,(5*r+c)/6,(s+l)/2,(r+c)/2]}}class ss{#t;#e=[];#n;#i;#r=[];#a=new Float32Array(18);#s;#o;#c;#l;#d;#h;#f=[];static#m=8;static#p=2;static#u=ss.#m+ss.#p;constructor({x:t,y:i},s,r,l,c,u=0){this.#t=s,this.#h=l*r,this.#i=c,this.#a.set([NaN,NaN,NaN,NaN,t,i],6),this.#n=u,this.#l=ss.#m*r,this.#c=ss.#u*r,this.#d=r,this.#f.push(t,i)}isEmpty(){return isNaN(this.#a[8])}#g(){const t=this.#a.subarray(4,6),i=this.#a.subarray(16,18),[s,r,l,c]=this.#t;return[(this.#s+(t[0]-i[0])/2-s)/l,(this.#o+(t[1]-i[1])/2-r)/c,(this.#s+(i[0]-t[0])/2-s)/l,(this.#o+(i[1]-t[1])/2-r)/c]}add({x:t,y:i}){this.#s=t,this.#o=i;const[s,r,l,c]=this.#t;let[u,h,f,p]=this.#a.subarray(8,12);const y=t-f,b=i-p,A=Math.hypot(y,b);if(A<this.#c)return!1;const w=A-this.#l,S=w/A,E=S*y,x=S*b;let C=u,T=h;u=f,h=p,f+=E,p+=x,this.#f?.push(t,i);const B=-x/w,O=E/w,L=B*this.#h,P=O*this.#h;return this.#a.set(this.#a.subarray(2,8),0),this.#a.set([f+L,p+P],4),this.#a.set(this.#a.subarray(14,18),12),this.#a.set([f-L,p-P],16),isNaN(this.#a[6])?(this.#r.length===0&&(this.#a.set([u+L,h+P],2),this.#r.push(NaN,NaN,NaN,NaN,(u+L-s)/l,(h+P-r)/c),this.#a.set([u-L,h-P],14),this.#e.push(NaN,NaN,NaN,NaN,(u-L-s)/l,(h-P-r)/c)),this.#a.set([C,T,u,h,f,p],6),!this.isEmpty()):(this.#a.set([C,T,u,h,f,p],6),Math.abs(Math.atan2(T-h,C-u)-Math.atan2(x,E))<Math.PI/2?([u,h,f,p]=this.#a.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((u+f)/2-s)/l,((h+p)/2-r)/c),[u,h,C,T]=this.#a.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((C+u)/2-s)/l,((T+h)/2-r)/c),!0):([C,T,u,h,f,p]=this.#a.subarray(0,6),this.#r.push(((C+5*u)/6-s)/l,((T+5*h)/6-r)/c,((5*u+f)/6-s)/l,((5*h+p)/6-r)/c,((u+f)/2-s)/l,((h+p)/2-r)/c),[f,p,u,h,C,T]=this.#a.subarray(12,18),this.#e.push(((C+5*u)/6-s)/l,((T+5*h)/6-r)/c,((5*u+f)/6-s)/l,((5*h+p)/6-r)/c,((u+f)/2-s)/l,((h+p)/2-r)/c),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#r,i=this.#e;if(isNaN(this.#a[6])&&!this.isEmpty())return this.#y();const s=[];s.push(`M${t[4]} ${t[5]}`);for(let r=6;r<t.length;r+=6)isNaN(t[r])?s.push(`L${t[r+4]} ${t[r+5]}`):s.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);this.#b(s);for(let r=i.length-6;r>=6;r-=6)isNaN(i[r])?s.push(`L${i[r+4]} ${i[r+5]}`):s.push(`C${i[r]} ${i[r+1]} ${i[r+2]} ${i[r+3]} ${i[r+4]} ${i[r+5]}`);return this.#v(s),s.join(" ")}#y(){const[t,i,s,r]=this.#t,[l,c,u,h]=this.#g();return`M${(this.#a[2]-t)/s} ${(this.#a[3]-i)/r} L${(this.#a[4]-t)/s} ${(this.#a[5]-i)/r} L${l} ${c} L${u} ${h} L${(this.#a[16]-t)/s} ${(this.#a[17]-i)/r} L${(this.#a[14]-t)/s} ${(this.#a[15]-i)/r} Z`}#v(t){const i=this.#e;t.push(`L${i[4]} ${i[5]} Z`)}#b(t){const[i,s,r,l]=this.#t,c=this.#a.subarray(4,6),u=this.#a.subarray(16,18),[h,f,p,y]=this.#g();t.push(`L${(c[0]-i)/r} ${(c[1]-s)/l} L${h} ${f} L${p} ${y} L${(u[0]-i)/r} ${(u[1]-s)/l}`)}newFreeDrawOutline(t,i,s,r,l,c){return new Xm(t,i,s,r,l,c)}getOutlines(){const t=this.#r,i=this.#e,s=this.#a,[r,l,c,u]=this.#t,h=new Float32Array((this.#f?.length??0)+2);for(let y=0,b=h.length-2;y<b;y+=2)h[y]=(this.#f[y]-r)/c,h[y+1]=(this.#f[y+1]-l)/u;if(h[h.length-2]=(this.#s-r)/c,h[h.length-1]=(this.#o-l)/u,isNaN(s[6])&&!this.isEmpty())return this.#E(h);const f=new Float32Array(this.#r.length+24+this.#e.length);let p=t.length;for(let y=0;y<p;y+=2){if(isNaN(t[y])){f[y]=f[y+1]=NaN;continue}f[y]=t[y],f[y+1]=t[y+1]}p=this.#S(f,p);for(let y=i.length-6;y>=6;y-=6)for(let b=0;b<6;b+=2){if(isNaN(i[y+b])){f[p]=f[p+1]=NaN,p+=2;continue}f[p]=i[y+b],f[p+1]=i[y+b+1],p+=2}return this.#_(f,p),this.newFreeDrawOutline(f,h,this.#t,this.#d,this.#n,this.#i)}#E(t){const i=this.#a,[s,r,l,c]=this.#t,[u,h,f,p]=this.#g(),y=new Float32Array(36);return y.set([NaN,NaN,NaN,NaN,(i[2]-s)/l,(i[3]-r)/c,NaN,NaN,NaN,NaN,(i[4]-s)/l,(i[5]-r)/c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(i[16]-s)/l,(i[17]-r)/c,NaN,NaN,NaN,NaN,(i[14]-s)/l,(i[15]-r)/c],0),this.newFreeDrawOutline(y,t,this.#t,this.#d,this.#n,this.#i)}#_(t,i){const s=this.#e;return t.set([NaN,NaN,NaN,NaN,s[4],s[5]],i),i+=6}#S(t,i){const s=this.#a.subarray(4,6),r=this.#a.subarray(16,18),[l,c,u,h]=this.#t,[f,p,y,b]=this.#g();return t.set([NaN,NaN,NaN,NaN,(s[0]-l)/u,(s[1]-c)/h,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,y,b,NaN,NaN,NaN,NaN,(r[0]-l)/u,(r[1]-c)/h],i),i+=24}}class Xm extends it{#t;#e=new Float32Array(4);#n;#i;#r;#a;#s;constructor(t,i,s,r,l,c){super(),this.#s=t,this.#r=i,this.#t=s,this.#a=r,this.#n=l,this.#i=c,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(c);const[u,h,f,p]=this.#e;for(let y=0,b=t.length;y<b;y+=2)t[y]=(t[y]-u)/f,t[y+1]=(t[y+1]-h)/p;for(let y=0,b=i.length;y<b;y+=2)i[y]=(i[y]-u)/f,i[y+1]=(i[y+1]-h)/p}toSVGPath(){const t=[`M${this.#s[4]} ${this.#s[5]}`];for(let i=6,s=this.#s.length;i<s;i+=6){if(isNaN(this.#s[i])){t.push(`L${this.#s[i+4]} ${this.#s[i+5]}`);continue}t.push(`C${this.#s[i]} ${this.#s[i+1]} ${this.#s[i+2]} ${this.#s[i+3]} ${this.#s[i+4]} ${this.#s[i+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,i,s,r],l){const c=s-t,u=r-i;let h,f;switch(l){case 0:h=it._rescale(this.#s,t,r,c,-u),f=it._rescale(this.#r,t,r,c,-u);break;case 90:h=it._rescaleAndSwap(this.#s,t,i,c,u),f=it._rescaleAndSwap(this.#r,t,i,c,u);break;case 180:h=it._rescale(this.#s,s,i,-c,u),f=it._rescale(this.#r,s,i,-c,u);break;case 270:h=it._rescaleAndSwap(this.#s,s,r,-c,-u),f=it._rescaleAndSwap(this.#r,s,r,-c,-u);break}return{outline:Array.from(h),points:[Array.from(f)]}}#o(t){const i=this.#s;let s=i[4],r=i[5];const l=[s,r,s,r];let c=s,u=r,h=s,f=r;const p=t?Math.max:Math.min,y=new Float32Array(4);for(let A=6,w=i.length;A<w;A+=6){const S=i[A+4],E=i[A+5];isNaN(i[A])?(st.pointBoundingBox(S,E,l),u>E?(c=S,u=E):u===E&&(c=p(c,S)),f<E?(h=S,f=E):f===E&&(h=p(h,S))):(y[0]=y[1]=1/0,y[2]=y[3]=-1/0,st.bezierBoundingBox(s,r,...i.slice(A,A+6),y),st.rectBoundingBox(y[0],y[1],y[2],y[3],l),u>y[1]?(c=y[0],u=y[1]):u===y[1]&&(c=p(c,y[0])),f<y[3]?(h=y[2],f=y[3]):f===y[3]&&(h=p(h,y[2]))),s=S,r=E}const b=this.#e;b[0]=l[0]-this.#n,b[1]=l[1]-this.#n,b[2]=l[2]-l[0]+2*this.#n,b[3]=l[3]-l[1]+2*this.#n,this.firstPoint=[c,u],this.lastPoint=[h,f]}get box(){return this.#e}newOutliner(t,i,s,r,l,c=0){return new ss(t,i,s,r,l,c)}getNewOutline(t,i){const[s,r,l,c]=this.#e,[u,h,f,p]=this.#t,y=l*f,b=c*p,A=s*f+u,w=r*p+h,S=this.newOutliner({x:this.#r[0]*y+A,y:this.#r[1]*b+w},this.#t,this.#a,t,this.#i,i??this.#n);for(let E=2;E<this.#r.length;E+=2)S.add({x:this.#r[E]*y+A,y:this.#r[E+1]*b+w});return S.getOutlines()}}class ah{#t;#e;#n;#i=[];#r=[];constructor(t,i=0,s=0,r=!0){const l=[1/0,1/0,-1/0,-1/0],c=10**-4;for(const{x:S,y:E,width:x,height:C}of t){const T=Math.floor((S-i)/c)*c,B=Math.ceil((S+x+i)/c)*c,O=Math.floor((E-i)/c)*c,L=Math.ceil((E+C+i)/c)*c,P=[T,O,L,!0],G=[B,O,L,!1];this.#i.push(P,G),st.rectBoundingBox(T,O,B,L,l)}const u=l[2]-l[0]+2*s,h=l[3]-l[1]+2*s,f=l[0]-s,p=l[1]-s;let y=r?-1/0:1/0,b=1/0;const A=this.#i.at(r?-1:-2),w=[A[0],A[2]];for(const S of this.#i){const[E,x,C,T]=S;!T&&r?x<b?(b=x,y=E):x===b&&(y=Math.max(y,E)):T&&!r&&(x<b?(b=x,y=E):x===b&&(y=Math.min(y,E))),S[0]=(E-f)/u,S[1]=(x-p)/h,S[2]=(C-p)/h}this.#t=new Float32Array([f,p,u,h]),this.#e=[y,b],this.#n=w}getOutlines(){this.#i.sort((i,s)=>i[0]-s[0]||i[1]-s[1]||i[2]-s[2]);const t=[];for(const i of this.#i)i[3]?(t.push(...this.#l(i)),this.#o(i)):(this.#c(i),t.push(...this.#l(i)));return this.#a(t)}#a(t){const i=[],s=new Set;for(const c of t){const[u,h,f]=c;i.push([u,h,c],[u,f,c])}i.sort((c,u)=>c[1]-u[1]||c[0]-u[0]);for(let c=0,u=i.length;c<u;c+=2){const h=i[c][2],f=i[c+1][2];h.push(f),f.push(h),s.add(h),s.add(f)}const r=[];let l;for(;s.size>0;){const c=s.values().next().value;let[u,h,f,p,y]=c;s.delete(c);let b=u,A=h;for(l=[u,f],r.push(l);;){let w;if(s.has(p))w=p;else if(s.has(y))w=y;else break;s.delete(w),[u,h,f,p,y]=w,b!==u&&(l.push(b,A,u,A===h?h:f),b=u),A=A===h?f:h}l.push(b,A)}return new _A(r,this.#t,this.#e,this.#n)}#s(t){const i=this.#r;let s=0,r=i.length-1;for(;s<=r;){const l=s+r>>1,c=i[l][0];if(c===t)return l;c<t?s=l+1:r=l-1}return r+1}#o([,t,i]){const s=this.#s(t);this.#r.splice(s,0,[t,i])}#c([,t,i]){const s=this.#s(t);for(let r=s;r<this.#r.length;r++){const[l,c]=this.#r[r];if(l!==t)break;if(l===t&&c===i){this.#r.splice(r,1);return}}for(let r=s-1;r>=0;r--){const[l,c]=this.#r[r];if(l!==t)break;if(l===t&&c===i){this.#r.splice(r,1);return}}}#l(t){const[i,s,r]=t,l=[[i,s,r]],c=this.#s(r);for(let u=0;u<c;u++){const[h,f]=this.#r[u];for(let p=0,y=l.length;p<y;p++){const[,b,A]=l[p];if(!(f<=b||A<=h)){if(b>=h){if(A>f)l[p][1]=f;else{if(y===1)return[];l.splice(p,1),p--,y--}continue}l[p][2]=h,A>f&&l.push([i,f,A])}}}return l}}class _A extends it{#t;#e;constructor(t,i,s,r){super(),this.#e=t,this.#t=i,this.firstPoint=s,this.lastPoint=r}toSVGPath(){const t=[];for(const i of this.#e){let[s,r]=i;t.push(`M${s} ${r}`);for(let l=2;l<i.length;l+=2){const c=i[l],u=i[l+1];c===s?(t.push(`V${u}`),r=u):u===r&&(t.push(`H${c}`),s=c)}t.push("Z")}return t.join(" ")}serialize([t,i,s,r],l){const c=[],u=s-t,h=r-i;for(const f of this.#e){const p=new Array(f.length);for(let y=0;y<f.length;y+=2)p[y]=t+f[y]*u,p[y+1]=r-f[y+1]*h;c.push(p)}return c}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class rh extends ss{newFreeDrawOutline(t,i,s,r,l,c){return new xA(t,i,s,r,l,c)}}class xA extends Xm{newOutliner(t,i,s,r,l,c=0){return new rh(t,i,s,r,l,c)}}class oe extends ct{#t=null;#e=0;#n;#i=null;#r=null;#a=null;#s=null;#o=0;#c=null;#l=null;#d=null;#h=!1;#f=null;#m=null;#p=null;#u="";#g;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=At.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=oe.prototype;return wt(this,"_keyboardManager",new xr([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||oe._defaultColor,this.#g=t.thickness||oe._defaultThickness,this.opacity=t.opacity||oe._defaultOpacity,this.#n=t.boxes||null,this.#y=t.methodOfCreation||"",this.#u=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#h=!0,this.#b(t),this.#A()):this.#n&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#s=t.focusNode,this.#o=t.focusOffset,this.#v(),this.#A(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#g,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#v(){const t=new ah(this.#n,.001);this.#l=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const i=new ah(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#a=i.getOutlines();const{firstPoint:s}=this.#l;this.#f=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height];const{lastPoint:r}=this.#a;this.#m=[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height]}#b({highlightOutlines:t,highlightId:i,clipPathId:s}){this.#l=t;const r=1.5;if(this.#a=t.getNewOutline(this.#g/2+r,.0025),i>=0)this.#d=i,this.#i=s,this.parent.drawLayer.finalizeDraw(i,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#a.box,path:{d:this.#a.toSVGPath()}},!0);else if(this.parent){const y=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:oe.#x(this.#l.box,(y-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:oe.#x(this.#a.box,y),path:{d:this.#a.toSVGPath()}})}const[l,c,u,h]=t.box;switch(this.rotation){case 0:this.x=l,this.y=c,this.width=u,this.height=h;break;case 90:{const[y,b]=this.parentDimensions;this.x=c,this.y=1-l,this.width=u*b/y,this.height=h*y/b;break}case 180:this.x=1-l,this.y=1-c,this.width=u,this.height=h;break;case 270:{const[y,b]=this.parentDimensions;this.x=1-c,this.y=l,this.width=u*b/y,this.height=h*y/b;break}}const{firstPoint:f}=t;this.#f=[(f[0]-l)/u,(f[1]-c)/h];const{lastPoint:p}=this.#a;this.#m=[(p[0]-l)/u,(p[1]-c)/h]}static initialize(t,i){ct.initialize(t,i),oe._defaultColor||=i.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,i){switch(t){case Nt.HIGHLIGHT_COLOR:oe._defaultColor=i;break;case Nt.HIGHLIGHT_THICKNESS:oe._defaultThickness=i;break}}translateInPage(t,i){}get toolbarPosition(){return this.#m}get commentButtonPosition(){return this.#f}updateParams(t,i){switch(t){case Nt.HIGHLIGHT_COLOR:this.#E(i);break;case Nt.HIGHLIGHT_THICKNESS:this.#_(i);break}}static get defaultPropertiesToUpdate(){return[[Nt.HIGHLIGHT_COLOR,oe._defaultColor],[Nt.HIGHLIGHT_THICKNESS,oe._defaultThickness]]}get propertiesToUpdate(){return[[Nt.HIGHLIGHT_COLOR,this.color||oe._defaultColor],[Nt.HIGHLIGHT_THICKNESS,this.#g||oe._defaultThickness],[Nt.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#r?.updateColor(this.color),super.onUpdatedColor()}#E(t){const i=(l,c)=>{this.color=l,this.opacity=c,this.onUpdatedColor()},s=this.color,r=this.opacity;this.addCommands({cmd:i.bind(this,t,oe._defaultOpacity),undo:i.bind(this,s,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#_(t){const i=this.#g,s=r=>{this.#g=r,this.#S(r)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#r=new wi({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#D())}getBaseTranslation(){return[0,0]}getRect(t,i){return super.getRect(t,i,this.#D())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#C(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#A(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let i=!1;this.parent&&!t?this.#C():t&&(this.#A(t),i=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),i&&this.select()}#S(t){this.#h&&(this.#b({highlightOutlines:this.#l.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())}#C(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#A(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#i}=t.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#l.toSVGPath()}},!1,!0),this.#p=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#a.box,path:{d:this.#a.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#i))}static#x([t,i,s,r],l){switch(l){case 90:return[1-i-r,t,r,s];case 180:return[1-t-s,1-i-r,s,r];case 270:return[i,1-t-s,r,s]}return[t,i,s,r]}rotate(t){const{drawLayer:i}=this.parent;let s;this.#h?(t=(t-this.rotation+360)%360,s=oe.#x(this.#l.box,t)):s=oe.#x([this.x,this.y,this.width,this.height],t),i.updateProperties(this.#d,{bbox:s,root:{"data-main-rotation":t}}),i.updateProperties(this.#p,{bbox:oe.#x(this.#a.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#u&&(t.setAttribute("aria-label",this.#u),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#R.bind(this),{signal:this._uiManager._signal});const i=this.#c=document.createElement("div");return t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=this.#i,this.setDims(),_m(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#R(t){oe._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#M(!0);break;case 1:case 3:this.#M(!1);break}}#M(t){if(!this.#t)return;const i=window.getSelection();t?i.setPosition(this.#t,this.#e):i.setPosition(this.#s,this.#o)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#h||this.#M(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!t}}))}#D(){return this.#h?this.rotation:0}#P(){if(this.#h)return null;const[t,i]=this.pageDimensions,[s,r]=this.pageTranslation,l=this.#n,c=new Float32Array(l.length*8);let u=0;for(const{x:h,y:f,width:p,height:y}of l){const b=h*t+s,A=(1-f)*i+r;c[u]=c[u+4]=b,c[u+1]=c[u+3]=A,c[u+2]=c[u+6]=b+p*t,c[u+5]=c[u+7]=A-y*i,u+=8}return c}#O(t){return this.#l.serialize(t,this.#D())}static startHighlighting(t,i,{target:s,x:r,y:l}){const{x:c,y:u,width:h,height:f}=s.getBoundingClientRect(),p=new AbortController,y=t.combinedSignal(p),b=A=>{p.abort(),this.#U(t,A)};window.addEventListener("blur",b,{signal:y}),window.addEventListener("pointerup",b,{signal:y}),window.addEventListener("pointerdown",se,{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",_i,{signal:y}),s.addEventListener("pointermove",this.#k.bind(this,t),{signal:y}),this._freeHighlight=new rh({x:r,y:l},[c,u,h,f],t.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#k(t,i){this._freeHighlight.add(i)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#U(t,i){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,i,s){let r=null;if(t instanceof qm){const{data:{quadPoints:w,rect:S,rotation:E,id:x,color:C,opacity:T,popupRef:B,richText:O,contentsObj:L,creationDate:P,modificationDate:G},parent:{page:{pageNumber:Q}}}=t;r=t={annotationType:At.HIGHLIGHT,color:Array.from(C),opacity:T,quadPoints:w,boxes:null,pageIndex:Q-1,rect:S.slice(0),rotation:E,annotationElementId:x,id:x,deleted:!1,popupRef:B,richText:O,comment:L?.str||null,creationDate:P,modificationDate:G}}else if(t instanceof Ah){const{data:{inkLists:w,rect:S,rotation:E,id:x,color:C,borderStyle:{rawWidth:T},popupRef:B,richText:O,contentsObj:L,creationDate:P,modificationDate:G},parent:{page:{pageNumber:Q}}}=t;r=t={annotationType:At.HIGHLIGHT,color:Array.from(C),thickness:T,inkLists:w,boxes:null,pageIndex:Q-1,rect:S.slice(0),rotation:E,annotationElementId:x,id:x,deleted:!1,popupRef:B,richText:O,comment:L?.str||null,creationDate:P,modificationDate:G}}const{color:l,quadPoints:c,inkLists:u,opacity:h}=t,f=await super.deserialize(t,i,s);f.color=st.makeHexColor(...l),f.opacity=h||1,u&&(f.#g=t.thickness),f._initialData=r,t.comment&&f.setCommentData(t);const[p,y]=f.pageDimensions,[b,A]=f.pageTranslation;if(c){const w=f.#n=[];for(let S=0;S<c.length;S+=8)w.push({x:(c[S]-b)/p,y:1-(c[S+1]-A)/y,width:(c[S+2]-c[S])/p,height:(c[S+1]-c[S+5])/y});f.#v(),f.#A(),f.rotate(f.rotation)}else if(u){f.#h=!0;const w=u[0],S={x:w[0]-b,y:y-(w[1]-A)},E=new rh(S,[0,0,p,y],1,f.#g/2,!0,.001);for(let T=0,B=w.length;T<B;T+=2)S.x=w[T]-b,S.y=y-(w[T+1]-A),E.add(S);const{id:x,clipPathId:C}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:E.toSVGPath()}},!0,!0);f.#b({highlightOutlines:E.getOutlines(),highlightId:x,clipPathId:C}),f.#A(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const i=ct._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s=super.serialize(t);return Object.assign(s,{color:i,opacity:this.opacity,thickness:this.#g,quadPoints:this.#P(),outlines:this.#O(s.rect)}),this.addComment(s),this.annotationElementId&&!this.#B(s)?null:(s.id=this.annotationElementId,s)}#B(t){const{color:i}=this._initialData;return this.hasEditedComment||t.color.some((s,r)=>s!==i[r])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class Ym{#t=Object.create(null);updateProperty(t,i){this[t]=i,this.updateSVGProperty(t,i)}updateProperties(t){if(t)for(const[i,s]of Object.entries(t))i.startsWith("_")||this.updateProperty(i,s)}updateSVGProperty(t,i){this.#t[t]=i}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){Vt("Not implemented")}}class zt extends ct{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#i=null;static#r=null;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#a(t),this.#c())}#a({drawOutlines:t,drawId:i,drawingOptions:s}){this.#t=t,this._drawingOptions||=s,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,t.defaultProperties)):this._drawId=this.#s(t,this.parent),this.#h(t.box)}#s(t,i){const{id:s}=i.drawLayer.draw(zt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s}static _mergeSVGProperties(t,i){const s=new Set(Object.keys(t));for(const[r,l]of Object.entries(i))s.has(r)?Object.assign(t[r],l):t[r]=l;return t}static getDefaultDrawingOptions(t){Vt("Not implemented")}static get typesMap(){Vt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,i){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,i),this._currentParent&&(zt.#n.updateProperty(s,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,i){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,i)}static get defaultPropertiesToUpdate(){const t=[],i=this._defaultDrawingOptions;for(const[s,r]of this.typesMap)t.push([s,i[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:i}=this;for(const[s,r]of this.constructor.typesMap)t.push([s,i[r]]);return t}_updateProperty(t,i,s){const r=this._drawingOptions,l=r[i],c=u=>{r.updateProperty(i,u);const h=this.#t.updateProperty(i,u);h&&this.#h(h),this.parent?.drawLayer.updateProperties(this._drawId,r.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:c.bind(this,s),undo:c.bind(this,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,zt._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#d()),{bbox:this.#f()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,zt._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#d()),{bbox:this.#f()}))}_onTranslating(t,i){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#f()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,zt._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#d(),this.parentDimensions),{bbox:this.#f()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#o(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let i=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#o()):t&&(this._uiManager.addShouldRescale(this),this.#c(t),i=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),i&&this.select()}#o(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#s(this.#t,t)}}#l([t,i,s,r]){const{parentDimensions:[l,c],rotation:u}=this;switch(u){case 90:return[i,1-t,s*(c/l),r*(l/c)];case 180:return[1-t,1-i,s,r];case 270:return[1-i,t,s*(c/l),r*(l/c)];default:return[t,i,s,r]}}#d(){const{x:t,y:i,width:s,height:r,parentDimensions:[l,c],rotation:u}=this;switch(u){case 90:return[1-i,t,s*(l/c),r*(c/l)];case 180:return[1-t,1-i,s,r];case 270:return[i,1-t,s*(l/c),r*(c/l)];default:return[t,i,s,r]}}#h(t){[this.x,this.y,this.width,this.height]=this.#l(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#f(){const{x:t,y:i,width:s,height:r,rotation:l,parentRotation:c,parentDimensions:[u,h]}=this;switch((l*4+c)/90){case 1:return[1-i-r,t,r,s];case 2:return[1-t-s,1-i-r,s,r];case 3:return[i,1-t-s,r,s];case 4:return[t,i-s*(u/h),r*(h/u),s*(u/h)];case 5:return[1-i,t,s*(u/h),r*(h/u)];case 6:return[1-t-r*(h/u),1-i,r*(h/u),s*(u/h)];case 7:return[i-s*(u/h),1-t-r*(h/u),s*(u/h),r*(h/u)];case 8:return[t-s,i-r,s,r];case 9:return[1-i,t-s,r,s];case 10:return[1-t,1-i,s,r];case 11:return[i-r,1-t,r,s];case 12:return[t-r*(h/u),i,r*(h/u),s*(u/h)];case 13:return[1-i-s*(u/h),t-r*(h/u),s*(u/h),r*(h/u)];case 14:return[1-t,1-i-s*(u/h),r*(h/u),s*(u/h)];case 15:return[i,1-t,s*(u/h),r*(h/u)];default:return[t,i,s,r]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,zt._mergeSVGProperties({bbox:this.#f()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,i;this._isCopy&&(t=this.x,i=this.y);const s=super.render();s.classList.add("draw");const r=document.createElement("div");return s.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,i),s}static createDrawerInstance(t,i,s,r,l){Vt("Not implemented")}static startDrawing(t,i,s,r){const{target:l,offsetX:c,offsetY:u,pointerId:h,pointerType:f}=r;if(Pt.isInitializedAndDifferentPointerType(f))return;const{viewport:{rotation:p}}=t,{width:y,height:b}=l.getBoundingClientRect(),A=zt.#i=new AbortController,w=t.combinedSignal(A);if(Pt.setPointer(f,h),window.addEventListener("pointerup",S=>{Pt.isSamePointerIdOrRemove(S.pointerId)&&this._endDraw(S)},{signal:w}),window.addEventListener("pointercancel",S=>{Pt.isSamePointerIdOrRemove(S.pointerId)&&this._currentParent.endDrawingSession()},{signal:w}),window.addEventListener("pointerdown",S=>{Pt.isSamePointerType(S.pointerType)&&(Pt.initializeAndAddPointerId(S.pointerId),zt.#n.isCancellable()&&(zt.#n.removeLastElement(),zt.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:w}),window.addEventListener("contextmenu",_i,{signal:w}),l.addEventListener("pointermove",this._drawMove.bind(this),{signal:w}),l.addEventListener("touchmove",S=>{Pt.isSameTimeStamp(S.timeStamp)&&se(S)},{signal:w}),t.toggleDrawing(),i._editorUndoBar?.hide(),zt.#n){t.drawLayer.updateProperties(this._currentDrawId,zt.#n.startNew(c,u,y,b,p));return}i.updateUIForDefaultProperties(this),zt.#n=this.createDrawerInstance(c,u,y,b,p),zt.#r=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(zt.#r.toSVGProperties(),zt.#n.defaultSVGProperties),!0,!1)}static _drawMove(t){if(Pt.isSameTimeStamp(t.timeStamp),!zt.#n)return;const{offsetX:i,offsetY:s,pointerId:r}=t;if(Pt.isSamePointerId(r)){if(Pt.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,zt.#n.add(i,s)),Pt.setTimeStamp(t.timeStamp),se(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,zt.#n=null,zt.#r=null,Pt.clearPointerType(),Pt.clearTimeStamp()),zt.#i&&(zt.#i.abort(),zt.#i=null,Pt.clearPointerIds())}static _endDraw(t){const i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),t?.target===i.div&&i.drawLayer.updateProperties(this._currentDrawId,zt.#n.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=zt.#n,r=this._currentDrawId,l=s.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(r,s.setLastElement(l))},undo:()=>{i.drawLayer.updateProperties(r,s.removeLastElement())},mustExec:!1,type:Nt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack(Nt.DRAW_STEP),!zt.#n.isEmpty()){const{pageDimensions:[s,r],scale:l}=i,c=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:zt.#n.getOutlines(s*l,r*l,l,this._INNER_MARGIN),drawingOptions:zt.#r,mustBeCommitted:!t});return this._cleanup(!0),c}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,i,s,r,l,c){Vt("Not implemented")}static async deserialize(t,i,s){const{rawDims:{pageWidth:r,pageHeight:l,pageX:c,pageY:u}}=i.viewport,h=this.deserializeDraw(c,u,r,l,this._INNER_MARGIN,t),f=await super.deserialize(t,i,s);return f.createDrawingOptions(t),f.#a({drawOutlines:h}),f.#c(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[i,s]=this.pageTranslation,[r,l]=this.pageDimensions;return this.#t.serialize([i,s,r,l],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class EA{#t=new Float64Array(6);#e;#n;#i;#r;#a;#s="";#o=0;#c=new Tr;#l;#d;constructor(t,i,s,r,l,c){this.#l=s,this.#d=r,this.#i=l,this.#r=c,[t,i]=this.#h(t,i);const u=this.#e=[NaN,NaN,NaN,NaN,t,i];this.#a=[t,i],this.#n=[{line:u,points:this.#a}],this.#t.set(u,0)}updateProperty(t,i){t==="stroke-width"&&(this.#r=i)}#h(t,i){return it._normalizePoint(t,i,this.#l,this.#d,this.#i)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#a.length<=10}add(t,i){[t,i]=this.#h(t,i);const[s,r,l,c]=this.#t.subarray(2,6),u=t-l,h=i-c;return Math.hypot(this.#l*u,this.#d*h)<=2?null:(this.#a.push(t,i),isNaN(s)?(this.#t.set([l,c,t,i],2),this.#e.push(NaN,NaN,NaN,NaN,t,i),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([s,r,l,c,t,i],0),this.#e.push(...it.createBezierPoints(s,r,l,c,t,i)),{path:{d:this.toSVGPath()}}))}end(t,i){const s=this.add(t,i);return s||(this.#a.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,i,s,r,l){this.#l=s,this.#d=r,this.#i=l,[t,i]=this.#h(t,i);const c=this.#e=[NaN,NaN,NaN,NaN,t,i];this.#a=[t,i];const u=this.#n.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#n.push({line:c,points:this.#a}),this.#t.set(c,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(t){return this.#n?(this.#n.push(t),this.#e=t.line,this.#a=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#n)return this.#c.removeLastElement();this.#n.pop(),this.#s="";for(let t=0,i=this.#n.length;t<i;t++){const{line:s,points:r}=this.#n[t];this.#e=s,this.#a=r,this.#o=0,this.toSVGPath()}return{path:{d:this.#s}}}toSVGPath(){const t=it.svgRound(this.#e[4]),i=it.svgRound(this.#e[5]);if(this.#a.length===2)return this.#s=`${this.#s} M ${t} ${i} Z`,this.#s;if(this.#a.length<=6){const r=this.#s.lastIndexOf("M");this.#s=`${this.#s.slice(0,r)} M ${t} ${i}`,this.#o=6}if(this.#a.length===4){const r=it.svgRound(this.#e[10]),l=it.svgRound(this.#e[11]);return this.#s=`${this.#s} L ${r} ${l}`,this.#o=12,this.#s}const s=[];this.#o===0&&(s.push(`M ${t} ${i}`),this.#o=6);for(let r=this.#o,l=this.#e.length;r<l;r+=6){const[c,u,h,f,p,y]=this.#e.slice(r,r+6).map(it.svgRound);s.push(`C${c} ${u} ${h} ${f} ${p} ${y}`)}return this.#s+=s.join(" "),this.#o=this.#e.length,this.#s}getOutlines(t,i,s,r){const l=this.#n.at(-1);return l.line=new Float32Array(l.line),l.points=new Float32Array(l.points),this.#c.build(this.#n,t,i,s,this.#i,this.#r,r),this.#t=null,this.#e=null,this.#n=null,this.#s=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Tr extends it{#t;#e=0;#n;#i;#r;#a;#s;#o;#c;build(t,i,s,r,l,c,u){this.#r=i,this.#a=s,this.#s=r,this.#o=l,this.#c=c,this.#n=u??0,this.#i=t,this.#h()}get thickness(){return this.#c}setLastElement(t){return this.#i.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:i}of this.#i){if(t.push(`M${it.svgRound(i[4])} ${it.svgRound(i[5])}`),i.length===6){t.push("Z");continue}if(i.length===12&&isNaN(i[6])){t.push(`L${it.svgRound(i[10])} ${it.svgRound(i[11])}`);continue}for(let s=6,r=i.length;s<r;s+=6){const[l,c,u,h,f,p]=i.subarray(s,s+6).map(it.svgRound);t.push(`C${l} ${c} ${u} ${h} ${f} ${p}`)}}return t.join("")}serialize([t,i,s,r],l){const c=[],u=[],[h,f,p,y]=this.#d();let b,A,w,S,E,x,C,T,B;switch(this.#o){case 0:B=it._rescale,b=t,A=i+r,w=s,S=-r,E=t+h*s,x=i+(1-f-y)*r,C=t+(h+p)*s,T=i+(1-f)*r;break;case 90:B=it._rescaleAndSwap,b=t,A=i,w=s,S=r,E=t+f*s,x=i+h*r,C=t+(f+y)*s,T=i+(h+p)*r;break;case 180:B=it._rescale,b=t+s,A=i,w=-s,S=r,E=t+(1-h-p)*s,x=i+f*r,C=t+(1-h)*s,T=i+(f+y)*r;break;case 270:B=it._rescaleAndSwap,b=t+s,A=i+r,w=-s,S=-r,E=t+(1-f-y)*s,x=i+(1-h-p)*r,C=t+(1-f)*s,T=i+(1-h)*r;break}for(const{line:O,points:L}of this.#i)c.push(B(O,b,A,w,S,l?new Array(O.length):null)),u.push(B(L,b,A,w,S,l?new Array(L.length):null));return{lines:c,points:u,rect:[E,x,C,T]}}static deserialize(t,i,s,r,l,{paths:{lines:c,points:u},rotation:h,thickness:f}){const p=[];let y,b,A,w,S;switch(h){case 0:S=it._rescale,y=-t/s,b=i/r+1,A=1/s,w=-1/r;break;case 90:S=it._rescaleAndSwap,y=-i/r,b=-t/s,A=1/r,w=1/s;break;case 180:S=it._rescale,y=t/s+1,b=-i/r,A=-1/s,w=1/r;break;case 270:S=it._rescaleAndSwap,y=i/r+1,b=t/s+1,A=-1/r,w=-1/s;break}if(!c){c=[];for(const x of u){const C=x.length;if(C===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,x[0],x[1]]));continue}if(C===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,x[0],x[1],NaN,NaN,NaN,NaN,x[2],x[3]]));continue}const T=new Float32Array(3*(C-2));c.push(T);let[B,O,L,P]=x.subarray(0,4);T.set([NaN,NaN,NaN,NaN,B,O],0);for(let G=4;G<C;G+=2){const Q=x[G],tt=x[G+1];T.set(it.createBezierPoints(B,O,L,P,Q,tt),(G-2)*3),[B,O,L,P]=[L,P,Q,tt]}}}for(let x=0,C=c.length;x<C;x++)p.push({line:S(c[x].map(T=>T??NaN),y,b,A,w),points:S(u[x].map(T=>T??NaN),y,b,A,w)});const E=new this.prototype.constructor;return E.build(p,s,r,1,h,f,l),E}#l(t=this.#c){const i=this.#n+t/2*this.#s;return this.#o%180===0?[i/this.#r,i/this.#a]:[i/this.#a,i/this.#r]}#d(){const[t,i,s,r]=this.#t,[l,c]=this.#l(0);return[t+l,i+c,s-2*l,r-2*c]}#h(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:r}of this.#i){if(r.length<=12){for(let u=4,h=r.length;u<h;u+=6)st.pointBoundingBox(r[u],r[u+1],t);continue}let l=r[4],c=r[5];for(let u=6,h=r.length;u<h;u+=6){const[f,p,y,b,A,w]=r.subarray(u,u+6);st.bezierBoundingBox(l,c,f,p,y,b,A,w,t),l=A,c=w}}const[i,s]=this.#l();t[0]=Ue(t[0]-i,0,1),t[1]=Ue(t[1]-s,0,1),t[2]=Ue(t[2]+i,0,1),t[3]=Ue(t[3]+s,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,i){return t==="stroke-width"?this.#f(i):null}#f(t){const[i,s]=this.#l();this.#c=t;const[r,l]=this.#l(),[c,u]=[r-i,l-s],h=this.#t;return h[0]-=c,h[1]-=u,h[2]+=2*c,h[3]+=2*u,h}updateParentDimensions([t,i],s){const[r,l]=this.#l();this.#r=t,this.#a=i,this.#s=s;const[c,u]=this.#l(),h=c-r,f=u-l,p=this.#t;return p[0]-=h,p[1]-=f,p[2]+=2*h,p[3]+=2*f,p}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(it.svgRound).join(" ")}get defaultProperties(){const[t,i]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${it.svgRound(t)} ${it.svgRound(i)}`}}}get rotationTransform(){const[,,t,i]=this.#t;let s=0,r=0,l=0,c=0,u=0,h=0;switch(this.#e){case 90:r=i/t,l=-t/i,u=t;break;case 180:s=-1,c=-1,u=t,h=i;break;case 270:r=-i/t,l=t/i,h=i;break;default:return""}return`matrix(${s} ${r} ${l} ${c} ${it.svgRound(u)} ${it.svgRound(h)})`}getPathResizingSVGProperties([t,i,s,r]){const[l,c]=this.#l(),[u,h,f,p]=this.#t;if(Math.abs(f-l)<=it.PRECISION||Math.abs(p-c)<=it.PRECISION){const S=t+s/2-(u+f/2),E=i+r/2-(h+p/2);return{path:{"transform-origin":`${it.svgRound(t)} ${it.svgRound(i)}`,transform:`${this.rotationTransform} translate(${S} ${E})`}}}const y=(s-2*l)/(f-2*l),b=(r-2*c)/(p-2*c),A=f/s,w=p/r;return{path:{"transform-origin":`${it.svgRound(u)} ${it.svgRound(h)}`,transform:`${this.rotationTransform} scale(${A} ${w}) translate(${it.svgRound(l)} ${it.svgRound(c)}) scale(${y} ${b}) translate(${it.svgRound(-l)} ${it.svgRound(-c)})`}}}getPathResizedSVGProperties([t,i,s,r]){const[l,c]=this.#l(),u=this.#t,[h,f,p,y]=u;if(u[0]=t,u[1]=i,u[2]=s,u[3]=r,Math.abs(p-l)<=it.PRECISION||Math.abs(y-c)<=it.PRECISION){const E=t+s/2-(h+p/2),x=i+r/2-(f+y/2);for(const{line:C,points:T}of this.#i)it._translate(C,E,x,C),it._translate(T,E,x,T);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${it.svgRound(t)} ${it.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const b=(s-2*l)/(p-2*l),A=(r-2*c)/(y-2*c),w=-b*(h+l)+t+l,S=-A*(f+c)+i+c;if(b!==1||A!==1||w!==0||S!==0)for(const{line:E,points:x}of this.#i)it._rescale(E,w,S,b,A,E),it._rescale(x,w,S,b,A,x);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${it.svgRound(t)} ${it.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,i],s){const[r,l]=s,c=this.#t,u=t-c[0],h=i-c[1];if(this.#r===r&&this.#a===l)for(const{line:f,points:p}of this.#i)it._translate(f,u,h,f),it._translate(p,u,h,p);else{const f=this.#r/r,p=this.#a/l;this.#r=r,this.#a=l;for(const{line:y,points:b}of this.#i)it._rescale(y,u,h,f,p,y),it._rescale(b,u,h,f,p,b);c[2]*=f,c[3]*=p}return c[0]=t,c[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${it.svgRound(t)} ${it.svgRound(i)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${it.svgRound(t[0])} ${it.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class gl extends Ym{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:ct._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,i){t==="stroke-width"&&(i??=this["stroke-width"],i*=this._viewParameters.realScale),super.updateSVGProperty(t,i)}clone(){const t=new gl(this._viewParameters);return t.updateAll(this),t}}class wh extends zt{static _type="ink";static _editorType=At.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,i){ct.initialize(t,i),this._defaultDrawingOptions=new gl(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!0}static get typesMap(){return wt(this,"typesMap",new Map([[Nt.INK_THICKNESS,"stroke-width"],[Nt.INK_COLOR,"stroke"],[Nt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,i,s,r,l){return new EA(t,i,s,r,l,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,i,s,r,l,c){return Tr.deserialize(t,i,s,r,l,c)}static async deserialize(t,i,s){let r=null;if(t instanceof Ah){const{data:{inkLists:c,rect:u,rotation:h,id:f,color:p,opacity:y,borderStyle:{rawWidth:b},popupRef:A,richText:w,contentsObj:S,creationDate:E,modificationDate:x},parent:{page:{pageNumber:C}}}=t;r=t={annotationType:At.INK,color:Array.from(p),thickness:b,opacity:y,paths:{points:c},boxes:null,pageIndex:C-1,rect:u.slice(0),rotation:h,annotationElementId:f,id:f,deleted:!1,popupRef:A,richText:w,comment:S?.str||null,creationDate:E,modificationDate:x}}const l=await super.deserialize(t,i,s);return l._initialData=r,t.comment&&l.setCommentData(t),l}get toolbarButtons(){return this._colorPicker||=new vr(this),[["colorPicker",this._colorPicker]]}get colorType(){return Nt.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:i,parent:s}=this;i.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,i.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:i,opacity:s}){this._drawingOptions=wh.getDefaultDrawingOptions({stroke:st.makeHexColor(...t),"stroke-width":i,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:i,points:s}=this.serializeDraw(t),{_drawingOptions:{stroke:r,"stroke-opacity":l,"stroke-width":c}}=this,u=Object.assign(super.serialize(t),{color:ct._colorManager.convert(r),opacity:l,thickness:c,paths:{lines:i,points:s}});return this.addComment(u),t?(u.isCopy=!0,u):this.annotationElementId&&!this.#t(u)?null:(u.id=this.annotationElementId,u)}#t(t){const{color:i,thickness:s,opacity:r,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((c,u)=>c!==i[u])||t.thickness!==s||t.opacity!==r||t.pageIndex!==l}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:i,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:i,popup:this.comment}),null}}class oh extends Tr{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const tl=8,ur=3;class na{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,i,s,r){return s-=t,r-=i,s===0?r>0?0:4:s===1?r+6:2-r}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#i(t,i,s,r,l,c,u){const h=this.#e(s,r,l,c);for(let f=0;f<8;f++){const p=(-f+h-u+16)%8,y=this.#n[2*p],b=this.#n[2*p+1];if(t[(s+y)*i+(r+b)]!==0)return p}return-1}static#r(t,i,s,r,l,c,u){const h=this.#e(s,r,l,c);for(let f=0;f<8;f++){const p=(f+h+u+16)%8,y=this.#n[2*p],b=this.#n[2*p+1];if(t[(s+y)*i+(r+b)]!==0)return p}return-1}static#a(t,i,s,r){const l=t.length,c=new Int32Array(l);for(let p=0;p<l;p++)c[p]=t[p]<=r?1:0;for(let p=1;p<s-1;p++)c[p*i]=c[p*i+i-1]=0;for(let p=0;p<i;p++)c[p]=c[i*s-1-p]=0;let u=1,h;const f=[];for(let p=1;p<s-1;p++){h=1;for(let y=1;y<i-1;y++){const b=p*i+y,A=c[b];if(A===0)continue;let w=p,S=y;if(A===1&&c[b-1]===0)u+=1,S-=1;else if(A>=1&&c[b+1]===0)u+=1,S+=1,A>1&&(h=A);else{A!==1&&(h=Math.abs(A));continue}const E=[y,p],x=S===y+1,C={isHole:x,points:E,id:u,parent:0};f.push(C);let T;for(const W of f)if(W.id===h){T=W;break}T?T.isHole?C.parent=x?T.parent:h:C.parent=x?h:T.parent:C.parent=x?h:0;const B=this.#i(c,i,p,y,w,S,0);if(B===-1){c[b]=-u,c[b]!==1&&(h=Math.abs(c[b]));continue}let O=this.#n[2*B],L=this.#n[2*B+1];const P=p+O,G=y+L;w=P,S=G;let Q=p,tt=y;for(;;){const W=this.#r(c,i,Q,tt,w,S,1);O=this.#n[2*W],L=this.#n[2*W+1];const ut=Q+O,mt=tt+L;E.push(mt,ut);const ht=Q*i+tt;if(c[ht+1]===0?c[ht]=-u:c[ht]===1&&(c[ht]=u),ut===p&&mt===y&&Q===P&&tt===G){c[b]!==1&&(h=Math.abs(c[b]));break}else w=Q,S=tt,Q=ut,tt=mt}}}return f}static#s(t,i,s,r){if(s-i<=4){for(let P=i;P<s-2;P+=2)r.push(t[P],t[P+1]);return}const l=t[i],c=t[i+1],u=t[s-4]-l,h=t[s-3]-c,f=Math.hypot(u,h),p=u/f,y=h/f,b=p*c-y*l,A=h/u,w=1/f,S=Math.atan(A),E=Math.cos(S),x=Math.sin(S),C=w*(Math.abs(E)+Math.abs(x)),T=w*(1-C+C**2),B=Math.max(Math.atan(Math.abs(x+E)*T),Math.atan(Math.abs(x-E)*T));let O=0,L=i;for(let P=i+2;P<s-2;P+=2){const G=Math.abs(b-p*t[P+1]+y*t[P]);G>O&&(L=P,O=G)}O>(f*B)**2?(this.#s(t,i,L+2,r),this.#s(t,L,s,r)):r.push(l,c)}static#o(t){const i=[],s=t.length;return this.#s(t,0,s,i),i.push(t[s-2],t[s-1]),i.length<=4?null:i}static#c(t,i,s,r,l,c){const u=new Float32Array(c**2),h=-2*r**2,f=c>>1;for(let S=0;S<c;S++){const E=(S-f)**2;for(let x=0;x<c;x++)u[S*c+x]=Math.exp((E+(x-f)**2)/h)}const p=new Float32Array(256),y=-2*l**2;for(let S=0;S<256;S++)p[S]=Math.exp(S**2/y);const b=t.length,A=new Uint8Array(b),w=new Uint32Array(256);for(let S=0;S<s;S++)for(let E=0;E<i;E++){const x=S*i+E,C=t[x];let T=0,B=0;for(let L=0;L<c;L++){const P=S+L-f;if(!(P<0||P>=s))for(let G=0;G<c;G++){const Q=E+G-f;if(Q<0||Q>=i)continue;const tt=t[P*i+Q],W=u[L*c+G]*p[Math.abs(tt-C)];T+=tt*W,B+=W}}const O=A[x]=Math.round(T/B);w[O]++}return[A,w]}static#l(t){const i=new Uint32Array(256);for(const s of t)i[s]++;return i}static#d(t){const i=t.length,s=new Uint8ClampedArray(i>>2);let r=-1/0,l=1/0;for(let u=0,h=s.length;u<h;u++){const f=s[u]=t[u<<2];r=Math.max(r,f),l=Math.min(l,f)}const c=255/(r-l);for(let u=0,h=s.length;u<h;u++)s[u]=(s[u]-l)*c;return s}static#h(t){let i,s=-1/0,r=-1/0;const l=t.findIndex(h=>h!==0);let c=l,u=l;for(i=l;i<256;i++){const h=t[i];h>s&&(i-c>r&&(r=i-c,u=i-1),s=h,c=i)}for(i=u-1;i>=0&&!(t[i]>t[i+1]);i--);return i}static#f(t){const i=t,{width:s,height:r}=t,{maxDim:l}=this.#t;let c=s,u=r;if(s>l||r>l){let b=s,A=r,w=Math.log2(Math.max(s,r)/l);const S=Math.floor(w);w=w===S?S-1:S;for(let x=0;x<w;x++){c=Math.ceil(b/2),u=Math.ceil(A/2);const C=new OffscreenCanvas(c,u);C.getContext("2d").drawImage(t,0,0,b,A,0,0,c,u),b=c,A=u,t!==i&&t.close(),t=C.transferToImageBitmap()}const E=Math.min(l/c,l/u);c=Math.round(c*E),u=Math.round(u*E)}const f=new OffscreenCanvas(c,u).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,c,u),f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,c,u);const p=f.getImageData(0,0,c,u).data;return[this.#d(p),c,u]}static extractContoursFromText(t,{fontFamily:i,fontStyle:s,fontWeight:r},l,c,u,h){let f=new OffscreenCanvas(1,1),p=f.getContext("2d",{alpha:!1});const y=200,b=p.font=`${s} ${r} ${y}px ${i}`,{actualBoundingBoxLeft:A,actualBoundingBoxRight:w,actualBoundingBoxAscent:S,actualBoundingBoxDescent:E,fontBoundingBoxAscent:x,fontBoundingBoxDescent:C,width:T}=p.measureText(t),B=1.5,O=Math.ceil(Math.max(Math.abs(A)+Math.abs(w)||0,T)*B),L=Math.ceil(Math.max(Math.abs(S)+Math.abs(E)||y,Math.abs(x)+Math.abs(C)||y)*B);f=new OffscreenCanvas(O,L),p=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),p.font=b,p.filter="grayscale(1)",p.fillStyle="white",p.fillRect(0,0,O,L),p.fillStyle="black",p.fillText(t,O*(B-1)/2,L*(3-B)/2);const P=this.#d(p.getImageData(0,0,O,L).data),G=this.#l(P),Q=this.#h(G),tt=this.#a(P,O,L,Q);return this.processDrawnLines({lines:{curves:tt,width:O,height:L},pageWidth:l,pageHeight:c,rotation:u,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(t,i,s,r,l){const[c,u,h]=this.#f(t),[f,p]=this.#c(c,u,h,Math.hypot(u,h)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),y=this.#h(p),b=this.#a(f,u,h,y);return this.processDrawnLines({lines:{curves:b,width:u,height:h},pageWidth:i,pageHeight:s,rotation:r,innerMargin:l,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:i,pageHeight:s,rotation:r,innerMargin:l,mustSmooth:c,areContours:u}){r%180!==0&&([i,s]=[s,i]);const{curves:h,width:f,height:p}=t,y=t.thickness??0,b=[],A=Math.min(i/f,s/p),w=A/i,S=A/s,E=[];for(const{points:C}of h){const T=c?this.#o(C):C;if(!T)continue;E.push(T);const B=T.length,O=new Float32Array(B),L=new Float32Array(3*(B===2?2:B-2));if(b.push({line:L,points:O}),B===2){O[0]=T[0]*w,O[1]=T[1]*S,L.set([NaN,NaN,NaN,NaN,O[0],O[1]],0);continue}let[P,G,Q,tt]=T;P*=w,G*=S,Q*=w,tt*=S,O.set([P,G,Q,tt],0),L.set([NaN,NaN,NaN,NaN,P,G],0);for(let W=4;W<B;W+=2){const ut=O[W]=T[W]*w,mt=O[W+1]=T[W+1]*S;L.set(it.createBezierPoints(P,G,Q,tt,ut,mt),(W-2)*3),[P,G,Q,tt]=[Q,tt,ut,mt]}}if(b.length===0)return null;const x=u?new oh:new Tr;return x.build(b,i,s,1,r,u?0:y,l),{outline:x,newCurves:E,areContours:u,thickness:y,width:f,height:p}}static async compressSignature({outlines:t,areContours:i,thickness:s,width:r,height:l}){let c=1/0,u=-1/0,h=0;for(const T of t){h+=T.length;for(let B=2,O=T.length;B<O;B++){const L=T[B]-T[B-2];c=Math.min(c,L),u=Math.max(u,L)}}let f;c>=-128&&u<=127?f=Int8Array:c>=-32768&&u<=32767?f=Int16Array:f=Int32Array;const p=t.length,y=tl+ur*p,b=new Uint32Array(y);let A=0;b[A++]=y*Uint32Array.BYTES_PER_ELEMENT+(h-2*p)*f.BYTES_PER_ELEMENT,b[A++]=0,b[A++]=r,b[A++]=l,b[A++]=i?0:1,b[A++]=Math.max(0,Math.floor(s??0)),b[A++]=p,b[A++]=f.BYTES_PER_ELEMENT;for(const T of t)b[A++]=T.length-2,b[A++]=T[0],b[A++]=T[1];const w=new CompressionStream("deflate-raw"),S=w.writable.getWriter();await S.ready,S.write(b);const E=f.prototype.constructor;for(const T of t){const B=new E(T.length-2);for(let O=2,L=T.length;O<L;O++)B[O-2]=T[O]-T[O-2];S.write(B)}S.close();const x=await new Response(w.readable).arrayBuffer(),C=new Uint8Array(x);return vm(C)}static async decompressSignature(t){try{const i=H0(t),{readable:s,writable:r}=new DecompressionStream("deflate-raw"),l=r.getWriter();await l.ready,l.write(i).then(async()=>{await l.ready,await l.close()}).catch(()=>{});let c=null,u=0;for await(const T of s)c||=new Uint8Array(new Uint32Array(T.buffer,0,4)[0]),c.set(T,u),u+=T.length;const h=new Uint32Array(c.buffer,0,c.length>>2),f=h[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const p=h[2],y=h[3],b=h[4]===0,A=h[5],w=h[6],S=h[7],E=[],x=(tl+ur*w)*Uint32Array.BYTES_PER_ELEMENT;let C;switch(S){case Int8Array.BYTES_PER_ELEMENT:C=new Int8Array(c.buffer,x);break;case Int16Array.BYTES_PER_ELEMENT:C=new Int16Array(c.buffer,x);break;case Int32Array.BYTES_PER_ELEMENT:C=new Int32Array(c.buffer,x);break}u=0;for(let T=0;T<w;T++){const B=h[ur*T+tl],O=new Float32Array(B+2);E.push(O);for(let L=0;L<ur-1;L++)O[L]=h[ur*T+tl+L+1];for(let L=0;L<B;L++)O[L+2]=O[L]+C[u++]}return{areContours:b,thickness:A,outlines:E,width:p,height:y}}catch(i){return bt(`decompressSignature: ${i}`),null}}}class _h extends Ym{constructor(){super(),super.updateProperties({fill:ct._defaultLineColor,"stroke-width":0})}clone(){const t=new _h;return t.updateAll(this),t}}class xh extends gl{constructor(t){super(t),super.updateProperties({stroke:ct._defaultLineColor,"stroke-width":1})}clone(){const t=new xh(this._viewParameters);return t.updateAll(this),t}}class Hi extends zt{#t=!1;#e=null;#n=null;#i=null;static _type="signature";static _editorType=At.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,i){ct.initialize(t,i),this._defaultDrawingOptions=new _h,this._defaultDrawnSignatureOptions=new xh(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!1}static get typesMap(){return wt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const i=t.get("hasDescription");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,i;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,t=this.x,i=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:r,mustSmooth:l,areContours:c,description:u,uuid:h,heightInPage:f}=this.#n,{rawDims:{pageWidth:p,pageHeight:y},rotation:b}=this.parent.viewport,A=na.processDrawnLines({lines:r,pageWidth:p,pageHeight:y,rotation:b,innerMargin:Hi._INNER_MARGIN,mustSmooth:l,areContours:c});this.addSignature(A,f,u,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return s&&(this._isCopy=!0,this._moveAfterPaste(t,i)),this.div}setUuid(t){this.#i=t,this.addEditToolbar()}getUuid(){return this.#i}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(i=>{i?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:i,thickness:s,width:r,height:l}=this.#n,c=Math.max(r,l),u=na.processDrawnLines({lines:{curves:t.map(h=>({points:h})),thickness:s,width:r,height:l},pageWidth:c,pageHeight:c,rotation:0,innerMargin:0,mustSmooth:!1,areContours:i});return{areContours:i,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,i,s,r){const{x:l,y:c}=this,{outline:u}=this.#n=t;this.#t=u instanceof oh,this.description=s;let h;this.#t?h=Hi.getDefaultDrawingOptions():(h=Hi._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:h});const[,f]=this.pageDimensions;let p=i/f;p=p>=1?.5:p,this.width*=p/this.height,this.width>=1&&(p*=.9/this.width,this.width=.9),this.height=p,this.setDims(),this.x=l,this.y=c,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:r}=this.parent.viewport;return na.process(t,i,s,r,Hi._INNER_MARGIN)}getFromText(t,i){const{rawDims:{pageWidth:s,pageHeight:r},rotation:l}=this.parent.viewport;return na.extractContoursFromText(t,i,s,r,l,Hi._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:r}=this.parent.viewport;return na.processDrawnLines({lines:t,pageWidth:i,pageHeight:s,rotation:r,innerMargin:Hi._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:i}){t?this._drawingOptions=Hi.getDefaultDrawingOptions():(this._drawingOptions=Hi._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":i}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:i,points:s}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":r}}=this,l=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:r});return this.addComment(l),t?(l.paths={lines:i,points:s},l.uuid=this.#i,l.isCopy=!0):l.lines=i,this.#e&&(l.accessibilityData={type:"Figure",alt:this.#e}),l}static deserializeDraw(t,i,s,r,l,c){return c.areContours?oh.deserialize(t,i,s,r,l,c):Tr.deserialize(t,i,s,r,l,c)}static async deserialize(t,i,s){const r=await super.deserialize(t,i,s);return r.#t=t.areContours,r.description=t.accessibilityData?.alt||"",r.#i=t.uuid,r}}class TA extends ct{#t=null;#e=null;#n=null;#i=null;#r=null;#a="";#s=null;#o=!1;#c=null;#l=!1;#d=!1;static _type="stamp";static _editorType=At.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#i=t.bitmapUrl,this.#r=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,i){ct.initialize(t,i)}static isHandlingMimeForPasting(t){return Wu.includes(t)}static paste(t,i){i.pasteEditor({mode:At.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const i=t.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}#h(t,i=!1){if(!t){this.remove();return}this.#t=t.bitmap,i||(this.#e=t.id,this.#l=t.isSvg),t.file&&(this.#a=t.file.name),this.#p()}#f(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#s){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:l,height:c}=t||this.copyCanvas(null,null,!0).imageData,u=await s.guess({name:"altText",request:{data:r,width:l,height:c,channels:r.length/(l*c)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const h=u.output;return await this.setGuessedAltText(h),i&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#m(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(s=>this.#h(s,!0)).finally(()=>this.#f());return}if(this.#i){const s=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(s).then(r=>this.#h(r)).finally(()=>this.#f());return}if(this.#r){const s=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(s).then(r=>this.#h(r)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=Wu.join(",");const i=this._uiManager._signal;this.#n=new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(r)}s()},{signal:i}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:i})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#s?.remove(),this.#s=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#m();return}super.rebuild(),this.div!==null&&(this.#e&&this.#s===null&&this.#m(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#n||this.#t||this.#i||this.#r||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,i;return this._isCopy&&(t=this.x,i=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#p():this.#m()),this._isCopy&&this._moveAfterPaste(t,i),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,i){const{id:s,bitmap:r}=this._uiManager.imageManager.getFromCanvas(t,i);i.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(this.#e=s,r&&(this.#t=r),this.#o=!1,this.#p())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#g()},t)}#p(){const{div:t}=this;let{width:i,height:s}=this.#t;const[r,l]=this.pageDimensions,c=.75;if(this.width)i=this.width*r,s=this.height*l;else if(i>c*r||s>c*l){const h=Math.min(c*r/i,c*l/s);i*=h,s*=h}this._uiManager.enableWaiting(!1);const u=this.#s=document.createElement("canvas");u.setAttribute("role","img"),this.addContainer(u),this.width=i/r,this.height=s/l,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#g(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#a&&this.div.setAttribute("aria-description",this.#a),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,i,s=!1){t||(t=224);const{width:r,height:l}=this.#t,c=new Gi;let u=this.#t,h=r,f=l,p=null;if(i){if(r>i||l>i){const L=Math.min(i/r,i/l);h=Math.floor(r*L),f=Math.floor(l*L)}p=document.createElement("canvas");const b=p.width=Math.ceil(h*c.sx),A=p.height=Math.ceil(f*c.sy);this.#l||(u=this.#u(b,A));const w=p.getContext("2d");w.filter=this._uiManager.hcmFilter;let S="white",E="#cfcfd8";this._uiManager.hcmFilter!=="none"?E="black":Y0.isDarkMode&&(S="#8f8f9d",E="#42414d");const x=15,C=x*c.sx,T=x*c.sy,B=new OffscreenCanvas(C*2,T*2),O=B.getContext("2d");O.fillStyle=S,O.fillRect(0,0,C*2,T*2),O.fillStyle=E,O.fillRect(0,0,C,T),O.fillRect(C,T,C,T),w.fillStyle=w.createPattern(B,"repeat"),w.fillRect(0,0,b,A),w.drawImage(u,0,0,u.width,u.height,0,0,b,A)}let y=null;if(s){let b,A;if(c.symmetric&&u.width<t&&u.height<t)b=u.width,A=u.height;else if(u=this.#t,r>t||l>t){const E=Math.min(t/r,t/l);b=Math.floor(r*E),A=Math.floor(l*E),this.#l||(u=this.#u(b,A))}const S=new OffscreenCanvas(b,A).getContext("2d",{willReadFrequently:!0});S.drawImage(u,0,0,u.width,u.height,0,0,b,A),y={width:b,height:A,data:S.getImageData(0,0,b,A).data}}return{canvas:p,width:h,height:f,imageData:y}}#u(t,i){const{width:s,height:r}=this.#t;let l=s,c=r,u=this.#t;for(;l>2*t||c>2*i;){const h=l,f=c;l>2*t&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),c>2*i&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const p=new OffscreenCanvas(l,c);p.getContext("2d").drawImage(u,0,0,h,f,0,0,l,c),u=p.transferToImageBitmap()}return u}#g(){const[t,i]=this.parentDimensions,{width:s,height:r}=this,l=new Gi,c=Math.ceil(s*t*l.sx),u=Math.ceil(r*i*l.sy),h=this.#s;if(!h||h.width===c&&h.height===u)return;h.width=c,h.height=u;const f=this.#l?this.#t:this.#u(c,u),p=h.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(f,0,0,f.width,f.height,0,0,c,u)}#y(t){if(t){if(this.#l){const r=this._uiManager.imageManager.getSvgUrl(this.#e);if(r)return r}const i=document.createElement("canvas");return{width:i.width,height:i.height}=this.#t,i.getContext("2d").drawImage(this.#t,0,0),i.toDataURL()}if(this.#l){const[i,s]=this.pageDimensions,r=Math.round(this.width*i*ha.PDF_TO_CSS_UNITS),l=Math.round(this.height*s*ha.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(r,l);return c.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,r,l),c.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,i,s){let r=null,l=!1;if(t instanceof Vm){const{data:{rect:S,rotation:E,id:x,structParent:C,popupRef:T,richText:B,contentsObj:O,creationDate:L,modificationDate:P},container:G,parent:{page:{pageNumber:Q}},canvas:tt}=t;let W,ut;tt?(delete t.canvas,{id:W,bitmap:ut}=s.imageManager.getFromCanvas(G.id,tt),tt.remove()):(l=!0,t._hasNoCanvas=!0);const mt=(await i._structTree.getAriaAttributes(`${sa}${x}`))?.get("aria-label")||"";r=t={annotationType:At.STAMP,bitmapId:W,bitmap:ut,pageIndex:Q-1,rect:S.slice(0),rotation:E,annotationElementId:x,id:x,deleted:!1,accessibilityData:{decorative:!1,altText:mt},isSvg:!1,structParent:C,popupRef:T,richText:B,comment:O?.str||null,creationDate:L,modificationDate:P}}const c=await super.deserialize(t,i,s),{rect:u,bitmap:h,bitmapUrl:f,bitmapId:p,isSvg:y,accessibilityData:b}=t;l?(s.addMissingCanvas(t.id,c),c.#o=!0):p&&s.imageManager.isValidId(p)?(c.#e=p,h&&(c.#t=h)):c.#i=f,c.#l=y;const[A,w]=c.pageDimensions;return c.width=(u[2]-u[0])/A,c.height=(u[3]-u[1])/w,b&&(c.altTextData=b),c._initialData=r,t.comment&&c.setCommentData(t),c.#d=!!r,c}serialize(t=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#l});if(this.addComment(s),t)return s.bitmapUrl=this.#y(!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:r,altText:l}=this.serializeAltText(!1);if(!r&&l&&(s.accessibilityData={type:"Figure",alt:l}),this.annotationElementId){const u=this.#v(s);return u.isSame?null:(u.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1,s.id=this.annotationElementId,delete s.bitmapId,s)}if(i===null)return s;i.stamps||=new Map;const c=this.#l?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!i.stamps.has(this.#e))i.stamps.set(this.#e,{area:c,serialized:s}),s.bitmap=this.#y(!1);else if(this.#l){const u=i.stamps.get(this.#e);c>u.area&&(u.area=c,u.serialized.bitmap.close(),u.serialized.bitmap=this.#y(!1))}return s}#v(t){const{pageIndex:i,accessibilityData:{altText:s}}=this._initialData,r=t.pageIndex===i,l=(t.accessibilityData?.alt||"")===s;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&r&&l,isSameAltText:l}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class un{#t;#e=!1;#n=null;#i=null;#r=null;#a=new Map;#s=!1;#o=!1;#c=!1;#l=null;#d=null;#h=null;#f=null;#m=null;#p=-1;#u;static _initialized=!1;static#g=new Map([ve,wh,TA,oe,Hi].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:i,div:s,structTreeLayer:r,accessibilityManager:l,annotationLayer:c,drawLayer:u,textLayer:h,viewport:f,l10n:p}){const y=[...un.#g.values()];if(!un._initialized){un._initialized=!0;for(const b of y)b.initialize(p,t)}t.registerEditorTypes(y),this.#u=t,this.pageIndex=i,this.div=s,this.#t=l,this.#n=c,this.viewport=f,this.#h=h,this.drawLayer=u,this._structTree=r,this.#u.addLayer(this)}get isEmpty(){return this.#a.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===At.NONE}updateToolbar(t){this.#u.updateToolbar(t)}updateMode(t=this.#u.getMode()){switch(this.#S(),t){case At.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case At.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case At.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:i}=this.div;if(i.toggle("nonEditing",!1),t===At.POPUP)i.toggle("commentEditing",!0);else{i.toggle("commentEditing",!1);for(const s of un.#g.values())i.toggle(`${s._type}Editing`,t===s._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}setEditingState(t){this.#u.setEditingState(t)}addCommands(t){this.#u.addCommands(t)}cleanUndoStack(t){this.#u.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.togglePointerEvents(t)}get#y(){return this.#a.size!==0?this.#a.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#m?.abort(),this.#m=null;const t=new Set;for(const s of this.#y)s.enableEditing(),s.show(!0),s.annotationElementId&&(this.#u.removeChangedExistingAnnotation(s),t.add(s.annotationElementId));const i=this.#n;if(i)for(const s of i.getEditableAnnotations()){if(s.hide(),this.#u.isDeletedAnnotationElement(s.data.id)||t.has(s.data.id))continue;const r=await this.deserialize(s);r&&(this.addOrRebuild(r),r.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#m){this.#m=new AbortController;const r=this.#u.combinedSignal(this.#m);this.#h.div.addEventListener("pointerdown",l=>{const{clientX:u,clientY:h,timeStamp:f}=l,p=this.#p;if(f-p>500){this.#p=f;return}this.#p=-1;const{classList:y}=this.div;y.toggle("getElements",!0);const b=document.elementsFromPoint(u,h);if(y.toggle("getElements",!1),!this.div.contains(b[0]))return;let A;const w=new RegExp(`^${pr}[0-9]+$`);for(const E of b)if(w.test(E.id)){A=E.id;break}if(!A)return;const S=this.#a.get(A);S?.annotationElementId===null&&(l.stopPropagation(),l.preventDefault(),S.dblclick(l))},{signal:r,capture:!0})}const t=this.#n,i=[];if(t){const r=new Map,l=new Map;for(const u of this.#y){if(u.disableEditing(),!u.annotationElementId){i.push(u);continue}if(u.serialize()!==null){r.set(u.annotationElementId,u);continue}else l.set(u.annotationElementId,u);this.getEditableAnnotation(u.annotationElementId)?.show(),u.remove()}const c=t.getEditableAnnotations();for(const u of c){const{id:h}=u.data;if(this.#u.isDeletedAnnotationElement(h)){u.updateEdited({deleted:!0});continue}let f=l.get(h);if(f){f.resetAnnotationElement(u),f.show(!1),u.show();continue}f=r.get(h),f&&(this.#u.addChangedExistingAnnotation(f),f.renderAnnotationElement(u)&&f.show(!1)),u.show()}}this.#S(),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const r of un.#g.values())s.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),t?.updateFakeAnnotations(i),this.#o=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#u.getActive()!==t&&this.#u.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const t=this.#u.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#v.bind(this),{signal:t}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#v(t){this.#u.unselectAll();const{target:i}=t;if(i===this.#h.div||(i.getAttribute("role")==="img"||i.classList.contains("endOfContent"))&&this.#h.div.contains(i)){const{isMac:s}=De.platform;if(t.button!==0||t.ctrlKey&&s)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),oe.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:t.x,y:t.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const t=this.#u.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const i=this.pointerup.bind(this);this.div.addEventListener("pointerup",i,{signal:t}),this.div.addEventListener("pointercancel",i,{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#a.set(t.id,t);const{annotationElementId:i}=t;i&&this.#u.isDeletedAnnotationElement(i)&&this.#u.removeDeletedAnnotationElement(t)}detach(t){this.#a.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#u.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#u.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#u.addDeletedAnnotationElement(t.annotationElementId),ct.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#u.addEditor(t),this.attach(t),!t.isAttachedToDOM){const i=t.render();this.div.append(i),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#u.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:i}=document;t.div.contains(i)&&!this.#r&&(t._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),i.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const i=()=>t._uiManager.rebuild(t),s=()=>{t.remove()};this.addCommands({cmd:i,undo:s,mustExec:!1})}getEditorByUID(t){for(const i of this.#a.values())if(i.uid===t)return i;return null}getNextId(){return this.#u.getId()}get#b(){return un.#g.get(this.#u.getMode())}combinedSignal(t){return this.#u.combinedSignal(t)}#E(t){const i=this.#b;return i?new i.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#b?.canCreateNewEmptyEditor()}async pasteEditor(t,i){this.updateToolbar(t),await this.#u.updateMode(t.mode);const{offsetX:s,offsetY:r}=this.#_(),l=this.getNextId(),c=this.#E({parent:this,id:l,x:s,y:r,uiManager:this.#u,isCentered:!0,...i});c&&this.add(c)}async deserialize(t){return await un.#g.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#u)||null}createAndAddNewEditor(t,i,s={}){const r=this.getNextId(),l=this.#E({parent:this,id:r,x:t.offsetX,y:t.offsetY,uiManager:this.#u,isCentered:i,...s});return l&&this.add(l),l}get boundingClientRect(){return this.div.getBoundingClientRect()}#_(){const{x:t,y:i,width:s,height:r}=this.boundingClientRect,l=Math.max(0,t),c=Math.max(0,i),u=Math.min(window.innerWidth,t+s),h=Math.min(window.innerHeight,i+r),f=(l+u)/2-t,p=(c+h)/2-i,[y,b]=this.viewport.rotation%180===0?[f,p]:[p,f];return{offsetX:y,offsetY:b}}addNewEditor(t={}){this.createAndAddNewEditor(this.#_(),!0,t)}setSelected(t){this.#u.setSelected(t)}toggleSelected(t){this.#u.toggleSelected(t)}unselect(t){this.#u.unselect(t)}pointerup(t){const{isMac:i}=De.platform;if(t.button!==0||t.ctrlKey&&i||t.target!==this.div||!this.#s||(this.#s=!1,this.#b?.isDrawer&&this.#b.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const s=this.#u.getMode();if(s===At.STAMP||s===At.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#u.getMode()===At.HIGHLIGHT&&this.enableTextSelection(),this.#s){this.#s=!1;return}const{isMac:i}=De.platform;if(t.button!==0||t.ctrlKey&&i||t.target!==this.div)return;if(this.#s=!0,this.#b?.isDrawer){this.startDrawingSession(t);return}const s=this.#u.getActive();this.#e=!s||s.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#l){this.#b.startDrawing(this,this.#u,!1,t);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const i=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(this.#d=null,this.commitOrRemove())},{signal:i}),this.#b.startDrawing(this,this.#u,!1,t)}pause(t){if(t){const{activeElement:i}=document;this.div.contains(i)&&(this.#d=i);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#b.endDrawing(t)):null}findNewParent(t,i,s){const r=this.#u.findParent(i,s);return r===null||r===this?!1:(r.changeParent(t),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#b.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(const t of this.#a.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#a.clear(),this.#u.removeLayer(this)}#S(){for(const t of this.#a.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,cs(this.div,t);for(const i of this.#u.getEditors(this.pageIndex))this.add(i),i.rebuild();this.updateMode()}update({viewport:t}){this.#u.commitOrRemove(),this.#S();const i=this.viewport.rotation,s=t.rotation;if(this.viewport=t,cs(this.div,{rotation:s}),i!==s)for(const r of this.#a.values())r.rotate(s)}get pageDimensions(){const{pageWidth:t,pageHeight:i}=this.viewport.rawDims;return[t,i]}get scale(){return this.#u.viewParameters.realScale}}class Ce{#t=null;#e=new Map;#n=new Map;static#i=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const i of this.#e.values())i.remove(),t.append(i);this.#t=t}}static get _svgFactory(){return wt(this,"_svgFactory",new rl)}static#r(t,[i,s,r,l]){const{style:c}=t;c.top=`${100*s}%`,c.left=`${100*i}%`,c.width=`${100*r}%`,c.height=`${100*l}%`}#a(){const t=Ce._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#s(t,i){const s=Ce._svgFactory.createElement("clipPath");t.append(s);const r=`clip_${i}`;s.setAttribute("id",r),s.setAttribute("clipPathUnits","objectBoundingBox");const l=Ce._svgFactory.createElement("use");return s.append(l),l.setAttribute("href",`#${i}`),l.classList.add("clip"),r}#o(t,i){for(const[s,r]of Object.entries(i))r===null?t.removeAttribute(s):t.setAttribute(s,r)}draw(t,i=!1,s=!1){const r=Ce.#i++,l=this.#a(),c=Ce._svgFactory.createElement("defs");l.append(c);const u=Ce._svgFactory.createElement("path");c.append(u);const h=`path_p${this.pageIndex}_${r}`;u.setAttribute("id",h),u.setAttribute("vector-effect","non-scaling-stroke"),i&&this.#n.set(r,u);const f=s?this.#s(c,h):null,p=Ce._svgFactory.createElement("use");return l.append(p),p.setAttribute("href",`#${h}`),this.updateProperties(l,t),this.#e.set(r,l),{id:r,clipPathId:`url(#${f})`}}drawOutline(t,i){const s=Ce.#i++,r=this.#a(),l=Ce._svgFactory.createElement("defs");r.append(l);const c=Ce._svgFactory.createElement("path");l.append(c);const u=`path_p${this.pageIndex}_${s}`;c.setAttribute("id",u),c.setAttribute("vector-effect","non-scaling-stroke");let h;if(i){const y=Ce._svgFactory.createElement("mask");l.append(y),h=`mask_p${this.pageIndex}_${s}`,y.setAttribute("id",h),y.setAttribute("maskUnits","objectBoundingBox");const b=Ce._svgFactory.createElement("rect");y.append(b),b.setAttribute("width","1"),b.setAttribute("height","1"),b.setAttribute("fill","white");const A=Ce._svgFactory.createElement("use");y.append(A),A.setAttribute("href",`#${u}`),A.setAttribute("stroke","none"),A.setAttribute("fill","black"),A.setAttribute("fill-rule","nonzero"),A.classList.add("mask")}const f=Ce._svgFactory.createElement("use");r.append(f),f.setAttribute("href",`#${u}`),h&&f.setAttribute("mask",`url(#${h})`);const p=f.cloneNode();return r.append(p),f.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(r,t),this.#e.set(s,r),s}finalizeDraw(t,i){this.#n.delete(t),this.updateProperties(t,i)}updateProperties(t,i){if(!i)return;const{root:s,bbox:r,rootClass:l,path:c}=i,u=typeof t=="number"?this.#e.get(t):t;if(u){if(s&&this.#o(u,s),r&&Ce.#r(u,r),l){const{classList:h}=u;for(const[f,p]of Object.entries(l))h.toggle(f,p)}if(c){const f=u.firstChild.firstChild;this.#o(f,c)}}}updateParent(t,i){if(i===this)return;const s=this.#e.get(t);s&&(i.#t.append(s),this.#e.delete(t),i.#e.set(t,s))}remove(t){this.#n.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#n.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:ah};globalThis.pdfjsLib={AbortException:Un,AnnotationEditorLayer:un,AnnotationEditorParamsType:Nt,AnnotationEditorType:At,AnnotationEditorUIManager:Fn,AnnotationLayer:Sh,AnnotationMode:zn,AnnotationType:fe,applyOpacity:K0,build:iA,ColorPicker:wi,createValidAbsoluteUrl:pm,CSSConstants:$0,DOMSVGFactory:rl,DrawLayer:Ce,FeatureTest:De,fetchData:Sr,findContrastColor:Q0,getDocument:yh,getFilenameFromUrl:I0,getPdfFilenameFromUrl:G0,getRGB:_r,getUuid:bm,getXfaPageViewport:V0,GlobalWorkerOptions:ls,ImageKind:el,InvalidPDFException:Qu,isDataScheme:hl,isPdfFile:uh,isValidExplicitDest:rv,MathClamp:Ue,noContextMenu:_i,normalizeUnicode:F0,OPS:mr,OutputScale:Gi,PasswordResponses:R0,PDFDataRangeTransport:Um,PDFDateString:Zu,PDFWorker:br,PermissionFlag:D0,PixelsPerInch:ha,RenderingCancelledException:ch,renderRichText:Sm,ResponseException:sl,setLayerDimensions:cs,shadow:wt,SignatureExtractor:na,stopEvent:se,SupportedImageMimeTypes:Wu,TextLayer:ze,TouchManager:dl,updateUrlHash:mm,Util:st,VerbosityLevel:ll,version:eA,XfaLayer:Am};const $m="/assets/pdf.worker.min-Cpi8b8z3.mjs";ls.workerSrc=$m;async function CA(m){const t=await m.arrayBuffer(),i=await yh({data:t}).promise;try{const r=(await i.getPage(1)).getViewport({scale:1}),l=r.width,c=r.height,u=l/72,h=c/72,f=dm();return f.push("Vector PDF detected. DPI and scaling are determined at print time; verify artwork before rasterization."),{fileType:"pdf",fileSizeMB:Ze(m.size/(1024*1024),2),pixels:void 0,dpi:null,hasICC:!1,bitDepth:void 0,hasAlpha:!1,iccProfile:void 0,alphaStats:void 0,imageCategory:"Vector",recommendedSizes:_0(u,h),aspectRatio:gm(l,c),rating:"VectorPDF",notes:f}}finally{i.cleanup(),i.destroy()}}function MA(m){return`#${m.map(t=>t.toString(16).padStart(2,"0")).join("")}`}function DA(m){const t=new Blob([JSON.stringify(m,null,2)],{type:"application/json"}),i=m.top.length?m.top:m.allGrouped,s=["hex,percent,count"];s.push(...i.map(l=>{const c=typeof l.percent=="number"?l.percent.toFixed(2):"",u=l.count??"";return`${l.hex},${c},${u}`}));const r=new Blob([s.join(`
`)],{type:"text/csv"});return{jsonUrl:URL.createObjectURL(t),csvUrl:URL.createObjectURL(r)}}function um(m){return m.map(t=>({...t,hex:t.hex.toUpperCase(),percent:typeof t.percent=="number"?Number(t.percent.toFixed(2)):t.percent}))}const RA=1024,NA=12e4,ta=24,OA=32;function LA(m,t){if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(m,t);const i=document.createElement("canvas");return i.width=m,i.height=t,i}async function kA(m){return await new Promise((t,i)=>{const s=new Image;s.crossOrigin="anonymous",s.onload=()=>t(s),s.onerror=r=>i(r),s.src=m})}async function BA(m){const t=URL.createObjectURL(m);try{const i=await kA(t),s=Math.min(1,RA/Math.max(i.width,i.height)),r=Math.max(1,Math.round(i.width*s)),l=Math.max(1,Math.round(i.height*s)),u=LA(r,l).getContext("2d");if(!u)return{top:[],allGrouped:[]};u.drawImage(i,0,0,r,l);const{data:h}=u.getImageData(0,0,r,l),f=Math.max(1,Math.floor(Math.sqrt(r*l/NA))),p=new Map;let y=0,b=0,A=0,w=0,S=255,E=0;for(let O=0;O<l;O+=f)for(let L=0;L<r;L+=f){const P=(O*r+L)*4,G=h[P+3];if(y+=1,G<S&&(S=G),G>E&&(E=G),G===0?b+=1:G===255?w+=1:A+=1,G<OA)continue;const Q=h[P],tt=h[P+1],W=h[P+2],ut=Math.round(Q/ta)*ta,mt=Math.round(tt/ta)*ta,ht=Math.round(W/ta)*ta,vt=`${ut}-${mt}-${ht}`,k=p.get(vt)??{r:0,g:0,b:0,count:0};k.r+=Q,k.g+=tt,k.b+=W,k.count+=1,p.set(vt,k)}const x=Array.from(p.values());if(!x.length)return{top:[],allGrouped:[]};const C=x.reduce((O,L)=>O+L.count,0),T=x.map(O=>{const L=O.count,P=[Math.round(O.r/L),Math.round(O.g/L),Math.round(O.b/L)],G=C>0?L/C*100:void 0;return{rgb:P,hex:MA(P),percent:G,count:L}}).sort((O,L)=>(L.count??0)-(O.count??0));let B;if(y>0){const O=Ze(b/y*100,2),L=Ze(A/y*100,2),P=Ze(w/y*100,2);B={present:b>0||A>0,min:S,max:E,transparentPercent:O,semiTransparentPercent:L,opaquePercent:P,transparentCount:b,semiTransparentCount:A,opaqueCount:w,sampleSize:y}}return{top:um(T.slice(0,8)),allGrouped:um(T),alphaStats:B}}finally{URL.revokeObjectURL(t)}}const zA=new Set(["image/png","image/x-png"]),PA=new Set(["application/pdf"]);function UA(m){const t=m.toLowerCase();return t.endsWith(".png")?"png":t.endsWith(".pdf")?"pdf":null}function FA(m){return zA.has(m.type)?"png":PA.has(m.type)?"pdf":UA(m.name)}async function jA(m){const t=FA(m);if(t==="png"){const[i,s]=await Promise.all([M0(m),BA(m).catch(()=>null)]);return s?.alphaStats&&(i.alphaStats=s.alphaStats),{quality:i,colors:s??void 0}}if(t==="pdf")return{quality:await CA(m)};throw new Error("Unsupported file type. Please upload a PNG or PDF artwork file.")}ls.workerSrc=$m;async function HA(m){return await new Promise((t,i)=>{const s=new Image;s.onload=()=>t(s),s.onerror=r=>i(r),s.src=m})}async function IA(m,t){const i=URL.createObjectURL(m);try{let s=t.pixels?.w??0,r=t.pixels?.h??0;if(!s||!r){const l=await HA(i);s=l.naturalWidth,r=l.naturalHeight}return{url:i,width:s,height:r,cleanup:()=>URL.revokeObjectURL(i)}}catch(s){throw URL.revokeObjectURL(i),s}}async function GA(m){const t=await m.arrayBuffer(),i=await yh({data:t}).promise;try{const s=await i.getPage(1),r=s.getViewport({scale:1}),l=document.createElement("canvas"),c=l.getContext("2d");return c?(l.width=r.width,l.height=r.height,await s.render({canvas:l,canvasContext:c,viewport:r}).promise,{url:l.toDataURL("image/png"),width:r.width,height:r.height,cleanup:()=>{l.width=0,l.height=0}}):void 0}finally{i.cleanup(),i.destroy()}}async function qA(m,t){if(t.fileType==="png")return IA(m,t);if(t.fileType==="pdf")return GA(m)}const VA=["md","markdown","txt"],hm=1024*1024*2,Yu=m=>{if(m===0)return"0 B";const t=1024,i=["B","KB","MB","GB"],s=Math.floor(Math.log(m)/Math.log(t)),r=m/Math.pow(t,s);return`${r.toFixed(r>=10||s===0?0:1)} ${i[s]}`};function XA(m){const t=m.toLowerCase().split(".");return t.length<2?!1:VA.includes(t.pop())}function YA(m){return typeof m!="number"||Number.isNaN(m)?"N/A":`${m.toFixed(2)} MB`}function $A(m){const t=new Date(m);return Number.isNaN(t.getTime())?m:t.toLocaleString()}function KA(){const[m,t]=pt.useState("analyze"),[i,s]=pt.useState(null),[r,l]=pt.useState(null),[c,u]=pt.useState(!1),[h,f]=pt.useState(null),[p,y]=pt.useState("How ready is this file for DTF printing?"),[b,A]=pt.useState(null),[w,S]=pt.useState(null),[E,x]=pt.useState(!1),[C,T]=pt.useState(null),[B,O]=pt.useState(""),[L,P]=pt.useState(!1),[G,Q]=pt.useState(!1),[tt,W]=pt.useState(null),[ut,mt]=pt.useState(null),[ht,vt]=pt.useState(""),[k,q]=pt.useState(!0),[Z,gt]=pt.useState([]),[xt,R]=pt.useState(!1),[I,K]=pt.useState(!1),[et,ot]=pt.useState(null),[ft,at]=pt.useState(null),[$t,Ct]=pt.useState("info"),ci=pt.useRef(null),[Oe,We]=pt.useState(null),xi=pt.useRef(null),Ei=pt.useMemo(()=>{switch($t){case"success":return"text-emerald-500";case"error":return"text-destructive";default:return"text-muted-foreground"}},[$t]);pt.useEffect(()=>{if(!i?.colors||i.colors.top.length===0){f(J=>(J&&(URL.revokeObjectURL(J.csvUrl),URL.revokeObjectURL(J.jsonUrl)),null));return}const $=DA(i.colors);return f(J=>(J&&(URL.revokeObjectURL(J.csvUrl),URL.revokeObjectURL(J.jsonUrl)),$)),()=>{URL.revokeObjectURL($.csvUrl),URL.revokeObjectURL($.jsonUrl)}},[i]),pt.useEffect(()=>{y("How ready is this file for DTF printing?"),A(null),S(null)},[i?.fileName]);const fs=pt.useCallback(async $=>{u(!0),l(null),xi.current?.(),xi.current=null;try{const{quality:J,colors:Wt}=await jA($);let pe;try{pe=await qA($,J)}catch(Oi){console.warn("Failed to generate artwork preview:",Oi)}pe&&(xi.current=pe.cleanup),s({fileName:$.name,quality:J,colors:Wt,preview:pe})}catch(J){const Wt=J instanceof Error?J.message:"Unexpected error analysing artwork.";l(Wt),s(null)}finally{u(!1)}},[]),da=pt.useCallback(async()=>{if(!i)return;const $=p.trim();if(!$){S("Please enter a question for the assistant.");return}x(!0),S(null);try{const J=await fetch("/api/ai/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:$,quality:i.quality,colors:i.colors})});if(!J.ok){const pe=await J.text();throw new Error(pe||`Request failed with status ${J.status}`)}const Wt=await J.json();A(Wt.answer)}catch(J){A(null),S(J instanceof Error?J.message:"AI assistant request failed.")}finally{x(!1)}},[i,p]),pl=pt.useCallback($=>{const J=$.target.files?.[0];J&&(fs(J),$.target.value="")},[fs]),Cr=pt.useCallback($=>{const J=$.target.files?.[0]??null;if(ot(null),!J){We(null);return}if(!XA(J.name)){We(null),at("Only Markdown (.md) or plain text (.txt) files are supported."),Ct("error"),$.target.value="";return}if(J.size>hm){We(null),at(`Document is too large (${Yu(J.size)}). Maximum allowed is ${Yu(hm)}.`),Ct("error"),$.target.value="";return}We(J),at(`Ready to upload ${J.name} (${Yu(J.size)}).`),Ct("info")},[]),je=pt.useCallback(async($,J)=>{const Wt=new Headers(J?.headers);return ht.trim()&&Wt.set("Authorization",`Bearer ${ht.trim()}`),fetch($,{...J,headers:Wt})},[ht]),gs=pt.useCallback(async()=>{P(!0),mt(null);try{const $=await je("/api/config");if(!$.ok){const Wt=await $.text();throw new Error(Wt||`Failed to load config (${$.status})`)}const J=await $.json();T(J),O("")}catch($){mt($ instanceof Error?$.message:"Unable to load configuration.")}finally{P(!1)}},[je]),Ri=pt.useCallback(async()=>{R(!0),at(null);try{const $=await je("/api/docs");if(!$.ok){const Wt=await $.text();throw new Error(Wt||`Failed to load documents (${$.status})`)}const J=await $.json();gt(J)}catch($){at($ instanceof Error?$.message:"Unable to load documents.")}finally{R(!1)}},[je]);pt.useEffect(()=>{if(m==="admin"){const $=window.localStorage.getItem("artwork-admin-token");$&&vt($)}},[m]),pt.useEffect(()=>{m==="admin"&&(gs(),Ri())},[m,gs,Ri]);const ml=pt.useCallback(async()=>{if(C){k&&(ht.trim()?window.localStorage.setItem("artwork-admin-token",ht.trim()):window.localStorage.removeItem("artwork-admin-token")),Q(!0),W(null),mt(null);try{const $={provider:C.provider,model:C.model,embeddingModel:C.embeddingModel,systemPrompt:C.systemPrompt};B.trim()&&($.apiKey=B.trim());const J=await je("/api/config",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify($)});if(!J.ok){const pe=await J.text();throw new Error(pe||`Failed to save configuration (${J.status})`)}const Wt=await J.json();T(Wt),O(""),W("Configuration saved successfully.")}catch($){mt($ instanceof Error?$.message:"Unable to save configuration.")}finally{Q(!1)}}},[C,B,ht,k,je]),yl=pt.useCallback(async()=>{if(!Oe){at("Select a .md or .txt file to upload first."),Ct("error");return}K(!0),ot(0),at("Reading document..."),Ct("info");try{const $=await new Promise((pe,Oi)=>{const ee=new FileReader;ee.onerror=()=>Oi(ee.error??new Error("Failed to read document.")),ee.onabort=()=>Oi(new Error("Document read aborted.")),ee.onprogress=Re=>{if(Re.lengthComputable){const ke=Math.min(80,Math.round(Re.loaded/Re.total*80));ot(ke)}},ee.onload=()=>{ot(Re=>Re!==null&&Re>80?Re:80),pe(typeof ee.result=="string"?ee.result:"")},ee.readAsText(Oe)});at("Uploading to worker..."),Ct("info"),ot(pe=>pe!==null&&pe>90?pe:90);const J=await je("/api/docs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filename:Oe.name,content:$})});if(!J.ok){const pe=await J.text();throw new Error(pe||`Failed to upload document (${J.status})`)}const Wt=await J.json();ot(100),at(`Uploaded ${Oe.name} (${Wt.chunks} chunks).`),Ct("success"),We(null),ci.current&&(ci.current.value=""),Ri()}catch($){at($ instanceof Error?$.message:"Document upload failed."),Ct("error")}finally{K(!1),setTimeout(()=>ot(null),250)}},[Oe,Ri,je,ci]),Le=pt.useCallback(async $=>{try{const J=await je(`/api/docs/${encodeURIComponent($)}`,{method:"DELETE"});if(!J.ok){const Wt=await J.text();throw new Error(Wt||`Failed to delete document (${J.status})`)}at(`Removed document ${$}.`),Ri()}catch(J){at(J instanceof Error?J.message:"Unable to remove document.")}},[Ri,je]),bl=pt.useMemo(()=>[{value:"claude",label:"Claude (Workers AI)"},{value:"openai",label:"OpenAI (coming soon)",disabled:!0}],[]),Je=i?.quality.alphaStats??i?.colors?.alphaStats??null,Ae=i?.preview,Ni=pt.useMemo(()=>{if(!Ae)return null;const $=.25,J=Ae.width&&Ae.width>0?Ae.width:0,Wt=Ae.height&&Ae.height>0?Ae.height:0;return!J||!Wt?{width:320,height:0,scale:$}:{width:Math.max(160,Math.round(J*$)),height:Math.max(0,Math.round(Wt*$)),scale:$}},[Ae]);return pt.useEffect(()=>()=>{xi.current?.(),xi.current=null},[]),D.jsx("div",{className:"min-h-screen bg-background text-foreground",children:D.jsxs("main",{className:"mx-auto flex w-full max-w-5xl flex-col gap-10 px-6 py-16",children:[D.jsx("header",{className:"flex flex-col gap-4 border-b border-border/60 pb-6",children:D.jsxs("div",{className:"flex items-center justify-between",children:[D.jsxs("div",{children:[D.jsx("h1",{className:"text-3xl font-bold tracking-tight sm:text-4xl",children:"Artwork Analyzer AI Agent"}),D.jsx("p",{className:"text-sm text-muted-foreground",children:"Analyse artwork files, review auto-generated reports, and manage AI configuration & knowledge documents."})]}),D.jsxs("nav",{className:"inline-flex rounded-lg border border-border/70 bg-card shadow-sm",children:[D.jsx("button",{type:"button",onClick:()=>t("analyze"),className:`rounded-l-lg px-4 py-2 text-sm font-medium transition ${m==="analyze"?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground"}`,children:"Analyzer"}),D.jsx("button",{type:"button",onClick:()=>t("admin"),className:`rounded-r-lg px-4 py-2 text-sm font-medium transition ${m==="admin"?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground"}`,children:"Admin"})]})]})}),m==="analyze"?D.jsxs(D.Fragment,{children:[D.jsxs("section",{className:"space-y-4",children:[D.jsx("h2",{className:"text-2xl font-semibold",children:"Analyse artwork files in the browser"}),D.jsx("p",{className:"max-w-2xl text-lg text-muted-foreground",children:"Upload a PNG or PDF to generate an instant print-readiness report. DPI, recommended sizes, ICC profile data, and DTF production guidelines are summarised here and forwarded to the AI assistant backend."}),D.jsxs("div",{className:"flex flex-wrap gap-3",children:[D.jsxs("label",{className:"inline-flex cursor-pointer items-center gap-2 rounded-lg border border-dashed border-border/70 bg-card px-4 py-2 text-sm font-medium shadow-sm transition hover:border-primary",children:[D.jsx("input",{type:"file",accept:".png,.pdf,image/png,application/pdf",className:"hidden",onChange:pl,disabled:c}),c?"Analysing":"Select PNG or PDF"]}),r&&D.jsx("span",{className:"text-sm text-destructive",role:"alert",children:r})]})]}),i?D.jsxs("section",{className:"grid gap-6 rounded-2xl border border-border/70 bg-card/80 p-6 shadow-sm backdrop-blur",children:[D.jsxs("header",{className:"space-y-1",children:[D.jsx("h3",{className:"text-2xl font-semibold",children:i.fileName}),D.jsxs("p",{className:"text-sm text-muted-foreground",children:[i.quality.fileType.toUpperCase(),"  ",YA(i.quality.fileSizeMB),"  Rating:"," ",D.jsx("span",{className:"font-medium text-primary",children:i.quality.rating})]})]}),Ae&&Ni&&D.jsxs("div",{className:"rounded-lg border border-border/70 bg-background/80 p-4",children:[D.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-muted-foreground",children:"Artwork preview"}),D.jsx("div",{className:"mt-3 flex justify-center",children:D.jsx("img",{src:Ae.url,alt:`Preview of ${i.fileName}`,loading:"lazy",style:{width:`${Ni.width}px`,height:Ni.height?`${Ni.height}px`:"auto"},className:"rounded border border-border/60 bg-muted object-contain shadow-sm"})}),D.jsxs("p",{className:"mt-2 text-xs text-muted-foreground",children:["Displayed at approximately ",Math.round(Ni.scale*100),"% scale. Original size:"," ",Ae.width?`${Ae.width}px`:"unknown","  ",Ae.height?`${Ae.height}px`:"unknown"," px."]})]}),D.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[D.jsxs("div",{className:"rounded-lg border border-border/70 bg-background/80 p-4",children:[D.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-muted-foreground",children:"Dimensions & DPI"}),D.jsxs("dl",{className:"mt-2 space-y-1 text-sm",children:[D.jsxs("div",{className:"flex justify-between",children:[D.jsx("dt",{children:"Category"}),D.jsx("dd",{children:i.quality.imageCategory})]}),D.jsxs("div",{className:"flex justify-between",children:[D.jsx("dt",{children:"Pixels"}),D.jsx("dd",{children:i.quality.pixels?`${i.quality.pixels.w} x ${i.quality.pixels.h}`:"Vector / N/A"})]}),D.jsxs("div",{className:"flex justify-between",children:[D.jsx("dt",{children:"DPI"}),D.jsx("dd",{children:i.quality.dpi??"Not embedded"})]}),D.jsxs("div",{className:"flex justify-between",children:[D.jsx("dt",{children:"Aspect ratio"}),D.jsx("dd",{children:i.quality.aspectRatio})]}),D.jsxs("div",{className:"flex justify-between",children:[D.jsx("dt",{children:"Bit depth"}),D.jsx("dd",{children:i.quality.bitDepth??"N/A"})]}),D.jsxs("div",{className:"flex justify-between",children:[D.jsx("dt",{children:"Alpha channel"}),D.jsx("dd",{children:i.quality.hasAlpha?"Yes":"No"})]})]})]}),D.jsxs("div",{className:"rounded-lg border border-border/70 bg-background/80 p-4",children:[D.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-muted-foreground",children:"Recommended print sizes"}),D.jsxs("dl",{className:"mt-2 space-y-1 text-sm",children:[D.jsxs("div",{className:"flex justify-between",children:[D.jsx("dt",{children:"300 DPI"}),D.jsxs("dd",{children:[`${i.quality.recommendedSizes.at300dpi.w_in}"  ${i.quality.recommendedSizes.at300dpi.h_in}"`,D.jsx("span",{className:"text-xs text-muted-foreground",children:` (${i.quality.recommendedSizes.at300dpi.w_cm}  ${i.quality.recommendedSizes.at300dpi.h_cm} cm)`})]})]}),D.jsxs("div",{className:"flex justify-between",children:[D.jsx("dt",{children:"150 DPI"}),D.jsxs("dd",{children:[`${i.quality.recommendedSizes.at150dpi.w_in}"  ${i.quality.recommendedSizes.at150dpi.h_in}"`,D.jsx("span",{className:"text-xs text-muted-foreground",children:` (${i.quality.recommendedSizes.at150dpi.w_cm}  ${i.quality.recommendedSizes.at150dpi.h_cm} cm)`})]})]}),D.jsxs("div",{className:"flex justify-between",children:[D.jsx("dt",{children:"ICC profile"}),D.jsx("dd",{children:i.quality.hasICC?i.quality.iccProfile??"Embedded":"Not embedded"})]})]})]})]}),Je&&D.jsxs("div",{className:"rounded-lg border border-border/70 bg-background/80 p-4",children:[D.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-muted-foreground",children:"Alpha channel details"}),D.jsxs("dl",{className:"mt-2 grid gap-2 text-sm sm:grid-cols-3",children:[D.jsxs("div",{className:"flex justify-between",children:[D.jsx("dt",{children:"Sample size"}),D.jsx("dd",{children:Je.sampleSize.toLocaleString()})]}),D.jsxs("div",{className:"flex justify-between",children:[D.jsx("dt",{children:"Minimum value"}),D.jsx("dd",{children:Je.min})]}),D.jsxs("div",{className:"flex justify-between",children:[D.jsx("dt",{children:"Maximum value"}),D.jsx("dd",{children:Je.max})]})]}),D.jsx("div",{className:"mt-3 overflow-x-auto",children:D.jsxs("table",{className:"min-w-full divide-y divide-border/60 text-sm",children:[D.jsx("thead",{className:"bg-muted/20 text-left text-xs uppercase tracking-wide text-muted-foreground",children:D.jsxs("tr",{children:[D.jsx("th",{className:"px-3 py-2",children:"Alpha range"}),D.jsx("th",{className:"px-3 py-2",children:"Transparency"}),D.jsx("th",{className:"px-3 py-2 text-right",children:"Pixels"}),D.jsx("th",{className:"px-3 py-2 text-right",children:"Percent"})]})}),D.jsxs("tbody",{className:"divide-y divide-border/60",children:[D.jsxs("tr",{children:[D.jsx("td",{className:"px-3 py-2 font-medium text-foreground",children:"0"}),D.jsx("td",{className:"px-3 py-2",children:"Fully transparent"}),D.jsx("td",{className:"px-3 py-2 text-right",children:Je.transparentCount.toLocaleString()}),D.jsxs("td",{className:"px-3 py-2 text-right",children:[Je.transparentPercent.toFixed(2),"%"]})]}),D.jsxs("tr",{children:[D.jsx("td",{className:"px-3 py-2 font-medium text-foreground",children:"1-254"}),D.jsx("td",{className:"px-3 py-2",children:"Semi transparent"}),D.jsx("td",{className:"px-3 py-2 text-right",children:Je.semiTransparentCount.toLocaleString()}),D.jsxs("td",{className:"px-3 py-2 text-right",children:[Je.semiTransparentPercent.toFixed(2),"%"]})]}),D.jsxs("tr",{children:[D.jsx("td",{className:"px-3 py-2 font-medium text-foreground",children:"255"}),D.jsx("td",{className:"px-3 py-2",children:"Fully opaque"}),D.jsx("td",{className:"px-3 py-2 text-right",children:Je.opaqueCount.toLocaleString()}),D.jsxs("td",{className:"px-3 py-2 text-right",children:[Je.opaquePercent.toFixed(2),"%"]})]})]})]})})]}),i.colors&&i.colors.top.length>0&&D.jsxs("div",{className:"rounded-lg border border-border/70 bg-background/80 p-4",children:[D.jsxs("div",{className:"flex items-center justify-between",children:[D.jsxs("div",{children:[D.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-muted-foreground",children:"Palette overview"}),D.jsx("p",{className:"text-xs text-muted-foreground",children:"Dominant colours detected across the artwork; exported alongside the AI prompt."})]}),h&&D.jsxs("div",{className:"flex gap-2 text-xs",children:[D.jsx("a",{href:h.csvUrl,download:`${i.fileName}-palette.csv`,className:"rounded-md border border-border/70 bg-background px-2 py-1 font-medium text-foreground transition hover:border-primary",children:"Download CSV"}),D.jsx("a",{href:h.jsonUrl,download:`${i.fileName}-palette.json`,className:"rounded-md border border-border/70 bg-background px-2 py-1 font-medium text-foreground transition hover:border-primary",children:"Download JSON"})]})]}),D.jsx("div",{className:"mt-4 grid gap-3 sm:grid-cols-2 lg:grid-cols-4",children:i.colors.top.map($=>D.jsxs("div",{className:"flex flex-col overflow-hidden rounded-lg border border-border/60 bg-background/90",children:[D.jsx("div",{className:"h-20 w-full",style:{backgroundColor:$.hex},"aria-hidden":"true"}),D.jsxs("div",{className:"flex flex-col gap-1 px-3 py-2 text-xs text-muted-foreground",children:[D.jsx("span",{className:"font-medium text-foreground",children:$.hex}),typeof $.percent=="number"&&D.jsxs("span",{children:[$.percent.toFixed(2),"% of sampled pixels"]}),typeof $.count=="number"&&$.count>0&&D.jsxs("span",{children:[$.count," samples"]}),D.jsxs("span",{children:["RGB ",`(${$.rgb[0]}, ${$.rgb[1]}, ${$.rgb[2]})`]})]})]},$.hex))})]}),D.jsxs("div",{className:"rounded-lg border border-border/70 bg-background/80 p-4",children:[D.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-muted-foreground",children:"Notes"}),D.jsx("ul",{className:"mt-2 list-disc space-y-1 pl-5 text-sm text-muted-foreground",children:i.quality.notes.map($=>D.jsx("li",{children:$},$))})]}),D.jsxs("div",{className:"rounded-lg border border-border/70 bg-background/80 p-4",children:[D.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-muted-foreground",children:"Ask the AI assistant"}),D.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"The assistant uses the analysis summary and any uploaded knowledge-base documents to answer."}),D.jsxs("div",{className:"mt-3 space-y-3",children:[D.jsx("textarea",{value:p,onChange:$=>y($.target.value),rows:3,className:"w-full resize-y rounded-lg border border-border/70 bg-background px-3 py-2 text-sm text-foreground shadow-sm focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30",placeholder:"Ask something about print readiness, colour accuracy, or file preparation...",disabled:E}),D.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[D.jsx("button",{type:"button",onClick:()=>void da(),disabled:E||!p.trim(),className:"inline-flex items-center rounded-lg bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow transition hover:bg-primary/90 disabled:cursor-not-allowed disabled:opacity-60",children:E?"Thinking":"Send to assistant"}),w&&D.jsx("span",{className:"text-sm text-destructive",role:"alert",children:w})]}),b&&D.jsx("div",{className:"rounded-md border border-border/60 bg-muted/30 p-3 text-sm leading-relaxed text-muted-foreground",children:b})]})]})]}):D.jsxs("section",{className:"grid gap-4 rounded-2xl border border-dashed border-border/60 bg-card/60 p-6 backdrop-blur",children:[D.jsx("h3",{className:"text-xl font-semibold",children:"Kick-off toolkit ready"}),D.jsxs("ul",{className:"grid gap-3 text-sm text-muted-foreground sm:grid-cols-2",children:[D.jsxs("li",{className:"rounded-lg border border-border/60 bg-background/70 p-4",children:[D.jsx("span",{className:"font-medium text-foreground",children:"Tailwind + shadcn/ui"}),D.jsx("p",{className:"mt-2 text-sm",children:"Design tokens, theming, and component registry are configured to match the shadcn/ui guidelines."})]}),D.jsxs("li",{className:"rounded-lg border border-border/60 bg-background/70 p-4",children:[D.jsx("span",{className:"font-medium text-foreground",children:"Type-safe module aliasing"}),D.jsxs("p",{className:"mt-2 text-sm",children:["Use ",D.jsx("code",{className:"rounded bg-muted px-1",children:"@/*"})," and"," ",D.jsx("code",{className:"rounded bg-muted px-1",children:"@shared/*"})," imports across the frontend as we build shared utilities and components."]})]}),D.jsxs("li",{className:"rounded-lg border border-border/60 bg-background/70 p-4",children:[D.jsx("span",{className:"font-medium text-foreground",children:"Cloudflare worker scaffold"}),D.jsx("p",{className:"mt-2 text-sm",children:"Hono-based worker, Wrangler config, and basic bindings are ready to expand into the analysis + AI API."})]})]})]})]}):D.jsxs("section",{className:"grid gap-6 rounded-2xl border border-border/70 bg-card/80 p-6 shadow-sm backdrop-blur",children:[D.jsxs("header",{className:"space-y-1",children:[D.jsx("h3",{className:"text-2xl font-semibold",children:"Admin configuration"}),D.jsx("p",{className:"text-sm text-muted-foreground",children:"Update AI provider settings and manage RAG documents. API keys are stored encrypted in KV; leave the field blank to keep the current key unchanged."})]}),D.jsx("div",{className:"grid gap-6 rounded-lg border border-border/70 bg-background/80 p-4",children:L?D.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading configuration..."}):C?D.jsxs("div",{className:"grid gap-4",children:[D.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[D.jsx("span",{className:"font-medium text-foreground",children:"Admin token"}),D.jsx("input",{className:"rounded-md border border-border/60 bg-background px-3 py-2 text-sm",value:ht,onChange:$=>{vt($.target.value),k&&($.target.value.trim()?window.localStorage.setItem("artwork-admin-token",$.target.value.trim()):window.localStorage.removeItem("artwork-admin-token"))},placeholder:"Enter admin token to access secured endpoints",type:"password"}),D.jsxs("label",{className:"mt-1 inline-flex items-center gap-2 text-xs text-muted-foreground",children:[D.jsx("input",{type:"checkbox",checked:k,onChange:$=>{q($.target.checked),$.target.checked?ht.trim()&&window.localStorage.setItem("artwork-admin-token",ht.trim()):window.localStorage.removeItem("artwork-admin-token")}}),"Remember token in this browser"]})]}),D.jsxs("div",{className:"grid gap-2 sm:grid-cols-2",children:[D.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[D.jsx("span",{className:"font-medium text-foreground",children:"Provider"}),D.jsx("select",{className:"rounded-md border border-border/60 bg-background px-3 py-2 text-sm",value:C.provider,onChange:$=>T(J=>J&&{...J,provider:$.target.value}),children:bl.map($=>D.jsx("option",{value:$.value,disabled:$.disabled,children:$.label},$.value))})]}),D.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[D.jsx("span",{className:"font-medium text-foreground",children:"Chat model"}),D.jsx("input",{className:"rounded-md border border-border/60 bg-background px-3 py-2 text-sm",value:C.model,onChange:$=>T(J=>J&&{...J,model:$.target.value})})]}),D.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[D.jsx("span",{className:"font-medium text-foreground",children:"Embedding model"}),D.jsx("input",{className:"rounded-md border border-border/60 bg-background px-3 py-2 text-sm",value:C.embeddingModel,onChange:$=>T(J=>J&&{...J,embeddingModel:$.target.value})})]}),D.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[D.jsx("span",{className:"font-medium text-foreground",children:"API key"}),D.jsx("input",{className:"rounded-md border border-border/60 bg-background px-3 py-2 text-sm",value:B,onChange:$=>O($.target.value),placeholder:C.apiKey?"Current key hidden  enter to replace":"Enter provider API key",type:"password"})]})]}),D.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[D.jsx("span",{className:"font-medium text-foreground",children:"System prompt"}),D.jsx("textarea",{className:"min-h-[120px] rounded-md border border-border/60 bg-background px-3 py-2 text-sm",value:C.systemPrompt,onChange:$=>T(J=>J&&{...J,systemPrompt:$.target.value})})]}),D.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[D.jsx("button",{type:"button",onClick:()=>void ml(),disabled:G,className:"inline-flex items-center rounded-lg bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow transition hover:bg-primary/90 disabled:cursor-not-allowed disabled:opacity-60",children:G?"Saving...":"Save configuration"}),tt&&D.jsx("span",{className:"text-sm text-muted-foreground",children:tt}),ut&&D.jsx("span",{className:"text-sm text-destructive",role:"alert",children:ut})]})]}):D.jsx("p",{className:"text-sm text-destructive",role:"alert",children:ut??"No configuration loaded."})}),D.jsxs("div",{className:"grid gap-4 rounded-lg border border-border/70 bg-background/80 p-4",children:[D.jsxs("div",{className:"flex items-center justify-between",children:[D.jsxs("div",{children:[D.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-muted-foreground",children:"Knowledge-base documents"}),D.jsx("p",{className:"text-xs text-muted-foreground",children:"Upload Markdown or plain text files; they will be chunked, embedded, and added to the RAG store."})]}),D.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[D.jsx("input",{ref:ci,type:"file",accept:".txt,.md,.markdown,.TXT,.MD,.MARKDOWN",onChange:Cr,className:"text-xs text-muted-foreground"}),D.jsx("button",{type:"button",onClick:()=>void yl(),disabled:I||!Oe,className:"inline-flex items-center rounded-md border border-border/60 bg-background px-3 py-1 text-xs font-medium transition hover:border-primary disabled:cursor-not-allowed disabled:opacity-60",children:I?`Uploading${et!==null?` ${et}%`:"..."}`:"Upload"})]}),et!==null&&D.jsx("div",{className:"h-2 w-full overflow-hidden rounded bg-muted",children:D.jsx("div",{className:"h-full bg-primary transition-[width] duration-200",style:{width:`${Math.max(0,Math.min(100,et))}%`}})})]}),ft&&D.jsx("span",{className:`text-xs ${Ei}`,children:ft}),D.jsx("div",{className:"overflow-hidden rounded-lg border border-border/70",children:D.jsxs("table",{className:"min-w-full divide-y divide-border/70 text-sm",children:[D.jsx("thead",{className:"bg-muted/30",children:D.jsxs("tr",{children:[D.jsx("th",{className:"px-3 py-2 text-left font-medium text-muted-foreground",children:"Document"}),D.jsx("th",{className:"px-3 py-2 text-left font-medium text-muted-foreground",children:"Chunks"}),D.jsx("th",{className:"px-3 py-2 text-left font-medium text-muted-foreground",children:"Updated"}),D.jsx("th",{className:"px-3 py-2 text-right font-medium text-muted-foreground",children:"Actions"})]})}),D.jsx("tbody",{className:"divide-y divide-border/70 bg-background/60",children:xt?D.jsx("tr",{children:D.jsx("td",{colSpan:4,className:"px-3 py-4 text-center text-muted-foreground",children:"Loading documents..."})}):Z.length?Z.map($=>D.jsxs("tr",{children:[D.jsx("td",{className:"px-3 py-2 font-medium text-foreground",children:$.source}),D.jsx("td",{className:"px-3 py-2 text-muted-foreground",children:$.chunks}),D.jsx("td",{className:"px-3 py-2 text-muted-foreground",children:$A($.updated_at)}),D.jsx("td",{className:"px-3 py-2 text-right",children:D.jsx("button",{type:"button",onClick:()=>void Le($.source),className:"rounded-md border border-border/60 px-2 py-1 text-xs text-destructive transition hover:border-destructive",children:"Remove"})})]},$.source)):D.jsx("tr",{children:D.jsx("td",{colSpan:4,className:"px-3 py-4 text-center text-muted-foreground",children:"No documents uploaded yet."})})})]})})]})]})]})})}A0.createRoot(document.getElementById("root")).render(D.jsx(pt.StrictMode,{children:D.jsx(KA,{})}));
